commit 275728e appears to have broken include issue type bug report ansible version running from source commit 275728e from jimi ansible configuration there is no etc ansible ansible cfg` file environment ubuntu 14 04 presumably independent of environment summary we regularly move forward with the source to take advantage of newly committed features and it appears that `include statements have been broken by the referenced commit steps to reproduce have four files in my simple repro file `inventory ini` file `playbook yml` file `roles sample role main yml` file `roles sample role included file yml` the repro is run with `ansible playbook inventory ini playbook yml` expected results actual results >>>bug_report
make sure we close file descriptors to avoid leaks>>>bugfix_pull_request in_progress
some typos in changelog md>>>docs_pull_request
include vars merge now include vars follows hash behavior settings>>>bugfix_pull_request in_progress
bug skipping task due to undefined attribute with with item even with default attribute hi trying to resolve an issue on ansible v2 migrated from v1 to v2 and had issues on testing my roles with ansible running debian jessie one of the issue is when using when statement with an undefined value all vars in with items are evaluated here is an example ve dict and if var is defined know that can evaluate it in my dict however in any case dict var list is evaluated which send warning message should get skipping value when var is not defined instead of this message even with the default function it doesn work hope my explanations are clear >>>bug_report
update playbooks roles rst just fixed double colon>>>docs_pull_request
shell or command fails in ubuntu 14 04 after installing ansible tower using the official installer with high availability option on vanilla ubuntu box with replication noticed my regular playbooks are failing at the shell command modules please see the sample playbook below when run it get the following error >>>bug_report p2
allow skipping tasks due to undefined var mimic behaviour but give out big deprecation message not only for missing attribute but any undefined error >>>bugfix_pull_request
regression with template lookup between ansible and after upgraging from ansible to lookup for template silently stops searching for template in files directory name creating vm virt command define guest hostname xml lookup template domain xml j2 delegate to hypervisor domain xml j2 was stored in files directory it worked in but broke in with message fatal dev failed failed true msg error the template file domain xml j2 could not be found for the lookup after moving files domain xml j2 to template domain xml j2 it start to work but think without deprecation warning this is clear regression corresponding launchpad bug https bugs launchpad net ubuntu source ansible bug 1544628>>>bug_report
change link in documentation for clarify>>>docs_pull_request
if role is skipped due to failed conditional the role dependencies are skipped in subsequent calls version ansible test inventory local 127 playbook yml hosts local gather facts no roles role alpha when false alpha roles alpha meta main yml allow duplicates yes dependencies beta roles alpha tasks main yml debug msg alpha roles beta tasks main yml debug msg beta invocation ansible playbook inventory playbook yml expected result play task beta debug skipping 127 task alpha debug skipping 127 task beta debug ok 127 msg beta task alpha debug ok 127 msg alpha play recap 127 ok changed unreachable failed actual result play task beta debug skipping 127 task alpha debug skipping 127 task beta debug skipping 127 task alpha debug ok 127 msg alpha play recap 127 ok changed unreachable failed >>>bug_report
cartesian product is not working anymore with ansible version configuration nothing special environment linux mint 17 summary cartesian product is not working anymore steps to reproduce here is small test to reproduce it expected results actual results with the result is possible fix remplacing https github com ansible ansible blob devel lib ansible plugins lookup cartesian py l53 by return self flatten for in product my list `>>>bug_report
upgrade to ps3 ps1 add memory fix for ps3 if upgrade to ps3 ps1 is used to upgrade powershell to the following fix should be installed to this prevents issues with max memory allocation for powershell please add this to upgrade to ps3 ps1 this fix is superseeded by powershell wmf maybe add upgrade to ps4 ps1 https support microsoft com en us kb 2842230>>>bug_report windows
inventory refresh inventory does not refresh inventory restriction if we are updating the inventory with the meta action refresh inventory the internal list of the inventory will be refreshed and new objects will be inserted into the new list but since the following code does equal check via memory address of host1 memory address of host2 further checks will fail and the host will not be returned see l204 refresh should search for restrition hosts on the new list and replace the old restriction host list>>>bug_report
ansible api documentation required am trying to use ansible api to run playbook file could not find proper doc for ansible anyone please explain me how to run playbook not play>>>docs_report
cleanup for networking common bits move conditional class to netcfg added error handling for connect and execute methods >>>bugfix_pull_request feature_pull_request
changed when true does not display the task as changed ansible version expected test changed when to be changed and yellow was ok and green instead changed when test yml result >>>bug_report
dnf module nameerror global name util is not defined ansible vomitting while trying to run dnf task on fedora 23 throws this error >>>bug_report feature_idea
error timeout 12s waiting for privilege escalation prompt issue type bug report ansible version ansible boto version 38 python version environment rhel summary am seeing the following error at random times on one really long playbook failed failed true msg error timeout 12s waiting for privilege escalation prompt running the same playbook under ansible never saw this problem it started happening when upgraded to ansible rc1 now we see it maybe one time out of three so 90 sure it related to ansible it generally happens about 10 minutes into the play and rarely happens at the same task the task itself doesn matter it could be in loop not loop file copy lineinefile etc failure means starting over so it would be really really nice to know what going on can at least increase that 12 sec timeout somehow tried enabling ssh pipelining thinking it would speed things up and skip over the issue but it made no difference it also didn reduce the time of the playbook either so don think it actually working tried debug vvvv and didn see anything obvious how to tell if pipelining is active >>>bug_report p2
any errors fatal doesn work when using includes in roles issue type bug report ansible version commit 64c976a6c395967f5d5dd29c00d53ca71c14f5c7 merge 371c731 3079a03 author brian coca date wed feb 10 15 42 29 2016 0500 merge pull request 14416 from bcoca diff size fix read full file when doing diff default configuration environment ubuntu 14 04 summary any errors fatal doesn stop task execution if failed in includes steps to reproduce playbook name test an errors fatal with includes hosts all any errors fatal true roles role test1 role test2 cat test1 tasks main yml include helper yml cat test1 tasks helper yml fail msg failed in include of test1 cat test2 tasks main yml include helper yml cat test2 tasks helper yml fail msg failed in include of test2 play test an errors fatal with includes task setup ok 192 168 208 104 ok 192 168 208 85 task test1 include included home zerostack ansible roles test1 tasks helper yml for 192 168 208 85 192 168 208 104 task test1 fail fatal 192 168 208 85 failed changed false failed true msg failed in include of test1 fatal 192 168 208 104 failed changed false failed true msg failed in include of test1 task test2 include included home zerostack ansible roles test2 tasks helper yml for 192 168 208 85 192 168 208 104 task test2 fail fatal 192 168 208 85 failed changed false failed true msg failed in include of test2 fatal 192 168 208 104 failed changed false failed true msg failed in include of test2 	to retry use limit home zerostack ansible include any errors fatal retry play recap 192 168 208 104 ok changed unreachable failed 192 168 208 85 ok changed unreachable failed >>>bug_report p2
add arista eos as platform in galaxy metadata after an ``ansible galaxy init name`` the resulting role meta main yml contains ``platform`` key the comments mention that if your platform is not present then ask can we add arista or eos to this list >>>feature_idea
delegate to doesn recognize hosts from dynamic inventory issue type bug report ansible version tested on both version and here the output it the same for both except for the final digit of course ansible configuration default nothing special environment not relevant summary `delegate to` doesn realize when you re specifying host that in the inventory iff you use dynamic inventory whereas that functionality works fine for static inventory steps to reproduce the file `inventory dynamic sh` simply contains `cat inventory hosts json` contents of `inventory hosts ini` contents of `inventory hosts json` this is my `site yml` file simply run expected results expect that the playbook will behave identically whether or not the inventory is dynamic specifically expect that ansible will figure out if delegating to host within the inventory and behave accordingly actual results some irrelevant redundant output omitted for brevity when run `ansible playbook inventory dynamic sh vvv kk site yml` get when run `ansible playbook inventory hosts ini vvv kk site yml` get know the issue is host variable inference because of the line `establish ssh connection for user none` in the first output >>>bug_report p2
terminate moved to base cli class to handle centrally and duplicate less code now avoids duplication and reiteration of signal handler by reassigning it left note on how to do non graceful in case we add in future as won remember everything did here and don want to relearn it >>>bugfix_pull_request
getting boolean error on new v2 s3 checksum overwrite option hi we re getting the error below when using overwrite different per the docs http docs ansible com ansible s3 module html we are calling it just like in the docs example we are using ansible 2>>>bug_report
svr4pkg fails to install package on subsequent runs installing package on solaris 10 with svr4pkg works on the first run but then fails on subsequent runs if remove the package manually then it will succeed again on the next run to install it but then subsequent runs will fail again ansible play name test installation avec svr4pkg svr4pkg name sunweu8os src reposolaris10 media solaris 10 u11 solaris 10 product state present svr4pkg name sunwi1cs src reposolaris10 media solaris 10 u11 solaris 10 product state present tags testdavepkg` 1st run `task solaris10 test installation avec svr4pkg changed ct20sldomsbxd01 subsequent runs `task solaris10 test installation avec svr4pkg fatal ct20sldomsbxd01 failed changed false failed true name sunwi1cs state present running ansible from ubuntu 14 04 on solaris 10 13 client >>>needs_to_be_moved
module params should default to str in most cases fixes https github com ansible ansible modules core issues 2867>>>bugfix_pull_request
read full file when doing diff but avoid reading file at all or full file when file is too big for diffing fixes 14406 alternative to 14051 and 14407 >>>bugfix_pull_request
dev pip module using both executable and virtualenv params installs to system instead of in virtual environment issue type bug report ansible version edit have just installed the latest dev version and still see the issue `sudo pip install git https github com ansible ansible git devel egg ansible` actually encountered this behavior in ansible and too ansible configuration environment tested on `bento ubuntu 14 04` vagrant box summary in the `pip` module when both the `executable` and `virtualenv` parameters are used the named package is installed in the system instead of in the virtual environment steps to reproduce running the following playbook will install `bottle` in the system rather than in the virtual environment `executable` points to usr bin pip` because have installed the latest version of `pip` namely using `get pip py` this will create virtual environment in home vagrant myenv` and install `bottle` in the system if the `executable` parameter is removed then the named package is installed in the virtual environment expected results would have expected either that the package were installed inside the virtual environment or that ansible returned an error saying that `executable` and `virtualenv` are not compatible similarly to `name` vs `requirements` actual results this will create virtual environment in home vagrant myenv` and install `bottle` in the system >>>bug_report
elasticache summarily fails ansible version the cache subnet group directive works but attempting to configure an elasticache cluster just fails elasticache config error >>>bug_report
reboot and wait for hi have the below as part of my playbok to upgrade all system packages reboot the machine and wait for it to come back the ansible playbook exists when machine reboots and is not waiting for the host to come back online and run the remaining playbook can you please suggest reboot works but unusable playbook lost it connection as shown with above error let me know if any details required thanks thanks govind>>>bug_report
inventory refresh inventory does not refresh inventory restriction if we are updating the inventory with the meta action refresh inventory the internal list of the inventory will be refreshed and new objects will be inserted into the new list but since the following code does equal check via memory address of host1 memory address of host2 further checks will fail and the host will not be returned see l204 https github com ansible ansible blob d9dcb2a427f4041f121950668c4ae40b0042c0d6 lib ansible inventory init py l204 refresh should search for restrition hosts on the new list and replace the old restriction host list>>>bug_report
redefining variables from meta different behavior in rc and hello ve got bunch of playbooks written initially for ansible by my precedessor recently tried to adapt it to ansible and discovered the difference in variable hadling when you override defaults in meta main yml like know whether it bug or feature ve tried versions of ansible ansible ansible detached head cc98528ecb last updated 2015 12 19 18 44 56 gmt 300 lib ansible modules core detached head fcb3397df7 last updated 2015 12 19 18 44 51 gmt 300 lib ansible modules extras detached head c6829752d8 last updated 2015 12 19 18 44 56 gmt 300 ansible detached head 7de237c5a1 last updated 2016 01 21 23 40 54 gmt 300 lib ansible modules core detached head 09e2457eb0 last updated 2016 01 21 23 40 48 gmt 300 lib ansible modules extras detached head e8427cb32a last updated 2016 01 21 23 40 54 gmt 300 first going to show test code also here https github com serge name test override var playbook yml test override var1 meta main yml test override var1 tasks main yml test override var1 meta main yml test override var3 defaults main yml test override var3 tasks main yml on ansible get the following sequence the desired behavior on ansible rc get the following and it gives me problems on ansible get the following problems again >>>bug_report
difficult to see full traceback for transient errors ansible version ansible playbook devel 5a88478 last updated 2016 02 10 12 21 18 gmt 300 lib ansible modules core detached head 9fc4ed0458 last updated 2016 02 10 12 21 20 gmt 300 lib ansible modules extras detached head 6aeb2ab6cf last updated 2016 02 10 12 21 20 gmt 300 summary when an internal error happens ansible shows message like if that error is hard to reproduce seeing the traceback is virtually impossible unless run with vvv all the time which is not something willing to do please always report the full traceback in case of errors if you don want to scare users with long tracebacks on screen then log to log file somewhere tmp ansible log ansible log ansible log or cache ansible ansible log whatever and tell the user they can find more information there >>>bug_report feature_idea
error unexpected exception nonetype object has no attribute terminate ansible version ansible playbook devel 5a88478ccc last updated 2016 02 10 12 21 18 gmt 300 lib ansible modules core detached head 9fc4ed0458 last updated 2016 02 10 12 21 20 gmt 300 lib ansible modules extras detached head 6aeb2ab6cf last updated 2016 02 10 12 21 20 gmt 300 summary every now and then get this error after run it sounds like the traditional problem of python thread running code during interpreter shutdown all the globals are set to none it hard to reproduce which means either run with vvv` all the time or ll never see the traceback so ve no clue nor what code >>>bug_report
diff don truncate local source file while it makes sense not to read multi gigabyte binary files into ram it not nice to show spurious diffs when text files also get truncated to the first kb fixes 14406 >>>bugfix_pull_request
malformed diff for long files when using the copy module ansible version summary trying to generate etc collectd collectd conf` using the `template` `copy` module when preview my changes get diffs like this note how the generated version of the template appears to be truncated actually applying the change works fine the apparent truncation happens only during diff >>>bug_report
dependent roles are only run for the first call even if allow duplicates yes using ansible devel branch 5a88478 have two roles role test2 is dependent of role test1 allow duplicates is defined in role test1 in order to be run each time role test1 is used but with this simple playbook test yml we can see it not the case output it should be test files are here https github com fabix ansible dependencies test>>>bug_report p2
paramiko transport appears to hang if it gets sudo lecture bring paramiko transport closer to ssh transport in how it deals with prompt>>>bugfix_pull_request p2
missing bin sh after upgrading to v2 on mac os yosemite upgraded to and wasn available to ssh anymore using vvv got this `ssh controlmaster auto controlpersist 60s kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user devops connecttimeout 10 controlpath users nbari ansible cp ansible ssh 10 lang en us utf lc all en us utf lc messages en us utf usr local bin python comparing the output of ansible v1 notice that there is missing bin sh before the` lang en us utf for now had to rollback to >>>bug_report pending_closure
ansible pull fails when no longer existing branch was checked out in the past when run ansible pull like this then delete `some branch` on the git remote and run ansible pull with an option to checkout the `master` branch instead this error occurs the solution is to delete the ansible pull git directory specified by directory` above this happens with ansible version installed from pip >>>bug_report
net common cleanup move conditional class from command modules to netcfg added consistent error handling to connect and execute methods >>>feature_pull_request
get url fails when moving file and become true worked in broken in the block above throws this error other tasks before the code block above run properly and can sudo to root example >>>bug_report
stdout lines has extra become success probably need to strip become success before splitting to an array>>>bug_report
task state rescued issue type feature idea ansible version ansible configuration no relevant changes in ansible configuration for this feature idea environment archlinux ansible installed via pip in virtualenv python summary ``blocks`` feature with ``rescue`` results in play recap with failed events pretty much like to see another event like ``rescued`` know there was an error but this was possibly on purpose and got dealt with in rescue block and it is therefor not an error in terms of plays recap steps to reproduce expected results no failed events in play recap reporting actual results there is one failed event in play recap reporting further observation the following playbook the same as above without using include removes the failed event from the recap completely this feels quite inconsistent >>>feature_idea
python crypto missing from ansible ansible repository can you please copy python crypto 1chl1 precise1 from the ansible ansible ppa into the ansible ansible ppa so ansible is installable on ubuntu 12 04 thanks >>>bug_report
strip become success at lower level script and probably others still has become sucess in stdout>>>bug_report p2
shell command tasks fail with attribute error tuple object has no attribute items issue type bug report ansible version ansible configuration nothing different env running ubuntu 14 04 running against centos machines summary command and shell are failing when using chown but it seems like it failing before it even executed steps to reproduce it looks like the following task in its entirety will cause the issue indentation is all weird above but it indented properly in my playbook here the stack trace for one of the ips >>>bug_report p2
ansible windows ssl certification installation hi guys have recently started using ansible for automating am trying to automate ssl certificate installation for windows 2008 r2 machines through ansible have created simple power shell script my script is perfectly working locally on windows machine but when am trying to run same scripts through ansible it is not working although through ansible can able to install p7b certificates but facing issues while installing pfx and p12 certificates any guidance is highly appreciate here is my sample power shell script certificatename certname pfx certificatepassword xxxxxx componentfolder temp certificatepath componentfolder certificatename pfxcert new object system security cryptography x509certificates x509certificate2 pfxcert import certificatepath certificatepassword exportable persistkeyset found above import is not able to write anything to pfxcert object echo pfxcert out file componentfolder cert output pfx after txt store get item cert localmachine my store open system security cryptography x509certificates openflags readwrite store add pfxcert store close >>>bug_report windows
windows net installation raw win chocolatey win webpicmd hi tried to install net on windows with ansible and task always fails raw output win webpicmd output win chocolatey output executing command in cmd was successful with webpicmd and choco what is the problem and how to install net it would be better to do it through webpicmd as the installation iis7 package depends on the net >>>bug_report windows
feature request disable specific fact gathering currently it seems that you can disable all fact gathering at once hosts beta gather facts no it would be good feature if we could disable only specific facts for example in my playbook the `fqdn` gathering is the culprit of hanging the whole playbook the only way to resolve this is by disabling gathering of all facts which however break some of my tasks this makes ansible pretty unusable since don have access to resolve the fqdn issue on the remote server probable solutions the way think of the solution would be to have `set fact` be able to be set on playbook basis instead of task and then it should bypass any gathering of that fact add `bypass fact` at playbook level to explicitly state which facts you don want to be gathered at all >>>feature_idea
support template variables in register and tags there currently no way to use variables in `register` and `tags` adding templating to those two would be helpful for cases where role tasks can be run on dictionaries so that something like this works and then running `ansible playbook baz` or alternatively `ansible playbook foo bar`>>>feature_idea
ansible errors on the task with the `with items` loop with `when some var is defined` condition when it is used in role but not in play issue type bug report ansible version ansible configuration nothing changed environment os 10 11 summary provided the `some var` variable is not defined ansible produces an error on the task with the `with items` loop with `when some var is defined` condition when it is used in role however it does not produce an error when that task is used in play given the input and command to run with ansible playbook from the develop branch get this expected output and behaviour with ansible if however the task is used in the `tasks` list in play instead of inside `roles` ansible correctly ignores it just to reiterate and make it as possibly clear as can my main point is that ansible does not error when the above mentioned task is being used in play but does error when the task is used in role it should either emit an error all the time regardless of where the task is and then one can use bold statements such as when using `with items` loop please make sure to define variable that is used in the loop regardless of the `when condition or it will error or not emit an error in case the `when some var is defined` is supplied in task with `with items some var` loop regardless of whether the task is in role or play please note this issue has been initially reported in https github com ansible ansible issues 14201but since the latter one has been closed for no reason am opening new issue>>>bug_report
task gives error status for some command output it happened with ansible version stevek ci new 1d448f02 roles ansible version ansible step to replicate it is very specific to command most commands using shell module runs fine however there is one command in our deployment that ansible consistently give error the command executes is success exit code is ansible will be happy if redirect stdout of the command to dev null so confirm that there is something in stdout that mess it up have executes command and log stdout and stderr into two files for reference if someone needs it however do not know how to attach to this bug report thanks>>>bug_report needs_info
add support for no expiration to jsonfile cache issue when using `fact caching jsonfile` to cache facts setting `fact caching timeout 0` does not disable cache expiration as it does with `fact caching redis` steps to reproduce configure ansible to cache facts to json file export ansible config ansible config cat ansible config defaults gathering smart fact caching jsonfile fact caching connection tmp ansible cache fact caching timeout create simple playbook cat ansible playbook yml hosts all tasks ping execute playbook multiple times for run in do ansible playbook ansible playbook yml done expected result note the setup task should only run on the first playbook execution it should be cached for the second execution actual result note the setup task is run for both executions >>>bug_report feature_idea
rfe permit passing stdin to commands shells want to be able to provide data to command via stdin in my ansible playbooks for example have playbook that uses `sfdisk` to handle partition manipulation this seems much more clear than the second requires the `shell` module to perform input redirection and requires referencing another file just to find small bit of input we already have `data` parameter in `module utils basic run command` so really this is just exposing it via the `command` module >>>feature_idea
added more info to the no action detected error error message update >>>docs_pull_request
fetch module doesn fail if remote file is missing in ansible head 50dfd4b the `fetch` module succeeds if the remote file is missing for example given the following playbook hosts targethost tasks fetch src lsidjfklhgjkdfhgkdjhfg dest localfile flat true and assuming host `targethost` exists in the inventory ansible playbook version ansible playbook devel 50dfd4b057 last updated 2016 02 07 11 26 30 gmt 400 lib ansible modules core detached head e1ec52e365 last updated 2016 02 07 11 23 16 gmt 400 lib ansible modules extras detached head 14a62fb5d6 last updated 2016 02 07 11 23 17 gmt 400 config file home lars src ansible work ansible cfg configured module search path default overrides ansible playbook playbook yml play task fetch ok targethost play recap targethost ok changed unreachable failed that is very surprising result this appears to have been the case for long time ansible behaves the same way >>>bug_report
feature request option to disable pseudo tty for ssh would like to request an option to disable pseudo tty when using ssh as routeros hasn got proper support for pseudo tty it is currently not possible to use openssh to manage devices running routeros in the past this was possible because custom ssh params where inserted behind the tt` option and could be overwritten with t` at the moment the only way to manage them is to use paramiko as it already offers the option to disable pseudo tty as openssh is lot faster it would be nice to have the option thanks >>>feature_idea
add ismount function in module utils needed to fix https github com ansible ansible modules core issues 2186 via pull request https github com ansible ansible modules core pull 2737>>>bugfix_pull_request
feature request display number of changed items in task currently after ansible has completed the summary looks something like `localhost ok 10 changed unreachable failed 0` but within those tasks items could have changed if using `with options this is ok for small jobs however it starts to become meaningless when having lots of tasks or lots of items within task imo it would be better if the summary was bit more granular perhaps displaying something like `changed items or `changed tasks items` etc thanks >>>feature_idea
conditional vars files when list is given doesn work issue type bug report ansible version ansible ansible configuration default environment mac os summary was using the feature where you pass list to vars files so when one of the items can be loaded the last one is used link https docs ansible com ansible playbooks conditionals html conditional imports but it seems this feature doesn work anymore aparently in previous versions silent error occurred when variable was used but not found in the list so last item in the list was used now the error is actually thrown is this expected was this feature removed in ansible expected results as worked with version variables from `vars coreos yml` were taken unless `os` was specified actual results >>>bug_report
module doc pages break when description is not list proxying email request your following page for ec2 ami search module looks to have comments column that is little off in terms of formatting http docs ansible com ansible ec2 ami search module html viewed in browers chrome 64 bit on windows professional 64 bit ubuntu 14 04 64 bit internet explorer 11 on windows professional 64 bit the comments column is one character per line example http notting fedorapeople org bugreport png http notting fedorapeople org bugreport png >>>docs_report
ansible pull does not read config file from working directory running ansible pull v2 as follows ansible pull accept host key url git git repo url checkout release ansible inventory localhosts verbose ansible playbooks aplaybook yml and getting this even though there is ansible cfg file in the working directory no config file found using defaults this worked in v1 if run ansible pull prefixed by ansible config path of working dir ansible cfg it works but there is no way can see to determine that path upfront >>>bug_report p2
loop error attributeerror list object has no attribute startswith issue type bug report ansible version 1ppa trusty ansible configuration default environment ubuntu 14 04 target systems ubuntu 14 04 summary have playbook for adding and modifying user at remote ubuntu hosts playbook worked correctly till upgrade ansible to version following code in my playbook group vars yml this code worked correctly with dfsg ubuntu14 04 ansible version but after upgrade to 1ppa trusty got error full strace steps to reproduce create playbook with following task group vars yml put sample key files to playbook directory run playbook expected results as worked with version actual results error if this bug unable to fix please help me modify my playbook to avoid this error >>>bug_report
fixing login for vcd service type in vca module login to vcloud director standalone service `vcd` fails with the error `login to vca failed` because the login routine is missing required `org` parameter this requirement is documented in the `pyvcoloud` library https github com vmware pyvcloud blob master examples examples py l115 >>>bug_report
show aggregated playbook execution recap at the bottom of play recap currently if you run playbook with many hosts `play recap` as ansible calls it looks like this even though ansible displays these host in colors green orange and red the problem with this display is that you can only see limited number of lines on my resolution and font size can see about 64 lines so if there are lot of hosts you have to scroll up to be able to see how things went in the example above host `backup 02` is unreachable and if didn scroll up would probably miss that also had situations where executed `site yml` which includes all playbooks and in some plays all hosts failed so ansible stopped further execution and since the hosts that failed were on top haven realized that the execution didn go over all hosts would also like to note that `to retry use limit site retry` is very easy to miss would recommend that at the bottom of this recap ansible prints an aggregated summary which you cannot miss either sums of all `ok` `changed` `unreachable` `failed` tasks or just count the number of hosts that are `ok` `changed` `unreachable` `failed` like the host recap more since you can easily see how many hosts were ok changed etc of course color them the same like before `ok` in green `changed` in orange and `unreachable` `failed` in red >>>feature_idea
allow grouping two ec2 tags to allow more specific configuration this pr is intended to help with multi stage environments dev staging prod etc ec2 py creates groups for tags so if you have for example the tags env prod role web then you will see groupings tag env prod tag role web this change allows the creation of more specific group based on two tags in the above example you can also get the group tags env prod role web so that configuration can be targeted to all prod web servers which tag names to join are configurable this is needed in more complex setups because ansible group names are unique even when nested in other words if we put the group tag role web inside tag env prod we can also put group tag role web inside tag env dev tag role web is single group with mix of dev and prod instances in considering if this is standard recommended way of working ve looked at how to differentiate staging vs production http docs ansible com ansible playbooks best practices html how to differentiate staging vs production variable precedence http docs ansible com ansible playbooks variables html variable precedence where should put variable and this related issue https github com ansible ansible issues 9877 while it possible to use per environment inventory the variable precedence can be error prone if you specify variable in the main group vars directory it will overwrite the inventory specific ones therefore for any per environment variable it can not have default value and you need to remember to put it in each inventory file and remember not to put it in the main group vars grouping tags together such as env and role believe is fairly common use case although it can be used with any pair of tags >>>feature_pull_request
inconsistent group var role var template module interaction `ansible 2` have role which writes systemd service files to target hosts from templates in `roles role templates one of the role vars defined in `roles role vars main yml` is list which compiles some labels for one of the services from group vars then in one of the template files sometimes but not always this role fails to fill in these labels when filling in the template leaving some of the elements in the list but not all of them still in jinja form just as they appear in the role vars file so that on the hosts in the uploaded service file see even odder some of the vars which fail to be evaluated are in reality provided default values default none is this defined behavior not intended usage >>>bug_report needs_info
attributeerror nonetype object has no attribute get pty after ansible reboot remote servers getting attributeerror without the reboot task the playbook finish successfully without errors exec umask 22 mkdir echo home ansible tmp ansible tmp 1454891784 45 18431289931272 echo echo home ansible tmp ansible tmp 1454891784 45 18431289931272 put tmp tmpkxaers to root ansible tmp ansible tmp 1454891784 45 18431289931272 stat an exception occurred during task execution the full traceback is traceback most recent call last file opt ansible lib ansible executor process worker py line 117 in run executor result taskexecutor host task job vars play context self new stdin self loader shared loader obj run file opt ansible lib ansible executor task executor py line 118 in run res self execute file opt ansible lib ansible executor task executor py line 349 in execute result self handler run task vars variables file opt ansible lib ansible plugins action normal py line 30 in run results update self execute module tmp tmp task vars task vars file opt ansible lib ansible plugins action init py line 389 in execute module tmp self make tmp path file opt ansible lib ansible plugins action init py line 203 in make tmp path result self low level execute command cmd sudoable false file opt ansible lib ansible plugins action init py line 502 in low level execute command rc stdout stderr self connection exec command cmd in data in data sudoable sudoable file opt ansible lib ansible plugins connection paramiko ssh py line 215 in exec command chan get pty term os getenv term vt100 width int os getenv columns height int os getenv lines attributeerror nonetype object has no attribute get pty fatal isr vcd cdh tst failed failed true stdout >>>bug_report needs_info
the flush cache option for playbook does not appear to work hi the option flush cache does not seem to have any effect on the existing cache files to reproduce here is my config and make tiny playbook called facts refresh yml run the playbook several files are created in the ansible fact cache` dir re run this or any other playbook with flush cache the cache files will not change in number or size nor will their timestamps update >>>bug_report
implement folding of long lines in inventory this commit permits entries in an inventory file to be extended over multiple lines by indenting subsequent lines as in https docs python org library configparser html supported ini file structure for example this example from the docs other1 example com ansible connection ssh ansible user mpdehaan can be written as other1 example com ansible connection ssh ansible user mpdehaan this commit includes doc and test updates resolves 14358 >>>feature_pull_request
rfe folding long lines in ansible inventory files would like the ability to fold long lines in ansible inventory files if have an inventory entry that includes lots of per host variables it is hard to discuss this in email or write about it in blog post or otherwise communicate with other people about it something that permitted this would be lovely >>>feature_idea
git module tests for local modified and git clean files adds tests for local file modifications which needs the force option adds tests for the new clean untracked and clean ignored options this depends on the pr https github com ansible ansible modules core pull 2980>>>feature_pull_request
add support for aws session token environment variable trivial patch according to http blogs aws amazon com security post tx3d6u6wsfgok2h new and standardized way to manage credentials in the aws sdks the official environment variables that should be used for aws credentials are `aws access key id` `aws secret access key` and `aws session token` this patch adds support for the latter the first two vars are already supported >>>bugfix_pull_request
don overwrite param variables if already set since get aws connection info correctly sets config parameters boto params aws session token and boto params verify when boto3 is detected we must detect whether these have already been set in boto3 conn before overwriting them from old style boto not boto3 parameters security token and validate certs respectively >>>bugfix_pull_request
pass boto profile to get route53 records>>>bugfix_pull_request feature_pull_request
become user with in path results in root directory being used as home dir issue type bug report ansible version ansible devel ansible configuration standard configuration environment debian ubuntu summary tasks which are run with `become user` and use in paths point to the root` path not that user home directory the issue has been bisected to https github com ansible ansible commit 75b6f616190857db6b816096ce39bdaf2c16822a commit steps to reproduce example playbook you should make sure that root` and user` home directories have different content to see the proper results expected results directories for `root` and an example user` have different content actual results directories for both `root` and an example user` have the same content specifically contents of root` directory >>>bug_report p2
fix for issue 14348 self written modules in roles with become user root are broken fix also make the args file world readable >>>bugfix_pull_request
an exception is thrown when task placed in unicode path triggers warning issue type bug report ansible version ansible configuration none environment ubuntu 15 10 python 10 summary an exception is thrown when task placed in unicode path triggers warning steps to reproduce create playbook with single task which does single operation twice place the playbook in unicode path run playbook expected results actual results >>>bug_report
self written modules in roles with become user root are broken issue type bug report ansible version kn master ansible version ansible config file etc ansible ansible cfg configured module search path default overrides ansible configuration kn master egrep etc ansible ansible cfg defaults privilege escalation paramiko connection ssh connection accelerate selinux environment lubuntu 15 10 rhel6 summary self written modules don work in ansible when the following conditions are true become yes is used become user is not root the playbook is targeting remote host don use 127 steps to reproduce code https gist github com adp knaumann 8db12375329f670091d4 to recreate the issue kn client sudo useradd testusr kn master ansible keep remote files ansible playbook hosts module bug yml expected results result with become user root is flawless because args can be read in any case of course kn master ansible keep remote files ansible playbook hosts ask pass ask become pass module bug yml play task setup ok client task module bug run module ok client task module bug print ok client param1 foobarbaz play recap client ok changed unreachable failed actual results play task setup ok client task module bug run module fatal client failed changed false failed true module stderr module stdout ntraceback most recent call last file tmp ansible tmp 1454756368 187607304090350 test py line in with open sys argv as arg file nioerror errno 13 permission denied tmp ansible tmp 1454756368 187607304090350 args msg module failure parsed false play recap client ok changed unreachable failed kn client ls tmp ansible tmp 1454756368 187607304090350 total rw kn kn 23 feb 10 59 args rw kn kn 286 feb 10 59 test py kn client cat tmp ansible tmp 1454756368 187607304090350 args echo param1 foobarbaz kn client cat tmp ansible tmp 1454756368 187607304090350 test py usr bin python coding utf want json import sys import json with open sys argv as arg file json data json load arg file print print ansible facts print param1 format json data param1 print print >>>bug_report p2
fix termination on user signal interrupt now both ansible and ansible playbook properly terminate and reap children fixes 14346>>>bugfix_pull_request
ansible is leaking subprocesses when killed by sigterm issue type bug report ansible version ansible configuration etc ansible ansible cfg` contains only comments environment archlinux summary when an `ansible` or `ansible playbook` process is killed by `sigterm` signal one of its sub process remains live forever this happens when one tries to invoke `ansible` or `ansible playbook` from program that has timeout and that fires `sigterm` signal to the `fork`ed `execve`d process if it takes more time than expected to complete in that case an `ansible` or `ansible playbook` sub process is leaked and never finishes steps to reproduce use basic inventory launch command and kill the launched `ansible` process while the `sleep 30` is running expected results eventually no `ansible` process remains it is actually what would have happened if the sent signal had been `int` instead of `term` actual results even after long time `26633` was children of the killed process but instead of being cleaned it has just been reaped by `init` remarks the reason why sub processes are correctly cleaned when the master process is killed by `int` and not by `term` is because there is signal handling code specific to `int` https github com ansible ansible blob devel lib ansible executor playbook executor py l72 the issue is not reproducible if `ansible` `ansible playbook` is wrapped inside usr bin timeout` because that utility creates process group before `fork`ing `exec`ing and signals the whole process group when timeout fires >>>bug_report
synchronize module error privilege output closed while waiting for password prompt issue type bug report ansible version ansible configuration unchanged configuration from default environment running from osx 10 10 yosemite managing centos summary can seem to use the `synchronize` module to push data to my remote box steps to reproduce these are truncated versions of my actual playbook it should only include relevant data site yml web yml web tasks main yml expected results expected that my app directory would get synchronized to the production directory on the remote server actual results >>>bug_report
serial percentage does not work ansible version ansible config file etc ansible ansible cfg configured module search path default overrides grep etc ansible ansible cfg grep defaults inventory etc ansible hosts remote tmp home ansible tmp pattern forks 64 poll interval 15 sudo user root transport smart module lang gathering implicit host key checking false sudo exe sudo timeout ansible managed ansible managed file modified on by uid on host action plugins usr share ansible plugins action plugins callback plugins usr share ansible plugins callback plugins connection plugins usr share ansible plugins connection plugins lookup plugins usr share ansible plugins lookup plugins vars plugins usr share ansible plugins vars plugins filter plugins usr share ansible plugins filter plugins fact caching memory retry files enabled false privilege escalation paramiko connection ssh connection control path directory pipelining true accelerate selinux environment arch linux centos centos summary specifying percentage such as 10 for the value of `serial` in playbook does not work as expected it runs against all hosts in parallel specifying number such as works as expected it runs against one host at time steps to reproduce server names and usernames are masked in the above output see the documentation for the serial keyword here http docs ansible com ansible playbooks delegation html might be related to 12698 >>>bug_report
changes to variable inheritance break existing playbooks commit 1733d43 changes how variable inheritance works if have role that attempts to override `ansible user` like this and someone passes in an inventory like this host0 ansible ssh user alice then my attempt at setting `ansible user` will always fail whereas previously it would have worked using `ansible user` in the playbook because `ansible ssh user` is deprecated but someone using my roles may not know that and may pass in an inventory that triggers this behavior it possible that trying to override `ansible user` like this is not actually great idea but wanted to document case in which there is clearly breaking change in variable handling so it should at least be documented >>>bug_report
ansible not respecting relative paths in include copy running into an issue with relative paths with the copy module when called from an included playbook it seems to be trying to pull from location relative to the main playbook rather than the included playbook here stripped down example main playbook included playbook version version >>>bug_report
add redirecthandler class for controlling redirects in urllib2 this pr adds new functionality to `ansible module utils urls` to control redirects in urllib2 this is added to provide missing functionality to `urls py` that will enable us to drop the `httplib2` dependency in the `uri` module pr for the `uri` module incoming >>>feature_pull_request
silly error message decryption failed vagrant provision default running provisioner ansible default running ansible playbook pythonunbuffered ansible force color true ansible host key checking false ansible ssh args userknownhostsfile dev null identitiesonly yes controlmaster auto controlpersist 60s ansible playbook connection ssh timeout 30 limit default inventory file users bob src ansible devops vagrant provisioners ansible inventory playbook yml no config file found using defaults error decryption failed ansible failed to complete successfully any error output should be visible above please fix these errors and try again >>>bug_report
playbook execution hangs on client with defunct process hello the playbook execution on aix tl3 sp5 client hangs occasionally with defunct porcess ansiuser 4980858 8585442 17 01 23 00 sshd ansiuser pts root 8585442 4718616 17 01 22 00 sshd ansiuser priv ansiuser 11862210 4980858 00 ansible server redhat el6 ansible >>>bug_report needs_info
add systemd nspawn connection driver this commit adds connection driver built on top of systemd nspawn this is similar to the existing `chroot` driver except that nspawn offers variety of additional services for example it takes care of automatically mounting proc` and sys` inside the chroot environment which will make variety of tools work correctly that would otherwise fail you can take advantage of other system nspawn features to perform more complicated tasks for example on my x86 64 system have raspberry pi disk image mounted on rpi` can use `chroot` with this because the binaries contained in the image are for the wrong architecture however can use the systemd nspawn bind` option to automatically insert the appropriate qemu arm binary into the container using an inventory file like this pi ansible host rpi ansible nspawn extra args bind usr bin qemu arm bind lib64 see http www freedesktop org software systemd man systemd nspawn html for more information about systemd nspawn itself >>>feature_pull_request
few more typos came across another typo and fixed similar ones in the docs >>>docs_pull_request
introduce new filetree lookup plugin the new filetree lookup plugin makes it possible to recurse over tree of files within the task loop this makes it possible to template complete tree of files to target system with little effort while retaining permissions and ownership the module supports directories files and symlinks and also selinux the item dictionary consists of src root path mode state owner group seuser serole setype selevel uid gid size mtime ctime examples here is an example of how we use with filetree within role the `web path is relative to either `roles files or `files special use the following properties also have its special use root makes it possible to filter by original location path is the relative path to root uid gid makes it possible to force create by exact id rather than by name size mtime ctime makes it possible to filter out files by size mtime or ctime todo add snippets to documentation>>>feature_pull_request
problem with tasks on localhost here is simple playbook this fails on localhost with the error message `error privilege output closed while waiting for password prompt` but only if the list contains items or more if remove either of the items from the list it works just fine also running the same playbook on remote host is working just fine and both hosts are configured exactly the same >>>bug_report
fix small typo while reading one of the docs found this small typo >>>docs_pull_request
rescue not called when in the playbook there is only the include think it might be related to this other issue https github com ansible ansible issues 14040 the problem there described seems to be solved now now am doing main2 yml tasks yml file to fail yml file path tmp file1 state directory` and happens the same as the other issue if make it fail the creation of tmp file1 the rescue is not called but only if it is inside the include if create it directly on the block without the include the rescue it is called did not test it with the las code but with the pr made some days ago it was working https github com ansible ansible pull 14213 thanks >>>bug_report
role `with items` does neither throw an error nor loops ansible is supposed to support looping over includes however this seems to be broken for roles does neither throw an error anymore nor does it actually loop >>>bug_report
retry outputs blank lines for every retry so ve upgraded from to using pip in this playbook have this piece of code in when it was executing this task there was no output in every time it checks it will echo new lines to my shell since the boot time for this service is at least 160 seconds have completely black shell yes can scroll up to see the rest of the playbook not sure if this is expected behaviour but hope you can agree that this is not very handy if you want to read the output of your playbook with having 60 blank lines in your output >>>bug_report
moved to base class for shell plugins fish now sets env vars correctly fish checksum now works>>>bugfix_pull_request
with and stdout lines doesn print correctly issue type bug report ansible version ansible config file data networkmanagement acs ansible ansible cfg configured module search path library library ixia ansible configuration environment ubuntu trusty summary when using with loops with items with lines etc and shell module on failure the whole json object is returned to console which is super verbose and loses the newline formatting on success you get no stdout msg at all using debug module it always returns the whole json object instead of specific dictionary items and doesn respect newlines need way to return the stdout with proper handling of newlines like the minimal callback module is supposed to do 8521 and 11417 look similar steps to repro expected results actual results >>>needs_info
module utils basic add generic method for checking for missing param when argspec can not be used also see comment on https github com ansible ansible pull 14273 cc abadger >>>feature_pull_request
error no action detected in task have the below add repo ml file am getting the below error while running the playbook let me know if any details required thanks thanks govind>>>bug_report
problem when using multiple inventory sources we have to support multiple inventory sources for client one is dynamic ec2 and the other one is static for some hosts in different data center but our playbooks should run across all hosts at once so we were happy to come across that section http docs ansible com ansible intro dynamic inventory html using multiple inventory sources so we call ansible with pointing to the directory that contains the dynamic and static inventory files and that is working as long as that directory doesn contain any other files nor any subdirectories with other files in them it seem that ansible is not only reading the files in the given directory but recursivle in all subdirectories as well moving the inventories into different subdirectory of its own such that there is nothing else in it won work either because we do need the group vars and host vars as subdirectories at least but also other stuff so this seems to be bug or there should be another option to explicitly define the inventory dir which is used to find the variables and other stuff any suggestions >>>bug_report p2
add new unsafe yaml constructor this new yaml tag constructor allows user to mark scalar variable value as unsafe which prevents templating among other things see https github com ansible ansible issues 12620 for potential use case documentation is provided alongside this new functionality >>>feature_pull_request
default tcsh makes ansible choke my default shell on target machine is tcsh the ansible connection process looks like it feeding sh syntax through the ssh pipe which is causing the host to choke the scriptlet looks like the syntax doesn work in tcsh is this in anyway configurable tried having ssh launch sh but that didn seem to work it just sort of hung >>>bug_report
include vars not respecting hash behaviour include vars is not merging the variables according to hash behaviour tested with hash behaviour merge test yml test1 yml test2 yml result expected result >>>bug_report
feature request ansible doesn show what task does without name can we have an option to get the old behavior back like in ansible in ansible line like this lineinfile dest root bashrc regexp export visual line export visual vim gives the following output when execute the playbook task lineinfile dest root bashrc regexp export visual line export visual vim ok xy however with ansible this got changed the exact same line gives the following output when the playbook is executed task lineinfile ok xy apparently this is the intended behavior for security reasons in order to avoid stuff like passwords being printed on screen however it would be nice to have an option to get the behavior from ansible back where name was optional the reason for this is that when you don use name all the time some yaml files can be shorter and easier to read especially if there suff like 20 lineinfile statements in row since there are no unauthorized people watching at my screen do not have any security gain from the behavior >>>bug_report
emit warnings when safe eval raises syntaxerror or other exception this change is related to reported issue 14291 and pull request 14293 without the fix from 14293 this change will emit warning as shown below on the following playbook on error this results in proper warning >>>bugfix_pull_request
ansible hide include tasks when not in verbose mode by default this implements 14285 by default it is quite annoying that ansible emits all include tasks >>>feature_pull_request
number of cloud modules with the updated method of connecting aws doesn work against eucalyptus clouds ansible version eucalyptus version os version of eucalyptus machine components summary there are couple of issues added them to this ticket since they are both closely related to each other if these need to be broken out into two separate issues please let me know issue attempted to use the ec2 elb lb module in the following tasks https github com hspencer77 ansible monitoring infrastructure blob master roles ec2 infrastructure tasks main yml l3 l18 the following error was returned following the documentation for ec2 elb lb module http docs ansible com ansible ec2 elb lb module html options region isn required option after searching through the ansible github issues found the following issues https github com ansible ansible pull 3739 https github com ansible ansible pull 3728 looks as if now region is requirement if this is the case then it should be documentation fix for this module and all other aws cloud modules issue after adding the region option to the ec2 elb lb module and adding boto configuration file in order for the custom region to be recognized https gist github com hspencer77 1010bfb79c36f6268f97 the modules still didn work what was confusing about this is that the ec2 elb lb module doesn work however the ec2 ec2 group and ec2 tag modules work just fine without the boto configuration file https gist github com hspencer77 d7cb712e1426d8135d92 it looks like back in the ec2 module wasn working however it was fixed https github com ansible ansible issues 11023 not sure if the same fix could be applied here and other modules after digging around bit it looks like there would be issues using any aws cloud module that utilizes the function call connect to aws https github com ansible ansible blob devel lib ansible module utils ec2 py l208 l217 the list of aws cloud modules found can be viewed here https gist github com hspencer77 9820ccc379fab67cdb12 in the function connect to aws the boto function connect to region is leveraged since by default eucalyptus uses port 8773 for eucalyptus service endpoints this will cause issues in order to get connect to region to work with eucalyptus the port needs to be passed demonstrated here http blogs mindspew age com 2015 06 04 using botos connect to region function with eucalyptus couple of questions how long will legacy boto be supported since boto3 seems to be the one getting all the new aws services http boto readthedocs org en latest index html if boto3 is used will the region variable override the endpoint url passed boto3 also works with eucalyptus as well it supports passing the endpoint url which works with eucalyptus endpoints that contain port 8773 for example looking in the module utils ec2 py file see the boto3 conn https github com ansible ansible blob devel lib ansible module utils ec2 py l48 l65 function which should be fine if thats the function that will be used in the rest of the aws cloud modules looks like that would suffice however would need to test it out steps for reproduction set up eucalyptus cloud with eucalyptus dns enabled and edge networking http docs hpcloud com eucalyptus follow the steps mentioned in the following playbook https github com hspencer77 ansible monitoring infrastructure by default after the variables have been set you should see an output similar to the following https gist github com hspencer77 d7cb712e1426d8135d92 to see module fail uncomment the ec2 elb lb task section in roles ec2 infrastructure tasks main yml https github com hspencer77 ansible monitoring infrastructure blob master roles ec2 infrastructure tasks main yml l3 l18 expected results eucalyptus elb to be created and instances able to be attached to the elb actual results after applying region and using boto configuration file https gist github com hspencer77 1010bfb79c36f6268f97 the following error was displayed >>>bug_report
add rackhd inventory script allow ansible to get hosts inventory from rackhd by node id>>>feature_pull_request needs_revision
ansible overrides default variables by accident since recently updated my ansible installation repository ansible overrides default variables where it should not if call sub role as dependency of parent role twice but the last time with overriding default variable the variable was also overridden on the first call here is tiny example setup omitted the starting in every file sub role defaults main yml sub role tasks main yml parent role meta main yml now executing the parent role leads to following wrong result can you see the error on the first call the output of `myval` should be first call and not second call because of recent changes ansible seems to interpret all role variables starting with the first definition and ignoring omitted definitions >>>bug_report
defined json booleans in global context for python eval we define false and true as variables so that python eval recognizes them as false and true this fixes 14291 >>>bugfix_pull_request
broken escaping with lookup for json template with convert data false how to reproduce plugin json j2 this generates the following `args` contents >>>bug_report needs_info
ansible booleans in dictionaries cause to json to fail very weird issue that is easy to reproduce if dictionary has boolean defined `to json` returns `string` rather than real `dict` the following playbook displays the problem if you run this you will see that the second dict fails we experience this issue within roles where we assign dictionary to role variable >>>bug_report
ansible setup censored by no log ansible 127 setup 127 success censored the output has been hidden due to the fact that no log true was specified for this result >>>feature_idea
wishlist hide include tasks when not in verbose mode one of the changes in ansible is that it now reports all `include` tasks this is bit painful especially when you ve big playbook and use tags` to select just few of the tasks all the include statements for roles irrelevant to what debugging now tend to hide the actual tasks being run in between the includes suggestion hide `include` tasks by default show them if an error happens or if the user asks for more verbosity by passing at least one v` to `ansible playbook` >>>feature_idea
unarchive module fails for aaceeiio copy jpg ansible error output fatal puppetclient xxxxx me failed changed false failed true msg unexpected error when accessing exploded file errno no such file or directory home services xxxx xxxx xxxxx test phpunit modules xxxx storage 314 200a 314 202 303 246c 314 247e 314 201e 314 200i 314 210i 314 202o 314 202 305 223 copy jpg original file aaceeiio copy jpg extracting file using tar at server works fine>>>bug_report
destination files get prepended with ansi escape sequence issue environment the host machine is mac os the remote machine is an amazon linux ami https aws amazon com amazon linux ami 2015 09 release notes possibly related to 5798 12068>>>bug_report needs_info
handle when the lookup plugin is used in jinja style this fixes 14190 terms provided in this case is list inside list which is not handled correctly it bails out trying to handle the list as filename instead >>>bugfix_pull_request
wip tag the setup task with always fixes 14228 but breaks 13602 since 5587b08335f223fff64f54ced6f2790b3d6ee6f0 the automatic `setup` created by `gather facts` inherits all properties from the play as other tasks this includes tags in the pr give it the `always` tag but this can be superseded by additional tags in the play included in skip tags` or by skip tags always` >>>bugfix_pull_request
set fact run once breaks register variables hi ansible rc1 centos 1511 x86 64 please fix this bug thank you with best regards mykola ulianytskyi>>>bug_report
establish sh as the default shell plugin this is fix for one of the problems pointed out in 14176>>>feature_pull_request
cloudstack integration tests for new modules ansible playbook cloudstack yml inventory cloudstack env yml resource prefix ansible testing 3pr1z73b tags test cs pod test cs cluster test cs configuration test cs resourcelimit rc exit rc play localhost task test cs configuration test fail if missing name failed localhost failed true msg missing required arguments value name ignoring task test cs configuration verify results of fail if missing arguments ok localhost msg all assertions passed task test cs configuration test configuration ok localhost category network changed false description load balancer haproxy stats visibilty the value can be one of the following six parameters global guest network link local disabled all default name network loadbalancer haproxy stats visibility value global task test cs configuration verify test configuration ok localhost msg all assertions passed task test cs configuration test update configuration string changed localhost category network changed true description load balancer haproxy stats visibilty the value can be one of the following six parameters global guest network link local disabled all default name network loadbalancer haproxy stats visibility value all task test cs configuration verify test update configuration string ok localhost msg all assertions passed task test cs configuration test update configuration string idempotence ok localhost category network changed false description load balancer haproxy stats visibilty the value can be one of the following six parameters global guest network link local disabled all default name network loadbalancer haproxy stats visibility value all task test cs configuration verify test update configuration string idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration string changed localhost category network changed true description load balancer haproxy stats visibilty the value can be one of the following six parameters global guest network link local disabled all default name network loadbalancer haproxy stats visibility value global task test cs configuration verify test reset configuration string ok localhost msg all assertions passed task test cs configuration test configuration ok localhost category advanced changed false description specify whether or not to recycle hung worker vms name vmware recycle hung wokervm value false task test cs configuration verify test configuration ok localhost msg all assertions passed task test cs configuration test update configuration bool changed localhost category advanced changed true description specify whether or not to recycle hung worker vms name vmware recycle hung wokervm value true task test cs configuration verify test update configuration bool ok localhost msg all assertions passed task test cs configuration test update configuration bool idempotence ok localhost category advanced changed false description specify whether or not to recycle hung worker vms name vmware recycle hung wokervm value true task test cs configuration verify test update configuration bool idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration bool changed localhost category advanced changed true description specify whether or not to recycle hung worker vms name vmware recycle hung wokervm value false task test cs configuration verify test reset configuration bool ok localhost msg all assertions passed task test cs configuration test configuration ok localhost category advanced changed false description what percentage of the agents can be held by one management server before load balancing happens name agent load threshold value task test cs configuration verify test configuration ok localhost msg all assertions passed task test cs configuration test update configuration float changed localhost category advanced changed true description what percentage of the agents can be held by one management server before load balancing happens name agent load threshold value 81 task test cs configuration verify update configuration float ok localhost msg all assertions passed task test cs configuration test update configuration float idempotence ok localhost category advanced changed false description what percentage of the agents can be held by one management server before load balancing happens name agent load threshold value 81 task test cs configuration verify update configuration float idempotence ok localhost msg all assertions passed task test cs configuration reset configuration float changed localhost category advanced changed true description what percentage of the agents can be held by one management server before load balancing happens name agent load threshold value task test cs configuration verify reset configuration float ok localhost msg all assertions passed task test cs configuration test configuration storage ok localhost category storage changed false description used for storage overprovisioning calculation available storage will be actualstoragesize storage overprovisioning factor name storage overprovisioning factor scope storagepool storage ps0 value task test cs configuration verify test configuration storage ok localhost msg all assertions passed task test cs configuration test update configuration storage changed localhost category storage changed true description used for storage overprovisioning calculation available storage will be actualstoragesize storage overprovisioning factor name storage overprovisioning factor scope storagepool storage ps0 value task test cs configuration verify update configuration storage ok localhost msg all assertions passed task test cs configuration test update configuration storage idempotence ok localhost category storage changed false description used for storage overprovisioning calculation available storage will be actualstoragesize storage overprovisioning factor name storage overprovisioning factor scope storagepool storage ps0 value task test cs configuration verify update configuration storage idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration storage changed localhost category storage changed true description used for storage overprovisioning calculation available storage will be actualstoragesize storage overprovisioning factor name storage overprovisioning factor scope storagepool storage ps0 value task test cs configuration verify reset configuration storage ok localhost msg all assertions passed task test cs configuration test configuration account ok localhost account admin category advanced changed false description if false users will not be able to create public templates domain root name allow public user templates scope account value true task test cs configuration verify test configuration storage ok localhost msg all assertions passed task test cs configuration test update configuration account changed localhost account admin category advanced changed true description if false users will not be able to create public templates domain root name allow public user templates scope account value false task test cs configuration verify update configuration account ok localhost msg all assertions passed task test cs configuration test update configuration account idempotence ok localhost account admin category advanced changed false description if false users will not be able to create public templates domain root name allow public user templates scope account value false task test cs configuration verify update configuration account idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration account changed localhost account admin category advanced changed true description if false users will not be able to create public templates domain root name allow public user templates scope account value true task test cs configuration verify update configuration account ok localhost msg all assertions passed task test cs configuration test configuration zone ok localhost category advanced changed false description bypass internal dns use external dns1 and dns2 name use external dns scope zone value false zone sandbox simulator task test cs configuration verify test configuration zone ok localhost msg all assertions passed task test cs configuration test update configuration zone changed localhost category advanced changed true description bypass internal dns use external dns1 and dns2 name use external dns scope zone value true zone sandbox simulator task test cs configuration verify update configuration zone ok localhost msg all assertions passed task test cs configuration test update configuration zone idempotence ok localhost category advanced changed false description bypass internal dns use external dns1 and dns2 name use external dns scope zone value true zone sandbox simulator task test cs configuration verify update configuration zone idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration zone changed localhost category advanced changed true description bypass internal dns use external dns1 and dns2 name use external dns scope zone value false zone sandbox simulator task test cs configuration verify reset configuration zone ok localhost msg all assertions passed task test cs configuration test configuration cluster ok localhost category advanced changed false cluster c0 description used for cpu overprovisioning calculation available cpu will be actualcpucapacity cpu overprovisioning factor name cpu overprovisioning factor scope cluster value task test cs configuration verify test configuration cluster ok localhost msg all assertions passed task test cs configuration test update configuration cluster changed localhost category advanced changed true cluster c0 description used for cpu overprovisioning calculation available cpu will be actualcpucapacity cpu overprovisioning factor name cpu overprovisioning factor scope cluster value task test cs configuration verify update configuration cluster ok localhost msg all assertions passed task test cs configuration test update configuration cluster idempotence ok localhost category advanced changed false cluster c0 description used for cpu overprovisioning calculation available cpu will be actualcpucapacity cpu overprovisioning factor name cpu overprovisioning factor scope cluster value task test cs configuration verify update configuration cluster idempotence ok localhost msg all assertions passed task test cs configuration test reset configuration cluster changed localhost category advanced changed true cluster c0 description used for cpu overprovisioning calculation available cpu will be actualcpucapacity cpu overprovisioning factor name cpu overprovisioning factor scope cluster value task test cs configuration verify reset configuration cluster ok localhost msg all assertions passed task test cs pod setup pod is absent ok localhost changed false task test cs pod verify setup pod is absent ok localhost msg all assertions passed task test cs pod setup zone is present changed localhost allocation state disabled changed true dhcp provider virtualrouter dns1 dns2 id 66663504 5c73 496e abfe ddaa54357437 internal dns1 internal dns2 local storage enabled false name ansible testing 3pr1z73b zone network type basic securitygroups enabled true tags zone token 8698b4bf e256 35ad 8516 994e91f73694 task test cs pod verify setup zone is present ok localhost msg all assertions passed task test cs pod test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs pod verify results of fail if missing name ok localhost msg all assertions passed task test cs pod test create pod changed localhost allocation state enabled changed true end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 101 zone ansible testing 3pr1z73b zone task test cs pod verify test create pod ok localhost msg all assertions passed task test cs pod test create pod idempotence ok localhost allocation state enabled changed false end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 101 zone ansible testing 3pr1z73b zone task test cs pod verify test create pod idempotence ok localhost msg all assertions passed task test cs pod test update pod changed localhost allocation state enabled changed true end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test update pod ok localhost msg all assertions passed task test cs pod test update pod idempotence ok localhost allocation state enabled changed false end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test update pod idempotence ok localhost msg all assertions passed task test cs pod test disable pod changed localhost allocation state disabled changed true end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test enable pod ok localhost msg all assertions passed task test cs pod test disable pod idempotence ok localhost allocation state disabled changed false end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test enable pod idempotence ok localhost msg all assertions passed task test cs pod test enable pod changed localhost allocation state enabled changed true end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test disable pod ok localhost msg all assertions passed task test cs pod test enable pod idempotence ok localhost allocation state enabled changed false end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test enabled pod idempotence ok localhost msg all assertions passed task test cs pod test absent pod changed localhost allocation state enabled changed true end ip 10 100 10 254 gateway 10 100 10 id 301d66b2 cf20 4109 bfa0 e4efd33d577a name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 102 zone ansible testing 3pr1z73b zone task test cs pod verify test create pod ok localhost msg all assertions passed task test cs pod test absent pod idempotence ok localhost changed false task test cs pod verify test absent pod idempotence ok localhost msg all assertions passed task test cs cluster setup cluster is absent ok localhost changed false task test cs cluster verify setup cluster is absent ok localhost msg all assertions passed task test cs cluster setup zone is present ok localhost allocation state disabled changed false dhcp provider virtualrouter dns1 dns2 id 66663504 5c73 496e abfe ddaa54357437 internal dns1 internal dns2 local storage enabled false name ansible testing 3pr1z73b zone network type basic securitygroups enabled true tags zone token 8698b4bf e256 35ad 8516 994e91f73694 task test cs cluster verify setup zone is present ok localhost msg all assertions passed task test cs cluster setup pod is preset changed localhost allocation state enabled changed true end ip 10 100 10 254 gateway 10 100 10 id 0210c51d 0e4a 451d b7c1 227b84170a97 name ansible testing 3pr1z73b pod netmask 255 255 255 start ip 10 100 10 101 zone ansible testing 3pr1z73b zone task test cs cluster verify setup pod is preset ok localhost msg all assertions passed task test cs cluster test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs cluster verify results of fail if missing name ok localhost msg all assertions passed task test cs cluster test create cluster changed localhost allocation state enabled changed true cluster type cloudmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test create cluster ok localhost msg all assertions passed task test cs cluster test create cluster idempotence ok localhost allocation state enabled changed false cluster type cloudmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test create cluster idempotence ok localhost msg all assertions passed task test cs cluster test update cluster changed localhost allocation state enabled changed true cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test update cluster ok localhost msg all assertions passed task test cs cluster test update cluster idempotence ok localhost allocation state enabled changed false cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test update cluster idempotence ok localhost msg all assertions passed task test cs cluster test disable cluster changed localhost allocation state disabled changed true cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test disable cluster ok localhost msg all assertions passed task test cs cluster test disable cluster idempotence ok localhost allocation state disabled changed false cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test disable cluster idempotence ok localhost msg all assertions passed task test cs cluster test enable cluster changed localhost allocation state enabled changed true cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test enable cluster ok localhost msg all assertions passed task test cs cluster test enable cluster idempotence ok localhost allocation state enabled changed false cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test enable cluster idempotence ok localhost msg all assertions passed task test cs cluster test remove cluster changed localhost allocation state enabled changed true cluster type externalmanaged cpu overcommit ratio hypervisor simulator id a8026303 44dc 4d11 8d21 c4cfae8cf966 managed state managed memory overcommit ratio name ansible testing 3pr1z73b cluster pod ansible testing 3pr1z73b pod zone ansible testing 3pr1z73b zone task test cs cluster verify test remove cluster ok localhost msg all assertions passed task test cs cluster test remove cluster idempotence ok localhost changed false task test cs cluster verify test remove cluster idempotence ok localhost msg all assertions passed task test cs resourcelimit setup domain changed localhost changed true id 28b261da 7438 4454 806e ef3531ff6f1c name ansible testing 3pr1z73b domain parent domain root path root ansible testing 3pr1z73b domain state absent task test cs resourcelimit verify setup domain ok localhost msg all assertions passed task test cs resourcelimit setup account changed localhost account type user changed true domain ansible testing 3pr1z73b domain id 62160f8c c334 4fd4 a828 f362a99eafe5 name ansible testing 3pr1z73b user network domain ansible testing 3pr1z73b local state enabled task test cs resourcelimit verify setup account ok localhost msg all assertions passed task test cs resourcelimit test failed unkonwn type failed localhost failed true msg value of resource type must be one of secondary storage volume vpc ip address network primary storage instance snapshot template memory cpu got unkonwn ignoring task test cs resourcelimit verify test failed unkonwn type ok localhost msg all assertions passed task test cs resourcelimit test failed missing type failed localhost failed true msg missing required arguments resource type ignoring task test cs resourcelimit verify test failed missing type ok localhost msg all assertions passed task test cs resourcelimit setup resource limits domain changed localhost changed true domain ansible testing 3pr1z73b domain limit 20 resource type instance task test cs resourcelimit verify setup resource limits domain ok localhost msg all assertions passed task test cs resourcelimit setup instance limits account ok localhost account ansible testing 3pr1z73b user changed false domain ansible testing 3pr1z73b domain limit 20 resource type instance task test cs resourcelimit verify setup instance limits account ok localhost msg all assertions passed task test cs resourcelimit set instance limits for domain changed localhost changed true domain ansible testing 3pr1z73b domain limit 12 resource type instance task test cs resourcelimit verify set instance limits for domain ok localhost msg all assertions passed task test cs resourcelimit set instance limits for domain idempotence ok localhost changed false domain ansible testing 3pr1z73b domain limit 12 resource type instance task test cs resourcelimit verify set instance limits for domain ok localhost msg all assertions passed task test cs resourcelimit set instance limits for account changed localhost account ansible testing 3pr1z73b user changed true domain ansible testing 3pr1z73b domain limit 10 resource type instance task test cs resourcelimit verify set instance limits for account ok localhost msg all assertions passed task test cs resourcelimit set instance limits for account idempotence ok localhost account ansible testing 3pr1z73b user changed false domain ansible testing 3pr1z73b domain limit 10 resource type instance task test cs resourcelimit verify set instance limits for account idempotence ok localhost msg all assertions passed task test cs resourcelimit setup cpu limits account changed localhost account ansible testing 3pr1z73b user changed true domain ansible testing 3pr1z73b domain limit 20 resource type cpu task test cs resourcelimit verify setup cpu limits account ok localhost msg all assertions passed task test cs resourcelimit set cpu limits for domain changed localhost changed true domain ansible testing 3pr1z73b domain limit 12 resource type cpu task test cs resourcelimit verify set cpu limits for domain ok localhost msg all assertions passed task test cs resourcelimit set cpu limits for domain idempotence ok localhost changed false domain ansible testing 3pr1z73b domain limit 12 resource type cpu task test cs resourcelimit verify set cpu limits for domain ok localhost msg all assertions passed task test cs resourcelimit set cpu limits for account changed localhost account ansible testing 3pr1z73b user changed true domain ansible testing 3pr1z73b domain limit 10 resource type cpu task test cs resourcelimit verify set cpu limits for account ok localhost msg all assertions passed task test cs resourcelimit set cpu limits for account idempotence ok localhost account ansible testing 3pr1z73b user changed false domain ansible testing 3pr1z73b domain limit 10 resource type cpu task test cs resourcelimit verify set cpu limits for account idempotence ok localhost msg all assertions passed play recap localhost ok 142 changed 34 unreachable failed >>>feature_pull_request
add ansible executable to magic inventory vars and shell type to ansible cfg executable and shell type are meant to work together so that ansible can use different shell when bin sh is not available on the remote host however currently user has to set executable globally in ansible cfg and ansible shell type per host in inventory vars we should add to this so that the user can set both of the settings at the same places >>>feature_idea
cloudstack new generic code>>>cloud feature_pull_request needs_revision p2
make executable setting connection dependant winrm shoudl not use executable rest should fixes 14233>>>bugfix_pull_request windows
fix note tag in the api docs minor but causing things not to render correctly image https cloud githubusercontent com assets 75556 12758949 89557170 c993 11e5 8a67 6fe3e516d6a7 png >>>docs_pull_request
add support for blocks in role handlers currently it not possible to define multiple tasks for one handler it is possible to call multiple handlers or to notify the next handler from the first one but all of these are more workarounds than simple solutions since ansbile added support for blocks maybe we could add this support to handlers so we could write something like this not sure if this would be the correct syntax but would be really nice to have >>>feature_idea
ansible playbook fails to load etc ansible ansible cfg after updating ansible the ansible playbook command no longer finds the default configuration file there is no ansible cfg in my current directory nor in my home directory nor is there an ansible config environment variable so it should be using etc ansible ansible cfg running this on osx el capitan >>>bug_report
ansible ansible doesn respect the switch bug report probing freshly installed archlinux installation on raspberry pi like so `ansible pi2 arch setup paramiko alarm vvvv` this reads to me fire the setup module against the ip connecting with the user alarm asking for the password of this specific user however the user that eventually attempts to connect is root here the debug response the inventory looks like this the expected result as version delivers is the control machine is mba on 10 11 the command was run against raspberry pi running archlinux cheers ralph>>>bug_report needs_info
documentation offline sometimes is not reachable the online doc https gist github com albertux c78aac25d831e7808a6c>>>feature_idea
module config template is missing interpreter line when using ceph ansible with the devel or stable branch of ansible get in config template there is not shebang but this is virtual module that is entirely implemented server sid` do you have an idea thanks>>>needs_info
ansible apt always report changed language problem it seems have minor problem while doing some experiments with the ansible apt module the upgrade process always reports change even if there is nothing todo the problem seems to be language problem changing the language to en gb the exakt same command results in valid report issue type bug report ansible version ansible ansible configuration no changes made default ubuntu 14 package deb http ppa launchpad net ansible ansible ubuntu trusty main environment linux ubuntu 14 summary language problem with the apt module within the upgrade command in combination with the german language the result is always changed changing the local language to en gb the result is correct changed steps to reproduce base yml role base task main yml command expected results changed actual results task output cheers dennis>>>bug_report
filter request it be nice to have filter that reverses strings or numbers or maybe addition of reverse dns in ip address entry or what it would look like >>>feature_idea
raw quotes arguments issue type bug report ansible version ansible configuration hope irrelevant environment fedora 23 summary raw shell do the same module should not quote its values but it do steps to reproduce task expected results loading sql file into database as it happened in shell directly actual results >>>bug_report needs_info
add validate certs param to skip ssl verification in vmware this is handy when working with development environments using self signed certificates >>>cloud feature_pull_request
ansible fails parsing dynamic inventory result hi have an inventory script that works fine with ansible but makes ansible fail with the trace traceback most recent call last file opt ansible python 2016 01 26 linux x86 64 ansible bin ansible playbook line 85 in sys exit cli run file opt ansible python 2016 01 26 linux x86 64 ansible lib python2 site packages ansible cli playbook py line 128 in run inventory inventory loader loader variable manager variable manager host list self options inventory file opt ansible python 2016 01 26 linux x86 64 ansible lib python2 site packages ansible inventory init py line 81 in init self parse inventory host list file opt ansible python 2016 01 26 linux x86 64 ansible lib python2 site packages ansible inventory init py line 124 in parse inventory self parser inventorydirectory loader self loader groups self groups filename host list file opt ansible python 2016 01 26 linux x86 64 ansible lib python2 site packages ansible inventory dir py line 164 in init host groups remove ungrouped valueerror list remove not in list inventory json txt https github com ansible ansible files 113907 inventory json txt >>>bug_report needs_info
ansible vault fails to decode secure file with accented characters issue type bug report may be related to some of these https github com ansible ansible issues utf8 is 3aissue is 3aopen ordinal is ansible version ansible configuration environment latest osx but not sure if this is os related summary if encoded file contains any non ascii characters viewing that file fails strangely you can still edit it steps to reproduce add something like try ansible vault view test secure yml unexpected exception ascii codec can decode byte 0xc3 in position ordinal not in range 128 to see the full traceback use vvv >>>bug_report
add integration test for ansible pull this test includes the behavior described in 13688 and 13681 it runs minimal playbook and checks for correct use of inventory and limit>>>feature_pull_request
allow specifying inventory hostnames as username host domain trying to copy file to the server with ansible copy module ssh connection works but seems that there problem with sftp same error happens when trying to execute shell script ansible script module errors error failed to transfer file to home jenkins ansible tmp ansible tmp 1454402413 233202231550330 source nexecuting program usr bin ssh host xxxx xxxx cloudapp azure com error failed to transfer file to home zzz ansible tmp ansible tmp 1454403000 94 30402471290978 source nssh could not resolve hostname xxx azure com looks that errors are not describing the root reason attached the command log with verbose mode on version `ansible on ubuntu 15 10` ansible cfg changes playbook part that fails roles folder contains the role kkkk files package tar gz tasks main yml and vars main yml had to revise the names to the ticket used command `ansible ssh pipelining ansible scp if ssh ansible playbook play yml hosts inv` note problem was shown up after rebooted the ubuntu remote server on azure that use for the ansible script testing yaml files are developed and ran on the laptop with ubuntu 15 10 running on virtual box 14r105127 ansible playbook verbose txt txt https github com ansible ansible files 113674 ansible playbook verbose txt txt >>>feature_idea
allow key authentication when using ask pass` just like ansible v2 this closes 14250 it should not have any ill effects for existing use cases as we would only allow additional authentication methods on top of password authentication and since the user can authenticate in other ways already it also has no security impact >>>backport feature_pull_request
pause module does not abort ansible pip installation when using the pause module using control does not abort the playbook hitting control will bring up the option of press to continue or to abort pressing just continues the playbook was able to reproduce this ansible host rhel6 ansible clients rhel5 >>>bug_report p2
better fix for ansible pull inventory handling now it mirrors what it did in previous versions alt to 14242 for fixes 13688 fixes 14241>>>bugfix_pull_request
ssh publickey and password combination not allowed if you use ask pass` with ansible playbook ansible appears to try and be clever by assuming that you do not want to use publickey authentication and adds pubkeyauthentication no` to the ssh command line at best this is misleading at worst it is wrong and prevents specific edge use cases it is perfectly valid for an ssh server to require that the client provide publickey and password or more commonly that the client provide publickey and factor otp via keyboard interactive consider the sshd config configuration authenticationmethods publickey password` and ssh config preferredauthentications publickey password` at present the above ssh configuration is not supported by ansible >>>feature_idea
bare handling this properly deals with environment in backwards compatible way and now adds the deprecation warning to bare variable usage in universal manner >>>bugfix_pull_request
multiple files in role defaults directory have role that manages complex piece of software with many options right now the defaults main yml is growing larger and larger with more variables it would be nice if in the defaults folder could have various yaml files for each group of variables that are semantically related ve tried adding more files to this folder but it doesn seem their definitions are picked up as expected only main yml is loaded believe this would be nice feature >>>feature_idea
no handlers could be found for logger paramiko transport when try to use paramiko for the ssh connection to router get the following error and ansible just hangs no handlers could be found for logger paramiko transport in ansible this worked just fine after updating to ansible pip and devel checkout got this error using vvvv` isn showing anything useful either `ansible router raw system clock print loaded callback minimal of type stdout v2 establish connection for user management on port 22 to 192 168 10 exec system clock print no handlers could be found for logger paramiko transport the router runs routeros and the `system clock print` command just prints the time debugging using password or key doesn seem to make difference this is the same error as in issue 13721 but can ssh into the host just fine can also run the command without paramiko but the tt` option doesn work on routeros connection doesn close that why use paramiko >>>bug_report
add option to group ec2 instances by platform we have instances windows and linux in our environment and for easy configuration for access we need to group all windows instance together this pr allows me to inventory base ini and inventory group vars windows yml >>>feature_pull_request
if specified non standard ssh port is not open revert to default ssh port this pull request supersedes 13580 13589 >>>feature_pull_request
update example vpc desitnation variable example with working settings the stated setting for vpc destination variable is quoted and as such will return zero hosts this pr removes those quotes and causes the code to work when uncommenting the supplied line >>>docs_pull_request
pre tasks not working while gathering smart in ansible cfg issue type bug report ansible version ansible configuration environment mac os summary when `gathering smart` used in ansible cfg pre tasks are not running steps to reproduce ansible cfg play yml expected results actual results >>>bug_report p2
don pass default repo to ansible playbook on pull fixes 13688 fixes 14241 removes the same unused things >>>bugfix_pull_request
cleanup unused code after 14220 delete unused variables node host limit opts inv opts remove duplicate local` in base opts and cmd>>>bugfix_pull_request
bool filter fails to lower case environment variables it seems to restrict the type match for conversion to lowercase changing the string test in the bool filter from to makes this work as expect but not submitting direct pr as not sure if this is the correct change >>>bug_report
made fact gathering into tagged task now that fact gathering respects tags changed to use pre task setup task with always tag fixes 14228>>>bugfix_pull_request
filter default does not work for ansible port variable anymore test inventory version playbook result version playbook result >>>bug_report
groups naming convention in vagrant hosts provider add grouping by naming convention capabilities if the file `vagrant ini` is present and contains regex then any vagrant machine with the following naming convention will be grouped machine x` group this is in addition to the previously used `vagrant` group if the `vagrant ini` file doesn exist or the needed option then the vagrant host provider will continue as before any group caught in the regex will be used as host group >>>needs_revision
winrm connector issue with rc1 hey my playbook fails with rc1 but succeeds with authentication is done via plain username it seems that ansible tries to execute the stuff locally and not via winrm >>>bug_report windows
ansible os family is undefined all playbooks with ansible os family used for conditional roll includes now fail using git bisect shows things break in 5587b08335f223fff64f54ced6f2790b3d6ee6f0 don see anything regarding the renaming of the ansible os family variable so assume this is bug >>>bug_report
ansible managed show modified date of the remote file instead of the template currently when using the ansible managed sting the modified date time refects the template date but its very common to update files for playbook vars while the templates themselves never change when using galaxy roles for example one rarely touches the templates so when we run the playbook files will be updated and the ansible managed line still shows the template modified date it can be extremely useful to be able to print the last time ansible changed the file it self >>>feature_idea
added test for new aws datapipeline module these tests are for the datapipeline module pull request for which is here https github com ansible ansible modules extras pull 1547>>>feature_pull_request
gather facts does not execute when using tags issue type bug report ansible version ansible configuration environment ubuntu 14 04 lts summary the destructive integration test for apt repository fails as of commit 5587b08335f223fff64f54ced6f2790b3d6ee6f0 the test passes using commit ceef202024423dd35ecef93f947d661f71c33e75 and earlier steps to reproduce run the destructive integration test on test apt repository expected results actual results >>>bug_report
do not append parent more than once when calling serialize can result in 10 time speed improvement when using role with redundant dependencies check https github com ansible ansible issues 14112 for more details >>>bugfix_pull_request
update intro dynamic inventory rst vagrant dev ansible tasks inventory ec2 py profile dev usage ec2 py list host host refresh cache boto profile boto profile ec2 py error unrecognized arguments profile dev vagrant dev ansible tasks inventory ec2 py boto profile dev>>>docs_pull_request
nested block within role stops processing role hi nested block within role stops processing role nested blocks in playbook tasks work correctly ansible centos x86 64 blocks fail yml roles role1 tasks main yml ansible playbook inventory hosts blocks fail yml please fix this bug thank you with best regards mykola>>>bug_report p2
some attributes of callbacks aren in v2 port plugins to the v2 way to do that also update porting guide with info on callback porting>>>bugfix_pull_request
harcoding inventory hosts when pulling from repo return to pre behaviour which did not factor inventory into the repo pull fixes 13681 alternative to 13688>>>bugfix_pull_request
high cpu usage issue type bug annoyance ansible version ansible configuration default configuration supplied from ubuntu ppa except uncommented environment ubuntu 15 10 python 10 running the playbook the target host in group is archlinux with python2 version python 11 summary when run playbook that runs long task say backup target machine or do virus scanning the machine running the playbook spawns python usr bin ansible playbook stress yml processes that consume high amount of cpu 15 20 each on my machine which is not that powerful since the machine running the playbook is pretty much waiting for remote task to complete it shouldn use up this much cpu it doesn seem to matter whether the host group contains machine or more this happens when playbook is executed in serial mode as well steps to reproduce for some host group let say stress where the machine running ansible command is not part of that group execute something that takes while on the remote machine eg `ansible stress shell dd if dev random of dev null bs 1m count or `ansible stress shell stress cpu timeout 60s monitor cpu usage with top on the machine that ran ansible command expected results cpu usage closer to idle did not have this problem with ansible actual results fairly high cpu consumption >>>bug_report
check plugin classes using isinstance encountered this issue while making subclass of the ssh connection plugin where the plugin loader attempts to validate that plugin has specific class as one of its bases the issue is that the current implementation only accounts for the immediate parents of the plugin this fix imports the actual base class at runtime and does check accouting for multiple levels of inheritance using isinstance >>>feature_pull_request
ansible path behavior is inconsistent issue type bug report ansible version ansible summary similar issue behavior as 14161 file and shell path will be current execution pwd while template is relative to the playbook role results in while results in the creation of pwd templates folder previously it created root ansible templ>>>bug_report
copy module calculating checksum failed unusually script module permission denied issue type bug report ansible version ansible and ansible ansible configuration ssh connection scp if ssh true environment mac darwin engwifi 230 23 wal actifio com 14 darwin kernel version 14 mon mar 23 11 59 05 pdt 2015 root xnu 2782 20 48 release x86 64 x86 64 managing centos linux augusta 32 358 14 sanvc x86 64 smp preempt thu sep 24 11 43 41 edt 2015 x86 64 x86 64 x86 64 gnu linux summary copy module is giving calculating checksum failed unusually although files are correctly being sent even when module reports failure in related problem script module doesn function against that set of hosts centos machine with ibm svc installed when running script module recieve stdout bash home root ansible tmp ansible tmp 1452900006 99 249090233060510 version sh permission denied however home root ansible location isn mounted with noexec additional info on script execution here https groups google com forum msg ansible project k0t4dkshlpu 8ofs9jo7bgaj steps to reproduce from role qa release tasks main yml omitted plays that execute scripts they aren reached from play expected results files copy over successfully and report pass files aren on machine in case of failures actual results following from executions output output after first run when scripts haven been removed >>>bug_report
better conflicting action statements message had tasks file including snippet twice to create and set up two users in ansible it started failing with the error conflicting action statements it is not clear that the problem is that there cannot be an `user` variable because `user` also happens to be role this worked ok in ansible think this is brittle an include may fail in the future because new action will be implemented anyway not up for painful discussion about ansible choices this patch just provides better error message which hopefully may lead an user to understand they have to rename variable >>>bugfix_pull_request
if hosts is marked as failed it seems odd to mark it as complete too referencing the issue https github com ansible ansible issues 14040 the problem is that if run state is complete the host is marked as failed and rescue is not called don know if there are other implications but for me it has no sense mark at the same time as completed and failed if something failed is not really complete is it only deleted the condition where in case of failed it was marked as completed and now it seems to work tested it without block rescue playn tasks playbook with block rescue with and without include and it seems to work again am not sure if this condition was there for some special reason and only decided to take it off because conceptualy for me something failed is not completed >>>bugfix_pull_request
list tasks disables module path leading to bogus no action detected in task errors issue type bug report ansible version ansible devel 210cf06d9a though looking at the latest commit to devel suspect it would show the same problem ansible configuration unremarkable environment linux summary list tasks disables module path leading to bogus no action detected in task errors steps to reproduce given the attached inventory playbook custom module ansible playbook works as expected but adding list tasks to the command line results in an error this happens because when list tasks is specified the playbookexecutor constructor skips instantiation of the taskqueuemanager object the taskqueuemanager constructor processes module path hello tar gz https github com ansible ansible files 110031 hello tar gz >>>bug_report
os listdir sysdir oserror errno when execute this simple playbook am getting failure but running ping ad hoc works fine >>>bug_report
doc wrong parameter succeeded in when statement in when statement the documentation states the use of succeeded when it should be success using succeeded will not work and return this error version ansible 4>>>docs_pull_request
ansible problems with utf characters when trying to include one template in another one trying to include one template my cnf into another one my second cnf using the following snippet in my second cnf the included template contains utf characters in comments unfortunately ansible displays an error message the comment with utf characters looks like this in general the following characters are causing trouble `>>>bug_report
remove the range part while parsing hostname and port fix the issue that the ini parser treat the hosts with range in etc ansible hosts` as ipv6 address with port which causes exception at runtime for example `server 01 99 dc1` >>>bugfix_pull_request
static inventory and host address parsing hi all have an inventory script that gives me something like hosta hostb as hostname and my ssh config is like using this syntax my inventory script can based on other info set ssh jump host by simply prepending the hostname with the jumphost if need be this avoids to put in proxycommand line per host or per ip range or any other difficult jumphost solution ve read now this syntax hosta hostb worked fine in versions of ansible and still works ok if returned by inventory script in but if use static inventory file and put in hosta hostb get syntax error saying that the port can be determined so it seems some extra check is done if using static inventory files which is very confusing ve narrowed it down to lib ansible parsing utils addresses py function parse address for now make that function just immediately return so now got my old behaviour back for static files maybe an option could be added to eliminate this check if desired >>>feature_idea
fixed code for v1 callback runtime compatiblity old exception code obsoleted by exception avoidance errors on v1 callback produce warnings and don stop play also cleaned out unused imports as per pyflakes>>>bugfix_pull_request
need to add ansible version lock feature when upgrade to ansible found have some bug such as can access ec2 tag var in template moudle so think add to version lock to playbook is good idea this will be more safe for production envrironments and ci environments such as >>>feature_idea
ansible become user take priority over become http docs ansible com ansible become html says that `ansible become user` can be used in host group vars to provide different default would have expected that this default could overridden by an explicit `become user in play however it appears that `ansible become user` always takes priority is that the expected behaviour if so could the document be clarified >>>docs_report
user module is not respecting system umask when creating user with ansible and specifying createhome yes home directory is created with different permissions than ones specified by server umask don see how to adjust home directory permissions with same module as well >>>bug_report needs_info
load now does not modify the incomming data also removed json loader as yaml loader can do both>>>bugfix_pull_request
when setting up the local connection for the rsync we need to set the shell as well fixes 13490>>>bugfix_pull_request
bug limit all excludes localhost issue type bug report ansible version ansible configuration environment summary limit all excludes localhost` steps to reproduce when using vagrant was surprised that play that works fine not under vagrant by not working mean turns out limit all` excludes localhost workaround is either limit or limit all localhost` the only reason the former is interesting is in the case of vagrant `ansible limit amounts to limit the caveat with vagrant is that vagrant always uses limit hostname` until you configure it expected results expect `localhost` to at least be available with limit all` actual results limit all` does not include plays for `localhost` update the inventory does not contain `localhost` >>>bug_report
net parser throw an error if the incoming config is not indented in way that can be parsed also use the first child to determine indentation width this gives some flexibility when creating config template >>>bugfix_pull_request
lookup first found problem ansible v2 my ansible role an exception occurred during task execution the full traceback is >>>bug_report
changes to convert to unicode at the borders the module docs and vault changes solve issues where tracebacks can happen the galaxy changes are mostly refactoring to be more pythonic with small chance that unicode traceback could have occurred there without the changes the change in init py when we actually call the pager makes things more robust but could hide places where we had bytes coming in already so didn want to change that without auditing where the text was coming from fixes 14178>>>bugfix_pull_request
rekey command checks for file after entering keys rather than before it looks like it does the file check after entering the keys it would be nice if it checks prior to entering them for example >>>feature_idea
identityfile flag passed by proxycommand arguments not being evaluated hello we have several different networks with ssh bastion jumphosts we also have several different ssh keypairs we re using ansible v2 we need to be able to specify an identityfile flag in the ssh proxycommand in order for the communication to work strangely only have issues when specifying private key other than the default ssh id rsa as specified by etc ssh ssh config command does not work unless id rsa exists and is the same as id rsa testkey command works `ssh proxycommand ssh ubuntu redacted bastion public ip home ansible ssh id rsa testkey identityfile home ansible ssh id rsa testkey ubuntu redated dest ip` command does not work as expected extrapolating from above `ansible vvvvv ssh common args proxycommand ssh ubuntu redacted bastion public ip identityfile home ansible ssh id rsa testkey redated dest ip ping` command does not work not as expected at first thought this may be bug with openssh or perhaps im missing flag but after getting ssh to work im not convinced diffing the outputs from command and command doesnt show that ansible is doing anything different with the additional inclusion of the identityfile in the proxycommand section im hoping someone can point me in the right direction thanks >>>bug_report
finalize task parameter values from include actions this is proposed fix to the issue described in https github com ansible ansible issues 14135 in summary task parameters from include actions aren finalized and will still reference item even if you ve assigned the value of it to another variable this causes issues where you want to use the value from parent with loop inside child with loop this does not change the behavior of item being overwritten in child loops only the behavior of other variables that happen to reference item and shouldn >>>bugfix_pull_request
user and groups modules modify in check mode the uid gid in ansible differed from the one on the remote system the remote system was changed despite running in check mode >>>bug_report p2
vim syntax hello not sure this is the right place to put such feature request but it will be very useful if ansible team could maintain vim syntax `https github com chase vim ansible yaml` based on readme the author is looking for maintainer >>>feature_idea
playbook environment cannot contain included vars issue type bug report ansible version ansible configuration stock configuration environment ubuntu 15 10 summary when you set playbook wide environment variables dynamically with jinja template syntax you cannot use included variables in ansible steps to reproduce consider the following playbook and the variables file `ansible env vars yml` contains when the playbook is run with ansible the environment variable http proxy is set correctly when run under ansible the variable is undefined this is problem when you rely on playbook environment variables to pass them to roles expected results be able to use included variables in environment variables actual results the variables file inclusion task fails with variable undefined error >>>bug_report
synchronize task copying locally instead to vagrant vm after vagrant up the vagrantfile ends up in tmp on the vm host not in the actual vm this used to work properly with ansible example test case below ubuntu 14 04 vagrant ansible 1ppa trusty output >>>bug_report pending_closure
non posix bin sh is not respected since v2 problem description dollar parents which aren supported on non posix shells for example solaris 10 one have been used in lib ansible plugins shell sh py since v2 for example tmp dir is being created as export home akint echo export home akint ansible tmp instead of export home akint ansible tmp because of mkdir echo home ansible tmp ansible tmp 1453972288 64 179689601296487 during connection initialization have found ways it could be fixed use backticks instead of dollar parents diff diff git lib ansible plugins shell sh py lib ansible plugins shell sh py index 8b20338 16b715a 100644 lib ansible plugins shell sh py lib ansible plugins shell sh py 35 35 class shellmodule object shell redirect allnull dev null shell and shell or shell sub left shell sub right shell sub left shell sub right shell group left shell group right ansible solaris10 host ping vvvv>>>bug_report
running assemble as handler in check mode will result in changed destination file on ansible seeing the following bug which isn present in we ran into the following issue today running an assemble task in handler from an ansible playbook in check mode will result in overwriting the destination file mark shell tmp ansibletest echo original destinationfile dest destfile mark shell tmp ansibletest cat dest destfile original destinationfile mark shell tmp ansibletest echo source file1 source file1 mark shell tmp ansibletest echo source file2 source file2 mark shell tmp ansibletest ls al source dest dest total 12 drwxr xr mark maniac 4096 jan 28 11 21 drwxr xr mark maniac 4096 jan 28 11 21 rw mark maniac 25 jan 28 11 26 destfile source total 16 drwxr xr mark maniac 4096 jan 28 11 21 drwxr xr mark maniac 4096 jan 28 11 21 rw mark maniac 13 jan 28 11 26 file1 rw mark maniac 13 jan 28 11 26 file2 mark shell tmp ansibletest ansible playbook hosts plays test yml check play localhost task test changed localhost notified assembletest changed localhost play recap localhost ok changed unreachable failed mark shell tmp ansibletest cat dest destfile source file1 source file2 mark shell tmp ansibletest the playbook used hosts localhost connection local gather facts no vars sudo no tasks name test command bin true notify assembletest always run yes handlers name assembletest assemble dest tmp ansibletest dest destfile src tmp ansibletest source running the same on ansible current devel doesn do this as it skips running the handler play task test changed localhost running handler assembletest skipping localhost play recap localhost ok changed unreachable failed >>>bug_report p2
grammar fixes capitalize where necessary general clean up hi all here another clean up grammar review of the bsd support page cheers scott>>>docs_pull_request
can include single quotes in jinja2 string literals anymore having hard time figuring out how to include single quotes inside single quoted jinja2 string literals in ansible playbook ansible ansible devel fad6eb1 >>>bug_report
make paramiko dependency optional trying to use ansible in an install script run by naive users which installs ansible using `pip install user` and then runs my playbook don want them to have to know that they re using ansible at all but due to the paramiko dependency have to make them install the whole python dev toolchain including the xcode cli tools on the mac what if ansible could just do conditional import of paramiko in the ssh fallback path failing if the import failed that would save lot of user pain in this scenario since my script needs to run without root privileges and hence has to nag the user to install any missing dependencies and rerun the script >>>feature_idea
fixing typo depricated for deprecated small typo in the intro getting started docs >>>docs_pull_request
check and diff producing unexpected results see the following behavior each and every copy module item produces changed status when running with check is this normal only some changed files produce diff output when run with check files produce ok status when run without check but those that had diff output on dry run continue to display differences despite an ok status files have been verified identical via md5 so it isn clear why they would indicate change on dry run or produce any type of diff results ownership group and mode have also been verified ansible local os el capitan remote freebsd 10 2>>>bug_report needs_info
squashing was occuring even though pkgs didn have template that would be affected by squash this broke other uses of looping looping for delegate to in the reported bug fixes 13980>>>bugfix_pull_request p2
combine vars merging on unicode as reported by assert we use custom vars plugin as referenced by similar issue at 13873 it looks as though the fix utilizing `combine vars` at 13902 returns unicode characters as reported by assert one must run our callback plugin to replicate our error the var `plugin vars default list` referenced below had dictionary merged into it by the vars plugin >>>bug_report needs_info
delegate to with hosts from with items not working correctly fresh checkout following playbook following ouptut is generated the metadata says that the task is being run on each of the hosts listed in the hosts variable but the stdout lines indicate that the task is being run twice on the same host this seems related to https github com ansible ansible issues 13880 but that issue was fixed >>>bug_report
template update fails due to checksum error issue type bug report ansible version ansible configuration `sudo flags environment running ansible from osx 10 11 managing centos summary when attempting to update template the tasks fails with `failed to checksum remote file checksum error code 0` steps to reproduce attempt to update template using sudo expected results actual results >>>bug_report
stdout lines sudo installing certain kernel removing all the other ones from an ubuntu instance came across this gem stdout which ofc failed because of the become success part running ansible pip >>>bug_report needs_info
failures on ansible connection local hosts stops playbook issue type bug report ansible version ansible configuration updated from to environment summary we are using ansible to deploy our junos devices so big part of our inventory uses `ansible connection local` when running playbook with multiple plays on our junos hosts and one of the tasks fails for host because of missing fact or whatever the host will be left out for all other tasks as expected but the next play in the playbook will not start for any host under the next play would be processed simply skipping previously failed hosts created very simple example which allows to easily reproduce the problem with linux host steps to reproduce inventory playbook expected results expected result would be that the playbook fails on `task1` for host `10 118 194 13` thus skipping `task2` and `task3` for this host while running all tasks for the other two hosts actual results as expected `task2` is skipped for `10 118 194 12` but `play2` is not starting at all ansible devel even reports `no more hosts left` using ansible the result is as expected removing the `ansible connection local` from host `10 118 194 13` the result is also as expected>>>bug_report
template src absolute path required in ansible v2 issue type bug report ansible version ansible environment controller os 10 11 target centos summary templates stored under our shared role are failing to be deployed from tasks in other roles this used to work fine in ansible and it currently major problem to migrate because of high number of templates we deploy that way if we change that in our shared role it means once we update to ansible v2 it will break the compatibility to run palybooks with version steps to reproduce expected results in ansible template is deployed successful actual results in ansible this fails in order for this to work on version have to change the src path to shared templates config conf j2 but this will break compatibility with ansible version >>>bug_report p2
pause prompt keeps input hidden in v2 in tasks prompt for an aws ami and get the user input using register before ansible v2 was able to see what was typing in at the prompt after v2 am not longer able to see what am typing it seems it now defaults to private but it there is no way to disable it >>>bug_report
added option groups to make help readable>>>feature_pull_request
hash calculation failed unusually in copy module this happened in my last run can get it to happen again but it asked to be reported so here it is >>>bug_report
fix handling of difflist containing multiple before after pairs commit ansible ansible c337293 introduced difflist feature the return value however was not adequately outdented to append any diff after the first fix this logic problem >>>bugfix_pull_request
create different cache dir for aws profile if don create different cache dir there will be some risk when user use aws profile switch in different production environments >>>feature_pull_request
ansible error file or module does not exist while running playbook with script module after installing ansible from rpm get the below error on running the playbook which uses the script module the playbook in question >>>bug_report
override ansible cfg settings on the commandline become vault issue type feature idea ansible version ansible version ansible config file home damjan sys ops ansible cfg configured module search path default overrides ansible configuration summary the ansible cfg file has `become true` and `ask vault pass true` but in rare situations need to run `ansible` without the vault or sudo requirements it would need to have something like no become` and no ask vault pass` or become false` to be able to revert the defaults from the config file >>>feature_idea
misleading error when file isn found in role issue type bug report ansible version ansible config file home user ansible ansible cfg configured module search path default overrides ansible configuration clean environment ubuntu 14 04 summary when copy or assemble operation can access the src file in role misleading error suggests to look at the playbooks directory steps to reproduce expected results actual results >>>bug_report
got error when using vars prompt and run with echo ansible playbook issue type bug report ansible version ansible configuration none environment centos ubuntu 14 04 summary got error when using vars prompt and run with echo ansible playbook steps to reproduce echo ansible playbook actual results >>>bug_report p2
ansible nested include with items does not work properly issue type bug report ansible version ansible ansible devel 7e3963420d ansible configuration environment ubuntu 15 10 summary ansible added feature to use include statements together with with items loops when nesting include statements file yml includes yml which includes yml the item variable is not set properly the inner include with items loop does not override the item value from the outer loop steps to reproduce main yml include outer yml include inner yml expected results actual results >>>bug_report
ansible shell module stdout captures are wrong in ansible shell fdisk systemcontainer quote grep disklabel wc returns in stdout 20 but in ansible stdout is record as running the generated ansible command manually python command from ansible tmp the recorded stdout is 20 >>>bug_report needs_info
listing playbook tasks fails issue type bug report ansible version ansible devel commit 78d49914 ansible configuration no changes environment macos 10 11 summary ``ansible playbook list tasks `` call fails with exception ``unexpected exception nonetype object has no attribute failed hosts `` this bug has been introduced with commit 78d49914 steps to reproduce running the command results in expected results no errors actual results exception is being raised >>>bug_report
ansible valueerror file descriptor out of range in select issue type bug report ansible version ansible configuration enabled logging disabled host key checking environment ubuntu 14 04 kvm summary attempting to run playbook across 220 vms running ubuntu at 220 forks started getting and error complaining about descriptor limit so raised the ulimit via etc security limits conf and confirmed via `ulimit n` that it is at 100000 still getting error raised to 200000 no go steps to reproduce spawn 220 virtual machines run the following will see error expected results successful hellos across all 220 vms actual results >>>bug_report
missing documentation the documentation on ansible docsite rst become rst is not sufficient to actually use these new directives to use these directives one needs to guess please provide documentation on how the directives are used or at least examples >>>needs_info
limit restricts visibility to hostvars not in the catalogue for the current run issue type bug report ansible version upgraded to v2 with some outcome ansible configuration environment doesn really apply but ubuntu 10 04 python connection local to generate fragments and assemble summary from my research `hostvars` should contain all yaml defined vars for all hosts even for `ansible playbook` runs which specify limit` it is what expect also this is not concerning gathered facts and caching which different issue though those don show either trying to access defined variables in templates on other hosts while running limit` for faster debugging and targeted executions if we have `host vars hosta hostb hostc yml` and template task running on hosta doing hostvars hostb it will not contain host specific yaml vars removing the limit it acts as you expect steps to reproduce command `ansible playbook set some vars playbooks play yml skip tags remote ask vault pass limit hostname` template the rest of the content isn really relevant this is what using to test role task playbook expected results would expect to see both group all vars and host specific vars under both returned host dicts actual results actual results show all host vars for the limit host hosta but hostb only has the group level vars and is missing the host specific host vars hostb yml ones >>>bug_report
fix for inventory hosts on localhost with alternate ports fixes https github com ansible ansible modules core issues 2831 going to run through my test cases and if it passes will merge this >>>bugfix_pull_request plugin
added the ability to filter gce grouped instances by region zone this implements the ability to filter inventory based on region zone much like in the rax and ec2 inventory scripts >>>feature_pull_request
user module ansible pull issue with user home directory ownership issue type bug report environment controller osx 10 11 03 target centos ansible summary we use ansible pull to run our security role as cronjob every 15 minutes where we create our user accounts and deploy their ssh public keys since we upgrade to ansible we are having issues to login to new instances it seems ansible pull create the user home directories with different uid guid ownership this is preventing normal users to login since each user public key is located in their home directory and cannot be read testing ansible in push mode ansible playbook don see this issue it seems to only happening when you run the same through ansible pull on version steps to reproduce roles security vars main yml expected results ssh nic 54 183 190 197 ls home actual results ssh nic 54 183 190 197 ssh root 54 183 190 197 ls home >>>bug_report
fix cache reading code add refresh cache and instance filters vmware ini has the line cache dir cache ansible however the code that reads the cache dir does not expand the added os path expanduser to fix to make this dynamic inventory similar to ec2 py added instance filters and refresh cache flag to test install jq customize your vmware ini and source your vars into the shell environment note is two single quotes in the lines below vmware py jq note now long it takes vmware py jq the second time should be much faster if you uncomment cache dir vmware py refresh cache jq this should return almost instantly>>>bugfix_pull_request feature_pull_request
ansible using with items and ec2 eni is changing other variables assuming this is set of tasks in role and that all variables have been validated to be defined to their correct values prior to hitting the ec2 ini task and that this is the output from using vvv you will see that there are two error messages as result of trying to iterate from the expected two items in `with items vpc created subnets the `msg` of the failure is bit odd json representation of the current `with items` element is replacing the region value somehow even though it printed correctly in the task output prior to calling this task the first of the two tasks in the above output >>>bug_report
ansible temp directory is not cleaned up properly all the directories within the `remote tmp` directory are empty if the files within them aren required then the directory shouldn be either >>>bug_report
when assigning tags to roles tags are not overwritten issue type bug report ansible version ansible configuration gathering explicit pipelining true summary when assigning tags to roles tags are not overwritten steps to reproduce here the tree file playbook yml file myrole tasks main yml and mydep tasks main yml file myrole meta main yml expected results actual results sylvain>>>bug_report
copy module fails when copying directory contents from remote src in ansible when using copy module fails with msg attempted to take checksum of directory this happens with and without slashes at the ends of both or either directory name and also whether or not the destination directory exists or not source directory always present and filled with files and subdirectories >>>bug_report p2
handle `omit` value in task attributes like `environment` or `become user` issue type feature idea ansible version ansible configuration no custom configuration environment ubuntu 15 04 summary when using `shell` module with attribute `environment` defined as provided env default omit the attribute is not omitted and it fails with error error environment must be dictionary received omit place holder dd43d6f3183f203e2d5011d3fe7f9d265a37ba74 steps to reproduce expected results `environment` is simply omitted actual results >>>feature_idea
add support for additional parameter pkg opts in package action current version of package action is quite limited and doesn have much capability beyond `package name foo state present` or `package name foo state absent` additional parameter `pkg opts` now facilitates adding package manager specific options to be passed on to the underlying package manager module via external platform specific variables so we can now do `package name foo pkg args my pkg args where `my pkg args` can be configured to have actual package module specific parameter specific to apt pacman homebrew etc >>>feature_pull_request
consistent parameters naming for file and acl modules feature idea in `file` module we have parameter `recurse` in `acl` module we have parameter `recursive` often use wrong one for each module think it would be more convenient for both modules to accept both forms but declare one of forms deprecated it won break existing playbooks and people will gradually start using one form not deprecated >>>feature_idea
ansible command list tags shows no tags issue type bug report ansible version ansible playbook ansible configuration nothing special environment debian summary ansible playbook option list tags shows no tags steps to reproduce ansible playbook inventories tad hosts 05 apache yml tadprsc01 list tags expected results playbook 05 apache yml play apache hosts tags tag1 tag2 tag3 task tags tag1 tag2 tag3 actual results playbook 05 apache yml play apache hosts tags task tags >>>bug_report needs_info
no such file or directory ansible version is ansible and my os is centos this issue has trouble me two hours and search google for this get nothing valuable run command `ansible daily ping vvvv` get the below errows the correct output may be why miss the put command >>>bug_report needs_info
ansible galaxy fails to login valueerror no json object could be decoded issue type bug report ansible version ansible configuration default environment verified on os 10 11 archlinux ubuntu 15 10 summary not sure where to direct `ansible galaxy` issues or whether or not this is an issue with python implementation of json or what but using homebrew installed python ansible or system python with pip installed ansible and all combinations of those aur or apt get installed python ansible the command `ansible galaxy login` fails with `valueerror no json object could be decoded` spent little time digging around in the code but couldn seem to find the issue additionally when view my personal access tokens can see one token from ansible which has never been used can delete this and retry it or regenerate new token and use it with `ansible galaxy login github token xxxxxxxxxxxxx` to no avail can also see that new token was generated and then deleted by ansible in my security history report on github steps to reproduce or expected results authenticate and be able to run commands like `ansible galaxy import actual results system `python 10` and pip installed `ansible 2` homebrew installed `python 11` and homebrew installed `ansible 2` >>>bug_report pending_closure
fixes 12309 duplicate 12571 for devel branch additional options to ansible pull git see 12309>>>feature_pull_request needs_revision
ansible regression ioerror exceptions in filters hang playbook execution issue type bug report ansible version ansible config file configured module search path default overrides the playbook runs as expected on the issue started with ansible configuration regression is evident with clean config environment ubuntu 14 04 but don expect the issue is os related summary during playbook execution when filter raises an exception the playbook should fail with ansible when an ioerror is raised execution hangs at the point of the exception steps to reproduce playbook hosts all gather facts false tasks debug msg hello myfilter filter filter plugins myfilter py def myfilter data raise ioerror ex1 playbook hangs return open no such file read ex2 playbook hangs return hello there ex3 playbook ok as expected this will raise nameerror ex4 playbook fail as expected class filtermodule object def filters self return dict myfilter myfilter command to run ansible playbook localhost playbook yml there are four examples provided in the filter above comment out the other lines to try each example expected results during playbook execution when filter raises an exception the playbook should fail actual results in examples and on ansible execution hangs at the point the exception is raised in execution fails as expected examples and behave as expected on both and >>>bug_report p2
feature request manipulate tags as play level parameter issue type feature request ansible version but to my knowledge this doesn exist in either ansible configuration environment summary love to see play level parameter that allows the user to specify which tags are to be used or skipped in that play for example this play would run only the tasks that are not tagged `iptables` alternatively this play would run only tasks that are tagged `configure` steps to reproduce see above for desired results this would be fantastic in particular for using ansible pull where altering the command line parameters on per playbook basis is bit more of hassle edit updated the suggested parameter for including tags since `tags is already play level parameter that exists >>>feature_idea
regression commit 8647fdc breaks become method su issue type bug report ansible version ansible config file home lifanov ansible cfg configured module search path usr local share ansible running version with backport of commit 8647fdc ansible configuration regression is evident with clean config environment summary the above mentioned commit fixes become method sudo with non default shells like bin csh on freebsd etc so it is important but it also regresses become method su by incorrectly quoting commands running through bin sh steps to reproduce playbook expected results playbook works actual results >>>bug_report p2
bug report callbacks print out before play recap not after hi like to report bug on callbacks behavior ansible version ansible ansible configuration callback plugins ansible plugins callback plugins environment running on mac osx with python 11 summary callback output from `v2 playbook on stats` is printed before `play recap` and not after ve placed my callback in ansible plugins callback plugins directory when move it into virtualenv in virtualenvs myansible lib python2 site packages ansible plugins callback` output is printed after `play recap` to display any information from my cllback use `self display display` method steps to reproduce see above expected results all callbacks output from `v2 playbook on stats` should be printed after `play recap` >>>bug_report
v2 sluggish playbook run with role inter dependencies issue type bug report performance resource usage ansible version ansible configuration no changes environment summary with more complex role dependency graph time to execute playbook is growing non linearly this became obvious after switching to ansible with our playbook time to execute jumped from 14s to 45s after role dependencies were removed and all roles explicitly included in playbook execution time between v2 vs v1 was acceptable again steps to reproduce create set of roles that depend on each other every role depends on all roles triangle in playbook include only the last role here is bash script to generate roles and playbook with higher number ansible will run out of memory with number too low the time difference is statistically insignificant workaround put all roles in playbook in the order you would expect them to be executed remove inter role dependencies expected results ansible actual results ansible ansible devel branch >>>bug_report
consistent regex regexp naming would like to request that we deprecate the `regexp` parameter of `lineinfile` and rename it to `regex` this may seem trivial but it is very confusing because of the jinja2 filter named `regex replace` am constantly getting them mixed up trying to use `regex` with `lineinfile` and the jinja filter `regexp replace` by renaming it to `regex` the name will be consistent >>>feature_idea
change example to use pkg rather than the obsolete pkg add pkg add has been obsoleted in all released versions of freebsd for several years change the example to use the appropriate pkg command line >>>docs_pull_request
checking node health on consul besides service health we can have false positive of node on the group of available nodes for service even if the serfhealth check of the node did not pass this patch pull request take this in to account to put node in the available or unavailable groups >>>feature_pull_request
unexpected exception list object has no attribute get ohai have ansible running in phusion container alongside hubot instance that should execute ansible playbooks get the mentioned exception no matter how far downgrade ansible which is installed via pip tried every version down to `pip freeze` ansible awscli 10 botocore 22 colorama crypto docutils 12 ecdsa 13 j2cli post0 jinja2 jmespath markupsafe 23 naked 31 paramiko 16 pyasn1 python dateutil python keyczar 715 pyyaml 11 requests rsa shellescape six 10 looked up similar looking exception bugtickets and made sure python setuptools is installed also patched the diff from this particular bug https github com ansible ansible issues 11521 by hand which didn solve the problem in any version either the playbook execute is the vvv version is hope passed all relevant pieces of information required >>>needs_info
regression on include with symlink issue type bug report ansible version ansible configuration no custom configuration environment ubuntu 15 04 summary relative include doesn work through symlinks anymore steps to reproduce here is the test case test tar gz https github com ansible ansible files 103395 test tar gz know it bit complicated but it our development mode run the `launch sh` expected results ansible result actual results ansible result >>>bug_report needs_info
ec2 inventory allow for and usage when specifying multiple tags for instances pretty common to want the intersection of multiple tags ie my app tag and the dev stage in an account with lots of apps stages >>>feature_pull_request
handle the key custom in the diff result from modules so far when diff dict is returned with module results it is checked for before and after texts which are processed in get diff by python difflib this generates the changes to display when cli users specify diff however some modules will generate changes that cannot easily be expressed in conventional diff one example is the output of the synchronize module which presents changed files in common log format as in `rsync itemize changes` add check for diff custom key which can contain custom diff text from modules >>>feature_pull_request
synchronize module not using remote user in we just upgraded from ansible to ansible and this has broken the synchronize module our config playbook inventory with flags it using remote user remote host so it looks like it isn resolving the variable from task vars and using the literal string remote user changing remote user remote user to remote user remoteuser works ok note other modules are ok >>>bug_report needs_info pending_closure
service name jenkins enabled yes not working ansible service name jenkins enabled yes establish connection for user vagrant on port 2222 to 127 exec umask 22 mkdir echo home ansible tmp ansible tmp 1453719480 262397764983596 echo echo home ansible tmp ansible tmp 1453719480 262397764983596 put tmp tmpjg8kt1 to home vagrant ansible tmp ansible tmp 1453719480 262397764983596 service exec bin sh sudo root bin sh echo become success pyplcmqcjuyjamybfagmkplpnnbvnnsc lang de de utf lc all de de utf lc messages de de utf usr bin python home vagrant ansible tmp ansible tmp 1453719480 262397764983596 service rm rf home vagrant ansible tmp ansible tmp 1453719480 262397764983596 dev null jenkins success changed false enabled true invocation module args arguments enabled true name jenkins pattern null runlevel default sleep null state null module name service name jenkins systemctl status jenkins jenkins service jenkins loaded loaded etc systemd system jenkins service disabled vendor preset disabled >>>needs_info
fixes documentation formatting fixes documentation formatting>>>docs_pull_request
async status file not using ansible python interpreter was ansible async polling is not working this is with pcbsd 10 system running ansible to configure digital ocean freebsd 10 droplet this is the task the problems are with the poll present the process stops after only 10 seconds with the error async task did not complete within the requested time with poll line removed then no error and the playbook continues after approximately seconds and completes without error in both cases logging in with ssh to the droplet shows the sleep 120 is still running and once complete the zero size file in ansible async gets the results added to it the results file looks ok notes the intsaledl ansible 002 has `plugins action init py` from devel branch to allow csh to work also added user with zsh which gave exactly the same results >>>bug_report
any errors fatal doesn work when using roles issue type bug report ansible version ansible devel 2b02e8e2b4 last updated 2016 01 25 09 52 17 gmt 200 ansible configuration default configuration environment fedora 23 summary any errors fatal doesn stop task execution in some cases steps to reproduce create the following two playbooks the first one has single file named `working yml` the second one uses the dir structure described as best practice file `notworking yml` where the `myrole` role has the following content into file `main yml` the accompanying hosts file is expected results the two playbooks both stops after the first task actual results playbook `working yml` stops after the first task the other one executes the remaining tasks on the non failing host>>>bug_report
variable specified in role invocation fails to override role default ansible version summary ve playbook that does this the role defines default value for the port and uses it in template when run this playbook with ansible correctly get when try ansible see this >>>bug_report p1
diff and files with missing newlines ansible version summary when an existing file has no newline at the end of file ansible diff mode output is hard to read compare with the way gnu diff reports this >>>bug_report
proxmox inventory added support for proxmox ve lxc vms added support for using the notes field of vm to define groups and variables well formatted json object in the notes field will be added to the meta section for that vm in addition the groups key of this json object may be used to specify group membership groups utility databases false true >>>feature_pull_request
rsync deprecation should not emitted when both paths are on inventory host don see way to use `synchronize` to rsync between two paths on the remote host so there no real alternative to using rsync inside `shell` but the deprecation will be emitted every time run my playbooks think ansible should either detect this usage of rsync and not emit deprecation for it add mode for `synchronize` allowing synchronization of two remote paths >>>bug_report
command make webdocs fails when attempting to generate the documentation for module writing receive the following message when running make webdocs from the docsite directory as instructed by http docs ansible com ansible developing modules html building testing make no rule to make target `webdocs stop >>>pending_closure
make list hosts honor limit fix for 13848 fix for 13848 makes list hosts` honor limit` by recomputing `hosts` when `options subset` is set with the fix the output for serialdoom example cases is as follows alternative solution recomputing `hosts` like this might be bit smelly one might contend that `hosts` should hold all hosts regardless of whether subset is selected another possibly cleaner route is to use two variables `all hosts` and `selected hosts` if you prefer this or some other variant let me know and ll fix the pr >>>bugfix_pull_request
ansible ssl sslerror ssl certificate verify failed certificate verify failed ssl 590 hi having an issue with ansible when trying to launch an ec2 instance getting an ssl verification error message and have no clue as to what to do to fix this issue also try the callback plugins to disable the ssl verification but had no luck cat fix py import ssl if hasattr ssl create default https context and hasattr ssl create unverified context ssl create default https context ssl create unverified context class callbackmodule object pass able to create stop terminate ec2 instances using python boto alone voila openssl version openssl 2d jul 2015 cat etc redhat release red hat enterprise linux server release santiago python version python 11 anaconda 64 bit ansible version warning log file at var log ansible log is not writeable aborting ansible config file user wannaknowmo ansible cfg ansible cfg configured module search path user wannaknowmo ansible library ansible cfg defaults host key checking false gathering explicit gathering false env dev transport ssh hostfile user wannaknowmo ansible cfg hosts log path var log ansible log fork 10 ansible library home ansible library module path home ansible custom modules ssh connection ssh args ssh args controlpath ssh control pipelining true remote tmp var tmp ansible tmp user wannaknowmo anaconda2 bin ansible playbook vvv launchec2 yml cfg hosts no config file found using defaults plays in launchec2 yml play provision an ec2 instance task create security group task path user wannaknowmo ansible playbook launchec2 yml 19 establish local connection for user gfadm localhost exec umask 22 mkdir echo home ansible tmp ansible tmp 1453591792 86 38906947896268 echo echo home ansible tmp ansible tmp 1453591792 86 38906947896268 localhost put tmp tmpeyeaoe to user wannaknowmo ansible tmp ansible tmp 1453591792 86 38906947896268 ec2 group localhost exec lang en us utf lc all en us utf lc messages en us utf user wannaknowmo anaconda2 bin python user wannaknowmo ansible tmp ansible tmp 1453591792 86 38906947896268 ec2 group rm rf user wannaknowmo ansible tmp ansible tmp 1453591792 86 38906947896268 dev null an exception occurred during task execution the full traceback is traceback most recent call last file user wannaknowmo ansible tmp ansible tmp 1453591792 86 38906947896268 ec2 group line 2632 in main file user wannaknowmo ansible tmp ansible tmp 1453591792 86 38906947896268 ec2 group line 272 in main for curgroup in ec2 get all security groups file user wannaknowmo anaconda2 lib python2 site packages boto ec2 connection py line 2968 in get all security groups item securitygroup verb post file user wannaknowmo anaconda2 lib python2 site packages boto connection py line 1170 in get list response self make request action params path verb file user wannaknowmo anaconda2 lib python2 site packages boto connection py line 1116 in make request return self mexe http request file user wannaknowmo anaconda2 lib python2 site packages boto connection py line 1030 in mexe raise ex ssl sslerror ssl certificate verify failed certificate verify failed ssl 590 fatal localhost localhost failed changed false failed true invocation module name ec2 group parsed false play recap localhost ok changed unreachable failed 1>>>cloud needs_info
note ssh deprecation for inventory variables as per the ansible faq http docs ansible com ansible faq html ansible has deprecated the ssh from ansible ssh user ansible ssh host and ansible ssh port to become ansible user ansible host and ansible port this change breaks working ansible configurations since sites often reference ansible ssh user http serverfault com search ansible ssh user and the others comment about this change should be present in the most common place people look when considering an upgrade to ansible >>>docs_pull_request
script module does not work in windows authentication or permission failure it seems that the script module under windows no longer works correctly it now gives the error establish winrm connection for user cloud on port 5986 to 10 51 30 57 winrm connect transport ssl endpoint https 10 51 30 57 5986 wsman exec set strictmode version latest new item type directory path env temp name ansible tmp 1453332209 69 193824785181852 fullname write host separator winrm open shell 42ff6705 b264 4699 af03 9d348978d09e winrm exec powershell noprofile noninteractive executionpolicy unrestricted encodedcommand endcoded establish winrm connection for user cloud on port 5986 to 10 184 44 122 winrm connect transport ssl endpoint https 10 184 44 122 5986 wsman exec bin sh powershell noprofile noninteractive executionpolicy unrestricted encodedcommand encoded winrm open shell ca9d1fe9 250c 4c8d b77a 9fad7000b695 winrm exec powershell noprofile noninteractive executionpolicy unrestricted encodedcommand encoded winrm result winrm close shell ca9d1fe9 250c 4c8d b77a 9fad7000b695 fatal te amers2 20160123 004025 app instance ywak3o5la6oa unreachable changed false msg authentication or permission failure in some cases you may have been able to authenticate and did not have permissions on the remote directory consider changing the remote temp path in ansible cfg to path rooted in tmp >>>bug_report windows
ansible variables in handler names not populated issue type bug report ansible version environment os 10 10 summary under ansible jinja variables contained in handler `name` are no longer populated under ansible they were populated here quick example steps to reproduce write this content to `playbook yml` yml hosts localhost connection local vars appname someapp handlers the following line when the handler is executed does not populate appname name restart appname debug msg some bogus module call in handler appname tasks name bogus task with notify for appname command ls notify restart appname run the playbook `ansible playbook connection local playbook yml` expected results in the output of the playbook run any mention of appname should not appear but replaced with `someapp` per the given variables actual results note that in the `running handler` line the jinja template syntax is printed literally rather than being populated with the variable that clearly exists since it populated elsewhere like the `msg` output two lines below this seems like regression but is it intentional thanks as always for fantastic product >>>bug_report
add vault support to copy action plugin via dataloader implementation added two methods to dataloader along the lines discussed with bcoca in 13849 get real file will decrypt vault encrypted files and return either path to temporary file or simply the path to the unencrypted file if its not encrypted cleanup real file will remove temporary file created with previous call to get real file>>>feature_pull_request
unarchive module does not clean up issue type bug report ansible version ansible configuration defaults host key checking false hostfile inventory test pipelining true environment from ubuntu 14 04 to sles12 summary after running the `unarchive` module the home ansible` is not cleaned up steps to reproduce name extract large file unarchive src large file tar gz dest tmp expected results home ansible` on target machine is small after playbook has finished actual results home ansible` is about the size of the archive extracted >>>bug_report
ansible winrm unicodeencodeerror ascii codec can encode character ufeff in position ordinal not in range 128 can use ansible windows support through winrm encoding character issue the full error message >>>bug_report needs_info windows
v2 ambiguous skipping status for command task in check mode issue type feature idea bug report ansible version ansible configuration no changes environment summary in check mode skipping status is ambiguous for command tasks with `when` condition one major use case for running check mode is to find out what would be applied in normal mode command tasks always return skipping status in check mode those that don have always run yes to be exact user cannot tell whether the command is really skipped due to `when` condition not being met or skipped because it is in check mode it would be nice to distinguish these two states one possible solution is to return changed status on commands that are not skipped by `when` condition this would align the behavior with other modules changing it from skipped to changed may cause heart attack for sysadmins already used to current convention don mind how it is fixed as long as those two states are distinguishable workaround print command `when condition with debug task next command would run true false in ansible it was distinguishable albeit the output was slightly confusing steps to reproduce create playbook name test1 hosts localhost gather facts no tasks name unconditional command command bin echo foo name conditional command command bin echo bar when condition default false run playbook in check mode expected results actual results notice first task would run in normal mode while the second would be skipped due to `when both have the same output in check mode >>>feature_idea
loop output now happens at the end of loop not on each item previously before each step using `with items` within task would echo out the status as it happened this allowed the user to see the progress and to know that ansible is still running however since it now only show the steps once the task has finished as whole this is makes it feel like the tasks have hung stopped and it really makes everything feel much much slower is there reason for this change in my opinion it has massive negative affect of the ux as it appears that no progress is being made and that the script needs to be terminated this issue initially caused me to open 13835 as thought it wasn working at all thanks >>>bug_report
ssh key connection on openshift unreachable changed false msg authentication or permission failure in some cases you may have been able to authenticate and did not have permissions on the remote directory consider changing the remote temp path in ansible cfg to path rooted in tmp failed command was umask 22 mkdir echo home ansible tmp ansible tmp 1453454818 34 93920951582093 echo echo home ansible tmp ansible tmp 1453454818 34 93920951582093 exited with result mkdir cannot create directory var lib openshift 5649c22b7628e1ea2d0000bc ansible permission denied unreachable true >>>needs_info pending_closure
setup fails on hp tape drive inappropriate ioctl for device hello using ansible the setup module fails on hp sas controller the controller is bot tape drive connected to hp smart array controller it is recognize by the system though any hints cheers matt>>>bug_report
ansible ignored host vars from inventory file variables priority was changed or it is bug created gist https gist github com kivagant 4d8c5a41e6107864ed75 with the problem explanation briefly when upgraded ansible from to got strange behaviour and after investigation found that variables priority now changed it is really critical changes especially for production environments ansible now get variables from group vars folders instead of group vars section from the inventory file it new normal behaviour >>>bug_report
feature request setup module import osquery data it would be really nice to have the setup module import osquery data if osqueryi is present on the system the simple path is to for table in osqueryi tables schema `osqueryi schema table for row in `select from table` add row to setup options osquery done>>>feature_idea
getting traceback call with syntax error hi was getting traceback call due yaml syntax error got it fixed but thought that would be interesting to fix the traceback showing friendly message here the code error quotes in the second line here the traceback ansible version >>>bug_report
extra modules missing from release via pip in particular was trying to use the `ec2 vpc net facts` module for whatever reason the installation via pip seems to be missing this module as well as couple others even though they have been around for while took file list from machine where installed from pip installed from github source using `make make install` devel branch github clone directory devel branch the modules missing are ec2 vpc net facts py ecs service py ecs service facts py outputs are at https gist github com wholroyd 87943f3f71fd0f09fa8f if you want to see the pip issue yourself caught the problem in fresh built docker image `wholroyd centos ansible latest` >>>bug_report
template module deleting directories ansible os 10 11 target is ubuntu 14 04 when using the template module included `state absent` to see if that would remove some files from the server without having to write some other playbook ansible came back with the message the playbook won continue after that so checked manually and the directory is missing though ansible warns me about the module state being unsupported adding it causes the directory `my fake dir` to be deleted >>>bug_report p1
vault shredding exception with length contents currently in the vault code we attempt to shred the tmp file there is problem with the implemented logic in that if you delete the contents of an already existing file or you create file with no contents you will get `zerodivisionerror` you don see that above exception modified `bin ansible` to print that exception normally you would just see propose fix to this where few things would happen we should pass along the previous length of the file and shred the larger value if the larger value is `0` it would just exit when creating an empty file >>>bug_report
add python requirement to module checklist it in travis but not explicitly in the docs >>>docs_pull_request
fix regression in max byte limit for diff source files ansible playbook version ansible playbook config file users george ansible cfg configured module search path default overrides>>>bugfix_pull_request
add lookup for pass the standard unix password manager provide alternative for `password` lookup that uses pass the standard unix password manager http www passwordstore org for storing and retrieving password usage code is basically mashup of the `password` and `pipe` lookups >>>feature_pull_request
ansible file state link bug have problem with running getting running ansible from osx target system is ubuntu 14 04 >>>bug_report
role is executed multiple times when referenced indirectly as dependency issue type bug report ansible version ansible configuration no changes environment independent for completeness control host fedora 23 managed host debian jessie summary role is executed multiple times when referenced indirectly as dependency steps to reproduce create three roles with following dependencies depends on depends on include only role in playbook and execute expected results each role should be included only once three tasks will be executed this is the behavior of ansible actual results role is included twice note when playbook includes role is included three times when playbook includes role is included only once >>>bug_report p2
make rpm fails on ansible ansible tar gz tried building the rpm for ansible and it completed without problems but when run make rpm for ansible it fails with the below error at the end >>>bug_report
adding support for scm based role source urls ansible galaxy fix for 13910 incl integration test to cover it >>>bugfix_pull_request
an exception is thrown when displaying another exception backtrace issue type bug report ansible version ansible configuration environment ubuntu 15 10 python 10 summary if ansible is installed in path containing unicode character trying to display backtrace of exception like in 14041 will produce another exception steps to reproduce install ansible in path containg unicode characters home dromanov ansible create playbook that triggers exception 14041 for example run playbook in verbose mode expected results actual results >>>bug_report
an exception in synchronize module when src or dest args contain unicode paths issue type bug report ansible version ansible configuration environment ubuntu 15 10 python 10 summary an exception is thrown in synchronize module when src or dest args contain unicode paths steps to reproduce run ansible playbook in verbose mode ansible playbook debug yml vvvv` project configuration ansible cfg hosts debug yml expected results actual results >>>bug_report
rescue not being executed if failed inside an include in development branch hi there am not sure if it changed as feature or if it is bug the thing is main yml file to fail yml am testing making the tmp file1 file creation fail so the thing is that in current version if it fails in the include the rescue part is called and the tmp file2 is created but with devel branch it does not it works if instead of include specify the task there see commented line but not with the include >>>bug_report
ansible galaxy use http for travis notifications the tls ciphers on our azure load balancer are not compatible with travis ci this is known issue difficulty with travis notifications see https docs travis ci com user notifications note on ssl tls ciphers changing the default travis yml created by ansible galaxy init it should default to http rather than https >>>bugfix_pull_request
with fileglob used in role resolves relative paths playbook directory issue type bug report documentation report ansible version ansible configuration none environment summary `with fileglob` used in role resolves relative to the directory the playbook is in which diverges from the docs as well as previous versions steps to reproduce put this in fileglob test roles fileglob foo tasks main yml run playbook against localhost that includes the above role expected results based on https docs ansible com ansible playbooks loops html id4 which notes when using relative path with `with fileglob` in role ansible resolves the path relative to the `roles files` directory am expecting the first fileglob pattern to find `testdir something` and the second fileglob pattern not to find that filename actual results is this bug with `with fileglob` or does the documentation need to be amended thanks >>>docs_report easyfix
use ssh askpass instead of sshpass for password logins description this pr makes openssh to use askpass directly without the need of external sshpass program this sets the password to the environment variable called ansible ssh pass and sets the ssh askpass enviroment to usr bin ansible pwecho itse also sets the display enviroment variable to empty string if it not set when the ssh needs password it ll execute the askpass program which simply outputs the password from the enviroment variable security considerations the password can be read from the environment variable of the ansible pwecho program however at least in linux the permissions are limited to the current user on the other hand the pwecho program is very simple todo does the change to the enviroment variables affect ansible or other programs tested this only with simple inventory file containing hostname ansible ssh user and ansible ssh pass should the feature be activated by default or with some command line switch should the sshpass program be removed completely or left as fallback current patch removes support for that program does the fix work with sftp or scp test with other systems currently tested only in linux >>>feature_pull_request needs_revision
strategy free messes up the terminal it is run in issue type bug report ansible configuration environment centos summary using strategy free seems to send control characters or other special characters to the terminal and break it steps to reproduce just made simple four host test group and ran shell command on each host to get hostname sorry can make detailed test examples for few days because can risk running random commands on my control server and need to set up test group to test this safely expected results playbook runs with each host running independent of each other actual results the playbook itself seems to execute as expected but the terminal becomes messed up in various ways such as font being changed or it looking like some of the output from ansible was executed as commands in the terminal have seen fonts change the command history have strings of output from the playbook run output and the echo of characters typed in the terminal not working >>>bug_report
add config option for rackspace inventory cache adding config and environment variable option for tuning the cache age check in the rackspace inventory module>>>cloud feature_pull_request
allow special inventory vars to be used in vars files want to be able to load variables depending on the inventory file used know we could put the variables in the inventory file itself but feels cleaner to keep them in separate file so want to be able to use inventory file in the value of vars files this didn work and found someone else had already filed issue 9723 also found out this issue is already fixed in but moving to is not yet an option for some environments this commit adds load vars in the play object so it can be used when updating the vars files templated values the precedence of the other injected variables was kept and load vars will take the lowest precedence >>>backport
adds ansible check mode boolean magic variable adds boolean magic variable `ansible check mode` which will be set to `true` if run with check` otherwise it will be `false` this allows for an easy way to skip or ignore tasks in check mode if it doesn make sense to run them need to run git module but git is not installed yet since we are running check mode this also closes https github com ansible ansible issues 10696>>>feature_pull_request needs_rebase
strategy free output not as expected when running playbook with strategy free set the output of the playbook doesn line up example playbook output on command line if you notice the output of srv01 task shows up under the task say bye header my thoughts are that the output should show like this >>>bug_report
ansible setup module no longer works on rhel5 10 python after upgrading to ansible from ansible can no longer manage rhel5 10 hosts due to issue with ansible fact collection module setup client details >>>bug_report
rescue is not called if the failure of one host with any errors fatal option on block level hi as seen on this thread https groups google com forum topic ansible project puupnptuz9c on the devel branch the option any errors fatal on block level should if single node fails have all nodes to fail and then execute rescue in all nodes in the last devel version yet if the option is accepted in current the option is just not accepted on block level and all nodes are marked as failed the rescue part is not executed in any of them instead the execution just stops in the previous example if the tmp testfolder1 fails in any node tmp testfolder2 will not be created either as rescue will not be executed without the option any errors fatal with single host the rescue part will be executed >>>bug_report
add support for nested hostgroups in freeipa by printing both member host and memberindirect host objects found in hostgroup>>>feature_pull_request
become can sudo without password issue type bug report ansible version ansible config file configured module search path default overrides ansible configuration nothing particular environment running from osx 10 11 ansible installed via homebrew target os up to date debian wheezy summary it seems that we can use become default sudo adapter without defining sudo password steps to reproduce just run ansible foo whoami or ansible foo whoami expected results foo success rc root actual results foo failed rc error missing sudo password of course sudo without password is well configured on the target machine and everything is ok with ansible >>>needs_info
error connection closed waiting for privilege escalation password prompt know that there are few issues like that and they all are closed as solved but still getting this error with version while using loops and modules apt repository pip and npm same usage with module apt works fine for example fails with but it works fine when change it to >>>bug_report p2
default variables not inherited when including multiple instances of role from another role issue type bug report ansible version environment ubuntu 14 04 summary default variables don appear to be inherited properly for optional vars when including multiple instances of role via another role meta dependencies this behaviour differs from ansible steps to reproduce have role which includes multiple instances of another role in roles user defaults main yml` we set `user shell` to bin bash` so if this var is not defined that default should be used expected results the user `mrbash` should have their shell set to bash the user `mrfalse` should have their shell set to bin false` actual results both users have their shell set to bin false` it doesn seem to matter which order the two instances of the role are specified the result is the same both users get their shell set to bin false` edge case there seems to be an edge case where if define multiple instances of role directly in playbook then the behaviour works according to the expected results section for example results in so it appears that this issue only affects roles included via other roles in their meta dependencies not roles which are included directly in playbook >>>bug_report
ansible no longer looks for ansible cfg in playbook directory issue type bug report ansible version ansible configuration ansible cfg environment ubuntu 12 04 lts ubuntu 12 04 lts summary database copy script that has been running pre ansible has started failing steps to reproduce upgrade to ansible difference is that ansible isn picking up the ansible cfg file that in the same directory as the playbook and so uses default options for ssh don know why the defaults for ssh fail but the fix is the cd into the directory first pre ansible looked for config in the current play directory expected results actual results >>>bug_report
ansible ssh control path not getting set hi had issues with control path being too long on some servers tried setting it in `ansible cfg` in etc ansible` on mac but it still kept picking the default path had to exclusively export the `ansible ssh control path` variable for it to pick the setting below is the stack overflow link control path issue http stackoverflow com questions 27487332 ansible playbook controlpath too long 34898006 34898006 vinit>>>needs_info
search is not working after upgrade to ansible issue type bug report ansible version master ansible version ansible config file home hclee develop vm ansible cfg configured module search path default overrides environment ubuntu 14 04 summary search is not working after upgrade to ansible steps to reproduce this is my playbook which is working in ansible expected results it should be running without errors actual results saw the following error instead >>>bug_report
initial add of action plugin nxos template adds new local action for working with cisco nxos configurations implemements the net config local action >>>feature_pull_request
initial add of action plugin ops template adds new local action ops config for handling openswitch configurations using either dc or cli based configurations implements the common net config local action >>>feature_pull_request
initial add of action plugin ios template adds new local action ios config for working with cisco ios configuration files implements the common net confing local action>>>feature_pull_request
initial add of action plugin eos template adds action plugin for working with eos configuration files implements common net config plugin>>>feature_pull_request
initial add of action plugin net template the net config local action handles templating for network configuration file it will also allow network device configurations to be backed up to the control host>>>feature_pull_request
go back to always wrapping commands in shell this was taken out in an effort to default to the user shell but creates issues as this is not known ahead of time and its painful to set executable and shell type for all servers it should only be needed for those that restrict the userto specific shells and when bin sh is not available fixes 13882>>>bugfix_pull_request p1
identifier validation for variable names issue type bug report ansible version ansible config file etc ansible ansible cfg configured module search path default overrides ansible configuration didn modify the default etc ansible ansible cfg and didn create any other ansible cfg files installed using `make make install` almost certainly irrelevant environment irrelevant summary variable names identifiers aren validated at all on the one hand that arguably just an undocumented feature and it quite fun to play with but it also means that errors are thrown way later than they ought to be if they re thrown at all which would have been more confusing if weren intentionally testing this steps to reproduce if you put the following in vars file and include the file that raises zero red flags of course most of these variables aren actually usable after evaluation with the delightful exception of `and hello expected results screen full of angry red text along the lines of ansible variables are basically just python identifiers so the same rules apply use za za only actual results when used in tasks ii got errors including but not limited to fatal 127 failed failed true msg error template error while templating string expected token variable end got fatal 127 failed failed true msg error var1 is undefined fatal 127 failed failed true msg error template error while templating string expected token name got ok 127 item you item you you variable is not defined fatal 127 failed failed true msg error dict object has no attribute you ok 127 and hello though and so on all that was just way for me to figure out sane way to implement namespacing but that discussion an unreasonable over the top rant about nothing for another day issue ticket >>>feature_idea
cannot access group variable when using dynamic includes given the following when running with get the following ve removed the logic that makes this actually useful but is this no longer supported as of this has been working well in but moving to it seems that access to the group variable is no longer available when dynamically including other files currently use this pattern of prechecks in other playbooks and don want to add the `when` logic to each task in the precheck playbook if this is just result of the way includes have been refactored can try to find way around it but didn know if this was to be expected or not >>>bug_report
error while executing ansible commands failed true msg error paramiko is not installed issue type error executing the ansible commands in remote hosts bug report ansible version ansible ansible configuration nothing just finished installing the ansible in oracle linuc same kernal as rhel after the installation when try to execute any ansible core commands such as ping file or setup are showing following error root wautomation tst01 ansible vvv werindbalajil01 ping using etc ansible ansible cfg as config file werindbalajil01 failed failed true msg error paramiko is not installed environment oel root wautomation tst01 ansible uname linux wautomation tst01 us int rci com 39 400 109 el6uek x86 64 smp mon jul 22 11 44 00 pdt 2013 x86 64 x86 64 x86 64 gnu linux python version root wautomation tst01 ansible python version python summary when try to use the basic ansible command it coming with following error root wautomation tst01 ansible vvv werindbalajil01 ping using etc ansible ansible cfg as config file werindbalajil01 failed failed true msg error paramiko is not installed steps to reproduce running any ansuble core commands root wautomation tst01 ansible werindbalajil01 ping werindbalajil01 failed failed true msg error paramiko is not installed root wautomation tst01 ansible vvv werindbalajil01 ping using etc ansible ansible cfg as config file werindbalajil01 failed failed true msg error paramiko is not installed expected results success changed false invocation module args data null module name ping ping pong actual results root wautomation tst01 ansible debug ansible vvv werindbalajil01 ping 2557 1452362993 51001 starting run using etc ansible ansible cfg as config file 2557 1452362993 74537 in variablemanager get vars 2557 1452362993 74583 done with get vars 2557 1452362993 76058 getting the remaining hosts for this loop 2557 1452362993 76133 done getting the remaining hosts for this loop 2557 1452362993 76180 building list of next tasks for hosts 2557 1452362993 76204 getting the next task for host werindbalajil01 2557 1452362993 76249 done getting next task for host werindbalajil01 2557 1452362993 76276 task is task meta 2557 1452362993 76300 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none 2557 1452362993 76324 done building task lists 2557 1452362993 76345 counting tasks in each state of execution 2557 1452362993 76365 done counting tasks in each state of execution 2557 1452362993 76385 advancing hosts in iterating tasks 2557 1452362993 76407 starting to advance hosts 2557 1452362993 76427 getting the next task for host werindbalajil01 2557 1452362993 76451 done getting next task for host werindbalajil01 2557 1452362993 76472 task is task meta 2557 1452362993 76493 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none 2557 1452362993 76516 done advancing hosts to next task 2557 1452362993 76814 done queuing things up now waiting for results queue to drain 2557 1452362993 76842 waiting for pending results 2557 1452362993 76862 no more pending results returning what we have 2557 1452362993 76883 results queue empty 2557 1452362993 76903 getting the remaining hosts for this loop 2557 1452362993 76926 done getting the remaining hosts for this loop 2557 1452362993 76969 building list of next tasks for hosts 2557 1452362993 76991 getting the next task for host werindbalajil01 2557 1452362993 77017 done getting next task for host werindbalajil01 2557 1452362993 77039 task is task ping 2557 1452362993 77059 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none 2557 1452362993 77079 done building task lists 2557 1452362993 77098 counting tasks in each state of execution 2557 1452362993 77122 done counting tasks in each state of execution 2557 1452362993 77141 advancing hosts in iterating tasks 2557 1452362993 77160 starting to advance hosts 2557 1452362993 77179 getting the next task for host werindbalajil01 2557 1452362993 77201 done getting next task for host werindbalajil01 2557 1452362993 77223 task is task ping 2557 1452362993 77243 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none 2557 1452362993 77263 done advancing hosts to next task 2557 1452362993 77288 getting variables 2557 1452362993 77311 in variablemanager get vars 2557 1452362993 77360 done with get vars 2557 1452362993 77409 done getting variables 2557 1452362993 77429 sending task start callback copying the task so we can template it temporarily 2557 1452362993 77448 done copying going to template now 2557 1452362993 77470 done templating 2557 1452362993 77492 here goes the callback 2557 1452362993 77516 sending task start callback 2557 1452362993 77538 entering queue task for werindbalajil01 task ping 2557 1452362993 77559 werindbalajil01 putting task task ping in queue 2557 1452362993 77578 worker is out of available 2557 1452362993 77736 exiting queue task for werindbalajil01 task ping 2557 1452362993 77822 done queuing things up now waiting for results queue to drain 2557 1452362993 77837 waiting for pending results 2567 1452362993 77969 running taskexecutor for werindbalajil01 task ping 2567 1452362993 77989 in run 2567 1452362993 78115 calling self execute 2567 1452362993 80524 starting attempt loop 2567 1452362993 80565 running the handler 2567 1452362993 80731 low level execute command starting 2567 1452362993 80750 low level execute command executing umask 22 mkdir echo home ansible tmp ansible tmp 1452362993 81 270355194533225 echo echo home ansible tmp ansible tmp 1452362993 81 270355194533225 2567 1452362993 80794 done running taskexecutor for werindbalajil01 task ping 2567 1452362993 80800 sending task result 2567 1452362993 80847 done sending task result 2567 1452362993 80851 worker process exiting 2566 1452362993 80977 worker has data to read 2566 1452362993 81099 got result from worker 2566 1452362993 81114 sending result host task failed 2566 1452362993 81144 done sending result 2557 1452362993 81396 got result from result worker host task failed 2557 1452362993 81426 marking werindbalajil01 as failed 2557 1452362993 81446 getting the next task for host werindbalajil01 2557 1452362993 81463 done getting next task for host werindbalajil01 2557 1452362993 81480 task is none 2557 1452362993 81494 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none werindbalajil01 failed failed true msg error paramiko is not installed 2557 1452362993 81572 no more pending results returning what we have 2557 1452362993 81600 results queue empty 2557 1452362993 81622 getting the remaining hosts for this loop 2557 1452362993 81649 done getting the remaining hosts for this loop 2557 1452362993 81695 building list of next tasks for hosts 2557 1452362993 81720 getting the next task for host werindbalajil01 2557 1452362993 81747 done getting next task for host werindbalajil01 2557 1452362993 81766 task is none 2557 1452362993 81786 state is host state block task rescue always role none run state fail state pending setup false tasks child state none rescue child state none always child state none 2557 1452362993 81807 done building task lists 2557 1452362993 81826 counting tasks in each state of execution 2557 1452362993 81844 done counting tasks in each state of execution 2557 1452362993 81863 all hosts are done so returning none for all hosts 2557 1452362993 81883 done queuing things up now waiting for results queue to drain 2557 1452362993 81907 waiting for pending results 2557 1452362993 81927 no more pending results returning what we have 2557 1452362993 81949 results queue empty 2557 1452362993 81969 running handlers 2557 1452362993 82096 running cleanup >>>bug_report needs_info
add host does not inherit inventory settings given the following inventory when running see the following correct then have task to create new group as soon as it hits the first task get the following ve removed the logic that makes this example actually useful in practice this logic works fine using however switching to causes the issue above >>>bug_report needs_info pending_closure
conda recipe to create conda package for ansible v1 4>>>feature_pull_request needs_revision
added conda recipe for v2 latest this conda recipe can be used with http conda pydata org to build conda package that can be installed with `conda install ansible` which will sandbox ansible versions those conda packages can be put on anaconda cloud http anaconda org in user namespaces and with tags this helps ansible live in conda software sandboxes >>>feature_pull_request needs_revision
package or yum modules do not complete downloads when dependencies present issue type bug report ansible version ansible version ansible config file etc ansible ansible cfg configured module search path default overrides ansible configuration default etc ansible ansible cfg found diff of file and https raw githubusercontent com ansible ansible devel examples ansible cfg shows no environment uname linux localhost 32 573 el6 x86 64 smp tue nov 10 18 01 38 utc 2015 x86 64 x86 64 x86 64 gnu linux cat etc release centos release final centos release final centos release final cpe centos linux ga summary unsure if bug but could not find information online on google or github am attempting to upgrade from mysql to mysql on ansible on centos client the play fails after few seconds and shows downloading packages as last message steps to reproduce create empty playbook paste hosts all tasks name enable mysql yum repo rhel yumrepo name mysql baseurl http repo mysql com yum mysql community el basearch gpgcheck yes gpgcakey file etc pki rpm gpg rpm gpg key mysql enabled yes when ansible distribution centos or ansible distribution rhel name install latest mysql package name mysql community server state latest name ensure mysql server is restarted service name mysqld state restarted save as yml file run the playbook on remote host expected results the package or yum modules should successfully download the packages and continue on to the next task actual results task install latest mysql task path root ansible playbooks upgrademysql yml 16 establish ssh connection for user none ssh exec ssh controlmaster auto controlpersist 60s kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 controlpath root ansible cp ansible ssh tt umask 22 mkdir echo home ansible tmp ansible tmp 1453230401 39 37989536278275 echo echo home ansible tmp ansible tmp 1453230401 39 37989536278275 put tmp tmpnsw4ev to root ansible tmp ansible tmp 1453230401 39 37989536278275 yum ssh exec sftp controlmaster auto controlpersist 60s kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 controlpath root ansible cp ansible ssh establish ssh connection for user none ssh exec ssh controlmaster auto controlpersist 60s kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 controlpath root ansible cp ansible ssh tt lang en au utf lc all en au utf lc messages en au utf usr bin python tt root ansible tmp ansible tmp 1453230401 39 37989536278275 yum rm rf root ansible tmp ansible tmp 1453230401 39 37989536278275 dev null fatal failed changed true failed true invocation module args ansible check mode false ansible debug false ansible diff false ansible no log false ansible verbosity conf file null disable gpg check false disablerepo null enablerepo null exclude null install repoquery true list null name mysql community server state latest update cache false validate certs true msg repository mysql is missing name in configuration using id nwarning rpmts hdrfromfdno header v3 dsa sha1 signature key id 5072e1f5 nokey npublic key for mysql community libs 10 el6 x86 64 rpm is not installed rc results loaded plugins fastestmirror replace nsetting up install process nloading mirror speeds from cached hostfile base mirror san fastserv com epel mirror sfo12 us leaseweb net extras linux mirrors es net updates centos distro cavecreek net webtatic us east repo webtatic com nresolving dependencies running transaction check package mysql community server x86 64 10 el6 will be obsoleting processing dependency mysql community common x86 64 10 el6 for package mysql community server 10 el6 x86 64 processing dependency mysql community client x86 64 10 el6 for package mysql community server 10 el6 x86 64 processing dependency libnuma so libnuma 64bit for package mysql community server 10 el6 x86 64 processing dependency libnuma so libnuma 64bit for package mysql community server 10 el6 x86 64 processing dependency libnuma so 64bit for package mysql community server 10 el6 x86 64 package mysql server x86 64 73 el6 will be obsoleted running transaction check package mysql x86 64 73 el6 will be obsoleted package mysql community client x86 64 10 el6 will be obsoleting processing dependency mysql community libs x86 64 10 el6 for package mysql community client 10 el6 x86 64 package mysql community common x86 64 10 el6 will be installed package numactl x86 64 el6 will be installed running transaction check package mysql community libs x86 64 10 el6 will be obsoleting package mysql libs x86 64 73 el6 will be obsoleted processing dependency libmysqlclient so 16 64bit for package postfix el6 x86 64 processing dependency libmysqlclient so 16 64bit for package perl dbd mysql 013 el6 x86 64 processing dependency libmysqlclient so 16 64bit for package php56w mysql 17 w6 x86 64 processing dependency libmysqlclient so 16 libmysqlclient 16 64bit for package postfix el6 x86 64 processing dependency libmysqlclient so 16 libmysqlclient 16 64bit for package perl dbd mysql 013 el6 x86 64 processing dependency libmysqlclient so 16 libmysqlclient 16 64bit for package php56w mysql 17 w6 x86 64 processing dependency libmysqlclient so 16 64bit for package mysql python c1 el6 x86 64 processing dependency libmysqlclient so 16 64bit for package php56w mysql 17 w6 x86 64 processing dependency libmysqlclient so 16 libmysqlclient 16 64bit for package mysql python c1 el6 x86 64 processing dependency libmysqlclient so 16 libmysqlclient 16 64bit for package php56w mysql 17 w6 x86 64 running transaction check package mysql community libs compat x86 64 10 el6 will be obsoleting finished dependency resolution ndependencies resolved package arch version repository size ninstalling mysql community client x86 64 10 el6 mysql 23 replacing mysql x86 64 73 el6 mysql community libs x86 64 10 el6 mysql replacing mysql libs x86 64 73 el6 mysql community libs compat x86 64 10 el6 mysql replacing mysql libs x86 64 73 el6 mysql community server x86 64 10 el6 mysql 134 replacing mysql server x86 64 73 el6 ninstalling for dependencies mysql community common x86 64 10 el6 mysql 324 numactl x86 64 el6 base 74 ntransaction summary ninstall package ntotal size 160 ndownloading packages >>>bug_report
inventory lookup does not work with group intersection nor negation use aws and combination of static dynamic inventory files and this example does not work the output my static inventory file if run `ec2 py` inventory script it returns both `tag project foo` and `tag stage production` groups with the same hosts but in the debug result don see them docs ve used http docs ansible com ansible intro patterns html http docs ansible com ansible playbooks loops html looping over the inventory http docs ansible com ansible guide aws html http docs ansible com ansible intro dynamic inventory html>>>bug_report
yum cannot install after upgrade without specifying version issue type bug report ansible configuration ansible environment from osx el capitan to centos summary yum module fails to install packages after upgrading from to without clear error message steps to reproduce create simple task execute the task within playbook with test and limit to host if the package is already installed via yum from the console the playbook detects that is already installed and exits ok expected results package should be installed actual results exit code with vvvv >>>bug_report
prefer delegate when getting variables from inventory use self delegate in preference to self host in the accelerate connection plugin for retrieval of variables from inventory without this change setting ansible ssh host to an ip address via the inventory and configuring transport to accelerate via the configuration will result in an exception message host not found on attempting to connect when ansible ssh host is defined for host the runner will pass this value which may be an ip address to the connection plugin as the value for host to the connector class connect method and eventually it will be used for the host attribute on the requested connection plugin consequently within the connnection plugin using the host attribute for inventory lookup may try using an ip address instead of the ansible inventory host name to handle this case ansible runner will check that the whether the host is being provided ansible ssh host is the same as the inventory host name and when different it will set an additional attribute delegate on the connection plugin instance switching to use attribute if not none and falling back to host which would have the correct value if delegate is not set ensures inventory lookup uses the correct host fixes 13994>>>bugfix_pull_request
inventory lookup failure with accelerate transport when ansible ssh host uses ips the inventory lookup in the accelerate plugin relies on the correct host name for the inventory being passed to the plugin via the host attribute however when using ansible ssh host and pointing to an ip address this will result in the call at https github com ansible ansible blob b24daecd6e78df13f8685e61699ea0f2a15a3c77 lib ansible runner connection plugins accelerate py l105 trying to perform inventory lookup with the ip address provided instead of the inventory host name since the runner will set the `delegate` attribute on the connection if the host name is different to the actual host simple fix is to lookup this attribute first and fallback to host if not set >>>bug_report
avoid recursively checking json inventory for unicode both python json and simplejson always return unicode strings when using their loads method on unicode strings this is true at least since 2009 this makes checkign each substring unnecessary this commit makes parsing of large dynamic inventory at least seconds faster related to issue 13956 cf https github com towolf ansible large inventory testcase>>>bugfix_pull_request
fix race in accelerate connection plugin first commit fixes 13850 which is two races on the controller is if the ansible keys directory for accelerate fireball doesn exist it can be attempted to be created by multiple threads where some may spot it exists but has the wrong permissions while others throw an exception on trying to create the directory second time in creating the credentials and storing them multiple forks may try to regenerate the keys for the same host where using delegate to or attempt to read the file before it contents are written in both cases the solution is combination of checking if the file exists and then locking and rechecking if it still doesn in case something acquired the lock before the current thread but after the exists test followed by using temporary file names under the desired path and only moving the files once they have the correct permissions and contents to ensure if the exists test returns true and we just created them they are guaranteed to be correct second commit builds on corner case of the 2nd part of the first commit it is limited to where executing against multiple hosts with task using the delegate to option or potentially where ansible ssh hosts references the same underlying machine for multiple hosts where the delegate to references the same host for each task if the accelerate daemon has not been already started multiple forks may each attempt to start it resulting in collisions and exceptions where multiple instances try to bind to the same port resulting in only one of the creating forks and other subsequent tasks that picked up the correctly generated key in succeeded it is probably possible to improve the performance around this second commit to avoid the locking where you are not targeting the same underlying host via delegate to or ansible ssh host settings but as this would only improve the initial connection set up time it should be relatively negligible except where running very small number tasks against many hosts with very high number of forks and using the accelerate transport >>>bugfix_pull_request
regression ansible requires access to api server for local dependencies issue type bug report regression ansible version from ppa ansible configuration other than upgrading to no config change environment ubuntu 15 10 summary ansible via the ansible galaxy command will not pull from local github enerprise dependencies without an internet connection to https galaxy ansible com api ansible version had no issues pulling down local dependencies from github enterprise steps to reproduce be on network without internet access but has hosted git repos on it github enterprise etc the playbook is not publicly hosted run dependency script command used ansible galaxy install requirements yml expected results command runs successfully standard output actual results error the api server https galaxy ansible com api is not responding please try again later >>>bug_report
regression errors out when user can write to var log even if they can to var log ansible log 4852 bug report version ansible installed from the ubuntu ppa configuration took the original cfg file and only changed log path to var log ansible log environment ubuntu 14 04 on both sides steps to reproduce as root make var log ansible log writeable chgrp admin var log ansible log chmod 775 var log ansible log make var log not writeable chgrp syslog var log chmod 775 var log my user is in the admin group but not in the syslog group as me ansible list hosts all expected results an error saying that there are no hosts configured in the inventory actual results warning log file at var log ansible log is not writeable aborting and then the inventory error history and fix original report https github com ansible ansible issues 4852 this popped up in the location for the code in my install is display py the fix is the same as the one in this commit https github com jinnko ansible commit d4ec7b2e96bb8cf86a6118e6303e1edafda687af except applied to usr share pyshared ansible utils display py https github com ansible ansible blob devel lib ansible utils display py change line 54 if os path exists path and not os access path os ok or not os access os path dirname path os ok to if os path exists path and not os access path os ok and not os access os path dirname path os ok >>>bug_report
gce documentation too vague looking at this page https github com ansible ansible blob devel docsite rst guide gce rst unfortunately not able to get working setup based on the instructions there seems to be lot of ambiguity specifically when talking about `gce py` file also unsure really what required to install and how perhaps someone who knows this module and inventory driver better can clarify things or simplify the instructions for someone starting from scratch >>>feature_idea
default omit does not work in dictionaries hashes the playbook yields instead of an empty `ec2 tags` hash >>>docs_report
bug report module utils basic py is executable does not check file type ansible version but probably all ansible configuration default environment think it will behave the same in all guess but tested on mac and ubuntu 14 04 with python virtual env summary if module using get bin path https github com ansible ansible blob 4de4d59d7a91aafa8127e6d48b303ea0abcc204b lib ansible module utils basic py l1504 composer https github com ansible ansible modules extras blob devel packaging language composer py l155 l156 it will check the path for binary using is executable https github com ansible ansible blob 4de4d59d7a91aafa8127e6d48b303ea0abcc204b lib ansible module utils basic py l492 l496 if directory has the same name as the binary and happens to be in the path and first matched it will try to use it directory has executable permission set on them this issue was discovered in codeship as they are using loads of things in the path potential fix check if file is not directory >>>bug_report
ansible plays all roles even though certain tag is given issue type bug report ansible version installed from ubuntu ppa repo ansible configuration environment summary ansible plays all roles even though certain tag is given this is not critical however make tags quite useless since the execution time grows vastly steps to reproduce see actual results expected results ansible plays only certain roles associated with given tag as it was in actual results see example the site yml as you can see ansible plays all roles that apply for given host whereas like to run playbook as the docs says tags tags tags only run plays and tasks tagged with these values` caveat it seems it might be related to the dynamic include problems because it only plays roles having `include` statement in their `tasks main yml` file how to avoid that http www ansible com blog ansible launch https launchpad net ansible archive ubuntu ansible>>>bug_report needs_info
atomic move inside docker fails for etc hosts when running ansible inside docker container ansible will fail if we try to change some systems file such as etc hosts this issue is related to this docker issue https github com docker docker issues 9295 you can reproduce with the following code https github com pgrange ansible docker resource busy wrote an uggly untested patch just to validate an alternative that would consist of overwriting the content of the target file instead of renaming or copying this patch is available here https github com pgrange ansible commit 844eb0bfea04473719e195fcad73a515516f1df6>>>bug_report
apt module somehow fails when using delegated variables in etc ansible hosts issue type bug report ansible version ansible configuration not much of difference for this bug report am using default ansible modules apt environment summary should install the requested package through apt as desired steps to reproduce etc ansible hosts playbook expected results installation succeeded actual results >>>bug_report p2
dictsort no longer works with with items issue type bug report ansible version devel summary ansible release automatically flattens list given in with items this breaks loops that use dictsort filter on hashes steps to reproduce debug item with items debug item with items dictsort expected results items should contain two element arrays actual results >>>needs_info
please add apt cyg or pact for cygwin control use windows and cygwin and it is wonderful if ansible support apt cyg https github com transcode open apt cyg or pact from babun https github com babun babun package manager >>>feature_idea
bug report winrm connection version config standard env centos summary when specifying connection type of winrm ansible does not default to the port 5986 steps to reproduce create play with the following name test hosts windows sudo no gather facts true connection winrm tasks whatever haven defined any ansible variables in my host file try to run the play when viewing debug see the following winrm connect transport ssl endpoint https 10 66 128 172 22 wsman winrm is trying to connect on the ssh port in ansible it used to default to the correct port 5986 workaround define port 5986 in the playbook expected behavior ansible detects connection type of winrm and defaults the port to 5986>>>bug_report needs_info windows
ec2 tag ansible using register with loop unable to grab output goal using loops and lists to create ec2 security groups and then another loop to tag them using loop with items to create multiple ec2 security groups this works fine however when try to follow up with loop using ec2 tag to tag the security groups unable to grab the group id can see the group id listed in the debug output but can manage to grab it here https gist github com ctarwater f15c70e1ca45435cdaec gist with my task yml and var yml here the sample output as you can see the group id is there but it not listed under items so can grab it >>>bug_report
about yum install rpm for repo such as zabbix repo rpm package if install again will give error the task is this >>>bug_report needs_info
make moduleargsparser more understandable both comments and method names for handling new old style parameters were switched around made comments and method names reflect actual code paths taken >>>bugfix_pull_request
error set fs attributes if different when using module file state link os centos7 ansible version ansible step to install ansible git clone git github com ansible ansible git recursive cd ansible git checkout tags v2 v2 make rpm ansible rpm is built rpm build ansible git201601142217 7de237c headsv20021 el7 centos noarch rpm rpm uvh rpm build ansible git201601142217 7de237c headsv20021 el7 centos noarch rpm step to reproduce bug login to centos for root via ssh ansible localhost file state link src usr share zoneinfo europe moscow dest etc localtime vvv actual result using etc ansible ansible cfg as config file establish local connection for user root 127 exec umask 22 mkdir echo home ansible tmp ansible tmp 1453190767 59 51621343552438 echo echo home ansible tmp ansible tmp 1453190767 59 51621343552438 127 put tmp tmpjn9vqm to root ansible tmp ansible tmp 1453190767 59 51621343552438 file 127 exec lang ru ru utf lc all ru ru utf lc messages ru ru utf usr bin python root ansible tmp ansible tmp 1453190767 59 51621343552438 file rm rf root ansible tmp ansible tmp 1453190767 59 51621343552438 dev null an exception occurred during task execution the full traceback is traceback most recent call last file root ansible tmp ansible tmp 1453190767 59 51621343552438 file line 2363 in main file root ansible tmp ansible tmp 1453190767 59 51621343552438 file line 394 in main changed module set fs attributes if different file args changed diff typeerror set fs attributes if different takes exactly arguments given localhost failed changed false failed true invocation module name file parsed false not reproduce on ansible >>>bug_report needs_info pending_closure
ansible unable to use become user in ufw module one of my roles broke today when ran it using ansible https travis ci org aelogica ansible role common builds 103246997 as workaround used the `shell` module to run `ufw` as root >>>bug_report needs_info pending_closure
strip become success from async stdout this should resolve https github com ansible ansible issues 13965>>>bugfix_pull_request
synchronize first cut at not doing sudo on the control machine but on the remote machine instead in become wa sreversed for synchronize happening on the local machine instead of the remote machine this restores the ansible behaviour it does become on the remote machine however there aspects of this that are hacky no hackier than ansible but not using features the big problem is that it does not understand any become method except sudo willing to use partial fix now because we don want people to get used to the reversed semantics in their playbooks >>>bugfix_pull_request
return unicode string in dump results method typo fix https github com ansible ansible issues 13964>>>bugfix_pull_request
no sudo cache>>>bugfix_pull_request
bug report unicode error with include bad args with unicode ansible version devel ansible configuration you can reproduce the issue using the following playbook you can retrieve it at the following location https github com yannig ansible issue low speed tree master error parsing environment ubuntu summary ansible v2 get unicode error when parsing bad formated module steps to reproduce ansible playbook error parsing error parsing args yml expected results actual results >>>bug_report
ansible gives an need more than values to unpack error if there are spaces in group names issue type bug report ansible version is not affected ansible configuration default no ansible cfg environment gentoo amd64 summary after upgrading to ansible it began to give me an error when have spaces in group names in my inventory files it was ok when have ansible steps to reproduce install ansible make test inventory file expected results ansible hosts ping all vvv no config file found using defaults error need more than values to unpack>>>bug_report
play level tags are being ignored for fact gathering while running this the tag is not working it will run the whole playbook that sucks don know if this is the latest documentaion http docs ansible com ansible playbooks tags html but this isn working for me used ansible on my latest ubuntu 15 10 system now back on and it is running fine again any ideas >>>bug_report
change solaris packaging module from pkg to pkg5 the solaris package managing module in ansible managing packages via the program usr bin pkg is named pkg5 not pkg http docs ansible com ansible pkg5 module html additionally there is no packaging module in ansible named pkg >>>bugfix_pull_request needs_revision
improve performance issue with large number of groups ansible excessively checks the file system for the potential presence of group vars and host vars files for large numbers of groups this leads to combinatorial performance issues this commit generates set of group vars and host vars filenames for every possible location and then checks against the sets before making stat of the file system also included in this commit is caching of the base directory lookup for the inventory related to issue 13956>>>bugfix_pull_request
performance issues with over 9000 groups we have over 9000 8500 groups coming out of dynamic inventory script and formatted as json assigned to those groups are about half that number of unique hosts this means hosts are member of several groups at once the inventory data coming from an internal database is basically key value property pairs made into group identifiers this scheme facilitates playbook host patterns like so we have lot of these kind of groups 7500 groups contain only one host and few groups contain thousands we also include meta` object in the json which supplies `hostvars` for each host with up to 30 host specific variables the problem is that parsing and sorting through our inventory takes over 20 seconds have tried to work out the hot spots during parsing this large inventory and identified few locations looking at the file system and checking for `group vars files for several relative paths and for every group and in multiple passes is very expensive even an `os path realpath` which serves as fancy string concatenation has to stat 35000 times and takes more than seconds not to mention what happens inside the `add group vars file function total time 27 3202 file home towolf src local ansible upstream lib ansible inventory init py function get hostgroup vars at line 702 line hits time per hit time line contents 702 profile 703 def get hostgroup vars self host none group none new pb basedir false 704 705 loads variables from group vars and host vars in directories parallel 706 to the inventory base directory or in the same directory as the playbook variables in the playbook 707 dir will win over the inventory dir if files are in both 708 709 710 24877 35363 results 711 24877 31044 scan pass 712 24877 1719067 69 basedir self basedir 713 714 look in both the inventory base directory and the playbook base directory 715 unless we do an update for new playbook base dir 716 24877 38816 if not new pb basedir 717 24877 41675 basedirs basedir self playbook basedir 718 else 719 basedirs self playbook basedir 720c 721 74631 121290 for basedir in basedirs 722 this can happen from particular api usages particularly if not run 723 from usr bin ansible playbook 724 49754 82384 if basedir in none 725 12438 15767 basedir 726 727 49754 63313 scan pass scan pass 728 729 it not an eror if the directory does not exist keep moving 730 49754 410588 if not os path exists basedir 731 continue 732 733 save work of second scan if the directories are the same 734 49754 89221 if basedir self playbook basedir and scan pass 735 continue 736 737 49754 67523 if group and host is none 738 load vars in dir group vars name of group 739 34212 5457260 159 20 base path os path realpath os path join basedir group vars group name 740 34212 11411194 333 41 results self variable manager add group vars file base path self loader 741 15542 22108 elif host and group is none 742 same for hostvars in dir host vars name of host 743 15542 2483568 159 base path os path realpath os path join basedir host vars host name 744 15542 5201313 334 19 results self variable manager add host vars file base path self loader 745 746 all done results is dictionary of variables for this particular host 747 24877 28735 return results it would be better to turn this around and make file listing once of every possible `group vars` directory relative to the inventory and the playbook and then checking against the filenames in that set instead of the file system directly implemented this in branch in my repo and this saves 12 seconds in the same method the basename relative to the inventory is evaluated every time group is checked even though it is constant suggest caching this in private property the parser from `json loads in `python json` and `simplejson` seems to always return unicode strings ansible however recursively checks every string in the input in `json dict bytes to unicode to see if it needs to be converted from byte string this calls `isinstance` about million times for no good reason total time 25549 file home towolf src local ansible upstream lib ansible module utils basic py function json dict bytes to unicode at line 349 line hits time per hit time line contents 349 profile 350 def json dict bytes to unicode encoding utf 351 recursively convert dict keys and values to byte str 352 353 specialized for json return because this only handles lists tuples 354 and dict container types the containers that the json module returns 355 356 357 510291 635723 19 if isinstance bytes 358 return unicode encoding 359 510291 535639 16 elif isinstance dict 360 24179 146484 return dict imap json dict bytes to unicode iteritems repeat encoding 361 486112 492564 15 elif isinstance list 362 15183 118530 return list imap json dict bytes to unicode repeat encoding 363 470929 472485 14 elif isinstance tuple 364 150689 664279 20 return tuple imap json dict bytes to unicode repeat encoding 365 else 366 320240 189790 return commenting out the line that does self raw json dict bytes to unicode self raw saves about seconds checking for membership in python `set is much faster than lookup in lists saved an addition seconds by changing data structures like `group child groups from lists to sets >>>bug_report
setup module fails on openvz container with ansible issue type bug report ansible version this issue is not present in ansible ansible configuration environment ansible host debian jessie target host centos6 openvz container `2 32 openvz amd64` summary when running `ansible setup` for the container the module fails with `module failure` and python exception stack trace expected results json output of facts of the target host actual results traceback most recent call last file line 5142 in file line 140 in main file line 84 in run setup file line 5080 in ansible facts file line 4740 in populate file line 4746 in get virtual facts file line 5068 in get file lines file line 5063 in get file content unboundlocalerror local variable datafile referenced before assignment steps to reproduce looking at the code it seems to result from facts py line 2667 https github com ansible ansible blob 7de237c5a1742660bc240c15e97a1f5b0d1611a8 lib ansible module utils facts py l2667 as proc cgroup`is available but not readable from within the container which results in the exception in line 2984 https github com ansible ansible blob 7de237c5a1742660bc240c15e97a1f5b0d1611a8 lib ansible module utils facts py l2984 which can reproduce in the container with the following snippet def read cgroup try open proc cgroup finally close read cgroup traceback most recent call last file line in file line in read cgroup unboundlocalerror local variable referenced before assignment comparing the virtualization environment detection of ansible with it appears that in the former version the function returned before opening that file when in openvz environment if you need any further information regarding the openvz environment please let me know >>>bug_report
ansible no more paybook name shown when running playbooks ansible version ansible ansible configuration environment summary when running playbook the name is not displayed anymore none of my playbooks show their names after upgrading to ve written plugin that depends on the `name` and `remote user` values provided by the `play` argument of `v2 playbook on play start` but both values are `none` steps to reproduce using ansible and any playbook expected results works using ansible actual results think this bug since there is code to print the playbook name in the default plugin https github com ansible ansible blob dc47c25e589f1c2b1f44867076624f0e0564b7c6 lib ansible plugins callback default py l130 >>>bug_report
synchronize module can access the remote machine which created by vagrant just local to local copy issue type documentation report ansible version ansible ansible configuration default no ansible cfg part of playbook xml environment rhel in aws ec2 summary use the ansible as vagrant provision vagrant run in local and use ssh port 2222 as default have tried to use synchronize module to copy the file folder quickly but always failed and copy into itself not in vagrant vbox verbose log as followings this is test that copy file changed 127 changed true cmd msg hosts rc stdout lines hosts think the wrong thing is the rsync command didnt use the remote username and if the rsync writing as following it will be success to copy to remote vbox that have test rsync delay updates compress archive rsh ssh none stricthostkeychecking no port 2222 home ec2 user centos hosts vagrant 127 home vagrant have set the remote user vagrant and still failed just copy into local >>>bug_report needs_info
etcd api verssion v1 and not current v2 hi cant get values from etcd using lookup it looks like the api version is hardcoded in etcd py self baseurl v1 keys thanks moshe>>>feature_idea
ansible regression retry file feature gone is that feature gone still documented in the ansible cfg but generate retry inventory has gone from ansible playbook >>>bug_report p1
force handlers does not work with inline handler using roles issue type bug report ansible version ansible configuration default configuration environment control machine os v10 11 managed node debian jessie summary site yml roles test role tasks main yml steps to reproduce expected results the handler restarts nginx on every execution when force handlers is set to yes actual results the handler runs the only once during installation the force handlers directive which is meant to run handlers regardless of the task status does not trigger handler on further executions after installation >>>bug_report needs_info p2
enforce `state file in `copy` module this was causing wrong behaviour when `prev state` was `hard` link since the `file` module tried to apply the same `state` on the new file causing unexpected errors fixes ansible ansible 10834 depends on ansible ansible modules core 2827 >>>needs_rebase
error when ansible config path contains unicode characters issue type bug report ansible version ansible configuration environment ubuntu 15 10 python 10 summary if path to ansible project directory contains non ascii characters running ansible will fail steps to reproduce create project directory containing non unicode characters home dmromanov create ansible cfg deploy yml and hosts files in that directory deploy yml ansible cfg hosts run provision `ansible playbook deploy yml` expected results oo oo fatal localhost unreachable changed false msg error ssh encountered an unknown error during the connection we recommend you re run the command using vvvv which will enable ssh debugging output to help diagnose the issue unreachable true oo localhost ok changed unreachable failed actual results >>>bug_report needs_info pending_closure
winrm issue typeerror argument of type nonetype is not iterable having the following problem since updating to had working cd pipeline that used ansible all did was updating to and changing my ssh vars to the new names now get the following error this only happens with winrm and only when using group vars or inventory this works so it seems as if something changed and ansible is unable to get the user to connect to the target see also here https co zf7fiwcou9>>>bug_report windows
specify the correct default options for sudo flags the correct default options for sudo flags can be found at https github com ansible ansible blob devel lib ansible constants py l181 slightly alter explanation of so as not to confuse it with preserve env which preserves existing environment variables when adding the two other options include short explanations of those options add note about which did not appear in believe and which bit me >>>docs_pull_request
parse cli inventory string with the inventoryiniparser fixes ansible ansible 13931 >>>feature_pull_request
can specify per host hostvars in cli inventory parameter is the ansible cli i` inventory arg not parsed using the standard inventory parser like to specify `ansible python interpreter` on per host basis when passing in comma separated list of hosts to the cli using i` but it doesn appear to support behavioral inventory parameters http docs ansible com ansible intro inventory html list of behavioral inventory parameters `sark` is centos 11 usr bin python` is so works great but what if want to specify two different hosts in i` each of which need different `ansible python interpreter` value simple enhancement here would be to pass the comma separated list of strings passed in the i` arg to whatever parser is used to parse the inventory if it was file or command output or am doing this wrong is there way to achieve what looking for that haven figured out yet >>>feature_idea
fix 13860 by setting rc variable properly when using remote fish shell set the rc variable properly when using remote fish shell this fixes issue 13860 >>>bugfix_pull_request
ansible pull lists multiple hosts with ansible my ansible pull invocation usr bin ansible pull url ssh url git key file root ssh id rsa ansible inventory only outputs local hostname info as expected task common configure root ok vulcan7 cora nwra com but with task setup ok lroot cora nwra com ok barry cora nwra com ok ibis cora nwra com ok moa cora nwra com it doesn appear to be trying to connect to these hosts but the output is problematic and perhaps more is going wrong >>>bug_report
added example of running commands on remote windows server added example of running commands on remote windows server>>>docs_pull_request
minor wording fixes>>>docs_pull_request
fix typos >>>feature_pull_request
error need more than values to unpack while using ansible commands caused by group names with spaces in ini inventory using ansible and while excuting any command on the remote server or local server getting following error root wautomation tst01 ansible ansible werindbalajil01 ping error need more than values to unpack trying reinstalling but still getting the same issue anybody help issue type can you help us out in labelling this by telling us what kind of ticket this this you can say bug report ansible version ansible ansible configuration nothing just finished installing the ansible in oracle linuc same kernal as rhel after the installation when try to execute any ansible core commands such as ping file or setup are showing following error environment oel root wautomation tst01 ansible uname linux wautomation tst01 us int rci com 39 400 109 el6uek x86 64 smp mon jul 22 11 44 00 pdt 2013 x86 64 x86 64 x86 64 gnu linux python version root wautomation tst01 ansible python version python summary when try to use the basic ansible command it coming with following error error need more than values to unpack steps to reproduce running any ansuble core commands root wautomation tst01 ansible ansible 127 ping error need more than values to unpack root wautomation tst01 ansible ansible vvv 127 ping using etc ansible ansible cfg as config file error need more than values to unpack expected results ping command output actual results root wautomation tst01 ansible ansible vvv 127 ping using etc ansible ansible cfg as config file error need more than values to unpack >>>bug_report p2
variable in dependency name is undefined when passing via group vars issue type bug report ansible version ansible devel 1b82de2354 last updated 2016 01 15 11 34 19 gmt 400 ansible configuration ansible cfg defaults roles path common roles inventory hosts remote user root ask pass true transport paramiko record host keys false host key checking false deprecation warnings false environment centos summary when using group var to pass variable used in dependency name the execution errors with variable is undefined this behavior works if you define the variable in vars file included in the playbook or if you directly define the variable in the playbook steps to reproduce expected results the variable in the group vars should be used in the interpretation of the role dependency actual results `error somevar is undefined` >>>bug_report
ansible vars prompt problem running syntax check on playbook and getting doing this on ubuntu 14 04 lts syntax check on this file is working with ansible rc2 swiching versions with >>>bug_report
allowed formatting has changed in issue type bug report ansible version ansible configuration environment ubuntu 14 04 summary previously allowed formatting is no longer accepted steps to reproduce put as the top line in tasks main yml expected results playbook works as expected actual results playbook fails>>>bug_report needs_info
wrong version of file core module in debian package issue type bug report ansible version ansible config file home cloos ansible cfg configured module search path default overrides environment ubuntu 15 10 summary running task with the file modules gives me the error described in https github com ansible ansible modules core issues 2585 which was fixes with c6fdd38 in november comparing usr share pyshared ansible modules core files file py` with https github com ansible ansible modules core blob devel files file py shows that the debian ubuntu package installs not the latest version of the module maybe other modules are also affected doesn checked this >>>bug_report
bug report ansible galaxy fails to download git based roles issue type bug report ansible version ansible configuration stock vanilla fresly installed from pip environment mac os 10 11 summary when installing custom roles using ansible galaxy from local git repo it fails to resolve provided url scheme scm url branch also tried following http git https and git but no any of them have worked steps to reproduce expected results from v1 actual results >>>bug_report
vars plugins are not collected when inventory is directory issue type bug report ansible version ansible detached head 46a3a6a03e last updated 2016 01 15 14 52 24 gmt 200 lib ansible modules core detached head fe73e06633 last updated 2016 01 15 14 45 44 gmt 200 lib ansible modules extras detached head d950ca9747 last updated 2016 01 15 14 45 44 gmt 200 config file home tkontusz int rd config ansible2 ansible cfg configured module search path default overrides ansible configuration environment summary vars plugins used to be loaded from inside an inventory directory now they are not loaded from anywhere near inventory nor playbook steps to reproduce create an inventory directory with vars plugins boom py in it and run ansible with that inventory inventory vars plugins boom py raise exception boom expected results unexpected exception asdf actual results ansible ignores the plugin and actually runs >>>bug_report
remove 3rdparty dependency allow token to be specified in environment remove third party dependency on hvac in favor of urllib2 allow vault token to be specified in environment variable to prevent sensitive information from ending up in git>>>feature_pull_request plugin
failed when directive does not accept lists issue type bug report ansible version environment ubuntu 14 04 summary the `failed when` module does not support lists anymore steps to reproduce hosts localhost tasks name hello command dev null register myresult failed when myresult myresult expected results pass actual results error the field failed when is supposed to be string type however the incoming data structure is >>>bug_report
threadsafety with ansible python api when call ansible api with multithreading sometimes it will prompt the error information how can fix this >>>needs_info
overwrite merge not remove prev inventory data alternate to 13839>>>bugfix_pull_request
fix issue with add hosts overwriting existing vars fixes http github com ansible ansible modules core issues 2799 and is alternative to 13841>>>bugfix_pull_request
allow ansible to return error with unicode within it fix for https github com ansible ansible issues 13899>>>bugfix_pull_request
ansible missing from ppa am unable to install from https launchpad net ansible archive ubuntu ansible would like working version of ansible since broken>>>bug_report
ansible failing with terminal control codes in the output from https groups google com forum topic ansible project 2jdklfsvmca having some trouble with the new ansible when trying to run ping on host that works with getting the following previously on would get any idea what the culprit might be at first glance the only real difference can see is that the older version had bin sh in front but that could just be change in logging update from https github com ansible ansible issues 13882 issuecomment 171723283 the local shell is zsh the remote term is sh the issue is that my local term environment xterm 256color was getting used by paramiko and openssh and sent to the remote system temporary workaround term vt100 ansible ping makes everything work peachy one interesting thing to note is that enabling pipelining makes the problem go away was able to track down the issue in the paramiko code paramiko ssh py 219 chan get pty term os getenv term vt100 the local environment is getting used for term instead of always forcing vt100 couldn find the corresponding openssh code cc fspadini >>>bug_report
custom library module resolution order incorrect in we re incorrectly loading library modules with the wrong extension eg the presence of library setup ps1 should override the setup module for windows hosts but it overrides it for all hosts the problem appears limited to library hosted overrides the load order extensions resolution is working fine for the built in modules sourced from https groups google com forum topic ansible devel segtpbpmb8a>>>bug_report windows
failed host starts executing when include after failure issue type bug report ansible version ansible config file users rkalff projects testprojects ansible bug report ansible cfg configured module search path default overrides ansible configuration environment os el capitan 10 11 summary this issue wasn resolved by 13699 when the failure occurs in an included task file and there is another included task file after the failure the failure is not respected and different tasks run in parallel on different hosts in other words the failed host starts executing from failure point later in the playbook see test5 yml all tests run as expected on steps to reproduce see https github com renekalff ansible bug report run ansible playbook hosts test5 yml expected results that no tasks are executed for host after it being marked as failed actual results see https github com renekalff ansible bug report blob master play results test5>>>bug_report p1
password hash md5 fails issue type bug report ansible version ansible configuration environment summary the password hash md5 jinja filter fails when fixed salt is not supplied steps to reproduce expected results actual results >>>bug_report
gathering facts failes ansible version ansible uname linux psi nb arch smp preempt wed dec 23 20 09 18 cet 2015 x86 64 gnu linux uname linux jenkins el7 elrepo x86 64 smp sun jan 10 21 17 16 est 2016 x86 64 x86 64 x86 64 gnu linux play all gathering facts establish connection for user vagrant remote module setup exec ssh tt controlmaster auto controlpersist 60s controlpath home psi ansible cp ansible ssh stricthostkeychecking no port 2222 identityfile home psi o2 ansible vagrant jenkins vagrant machines jenkins virtualbox private key kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user vagrant connecttimeout 10 127 bin sh mkdir home ansible tmp ansible tmp 1452776926 62 156382542588191 chmod rx home ansible tmp ansible tmp 1452776926 62 156382542588191 echo home ansible tmp ansible tmp 1452776926 62 156382542588191 put tmp tmpof1gpr to home vagrant ansible tmp ansible tmp 1452776926 62 156382542588191 setup exec ssh tt controlmaster auto controlpersist 60s controlpath home psi ansible cp ansible ssh stricthostkeychecking no port 2222 identityfile home psi o2 ansible vagrant jenkins vagrant machines jenkins virtualbox private key kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user vagrant connecttimeout 10 127 bin sh lang lc ctype usr bin python home vagrant ansible tmp ansible tmp 1452776926 62 156382542588191 setup rm rf home vagrant ansible tmp ansible tmp 1452776926 62 156382542588191 dev null failed jenkins failed true parsed false verbose override true changed false ansible facts ansible product serial na ansible form factor other ansible product version ansible fips false ansible swaptotal mb 1535 ansible user id vagrant module setup true ansible userspace bits 64 ansible architecture x86 64 ansible distribution version 1503 ansible domain localdomain ansible date time tz est hour 08 time 08 08 47 epoch 1452776927 month 01 tz offset 0500 second 47 iso8601 micro 2016 01 14t13 08 47 283819z weekday thursday year 2016 date 2016 01 14 iso8601 2016 01 14t13 08 47z day 14 minute 08 ansible python version ansible processor cores ansible virtualization role guest ansible env lang term xterm 256color shell bin bash xdg runtime dir run user 1000 shlvl ssh tty dev pts lc ctype lessopen usr bin lesspipe sh path usr local bin usr bin pwd home vagrant logname vagrant user vagrant mail var mail vagrant home home vagrant ssh connection 10 41752 10 15 22 xdg session id ssh client 10 41752 22 usr bin python ansible processor vcpus ansible docker0 macaddress 02 42 33 3c c5 e0 interfaces mtu 1500 active false promisc false stp false ipv4 netmask 255 255 network 172 17 address 172 17 device docker0 type bridge id 8000 0242333cc5e0 ansible bios version virtualbox ansible processor genuineintel intel core tm i5 5200u cpu 20ghz ansible virtualization type virtualbox ansible lo mtu 65536 active true promisc false ipv4 netmask 255 network 127 address 127 ipv6 scope host prefix 128 address device lo type loopback ansible memtotal mb 2000 ansible ssh host key ecdsa public aaaae2vjzhnhlxnoytitbmlzdhayntyaaaaibmlzdhayntyaaabbbk5jp5g qsxgzxlc6zleqfupiauzrcxv1gfpe9h1f9t yvcbqzs2fm37 6ciljyzswxijvsvegiomglxyba9g0 ansible default ipv4 macaddress 52 54 00 d3 eb a4 network 10 mtu 1500 alias eth0 netmask 255 255 255 address 10 15 interface eth0 type ether gateway 10 ansible swapfree mb 1535 ansible default ipv6 ansible distribution release core ansible system vendor innotek gmbh ansible os family redhat ansible cmdline lang en us utf systemd debug true boot image vmlinuz el7 elrepo x86 64 biosdevname quiet true net ifnames rhgb true rd lvm lv volgroup00 logvol00 crashkernel auto console ttys0 115200 ro true root dev mapper volgroup00 logvol00 ansible user gid 1000 ansible selinux status disabled ansible userspace architecture x86 64 ansible product uuid na ansible system linux ansible pkg mgr yum ansible memfree mb 1333 ansible devices sda scheduler mode deadline rotational vendor ata sectors 83886080 host sectorsize 512 removable support discard model vbox harddisk size 40 00 gb holders partitions sda2 start 4096 sectorsize 512 sectors 409600 size 200 00 mb sda3 start 413696 sectorsize 512 sectors 83472384 size 39 80 gb sda1 start 2048 sectorsize 512 sectors 2048 size 00 mb ansible user uid 1000 ansible memory mb real total 2000 free 1333 used 667 swap cached total 1535 used free 1535 nocache used 300 free 1700 ansible distribution centos ansible distribution major version ansible user dir home vagrant ansible processor countopenssh 1p1 openssl 2e dec 2015 debug1 reading configuration data home psi ssh config debug1 reading configuration data etc ssh ssh config debug1 etc ssh ssh config line 20 applying options for debug1 auto mux trying existing master debug1 mux client request session master session id shared connection to 127 closed >>>bug_report
not able to download specific role version with ansible galaxy using ansible inside docker container when run the following command inside the container get the following error message without specifying the version it is downloaded from this url `https github com weareinteractive ansible docker archive tar gz` the container is using >>>bug_report
bug report ansible fact pkg mgr wron on solaris 11 pkg instead of pkg5 issue type bug report ansible version ansible version ansible configured module search path none ansible configuration using the fedora shipped ansible cfg compared to the github version most of the variables are commented out and thus defaults are used almost everywhere environment client fedora 23 server solaris 11 summary on solaris 11 the variable ansible pkg mgr is determined wrong ansible krypton setup filter pkg krypton success ansible facts ansible pkg mgr pkg changed false pkg is not the proper package manager on solaris it needs to be pkg5 ansible krypton pkg name web server apache 24 state absent krypton failed module pkg not found in configured module paths ansible krypton pkg5 name web server apache 24 state absent krypton success changed false msg results steps to reproduce query the variable ansible pkg mgr try to use the resulting value as module see that there is no corresponding module expected results the value for ansible pkg mgr should be pkg5 which is the software packaging module actually used on solaris 11 actual results the variable was set to pkg which is not the actual packaging module for solaris 11 >>>bug_report
ansible playbook doesn behave well with virtual file desriptors this works this does not bash sometimes the latter is useful for oddball scripting know there are workarounds wrap it in shell script that outputs `yaml` etc but feel like this should be supported >>>feature_idea
add support ssh configs from etc openssh in altlinux system config dir for openssh is etc openssh >>>feature_pull_request
ansible failing when remote shell is fish this has been reported at https groups google com forum topic ansible project 2jdklfsvmca and my example is this one when changing the remote shell it is working just fine >>>bug_report p2
with items doesn work as expected with delegate to in haproxy module issue type bug report ansible version ansible summary delegation happens only on first host in with items steps to reproduce also results seems strange presence of none play task take out of load balancer changed ha1 none item ha1 ok ha1 none item ha2 play task take out of load balancer changed ha2 none item ha1 ok ha2 none item ha2 >>>bug_report p1
with sequence does not accept dict argument based on typical ansible syntax would expect this debug var item with sequence start end to be identical to debug var item with sequence start end but while the latter works the former results in fatal localhost failed failed true msg error unknown error parsing with sequence arguments start error was error unrecognized arguments to with sequence raw params >>>bug_report
defined vars are empty string and not none null this doesn seem to work on but it does work on tested on fedora 23 hosts localhost connection local gather facts false tasks name debug debug msg ansible port default 22 v1 output play localhost task debug ok localhost msg 22 v2 output play task debug ok localhost msg default not picked up first posted on mailing list https groups google com forum topic ansible project 4jlrqvglxz4 any ideas am missing something regards m>>>bug_report
ansible hostgroup vars issues im using custom vars plugin https github com blueboxgroup ursula blob master plugins vars default vars py under ansible however it looks as though the host object which run https github com ansible ansible blob 4ba7158282f148c90c72f824d6ebcd1a9953b580 lib ansible inventory vars plugins noop py l38 is passed is missing the group host vars from inventory have tracked this down to what appears to be bug with get hostgroup vars https github com ansible ansible blob devel lib ansible inventory init py l702 `basedirs basedir self playbook basedir is list containing the path to my inventory as specified by i` and none since playbook basedir is false since the loop is iterated before returning to the caller the none directory fails to load inventory and returns an empty dict to the caller ansible was retaining the previous result https github com ansible ansible blob stable lib ansible inventory init py l651 each time through the loop when removing none items from the `basedirs` list the plugin works as expected >>>bug_report
`become yes` on tasks `include` does not override `become no` at the play level issue type bug report ansible version environment os el capitan 10 11 summary am testing playbook that worked under ansible at the play level have `sudo no` within the play tasks have an `include` with `sudo yes` with ansible the `sudo yes` on the `include` appears to have no effect steps to reproduce expected results file hats` touched actual results >>>bug_report p2
with items not working on list on registed ec2 variable have problem creating dynamic inventories on ansible after the instances is created using ec2 module after the variable is registered ansible is not able to loop into instances list but it can access the item using the index these are the tasks result >>>bug_report
blocks rescue with unreachable host issue type bug report ansible version ansible configuration environment centos summary trying to use the block and rescue feature to recover from issues during updates if the host becomes unreachable then the rescue section does not execute just because host is presently unreachable doesn mean roll back to the change or other steps can be taken to recover the host so would like method to do so and to clarify mean that if have delegate to command that changes some other system such as dns or firewalls on the ansible server and causes host to be unreachable should have the option to execute commands to fix this mistake and make it reachable again steps to reproduce in role expected results would expect that should get both debug messages actual results the playbook run terminates due to host unreachable >>>feature_idea
unarchrefactor this is the plugin side of refactor to allow untar and unzip and any future unarchivers to have their own modules thus allowing their own arguments there will be corresponding pr for ansible modules core in just moment don accept one without the other this pr only refactors and does not add new arguments after doing it realized lot of ways to make it better added copy method to the actionbase class thinking this would be good because other future modules could use it however it might be better to make an unarchive subclass of actionbase and stick stuff in thier also wound up duplicating fair amount of code between the unarchive module and the untar and unzip modules would like to separate out some of the logic possibly into ansible module utils somewhere sigh so basically if you aren picky take this pr it should allow folks who want to submit prs for new tar zip features to be able to do so if you re even remotely picky fire it back with comments and ll unscrew whatever parts you don like there will be nearly identical sounding pr for ansible modules core in just moment one doesn work without the other >>>feature_pull_request plugin
behavior regression error in `with url` lookup causes play to fail prior to 404 occurring in `with url` lookup didn lead to failure of the play instead `warning` was issued test play to reproduce in it prints warning failed lookup url for http example com 404 http error 404 not found` but afterwards `life goes on` in homebrew it fails fatally while it completely fine to increase the severity of failed lookup ansible offers no way to handle these errors or at least couldn find the documentation >>>bug_report
start at task failures seeing some bugs when run `ansible playbook test yml start at task` using ansible only seeing them on playbooks with multiple hosts in this example host1 and host2 the gist is that it seems to only obey the start task on the first host it starts from the beginning on the second host and also mis labels the first task as setup source code test yml roles foo tasks main yml roles bar tasks main yml example when run `ansible playbook test yml start at task two it still runs the first task one on one of the hosts but mis labels it setup example when run `ansible playbook test yml start at task three it still runs the first two tasks one and two on one of the hosts and mis labels the first task setup >>>bug_report p1
ad hoc mode commands incorrectly parses arguments issue type bug report ansible version ansible ansible configuration no external changes environment ubuntu 14 04 summary ansible incorrectly parses arumments in ad hoc mode steps to reproduce example ansible all sudo inventory shell mount nfs4 proto tcp port 2049 192 168 102 11 opt stack data nova instances expected results command succeed actual results 192 168 102 12 failed rc unsupported parameter for module proto there is workaround by escaping with >>>bug_report
global name do encrypt is not defined ansible trying to encrypt an input prompt with passlib results in an error unexpected exception global name do encrypt is not defined the full traceback was traceback most recent call last file usr bin ansible playbook line 85 in sys exit cli run file usr lib python2 site packages ansible cli playbook py line 150 in run results pbex run file usr lib python2 site packages ansible executor playbook executor py line 117 in run play vars vname display do var prompt vname private prompt encrypt confirm salt size salt default file usr lib python2 site packages ansible utils display py line 310 in do var prompt result do encrypt result encrypt salt size salt nameerror global name do encrypt is not defined my playbook goes like this vars prompt name pwd prompt enter password private yes encrypt sha512 crypt salt size using centos tried with passlib installed with yum and with pip same error >>>bug_report
unarchive results in dest must be an existing dir with fish shell problem occurs after upgrading to running on ubuntu 14 04 lts running with `ansible shell type fish` as both remote as local machine use fish shell the directory exists and has the right ownership and permissions task runs fine using verbose log >>>bug_report
synchronize module ignores ansible ssh extra args somwhat similar to 5109 the synchronize module doesn pickup the `ansible ssh extra args` is it supposed to if not it would be nice feature >>>feature_idea
version control your documentation issue type bug report documentation report ansible version who knows that the problem summary most software projects release documentation which is versioned alongside the code releases so that you can track the documentation for the version you re actually using rather than tracking the documentation for literally every possible version please please please switch to the former the spot checking of oh and if you re using this version is categorically not enough and when an article is out of date it both impossible to tell that and utterly misleading this error handling lt rant gt don see why this is fundamental and inexcusably basic issue that needs solving yesteryear try installing and configuring pg barman barman an application which also takes this laissez faire approach to documenting important changes it like pulling teeth and it like pulling teeth because the longer project goes on the more each page of documentation becomes filthy filthy lies at certain tipping point every page of the documentation for any given user will be two thirds misleading lies know sound crazed it just this gets more and more annoying with time every project see that does this forces me to read 30 or so extra little colored boxes labeled with note which should either be in the body of the versioned text or left entirely out it forcing the end user to pay for the laziness of the documenter and it soviet era bureaucratic inefficiency that wouldn be out of place in kafka novel it also makes the documentation maintainer job that much harder in part because you can no longer tell which things are mistakes and which things were actually once true for some version can guarantee you right now that not single user is masochistic enough to be running and maintaining code targeting every version of ansible extant simultaneously so by structuring your documentation in this way you are appealing to an audience so niche and unreasonable that it does not even exist to the detriment of the very real user base who is not thus configured as sure you can tell by now am against hyperbole in all its forms but those little boxes are an obscene offense to common decency an affront to the abstract concept of human social progress and disgrace to our entire solar system the world will end not with bang but with small box that lets the end user know support for the world was added in version changed in version and removed in version lt rant gt error handling http docs ansible com ansible playbooks error handling html barman http www pgbarman org>>>docs_report feature_idea
looping modifiers in roles may crash in ansible issue type bug report ansible version ansible configuration `vault password file` is set to decrypt certain inventory variables environment pretty sure it doesn apply but summary looping modifiers `with items` or `with subelements` are crashing out when used in role where the elements are provided from the playbook as parameters the python code for playbook role tries to add an ansiblesequence to an array but it unhashable steps to reproduce jscott test yml roles jscott test tasks main yml expected results would expect it to print debug message of `1` actual results `ansible playbook inventory jscott test yml` crashes out as you might expect from the erroring file it works as expected if the variable is either entirely in the role or entirely in the playbook >>>bug_report p2
chocolatey module fails when it is not already installed issue type bug report ansible version environment from macosx 10 11 to windows server 2008r2 summary here what trying to do on windows server 2008r2 name add git win chocolatey name git state present it appears that chocolately as the doc says tries to install itself because it is not present on the machine but everything still fails here the relevant output >>>bug_report needs_info windows
unexpected exception using ansible vault ve suddenly started getting an exception when quit an encrypted file after editing it with ansible vault the exception doesn appear to stop ansible vault from working ok currently using the devel branch but did try changing to the stable branch and it continued to show this exception here the full stack trace >>>bug_report
fatal error on file task creating directory encountering this issue with ansible stable running against ubuntu 14 04 systems this error occurs both in running `against remote host and running locally the failing task is simple file task creating directory the resulting error >>>bug_report needs_info
add posix groups to the list of returned facts>>>feature_pull_request plugin
bare variables in with loops are not printing deprecation warning in changelog we specified that with loops with bare variables are deprecated however the code is not printing deprecation warning sample playbook problem code https github com ansible ansible blob devel lib ansible executor task executor py l173>>>bug_report
add detect altlinux distributive hello please add detect altlinux distributive >>>feature_pull_request
race in initial creation of accelerated keys dir with multiple target hosts as described at https groups google com forum topic ansible project wh0zm1zy5l8 there is race in how accelerate mode attempts to create the accelerate keys dir path when it doesn exist and executing against multiple target hosts the problem is at https github com ansible ansible blob stable lib ansible utils init py l130 l131 when running with multiple target hosts each fork will run through this section of code it is possible for each of the forks to evaluate the initial conditional before any have executed and returned from `os makedirs key path mode 0700 this means that for one fork it will succeed in completing this block while the others may fail on subsequent runs the directory now exists so until it is deleted or the play is run again in pristine environment the error will disappear possible solutions include using lock or simply wrapping the call in try except that swallons any eexist errors while also less likely for the actual file used to store the per host key https github com ansible ansible blob stable lib ansible utils init py l142 l147 it still remains possible for similar race when using delegate to to attempt to open and write the file multiple times thus resulting in the key being generated and used correctly sometimes and throwing an exception in others about trying to create the file multiple times when it already exists lock would probably be the safest thing here as would want to wait until the file was created and could be read before allowing other forks to continue to read it contents in parallel alternatively lock around the `utils key for hostname host at https github com ansible ansible blob stable lib ansible runner connection plugins accelerate py l48 also appears as though it would solve the problem >>>bug_report
feature copy vault add vault support to copy action plugin this pr allows the copy task to support copying encrypted vault files as described in 7298 at least with respect to the copying of files the implementation is the same as that used in the copyv action plugin https github com saygoweb ansible plugin copyv developed for ansible v1 2>>>feature_pull_request
list hosts does not work with limit ansible as described here https groups google com forum topic ansible project sxuzfahmrui this doesn work nor this but this will ansible version installation through `pip install user ansible upgrade` my hosts file was generate with `for in seq 10 do echo host hosts done`>>>bug_report
specifying role whose name is variable value doesn work as expected issue type bug report ansible version ansible configuration none environment os 10 11 summary want to include playbook twice with different parameters and inside this playbook want to specify role whose name actually is the parameter value it worked with ansible and is broken with ansible steps to reproduce expected results actual results >>>bug_report
cannot add role global name role is not defined github https github com jesuscript charlie flu error failed failed to update the specified role fields please retry the import in few minutes if you continue to receive failure please contact support error was global name role is not defined>>>needs_info
rpm build from v2 release fails with error line 10 illegal sequence in release issue type bug report ansible version ansible configuration none environment reproduced in centos release final centos linux release 1511 core summary the build of rpm fails with error steps to reproduce unarchived v2 tar gz under usr local src and tried to build rpm by following expected results get ansible el7 centos noarch rpm in ansible rpm build directory actual results got error >>>bug_report
syntax check doesn work with vars prompt issue type bug report ansible version ansible devel 589971fe7e last updated 2016 01 13 15 17 12 gmt 200 ansible configuration nothing environment ubuntu 15 10 summary if playbook has `vars prompt` running it with syntax check` won prompt you to enter variables but will generate an error steps to reproduce use the following playbook and run it with expected results playbook should prompt you to enter variables like in version and then check the syntax actual results prints an error >>>bug_report
updated intro getting started rst to reference ask become pass updated intro getting started to reference ask become pass instead of ask sudo pass>>>docs_pull_request
fix add host overwrites runtime host vars fix ansible ansible modules core 2799>>>bugfix_pull_request p2
with items fails in v2 when with items argument is variable vars toto titi prefix toto suffix titi tasks name test debug msg item with items prefix suffix task roles db2 test ok dx3besip01 item toto titi item toto titi msg toto titi task roles db2 test ok dx3besip01 item item msg ok dx3besip01 item item msg ok dx3besip01 item item msg >>>bug_report
include all inventory group vars and host vars ensure results from all basedirs are included and not just overwritten by the results from the last one>>>bugfix_pull_request p2
hostvars in template doesn work as expected in v2 in could do the following in template however in it no longer works as expected it generates the following error when using the variable in template without jinja filter now get this would explain the error could you mention error in there one more time could be something wrong here but would expect this to still work as the following lines work like they do in >>>bug_report
2799 fix add host ignores runtime host vars make sure to grub runtime host vars as well as vars file otherwise add host will delete runtime data fix ansible ansible modules core 2799>>>bugfix_pull_request
homebrew hangs since updating to ansible the following task hangs and never completes the previous task of tapping formulas works fine >>>bug_report pending_closure
fetch module fail on missing is ignored issue type bug report ansible version ansible config file users rick ansible cfg configured module search path default overrides ansible configuration nothing has changed other than that ve upgraded ansible from to environment this is on macos 10 11 el capitan summary when running playbook which works fine on on ansible an error is generated by the fetch module ve edited the item bits because these contained customer information failed foo item foo failed true item foo msg file not found root mysql foo txt steps to reproduce run the following task on ansible name download the credentials fetch dest credentials src root mysql item name txt flat true fail on missing false with items users expected results the task should not fail it does not fail on ansible task download the credentials ok foo item foo actual results the task does fail on ansible task download the credentials failed foo item foo failed true item foo msg file not found root mysql foo txt >>>bug_report
jinja2 comment included in the template output issue type bug report ansible version ansible configuration blank `ansible cfg` with default configuration environment macos 10 11 el capitan summary jinja2 comments http jinja pocoo org docs dev templates comments syntax doesn work in templates steps to reproduce playbook template `template with comment j2` expected results actual results >>>bug_report
command args creates is ignored in async mode when command is used in async mode the args form of creates appears to be ignored however the embedded `creates file` does work in the code below the first two items initialise will always report changed and their commands are run the third case never runs which shows that async code is only ignoring the args format name testing initialise command touch tmp testing file args creates tmp testing file async 200 poll 10 name testing should not run command touch tmp testing file args creates tmp testing file async 200 poll 10 name testing should not run command touch tmp testing file creates tmp testing file async 200 poll 10 >>>bug_report
ansible synchronize change in functionality broke my deploys had been using play for few months now on the releases it looks like the following code name ensure all ssl certs are copied to server synchronize src ssl dest opt backup ssl archive no recursive yes code with ansible its now trying to sudo on my local host in order to be able to sudo copy them on the remote host from the docs note the user and permissions for the synchronize src are those of the user running the ansible task on the local host or the become user if become yes is active synchronize will attempt to escalate privileges to the become user on the local host this is counter to the previous functionality the user running the play has access to the remote server the local root account isn available to use not understanding the purpose of the local sudo when become is enabled when the module is showing set remote user option as well the purpose of become is for the remote system not the local one make the set remote user to be set local user and keep the same functionality as was present in >>>p2
document that ansible api is not thread safe when ansible loads module from disk for plugin it first checks to see if the module has already been loaded exists in sys modules and if it does it returns that reference rather than loading the module again which as described in issue 13110 must not happen because repeating the module load may re initialize module global variables when module is loaded the reference is immediately added to sys modules even before the module initialization is complete therefore if two threads race the module loading code the first will begin loading the module from disk and the second will see the module in sys modules it might begin using that module before it is even fully loaded resulting in attributeerrors on objects which should be defined in the module this can be reproduced by wrapping the python api example at http docs ansible com ansible developing api html in function and then adding the following this results in the this traceback traceback most recent call last file usr lib python2 threading py line 810 in bootstrap inner self run file usr lib python2 threading py line 763 in run self target self args self kwargs file test py line 13 in test variable manager variablemanager file lib ansible vars init py line 92 in init self fact cache factcache file lib ansible plugins cache init py line 35 in init self plugin cache loader get cache plugin file lib ansible plugins init py line 335 in get obj getattr self module cache path self class name args kwargs attributeerror module object has no attribute cachemodule the problem can be corrected by wrapping module loading in mutex >>>docs_report
ansible install from pip seems incomplete missing extract filter it seems like the release of ansible on pip is incomplete after installing am trying to use the extract filter but getting the error message `no filter named extract after comparing the file `ansible plugins filter core py` at https pypi python org pypi ansible with the one in this repository it seems like it missing at least one line at the bottom array and dict lookups extract extract this is in fact missing from rc4 as well is it possible the version on pypi is actually rc4 >>>docs_report
doc fragments for vmware and vca modules>>>docs_pull_request
multi level includes template action can find template in roles templates issue type bug ansible version ansible rc4 ansible ansible configuration default environment os yosemite 10 10 summary please see the project structure below similar to the issue 12303 and 13671 anther user also reports that the same issue nutztherookie on version steps to reproduce my roles layout is roles docker service tasks docker service yml templates docker service j2 kafka tasks main yml zookeeper tasks main yml the zookeeper kafka playbook all include the `docker service yml` via include docker service tasks docker service yml vars systemd service name zookeeper and in the docker service playbook it adds the systemd service file name adds systemd service name service files template src docker service j2 dest etc systemd system systemd service name service owner root group root mode 0644 the problem is when running the docker service playbook cannot find the template file from `docker service templates and reports this error 	failed example item zookeeper failed true item zookeeper msg ioerror errno no such file or directory users alexw tmp projectname docker service j2 the same playbook works on ansible >>>pending_closure
identify which module is missing the shebang fixes 13816>>>bugfix_pull_request
module not identified in missing interpreter line error message lib ansible plugins action init py includes this this is not as helpful as it could be it would be better if this message identified the module in question >>>bug_report
ansible error for custom module with pipelining if run ansible with custom bash module the execution fail for example as you can see in the last ssh exec there nothing before root ansible tmp ansible tmp 1452613433 69 108011768581484 args there should be root ansible tmp ansible tmp 1452613433 69 108011768581484 rpm installed if run the same task with ansible the execution ends without errors the problem seems to be something like that thanks>>>bug_report p2
default vars from roles can be used before they are defined issue type bug report documentation report pick one ansible version ansible devel b58673289a last updated 2016 01 12 15 13 34 gmt 200 ansible configuration environment summary we are puzzled by the scoping behavior of ansible where default variables are concerned when multiple roles are pulled into playbook earlier roles can reference default variables from later roles variables can be used before they are defined even after scouring the documentation we can only conclude that this is surprising behaviour it has been stated elsewhere that defaults belong to the global scope but this issue is tangential it refers to ordering of roles when it comes to defaults steps to reproduce minimal example which contains expected results actual results >>>bug_report
added galaxy data not tested but something like this seems to be missing in the manifest in this can be fix for 13419>>>bugfix_pull_request
added common user function to get global unique sid with include statement this pull request is based on https github com ansible ansible pull 12806 in addition it will add another replacement like powershell common regarding accounts >>>feature_pull_request plugin windows
confusing group vars host vars when using ip for hosts issue type feature and or bug report ansible version ansible summary in host file when defining two distinct groups pointing to the same ip configuration get merged found this very unintuitive however when defining two groups pointing to two domain that point to the same ip group vars and host vars will work as expected how to reproduce https github com incubatio ansible variable tests story new ansible user first docs tells us to define group then docs tells us we can define group of groups then docs tells us we can define specific config for host and group my first personal conclusion was ok group is an entity for one or more hosts so defining group is like defining virtual environment with the possibility to store variable inside it if use ip address like this the previous conclusion is incorrect and db port value will be 2222 regardless of the actual target group deploying to if use domain instead of ip like this the previous conclusion is correct and db port value will be defined according to the group deploying to edit sorry for the first post it was long poorly written and partly incorrect >>>docs_report
added ignore certs option to ansible galaxy init install and info in the mailing list there is thread https groups google com forum topic ansible project l2h6ksaf o0 of users having issues with ansible galaxy behind proxy in my testing can get it to work but only with v2 using the ignore certs flag the ignore certs option gets passed to open url as validate certs false this pr backports the same logic to stable >>>bugfix_pull_request
ansible fails to execute handlers after the copy module fails to find file issue type bug report ansible version ansible playbook configured module search path none ansible configuration force handlers true environment arch linux summary ansible fails to execute handlers using force handlers after the copy module fails to find file it is only reproducable when the copy module is used in play and `hosts specifies group not single host steps to reproduce since role is needed to reproduce it have attached ansible repro zip https github com ansible ansible files 86345 ansible repro zip in addition to inline contents hosts site yml roles main tasks main yml roles main handlers main yml finally run ansible playbook hosts site yml` expected results ansible should execute the handler actual results >>>bug_report
profile tasks readme md as agreed with brian coca in ansible project group https groups google com forum searchin ansible project tom 20paine ansible project nv6bzs2yu akyq0hu bqaj>>>docs_pull_request
fix typo in api docs this typo caused syntaxerror when attempting to run the example in the api docs >>>docs_pull_request
new swiftype engine made new swiftype engine off http as suggested replaced script added sitemap xml file>>>docs_pull_request
correctly parse dependency yaml dict fixes 13800 >>>bugfix_pull_request
add host doesn load group vars version command line ansible playbook hosts ini test yml jjshoe tgz of files http www filedropper com jjshoe group vars add hosttar expected output received output files test yml group vars all yml group vars yml hosts ini >>>bug_report
bug private role repository in role dependency during playbook issue type bug report ansible version ansible configuration ansible config is local folder nothing taken from etc ansible environment ubuntu 14 04 summary using role in private non galaxy git repo which has dependency on similar private non galaxy role works when pulling the roles with `ansible galaxy` but fails when running `ansible playbook` steps to reproduce see github https github com timjones ansible bug test playbook git https github com timjones ansible bug test role git https github com timjones ansible bug test dependency role git expected results actual results >>>bug_report
added custom code for swiftype custom search google custom search replacement>>>docs_pull_request
remove unused imports in utils path py clean up imports of time sleep and stat that are no longer used here>>>bugfix_pull_request
aws api rate limit exceeds are we able to deal with that issue type bug report feature idea ansible version ansible configuration environment os mac os el capitan summary there are couple of ec2 modules saying ec2 elb lb module and have code like this very oftenly aws bounces me with an error like this wonder if it is possible to set up the throttling or maybe ansible can catch this via exception and reduce its appetite in order to be able to finish the playbook steps to reproduce try to create lot of elbs etc expected results to be able to catch the exceptions like api rate limit requests actual results error and playbook execution fails >>>bug_report
tags are ignored at role level issue type bug report ansible version ansible playbook devel c3dd0213ef last updated 2016 01 11 12 26 53 gmt 200 lib ansible modules core detached head 33014c6db1 last updated 2016 01 08 15 07 37 gmt 200 lib ansible modules extras detached head 82a4cf84be last updated 2016 01 08 15 07 37 gmt 200 environment ubuntu 15 04 problem using tags defined for specific roles inside playbook are ignored when running ansible playbook with that tag please see example for more details using version 94 this works perfectly when tags are specified for some tasks inside this role they are usable just as expected with tags tag1 example running ansible playbook ansible hosts ansible site yml somehost tags tag1 results in skipping everything >>>bug_report
fixes 13763 update connections play context on every iteration if this isnt updated the connection is reused and thus has an outdated play context` this results in outdated `success key` and `prompt` causing issues if sudo is run in loop refer to the issue 13763 for more debugging and details>>>bugfix_pull_request
vars missing ansible private role vars issue type bug report ansible version v2 rc4 from checkout ansible configuration trying out ansible environment summary with `ansible private role vars 1` local variables to role1 are not available to pass to role2 where role2 is declared as dependency to role1 steps to reproduce checkout https github com davidbirdsong ansible vars weirdness expected results actual results >>>bug_report
hostname as bool at `unarchive` hi tested at `ansible` versions `1 2` `1 4` when we write domain name at `inventory` without dots like `vagrant` not `vagrant com` and having variable `vagrant` defined at `vagrantfile` and set to `true` playbook will fail at commands like `unarchive` >>>bug_report
support for playbook level variables new feature allow playbooks to contain vars vars files and vars prompt blocks whose values are available to all plays in the playbook this allows prompted variables to be shared across plays and also provides an alternative to defining variables in inventory which makes playbooks less easy to read as not all information is kept at the same place and does not support prompting >>>feature_pull_request
fix minor typo in comment>>>docs_pull_request
fixed typo integerations integrations>>>docs_pull_request
bug for ansible docs search is broken should be reoppened since it not fixed and people have been commenting saying so but we don have the ability to reoppen the bug >>>docs_report
stderr lines to match stdout lines issue type feature idea ansible version summary it would be useful to have `stderr lines` to match `stdout lines` especially when trying to debug broken play using debug var something stderr` >>>feature_idea
including playbook with variables adds extra quotes to the variables cat include yml include debug yml msg look at quotes cat debug yml hosts localhost connection local gather facts no tasks debug msg msg debug var msg ansible playbook localhost include yml play localhost task debug msg msg ok localhost msg look task debug var msg ok localhost var msg look at quotes play recap localhost ok changed unreachable failed include debug yml vars msg look at quotes >>>bug_report
restore ability for module to specify want json in devel it appears that `want json` functionality has been broken nowhere did we inspect `module style` for `non native want json` and upload json args file this change should fix this this should likely be cherry picked in stable as well >>>bugfix_pull_request
restructure vars prompt and fix regression pushed it to use the existing propmpt from display and moved the vars prompt code there also for uniformity changed vars prompt to check extra vars vs the empty play vars to restore behaviour sipmlified the code as it didn need to check for syntax again tqm is made none prior based on that fixes 13770>>>bugfix_pull_request
first pass at allowing binary modules 6374 is bit out of date with all of the changes for this pr adds some proof of concept changes that allow ansible to utilize binary modules that have no shebang and whatnot binary detection is done similarly to the `file` command using concept found at http stackoverflow com 7392391 there are no doubt some things missing right now but this is working for the standard action not tested with async and the `ssh` transport few things that need to be looked at async async seems to work fine per my tests windows had to change some things around to allow exe` extensions for modules but working now assumes windows binaries are always exe` binaries other than go and non elf have testing things from executables to images to pdfs which all report properly >>>feature_pull_request
ansible prompts for vars prompt when extra vars is used issue type bug report ansible version from the stable branch commit 91c7691a92e63580216e0e5c657b689361330beb ansible configuration no changes environment rhel summary ansible stops execution and requests the user to enter variables specified with `vars prompt` even if the same variable has been specified on the comand line ansible does not prompt for `vars prompt` if extra vars` specifies the same variable steps to reproduce playbook yml expected results non interactive run as on actual results the user is prompted >>>bug_report
ansible playbook msg could not find job environnement ansible on debian hosts are on debian too case creating playbook to automate client delivery during my test focus on how to manage the environnement which need sudo authorization to manage my tomcats after some test got my the solution to use sudo in command line use the solution first time with success but at second time got an error failed my ip ansible job id 568493482014 5802 failed true msg could not find job failed on my ip try to reproduce on another similar server with same playbook and all works so didn understand what can append sources command use to launch the playbook ansible playbook hosts main2 yml sudo my main2 yml my role liferaycommand any idea if you have any idea try to restart the server in case broke needed process the behaviour doesn change >>>bug_report
allow inventoryscript json with childgroups only and without hosts and vars without this patch the simplified syntax is triggered when group is defined like this platforms children cloudstack which results in group platforms with host platforms this is basically only redo of this commit https github com ansible ansible commit 69740b86e8b8ce7e0407bbe6f8eb9d97dd93022c that got nullified by this commit https github com ansible ansible commit ce3ef7f4c16e47d5a0b5600e1c56c177b7c93f0d diff a4d695beaa410b22bfeb22749cdaa210r99 more details in issue https github com ansible ansible issues 13655>>>bugfix_pull_request
add sudo su become option we manage server were we do not have access to the sudoers file the only way on this server to execute commands is to use sudo su this adds sudosu option to become method it did not use the become command argument because it is not clear if that would reference the sudo or su part the same goes for the flags which currently apply to the sudo part >>>feature_pull_request
sudo become doesnt work on local connection in loops am having confusing problem it does look like bug and hence am reporting here not sure if duplicate am using ansible version locally on osx el capitan to run series of steps which sets up my machine for development for my project the last step here is to add few lines to etc hosts` 15 lines am using `lineinfile` to add these lines in loop have tried `become root` with `become ask pass true` in the cfg file this does nothing it does not ask my password and once it hits that task get `the destination directory private etc is not writable by the current user if try `sudo yes` and `ask sudo pass true` then get `fatal localhost failed failed true msg error privilege output closed while waiting for password prompt msg line added changed true backup but infact if check now etc hosts` file now has the first lines of the list of lines had to add running the playbook now doesnt help me at all but even more oddly if remove the config option to ask for password and run the play it works fully >>>bug_report
show version without supplying dummy action especially check for version fixes 12004>>>bugfix_pull_request needs_rebase
new idea ansible proxy server dest server to excute command hi have one suggestion with proxy can one master server use another proxy master server to excute ansible module when two master server had all been installed ansible it may useful in that master server can connect master server and master server can connect client server but master server can connect server directly excute command like ansble proxy server dest server shell echo something is that posible to be developped >>>feature_idea
filter in yaml no filter named regex escape yml name add ip hostname couples to etc hosts file lineinfile state present dest etc hosts regexp regex escape item hostname regex escape line item ip item hostname bash task etc hosts add ip hostname couples to etc hosts file fatal web failed to template regex escape item hostname regex escape template error while templating string no filter named regex escape >>>docs_report
moved readme md to readme rst normalizes on rst and auto uploads description to pipy set default long description based on the first few lines of readme md added script that will convert readme md into restructured text for pypi send project metadata to pypi and delete the temporary file code based on https coderwall com qawuyq use markdown readme in python modules addresses 13234 when script applied to project by core dev with access to the pypi account >>>docs_pull_request
breaking change to roles between v2 rc3 and v2 rc4 hello we noticed regression back to behavior for finding roles between these two tags with `playbooks` and `roles` in the same directory running something like the following was working fine with v2 rc4 it can no longer find the roles referenced in the playbook was this an intentional change >>>needs_info
changing md5 checksum code to work against files in use currently when using module such as win stat it will fail when trying to stat file that is in use this is due to the way the md5 checksum is being extracted via the current powershell code have changed the code to no longer require locking the file in order to properly read an md5 checksum in return you can now run win stat against files that are in use >>>bugfix_pull_request windows
added new custom search and updated footer swiftype custom search code put into the searchbox html file while other content was commented out would like to test this with production build before removing the old content also updated footer with date removed stray period added division of red hat inc with link as well >>>docs_pull_request needs_rebase
correct invocation of launchctl when executed `launchctl limit maxfiles 1024 2048` my entire system would become unusable as all of the sudden no process could use any file anymore reporting that the max file limit was reached only hard reboot could fix the problem which fortunately revealed that the configuration was not saved the change made should remedy the issue even though didn test it therefore hope you can revise the documentation to be sure nothing bad happens meta tested on osx 10 11 2>>>docs_pull_request
error include tasks should not specify tags in more than one way both via args and directly on the task issue type bug report ansible version ansible playbook stable fcd074d40f last updated 2016 01 07 12 20 55 gmt 200 lib ansible modules core detached head 0b8ae0da8b last updated 2016 01 07 12 21 00 gmt 200 lib ansible modules extras detached head 5b47600c2b last updated 2016 01 07 12 21 00 gmt 200 config file etc ansible ansible cfg configured module search path default overrides ansible configuration environment summary the tag style mixing message shows up where it doesn really make sense mixing styles between import levels and not on single import steps to reproduce run `ansible playbook localhost local site yml` site yml tagging yml tagged yml expected results the playbook running actual results >>>pending_closure
ansible vault surface keys inside as clear text one great aspect of ansible think is grep ability of the repo to find all links in applications however when some variables are encrypted through ansible vault you can grep them anymore to know which files you need to change that will impact it would be cool to have be encrypted to something like >>>feature_idea
pass diff and verbosity settings to modules also simplifies and guarantees that all flags are always passed even when false this should make checks simpler as you always expect them to exist>>>feature_pull_request
don break out of plays loop when some hosts fail it used to break out of the wrong loop first play with failed hosts silently stopped running the playbook instead of just skipping the current play >>>feature_pull_request
role runs on failed host if second role has include statement issue type bug report ansible version from the stable branch commit fcd074d40f32ef52ed286678293984125ff51008 ansible configuration no changes environment rhel summary in multi role playbook with include statements it seems all that ansible fails to preserve the list of failed hosts the result is that tasks are executed on hosts with failures ansible does not have this behavior steps to reproduce playbook yml roles r1 tasks main yml roles r2 tasks main yml included yml expected results as `r1` fails on host app02 expected it to not run `r2` this is the behavior in actual results when `r2` has an `include` statement `r2` runs on both hosts without it it only runs on app01 with include without include >>>bug_report p2
win copy module is slow copying folder containing 60 files totaling 75 files took about 12 minutes on the first run and 10 minutes on the second run when the files were already there this is ok for copying small text config files but magnitues slower then other methods >>>bug_report windows
fix module name>>>docs_pull_request
changes to ansible shell wrapper breaks setup ping modules bug report regression in 0rc3 issue type bug report regression between and 0rc3 ansible version master on osx managing freebsd 10 2r amd64 summary setup inventory fails in to run on freebsd 10 release due to removing bin sh c` as wrapper from mkdir shell command nb default shell on freebsd is bin csh demonstrated using setup module but ping module also fails issue appears to be in ansible itself `lib ansible plugins shell sh py` possibly broken by this commit https github com ansible ansible commit 26520442bd0fe231abc0a4432c6f2943b61f8fb8 works on `brew switch ansible 1` fails on `brew switch ansible rc3 1` steps to reproduce `vagrant init freebsd freebsd 10 release vagrant up` add the ip hostname to your ansible inventory file switch to `ansible all tenrtwo bootstrap root setup vvvv` should work switch to rc3 repeat above command expected results as seen in actual results >>>bug_report
play continues after failed task when `any errors fatal` is set issue type bug report ansible version from the stable branch commit fcd074d40f32ef52ed286678293984125ff51008 ansible configuration no changes environment rhel summary play continues after failed task when `any errors fatal` is set steps to reproduce expected results expected the playbook to stop after the executing the first task on all nodes before the stop before this task as it does on the documentation says the `any errors fatal` play option will mark all hosts as failed if any fails causing an immediate abort actual results the second task is executed on the node which completed the first task without error >>>bug_report p2
ansible galaxy install is completely unusable when any flags are passed issue type bug report ansible version the bug was introduced in 21775d7866c7953d4d953c271c0a18e227e4bc66 and is still present in fcd074d40f32ef52ed286678293984125ff51008 which is the version discovered it in ansible configuration none this occurs before can even get to running `ansible playbook` at all as `ansible galaxy` is failing to do anything environment discovered on ubuntu 14 04 verified and git bisected on os 10 11 summary `ansible galaxy install` and presumably other subcommands too no longer accepts any flags steps to reproduce `ansible galaxy install f` expected results actual results >>>bug_report
feature request use git lfs with ansible modules copy and unarchive and possibly other modules git lfs large file storage is catching on and is available in both github and gitlab as of late 2015 it would be nice to include large files in role files directory and track them with git lfs in git lfs these are text reference pointers to the file that can be fetched from the git server the feature request file modules such as copy and unarchive should check for the text reference pointer and if found automatically transfer the file from the git server git lfs directly to the destination hosts while could clone the full git repo and fetch all the files this would cause two full transfers of potentially gb of data vs just one as described above perhaps another feature request should be add git lfs support to the git module as well >>>feature_idea
ipaddr filter properly handle addresses on 31 networks fix for https github com ansible ansible issues 13716 >>>bugfix_pull_request plugin
now show full callback stacktrace when vvv still is warning as we don want to repeat it multiple times nor additional callbacks to stop ansible execution hopefully we can avoid shipping exceptions in the default minimal callbacks fixes 13713 >>>bugfix_pull_request
strip string terms before templating the earlier code did call terms strip but ignored the return value instead of passing that in to templar template clearly an oversight >>>bugfix_pull_request
adding password no log and cleaning up argument spec for vca module>>>bugfix_pull_request
linear strategy don look at tasks from the next block fixes 13732 the linear strategy tries to guess which hosts should get their task by counting hosts in each `run state` before this patch it was taking all hosts into account even the ones that are not in the current block this could cause it to emit noops for all hosts and not consume any tasks from play iterator >>>bugfix_pull_request
not able to execute windows module in ansible hello am getting below error when try to run below ansible command though accessing linux works perfectly environment details running python on virtualenv os centos 6>>>bug_report needs_info windows
ansible v2 and devel hangs issue type bug report ansible version ansible devel cd3cfa93bf last updated 2016 01 05 11 51 41 gmt 200 lib ansible modules core detached head 002028748f last updated 2016 01 04 16 51 50 gmt 200 lib ansible modules extras detached head f6a7b6dd1f last updated 2016 01 04 16 51 50 gmt 200 config file home tkontusz int rd config ansible cfg configured module search path default overrides also in stable ansible configuration environment ubuntu trusyt on host debian wheezy ubuntu trusty as target summary running specific playbook hangs when the implicit flush handlers should run this is the end of ansible debug log before killing ansible it loops anyway steps to reproduce working on this as reducing the problem seems to be hard couldn build failing playbook from scratch so far so ll have to reduce proprietary one until it small enough to paste here expected results the playbook running to completion actual results the whole thing eating 100 of one cpu >>>bug_report
ansible vault unknown openssl error when running `ansible vault encrypt` get the following error have tried with and without password file with the same outcome system information mac os 10 11 el capitan ansible rc3 openssl 2e>>>bug_report
os x10 11 can use ansible it works in ansible when update ansible it prompts error like this >>>needs_info
local connection sudo pipelining raw fails waiting for password prompt ansible raw localhost echo connection sudo vvvv local using etc ansible ansible cfg as config file sudo password loaded callback minimal of type stdout v2 establish local connection for user badger 127 exec bin sh sudo sudo via ansible key dsvxgavwyxalsjrucewuzwdyxmpasolo password root bin sh echo become success dsvxgavwyxalsjrucewuzwdyxmpasolo echo connection localhost failed rc error privilege output closed while waiting for password prompt become success dsvxgavwyxalsjrucewuzwdyxmpasolo connection pts 36 roan srv ansible ansible friday ansible raw localhost bin echo connection sudo vvvv local sudo password localhost success rc connection pts 36 roan srv ansible ansible friday ansible raw rhel7 test echo connection sudo sudo password rhel7 test success rc connection pts 36 roan srv ansible ansible friday ansible raw rhel7 test bin echo connection sudo sudo password rhel7 test success rc connection pts 36 roan srv ansible ansible friday devel 20 03 38 ansible raw localhost echo connection sudo sudo password localhost success rc connection >>>bug_report
boto3 conn can use aws session token environment variable when boto3 true in get aws connection info issue type bug report ansible version ansible configuration environment ubuntu 14 04 summary when using sts you get the following environment variables set aws secret access key aws session token aws access key id when calling get aws connection info with boto3 true you get returned aws session token aws access key id aws secret access key then boto3 conn deletes aws session token with this code suggest this be changed to example to reproduce https gist github com gergnz 3e7783b16db606751e23 >>>bug_report cloud plugin
added openstack dynamic inventory example added an example illustrating how to use the openstack dynamic inventory script to the dynamic inventory section of the docsite >>>docs_pull_request
do not set changed to true when using group by since group by is not changing in any way to the remote system there is no change this also make things more consistent with the set fact plugin >>>bugfix_pull_request
minor grammar error was making me pull hair out not super important but annoying to look at if not fixed >>>docs_pull_request
no handlers could be found for logger paramiko transport ve installed python 11 and ansible but testing the installation with simple ansible ping is failing ansible also gives the same error my linux version 32 431 29 el6 x86 64 smp both paramiko and pycrypto seem to be up to date error ansible all ping no handlers could be found for logger paramiko transport 127 failed failed error reading ssh protocol banner errno 104 connection reset by peer python python 11 pip install upgrade paramiko requirement already up to date paramiko in usr local lib python2 site packages paramiko 16 py2 egg requirement already up to date pycrypto in usr local lib python2 site packages pycrypto py2 linux x86 64 egg from paramiko requirement already up to date ecdsa 11 in usr local lib python2 site packages ecdsa 13 py2 egg from paramiko pip install upgrade pycrypto requirement already up to date pycrypto in usr local lib python2 site packages pycrypto py2 linux x86 64 egg cat ansible hosts 127 ansible version ansible configured module search path none similar error with ansible ansible version ansible config file configured module search path default overrides ansible all ping no handlers could be found for logger paramiko transport 127 unreachable changed false msg error error reading ssh protocol banner errno 104 connection reset by peer unreachable true >>>needs_info pending_closure
fixed links in readme fixed from broken links in readme and removed extraneous whitespace >>>docs_pull_request
ansible docs links on google throw 404 issue type documentation report ansible version ansible configuration environment chrome on osx summary the ansible docs were moved to http docs ansible com ansible but google has page results cached for http docs ansible com the is no redirect in place so all links from google 404 steps to reproduce google ansible file click the first link expected results the link should redirect to http docs ansible com ansible list of files modules html actual results the link throws 404 http docs ansible com list of files modules html>>>docs_report
ipaddr returns empty string given ipv4 network with exactly two addresses specified in cidr notation when use the ipaddr filter to extract the address without prefix then expect to have the address returned but an empty string is returned example >>>bug_report
allow empty string gce parameters empty strings are valid parameters when running on gce instance http libcloud readthedocs org en latest compute drivers gce html using gce internal authorization>>>feature_pull_request plugin
unnecessary in ansible playbook run output here is simple playbook usr bin env ansible playbook hosts hosts sample gather facts false sudo yes tasks file path tmp foo state absent file path tmp bar state absent when run it see sample play sample task file path tmp foo state absent ok host task file path tmp bar state absent ok host play recap host ok changed unreachable failed in the first task output there is new line after the word `absent` that can be removed to make the output better task file path tmp foo state absent ok host ps using ansible installed from brew on my mac >>>bug_report
can get python traceback from exception thrown in callback plugin as part of 13712 was trying to track down the source of python exception in the `default py` stdout callback plugin unfortunately this effort was hindered by the apparent inability to get more than the exception and the file that it came from no line number or traceback even when running with vvv` this is the most could get which is exactly what get without any v` option >>>bug_report
default py callback plugin throwing exceptions warning error when using bound method callbackmodule v2 on file diff of home agaffney dev ansible lib ansible plugins callback default callbackmodule object at 0x760c34f0 taskresult object has no attribute get >>>bug_report
feature ability to specify custom template for item label in output currently when you use `with items` or related functions such as `with dict` with complex data structure as opposed to simple list the entire structure gets displayed in the console output unless you use `no log` this results in output like the following ideally you should be able to specify custom template string to use as the label for each item for var structure and task like the following and the output would look like rather than the output at the beginning of this issue the `default py` stdout callback plugin could easily be modified to check for the `item label` field in the result before the `item` field to support this >>>feature_idea
make credstash lookup plugin support encryption contexts previously the lookup plugin passes all its keyword arguments to credstash `getsecret` while this works for passing the standard parameters version region and table this does not allow passing dictionary of key value pairs as `getsecret` context parameter instead pop `version` `region` and `table` from `kwargs` supplying the default value if they are not defined and pass the rest of the `kwargs` as the `context` parameter https reviewable io reviews ansible ansible 13709 >>>feature_pull_request plugin
windows tasks sometimes not repeatable issue type bug report running ansible from oracle linux my playbook is fairly simple run windows updates on mix of domain joined server 2008 and server 2012 systems and restart if necessary if run the playbook on system and no updates are available the result is ok as expected however if subsequently run that playbook again on the same server get very extensive error message the critical portion of which is an error occurred while registering scheduled job definition ansible win updates to the windows task scheduler the task scheduler error is cannot create file when that file already exists exception from hresult 0x800700b7 on these systems notice that there file named ansible win updates under windows system32 tasks microsoft windows powershell scheduledjobs if manually delete that file and restart the server can then successfully run the playbook again >>>bug_report needs_info windows
window modules auth not working as expected with have valid kerberos ticket on host with and the following playbook fails modonnel appl303 stc tmp playbook cat win test yaml name test windows hosts ws3 adm stc vars ansible ssh user modonneladmin global tudor com ansible ssh port 5986 ansible connection winrm tasks name test ping action win ping modonnel appl303 stc tmp playbook ansible playbook win test yaml vvvv using home modonnel ansible cfg as config file plays in win test yaml loaded callback default of type stdout v2 play test windows task setup establish winrm connection for user modonneladmin global tudor com on port 5986 to ws3 adm stc fatal ws3 adm stc failed failed true msg error ssl 401 unauthorized no more hosts left play recap ws3 adm stc ok changed unreachable failed modonnel appl303 stc tmp playbook it works fine on host running modonnel adm1 stc tmp playbook ansible nocows ansible playbook win test yaml play test windows gathering facts ok ws3 adm stc task test ping ok ws3 adm stc play recap ws3 adm stc ok changed unreachable failed modonnel adm1 stc tmp playbook ansible version ansible configured module search path home modonnel ansible playbooks library usr share ansible modonnel adm1 stc tmp playbook thanks mike >>>bug_report windows
bug redis fact caching does not work on rhel6 issue type bug report ansible version ansible configuration environment rhel python redis el6 noarch redis 10 el6 x86 64 summary ansible claims redis is not installed ansible incorrectly tests for strictredis this is not available in rhel6 this is related to issue 12019 have done quick nested try except to resolve but it looks like ansible uses some of the changed functionality between strictredis and redis `zadd` and `setex` appear to be in use lrem order of num and value arguments reversed such that num can provide default value of zero zadd redis specifies the score argument before value these were swapped accidentally when being implemented and not discovered until after people were already using it the redis class expects args in the form of name1 score1 name2 score2 setex order of time and value arguments reversed steps to reproduce enable fact caching run playbook expected results no error actual results ansible playbook inventory mgmt playbooks var report yml the redis python module is required pip install redis >>>bug_report
separate verbosity diff levels for logfile and stdout issue type feature idea ansible version environment fedora summary provide mean to configure verbosity for different log outputs expected results as user don want to get all of the noise on stdout when running playbook but when some task unexpectedly changes or fails want to find out what actually happened >>>feature_idea
security shred ansible vault tmp file also when editor is interruped the implementation of ansible vault has two problems when you do `ansible vault edit my encrypted secrets yml` if ansible vault receives keyboard interrupt during editing the file is not deleted and the secrets are left plain unencrypted on disk chmod 600 granted this keyboard interrupt is not likely when you are using vim but it is when you are using gedit or meld you have an attached terminal then because you gave in the password there with or without interrupt the unencrypted file is not shredded by ansible vault just deleted this patch fixes both issues >>>bugfix_pull_request needs_revision
execution hangs and failure not respected when using include statements issue type bug report ansible version ansible detached head a2120a3d63 last updated 2015 12 30 16 14 04 gmt 200 lib ansible modules core detached head 5777c28f50 last updated 2015 12 30 16 14 13 gmt 200 lib ansible modules extras detached head 14b81df29c last updated 2015 12 30 16 14 13 gmt 200 config file users rkalff projects testansible test ansible cfg configured module search path default overrides ansible configuration environment os el capitan 10 11 summary when executing on multiple hosts in parallel and single host fails execution never ends when there is include task after the failure see test3 yml when the failure occurs in an included task file and there is another included task file after the failure the failure is not respected and different tasks run in parallel on different hosts see test5 yml all tests run as expected on steps to reproduce see https github com renekalff ansible bug report expected results that ansible playbook returns to the prompt in test3 yml that no tasks are executed for host after failure in test5 yml actual results see play results folder in https github com renekalff ansible bug report 1>>>bug_report p1
set executable to none fixes issue 13696 see issue 13696 for detailed description of the problem `executable none` will be picked up in low level exec command` https github com ansible ansible blob stable lib ansible runner init py l1161 and set to default executable if it is none >>>bugfix_pull_request
script raw module unexpected behaviour bug in when executing playbooks as root the script module fails creating user account and running the same playbook as non root works fine this is stripped down version of my playbook the output of `root c22cf074c887 ansible playbook connection local vvvv localhost play yml creating user nonroot and executing the playbook as normal user `nonroot` works fine `nonroot c22cf074c887 ansible playbook ask become pass connection local vvvv localhost play yml can fix this behaviour by changing `executable to `executable none` in https github com ansible ansible blob stable lib ansible runner action plugins raw py l37 this will then be picked up in https github com ansible ansible blob stable lib ansible runner init py l1161 and being set to the default executable not sure if this is the correct fix with this change applied the output to `root c22cf074c887 ansible playbook connection local vvvv localhost play yml` looks like this >>>bug_report
cloudstack fix more case insensitivity cloudstack fix has change reports changed for case insensitivity values for some values the api returns capitalized values while you used lower case ones and for most values the api handles the values case insensitive which means we would handle it as change even thought for cloudstack it is not there are some exceptions we will handle them later in for now compare the string values case insensitive produces less unwanted changes needs to be backported to stable 0>>>bugfix_pull_request
issue with ansible ssh port currently getting to grips with ansible but believe this to be bug this could be due to my incomplete code but am currently trying to learn about creating dynamic inventories the following code produces the error show below edited usr local lib python2 dist packages ansible inventory host py and before line 32 added print port which outputs 44 don think the inventory json is being picked up correctly >>>bug_report pending_closure
output color is now configurable next people will want to broaden to more than ansi colors >>>feature_pull_request
hashi vault lookup be more rebust and allow fields with other name than value extension on plugin by defionscode do not stacktrace if the string does not contain proper chars do not stacktrace if token or url or secret is not specified but give proper error allow user to specify the field with secret hello world value2 you can use other fields than just value allow user to query the entire secret dict with secret hello world still allow user to use the old behavior secret hello world defaults to secret hello world value do not stacktrace if the field is not available in the vault but give proper error>>>bugfix_pull_request feature_pull_request
use pulled ansible cfg for inventory restore behavior only give i` option to ansible playbook if explicitly given to ansible pull this then allows ansible playbook to use the pulled ansible cfg for the inventory leave behavior of all other tools unchanged fixes 13688>>>bugfix_pull_request
ansible pull does not respect ansible cfg in pulled repo while researching fixing 13681 realized where that the problem is actual another assumption ansible pull in v2 setups up all standard ansible arguments l` i` before cloning the repository there is workaround for the inventory pull but for anything else it completely ignores the ansible cfg file inside the pulled repository this breaks existing behavior suggestion allow explicitly passed arguments to ansible pull and forward them to the ansible playbook call for anything that is not passed explicitly don append it to the ansible playbook call but let ansible playbook figure out the values by itself it then has access to the ansible cfg in the pulled repo >>>bug_report
custom ansible module verbosity detection issue type feature idea ansible version ansible configuration not relevant environment not relevant summary as an author of custom ansible module should be able to access the current verbosity level on the module class so that may vary the content of the json output based upon verbosity levels steps to reproduce not relevant expected results an api can call to access the verbosity level or way to tag the json elements in the kwargs to module json fail so that some keys values only appear when certain verbosity levels are active actual results not relevant >>>feature_idea
add generic data structures querying this plugin adds generic query language to ansible this is useful when you register the results of module that has complex data in it the idea of writing this plugin came when needed to tag the ec2 instance volumes just after its creation the ec2 module outputs something like currently the only way to get list of volume ids is to invoke an `ec2 vol` task with `state list` so thought that having jq like query plugin would be great because it would solve not only this problem but many others with this plugin we can query our data structures with something like tagged instances block device mapping volume id` any comments to the pr would be appreciated >>>feature_pull_request
added newer vars to reset vars these vars pass back info to the task about the connection moved to their own block at start at file for readability and added the newer standard vars fixes 13669>>>bugfix_pull_request
make ansible pull clone only once fixes 13681 13925 the initial clone should only run once on localhost remove 127 there the actual playbook run should be with all possible hostnames for localhost options to ansible pull are overwritten otherwise one could execute things with otherhost local` which might lead to unexpected behavior>>>bugfix_pull_request
ansible pull clones double 127 and localhost issue type bug ansible version 0rc3 ansible configuration default environment opensuse 42 summary ansible pull runs clone twice steps to reproduce run ansible pull on system with ipv4 working and localhost resolving usr bin ansible pull var lib ansible local your git repo` expected results the ansible git module clone the repo once and then runs inside it actual results the clone is run twice and one of them fails >>>bug_report
rename synchronize module owner group to preserve owner preserve group issue type bug report ansible version summary think the synchronize module owner group options are currently confusing and would better be renamed to preserve owner and preserve group reasons both options in all other modules accept username group while in synchronize module they accept yes no the use case for synchronize makes it valid to think that by specifing owner group options we are asking it to change ownership on destination not preserve them as is backwards compatibility concerns aside it might be worth considering re introducing owner and group options but for chown ing files on dest similar to rsync chown which imho is more useful in ansible than preserving ownership since files are usually maintained in vcs and have no guaranteed ownership>>>feature_idea
fix for datetime exception in ecs tasks proposed fix for https github com ansible ansible modules extras issues 1348 in ansible module extras as remove values function is does not have an option to match the datetime datetime type and throws an error also seen in other boto3 modules in the ones ve written popped date handler function but with this that can be removed >>>bugfix_pull_request
handle unreachable hosts second last this change brings the behaviour back in line with without this change an unreachable host will always mask hosts that have had task failure allowing the playbook to continue running instead of aborting when all hosts have finished executing the current play simple playbook illustrating this is as follows if all hosts are reachable this playbook will fail as expected when each host hits `b` at present if there are any unreachable hosts the failures will be masked and all hosts will also execute `c` >>>bugfix_pull_request
tags are not inherented by multiple include levels issue type bug report or feature request depends on how you see it ansible version ansible configuration default environment debian jessie summary see the project structure below steps to reproduce have the following project structure main yml has content include media main yml tags media` main yml has content expected results expect all tasks from `media main yml` will inherit all tags specified in `tasks main yml` so if run `ansible playbook hosts site yml tags media` it will run all tasks specified in `media main yml` and ansible playbook list tags hosts site yml` reports this tag as well actual results it fails with the following error the whole source code of the project is available here https github com zshamrock ididitagain as workaround or the right way to do move specific subdirectories like media dev dot files etc in its own roles and assign tags with role instead as mentioned here http docs ansible com ansible playbooks tags html in my `site yml` >>>bug_report
strange with items parsing am using ansible using `lineinfile` module with `with items` loop faced some errors in parsing these items by simplifying the string it fails on came up to this one this fails with if you remove space before minus sign or replace it with an char it starts working the original line started with was also it seems that problem could be solved by changing double quote to single ones but still am not sure if this behavior is not wrong >>>bug_report
multi level includes copy template can find file in files issue type bug report ansible version ansible configuration default environment debian jessie summary see the project structure below steps to reproduce have the following project structure main yml has content include system main yml tags system` main yml has content include vim yml` vim yml has copy task like this one expected results when run `ansible playbook site yml hosts` expect `copy` module is able to understand that vim is inside `files directory and copy it into the destination as it has worked fine before moved `vim yml` into `system` subdirectory actual results it fails with the following error as you can see ansible tries to search for `local tasks files` instead of `local files` as workaround can use role path files vim` as `src` for `copy` but this is the reason for the layout for not prefix the resources inside `files` same is true for `template` module as well >>>bug_report
intro adhoc rst clarify idempotence explanation small but important enough typo wasn sure what to replace it with >>>docs_pull_request
ansible ssh user is null in newer versions issue type bug report ansible version issue was introduced in commit 226c7f4 and is present from there to head found via bisecting https gist github com alexwh 4399c41d39afdc58ce6c environment running ansible on arch linux managing debian jessie box summary when trying to reference the ansible ssh user variable it returns null in newer versions of ansible past the previously mentioned commit the documentation http docs ansible com ansible playbooks variables html variable precedence where should put variable states that ansible ssh is deprecated but doesn seem to say it removed the alternative ansible user returns variable is not defined in git head unless referencing it wrong or something steps to reproduce ansible do debug var ansible ssh user expected results copy from arch repos versions prior to 226c7f4 actual results from playbook https github com alexwh ansible playbooks blob 8705ad4c252942e36d8fff260ef2a0d6cbded2bd debian roles ssh tasks main yml l3 >>>bug_report
bigip changes as requested by bcoca and abadger fix to error if validate cert is true and python doesn support it only globally disable certificate checking if really needed use bigip verify parameter if available instead remove public disable certificate function to make it less likely people will attempt to reuse that>>>bugfix_pull_request p1
add checksum check to unarchive module feature request very common usage scenario is download file download checksum file check and then unpack suppose adding this variables `md5 47c7 for directly specified checksum `md5src https example com example zip md5` for checksum in file local or downloaded `md5src raw https example com example zip md5` for checksum in file but not in `md5sum` format just plain checksum sometimes checksum is stored that way similar varibales should be created for `sha1` `sha256` >>>feature_idea
environment variables values are printed in debug mode even when no log is set how to reproduce see param secret leaking in the output expected not printing the env params >>>feature_idea
expect module fails with stacktrace using the expect module fails have the following playbook it fails with consider this bug as the module should never stacktrace have not succeeded in successfully using the module at all system specs >>>bug_report
win file path gets garbled and not accepted due to backslash in that path snippet from my playbook `win file path my repository state directory` what happens is that the in the path causese win file ps1 to choke after that the directory is not created workaround for me is to double escape the `win file path my repository state directory` output from winrm via vvvvvv` update by the way maybe not win file specific problem because have the same issue with all path like parameters in win unzip used version ansible devel d89d7951e6 last updated 2015 12 23 17 51 57 gmt 200 used on azure windows server 2012 r2>>>bug_report windows
when the ansible ssh pass vaule has character ansible will show failed failed authentication failed >>>bug_report
ansible from dynamic inventory groups showing as hosts we are noticing some errors while testing on ansible v2 now rc3 where sub groups are being mentioned as failing nodes have narrowed this down to reproducible case note that it does not happen with subgroups in plain hosts file only when coming from dynamic inventory script say you have the following output from your dynamic inventory now try to run under ansible you will only get the hosts in you get the hosts plus group1 have narrowed this down bit it did not happen at this commit couple of unworking merges later it starts happening have not yet been able to track down the issue in code this has been reproduced on multiple machines and mac os and ubuntu 14 04 >>>bug_report
add proxycommand support to the paramiko connection plugin this pr adds openssh like `proxycommand` support to the paramiko connection plugin this is one problem that have at work as we have to use bastion to access all devices which forces us to use the `ssh` connection plugin regardless of whether the version of openssh supports `controlpersist` which requires us to configure `ssh args` to an empty string or even supply `controlpath` and such without `controlpersist` now you can set up your `ansible cfg` to have your proxycommand such as or this functionality requires `paramiko 0` which is included in the documentation and in the code what this pr does not address an inventory variable for supplying this configuration >>>feature_pull_request
invalid literal for int with base 10 when trying to add length of host group to serial issue type bug report ansible version ansible configuration changed nothing to default configuration except added hosts to etc ansible hosts` environment summary context first one in inventory file should always fail `172 19 250` second one in inventory file should be online `10 100 69 101` steps to reproduce ansible playbook groups vars expected results the length of the host group in string not int because it is converted by ansible to integer actual results as you can see at line `757` `serial int play serial >>>bug_report
weird msg src and dest are required for creating links error when using ansible inside docker build hi we re using ansible inside docker build to build an image for our jenkins nodes the template module issues an error and the workaround is even weirder for `template src yum conf owner root dest etc yum conf mode 644` result is but if add `state file` then it works although state file is not legal parameter for the template module and indeed this does fail when used on another non container vm in our shop suspect this had something to do with the way that underlying storage driver handles files in the end that is copying symlinking hard linking and more advanced tricks when files are the same versions in container ansible docker storage driver overlay currently preparing demo github repo to reproduce that issue >>>bug_report
fix last commit make it python3 compatible>>>bugfix_pull_request
update playbooks intro rst if you follow the documentation through in order you shouldn have read about modules yet >>>docs_pull_request
better module error handling now module errors clearly state msg module failure module stdout and stderr go into module stdout and module stderr keys which only appear during parsing failure invocation module args are deleted from results provided by action plugin as errors can keep us from overwriting and then disclosing info that was meant to be kept hidden due to no log fixed invocation module args set by basic py as it was creating different keys as the invocation in action plugin base >>>bugfix_pull_request
corrected role path search order the unfraking was matching roles in current dir as it always returns full path pushed to the bottom as match of last resort fixes 13645>>>bugfix_pull_request
solved route53 in v2 init got an unexpected keyword argument health check getting strange error with the route53 module have tested it on all alpha beta and rc tags alpha1 through rc3 the following works without error on sample playbook only domain name sanitized error >>>bug_report cloud
role search path precedence change in v2 in the path precedence appears to be playbook dir roles playbook dir in the path precedence has changed to what appears to be playbook dir playbook dir roles to validate this the file tree looks like ansible cfg in this case is completely empty test yml each `main yml` should contain single debug each with different message such as this causes completely non role related directory in the `playbook dir` to potentially override an actual role of the same name in the `roles` directory >>>bug_report
restart service is silent about failures centos rhel7 systemctl fails to stop audit but ansible service module is quiet about the failure >>>bug_report
fix typo in developing api rst>>>docs_pull_request needs_rebase
fix make tests py3 on devel fix for https github com ansible ansible issues 13638>>>bugfix_pull_request
also convert ints to bool for type bool>>>bugfix_pull_request
bug report make tests py3 is broken in devel ansible version last devel ansible configuration nothing special environment nothing special summary make tests py3 is broken steps to reproduce launch make tests py3 expected results tests ok actual results >>>bug_report
support aws named profiles as profile from aws credentials file when you have multiple named profiles in your aws credentials file on your local machine it would be nice to have the ability to specify which profile you would like to run playbook under for example `ansible playbook ec2 py profile production playbook yml` my aws credentials` file would look like this if you do not specify profile` then use the default as it does in current behavior >>>feature_idea
force success key value against play context and connection play context do not look for sudo prompt on second item run using with items for exemple for the same task fix https github com ansible ansible issues 13624>>>bugfix_pull_request
add support to create nested groups using group by for instance using the syntax below >>>feature_idea
group by creates incorrect groups we have two mysql masters and wanted to create an active passive group based on which server has the vip https en wikipedia org wiki virtual ip address so in the cause above `db 01 example com` is the master the debug playbook below shows the correct group names now comes the strange thing expected the `group by` statement below to work but it doesn the following statement does when debug `ansible eth1 1` use it as group name both machines have the same values so it looks like variables are not been reset >>>bug_report
ansible stable mysql db module login host arguments not affect run task of mysql dbget result assigned any value login user localhost 127 10 169 123 172 the error message is localhost always for some reason mysql will refuse localhost but will accept 127 and 10 169 123 172 such as run in shell >>>bug_report
0rc3 fetch module cannot deal with multiline argument if use for multiline strings in the fetch module this goes fine according to yaml spec the newlines are stripped but with it breaks the yaml resulting string then contains n` the point is this worked with ansible think it was an explicit goal to be backwards compatible so therefore report it outputs >>>bug_report
when var name is the same as var content try to template it before reporting that var is not defined add asserts in test var blending to check this special corner case >>>bugfix_pull_request
failed to launch docker container in trying to launch container with reload and expose >>>needs_info
move hostvars vars to vars this fixes duplication under hostvars and exposes all vars in the vars dict which makes dynamic reference possible on non hostvars this fixes regression from the fix in 5000>>>bugfix_pull_request
remove new inventory since that unused the class have been either moved or reimplemented elsewhere >>>bugfix_pull_request
ansible local connector misbehaves when using with items ansible crashes when creating links with items and using `ansible connection local` here an example playbook for reproducing the behavior the output is think the local connector misbehaves with more then just the file module when using `with items` have another issue open pip module does not work with items in ansible 2552 https github com ansible ansible modules core issues 2552 where suspected the pip module having problems `with items` however the general error remains the same in both issues during the investigation of the other issue found out that the error for it was introduced with commit https github com ansible ansible commit 53e86f3130145ce40606cec32aef2858756a20ab which was merged with pr https github com ansible ansible pull 13261 haven checked if it is the same for this issue but it could be first trace >>>bug_report
update gce module to use json credentials this fixes issue https github com ansible ansible issues 13515 in backwards compatible way gcp now recommends using json credentials files rather than p12 files using json files also simplifies the onboarding process for ansible as it no longer requires openssl foo in order to get started this pr updates includes the following bumps the required libcloud version to 17 which allows for json credentials adds parameter `credentials file` that supplants `pem file` adds documentation for configuring via environment variables adds documentation for using gce service accounts rather than json files updates the examples to use the new `credentials file` parameter this pr has counterpart in the ansible modules core repository that enables this functionality in the modules themselves that one should be merged first or at the same time cc erjohnso >>>docs_pull_request
allow for non standard hostnames changed parse addresses to throw exceptions instead of passing none switched callers to trap and pass through the original values look at deprecating this and possibly validate at plugin instead fixes 13608>>>bugfix_pull_request
draft update json for module intermediate comms this is just the client side need to implement the server side in connection base classes to be used by each connection plugin >>>feature_pull_request
ansible variables were not passed to role recognized somewhat strange behavior bug it took me some hours to figure out what wrong let me explain it by the following example we have three roles each role comprising one file as following rolespath role1 tasks main yml rolespath role2 meta main yml rolespath role3 meta main yml what is working now when call the role2 within playbook everything works as expected the playbook would lead to the following correct output what does not work but when call the role3 the playbook would lead to the following error output further description it doesn matter if you set the role2 variable within the third roles meta main yml directly as shown in the example or introduce role3 variable even when you introduce further role4 which calls role3 and setting the role3 variable and even further roles in this scheme the error remains that role2 variable is undefined` >>>bug_report
stable cloudstack test cs instance more integration tests cloudstack extend test cs instance addressing recovering cloudstack test cs instance add tests for using display name as indentifier >>>feature_pull_request
fixed task variables precedence this pr would fix issue 13614 by simply moving the code block applying the task vars to the lines of code that otherwise would override the task vars >>>bugfix_pull_request
ansible task variable precedence is lower than in documentation the task variable `remote user` becomes overridden by the inventory variable `ansible user` >>>docs_report
adding documentation for the dig lookup 13126 here is the documentation for the dig lookup in addition to the dig lookup there also seems to be dnstxt lookup but have decided not to spend time documenting because it seems inferior to the dig lookup both in terms of supported options and especially in terms of result output the dnstxt lookup does not seem to be able to handle records with multiple values in particular does not return coma separated list and can return proper list in case of wantlist true it might be better to remove deprecate the dnstxt lookup altogether do let me know if you would prefer to have docs for the dnstxt lookup too though >>>docs_pull_request
add guestfs connexion plugin this permit to edit base image in similar fashion to packer thus permitting for example to customize base image before uploading them directly to glance or similar services for openstack enabling immutable server deployment it can be used like this cat hosts fedora 22 ansible ssh host fedora cloud base 22 20150521 x86 64 qcow2 ansible connection guestfs cat deploy yml hosts fedora 22 roles somerole ansible playbook hosts deploy yml for now it only support local vm with single os but it should be trivial to add support for remote disks and multiple os >>>new_plugin
win get url doesn work on ansible v2 works fine on but not on v2 devel error >>>bug_report needs_info windows
ansible user is ignored in the inventory file it seems that specifying an ssh user in the inventory file is ignored in ansible steps to reproduce setup some host which does not have the user you are logged in as on your ansible host and configure passwordless ssh access create an inventory file which contains something like this somehost somehost example com ansible user someuser issue `ansible all vvvv ping inventoryfile` you will see that ansible tries to login as you not as the stated ansible user only workaround for now is to specify user someuser at the command line >>>docs_report
enable use of non standard hostname in inventory if the host given cannot be parsed in hostnae port tuple then it might be different format and used by alternative connexion plugin fixes 13608>>>bugfix_pull_request needs_revision
no longer able to use non standard hostname in inventory am trying to work on connection plugin using guestfish to modify disk image directly and while testing on devel 07a00593066cb stumbled on few hurdles like this after digging found that this function https github com ansible ansible blob devel lib ansible parsing utils addresses py l167 kinda filter all non standards address and reutnr none none unless am careful into what give for argument this also break connection plugins like chroot jail and potentially the docker one >>>bug_report
fixed import typo for memcache module in tests the typo caused the test for the memcached cache plugin to be skipped even when the necessary memcache python module was installed >>>bugfix_pull_request
include in rescue block is included but does not run issue type bug report ansible version v2 rc2 ansible configuration default from pip install environment fedora centos locally reproducible summary running command directly in the rescue block works as follows roles tasks main yml tasks block debug msg execute normally command bin false rescue debug msg rescuing output ansible playbook vv playbooks test yml no config file found using defaults warning provided hosts list is empty only localhost is available plays in playbooks test yml play include test role task test debug msg execute normally ok localhost changed false msg execute normally task test command fatal localhost failed changed true cmd bin false delta 00 00 001340 end 2015 12 18 15 10 27 252622 failed true rc start 2015 12 18 15 10 27 251282 stderr stdout stdout lines warnings task test debug msg rescuing ok localhost changed false msg rescuing play recap localhost ok changed unreachable failed however if move that debug to rescue yml file and include it instead the debug does not run see following example roles tasks main yml tasks block debug msg execute normally command bin false rescue include rescue yml and roles tasks rescue yml debug msg rescuing the output of the ansible run with the include is as follows ansible playbook vv playbooks test yml no config file found using defaults warning provided hosts list is empty only localhost is available plays in playbooks test yml play include test role task test debug msg execute normally ok localhost changed false msg execute normally task test command fatal localhost failed changed true cmd bin false delta 00 00 001356 end 2015 12 18 15 11 35 071738 failed true rc start 2015 12 18 15 11 35 070382 stderr stdout stdout lines warnings task test include included home dmsimard dev ansible playbooks roles test tasks rescue yml for localhost play recap localhost ok changed unreachable failed expectations would expect an included task file to actually run it contents in the examples above this would mean running the debug module inside the rescue yml file >>>bug_report p2
can disable warning about duplicate dict keys when parsing yaml issue type bug report feature idea ansible version latest and v2 rc2 ansible configuration nothing relevant environment osx summary the warning about duplicate dict keys when parsing yaml is annoying for legitimate use cases and there should be feature to disable it steps to reproduce use yaml anchors aliases extensively to make my giant var files much easier to read the following gist demonstrates what doing and what seeing https gist github com mspiegle ef4630cbdf8b18f93613 the ansible code responsible for this is https github com ansible ansible blob v2 rc2 lib ansible parsing yaml constructor py l67 expected results either expect ansible to not bother me about this or provide some way for me to disable this particular warning actual results get lots of warnings about duplicate dict keys the duplicate dict keys are completely normal and expected in my use case >>>feature_idea
ansible runs setup for all plays when run with cat master yml include home kevin git scrye ansible playbooks one yml include home kevin git scrye ansible playbooks two yml cat playbooks one yml name one playbook hosts td gather facts true tasks name test command uptime tags one cat playbooks two yml name two hosts peven gather facts true tasks name test command uptime tags two ansible playbook root inventory two master yml with play one playbook task setup ok td play two task setup ok peven task test changed peven play recap peven ok changed unreachable failed td ok changed unreachable failed ansible playbook root inventory two master yml with play two gathering facts ok peven task test changed peven play recap test 29s peven ok changed unreachable failed >>>bug_report
docker api fail installed python and the newest docker py this is my role name nginx docker docker name nginx image nginx latest below the output of the ansible playbook whats going wrong failed docker02 meisters io failed true parsed false invalid output was traceback most recent call last file root ansible tmp ansible tmp 1450433454 29 214084830665893 docker line 2130 in main file root ansible tmp ansible tmp 1450433454 29 214084830665893 docker line 723 in main containers manager create containers file root ansible tmp ansible tmp 1450433454 29 214084830665893 docker line 596 in create containers containers do create count params file root ansible tmp ansible tmp 1450433454 29 214084830665893 docker line 584 in do create result self client create container params file usr local lib python2 dist packages docker api container py line 115 in create container volume driver file usr local lib python2 dist packages docker api container py line 120 in create container config return utils create container config self version args kwargs file usr local lib python2 dist packages docker utils utils py line 736 in create container config mem limit has been moved to host config in api version 19 docker errors invalidversion mem limit has been moved to host config in api version 19 fatal all hosts have already failed aborting>>>bug_report needs_to_be_moved
add something like role name to possible variables in ansible managed feature idea now ansible managed supports only file host uid and `strftime` variables it would be convinient to add role name variable so that you can explicitly see what role created this file by setting `ansible managed ansible managed file from role role name on host `>>>feature_idea
gce dynamic inventory script is not compatible with apache libcloud v0 20 hi tried generating dynamic inventory using properly configured secrets py gce py script and got next issue while running it please go to the following url and sign in https accounts google com oauth2 auth bunch of parameters enter code following the link got error redirect uri mismatch the redirect uri in the request urn ietf wg oauth oob can only be used by client id for native application it is not allowed for the 39 web 39 client type you can create client id for native application in the credentials section of the google developers console everything works fine if apache libcloud is downgraded to 19 version >>>bug_report cloud
add filtered stdout callback plugin this plugin filters output for any task that is ok or skipped it works by subclassing the default stdout callback plugin and overriding certain functions it will suppress display of the task banner until there is changed or failed result or an unreachable host >>>needs_revision new_plugin
ansible env shows root environment despite become false on play issue type bug report ansible version encountered in ansible version ansible configured module search path none also tested vs devel branch ansible configuration these are all of the non blank non comment lines in my local `ansible cfg` also tested with the entire privilege escalation section commented out this had no effect on the issue also tested with an entirely blank ansible cfg as follows this configuration behaved as expected saw the environment variables for my userid and not root environment all testing was done locally on osx yosemite summary ansible displays the root sudo environment variables instead of the actual user environment steps to reproduce example playbook expected results expect to see the environment variables for my actual userid which can get if set an absolutely blank ansible config actual results see the environment variables for the root user it seems that something in the config file is causing ansible to drop into sudo mode despite it being explicitly disabled for the play >>>bug_report
stdout can not be retried for ansible v2 have the following code working for ansible however after upgrading to v2 it returns the error as can anyone help thanks my system is ansible ubuntu 15 04>>>bug_report
add support for environment variable defined ec2 instance filters this change adds support for defining ec2 instance filters in an environment variable called `ec2 instance filters` filters defined in that environment variable will be used in addition to any filters defined in `instance filters` in `ec2 ini` >>>feature_pull_request
revert to standard port if non standard port not open this is ansible version patch to revert to the standard ssh port if the non standard port is not open please refer to the stable pull request for the rationale for this patch it has been tested and works as expected >>>feature_pull_request needs_info
can open file setup issue type bug report ansible version ansible configured module search path none installed from epel ansible el6 noarch rpm ansible configured module search path none installed from pip ansible configuration no changes to etc ansible ansible cfg ansible cfg defaults remote user pfletcher sudo flags environment centos on both ansible host and systems being managed summary running playbook with become fails to run with `become success stjyuijbzkkzijzfuuyuvtaisqglfkxb usr bin python can open file setup errno no such file or directory` unless re using an already existing ssh connection the problem appears to lie somewhere in or below `connection communicate of the ssh connection plugin what happens is that stdout of the remote command gets lost in this case resulting in `runner execute module having incorrect information about where the module has been copied to thus when it tries to execute it it fails here trace from failed run and here one when it works what you can see is that although in both cases the remote temporary directory is created in the failed case that directory is not actually used as the destination for the put or the following execute the execute then fails because the home directory for root who is executing the command is not the same as the user who put the file as say the cause is that the path is read from stdout of the first command which creates the temp directory but it gets lost steps to reproduce log in to new session on the host running ansible run any playbook with fact gathering and become enabled against remote host ansible playbook dns vvv poison dns yml the playbook fails as shown below within 60 seconds before the control connection times out re run the same command this time it succeeds as shown in expected results expected results actual results note sometimes when re using an existing connection and fact gathering has succeeded have had the playbook fail in the same way later on with different module filename is usually `command` in that case >>>pending_closure
enhancement ability to wrap blocks around other content such as roles in addition to tasks the blocks feature from ansible is great but as the documentation http docs ansible com ansible playbooks blocks html and my various attempts shows it can only be used in the scope of tasks list it would be awesome if you could use blocks elsewhere as well such as to wrap around roles here two example playbooks to explain what mean playbook1 yml name create test environment hosts localhost roles role create test environment it is expected that any of these tests can and will fail but laid out like this the testing environment will not be destroyed if there are any failures in the tests unless they are plastered with ignore errors everywhere would love to wrap the content of this playbook in block to ensure the test environment would always be destroyed name test things hosts nodes roles role test one role test two role test three name destroy test environment hosts localhost roles role destroy test environment and playbook2 yml name run tests hosts nodes pre tasks name create test environment roles role create test environment roles it is expected that any of these tests can and will fail but laid out like this the testing environment will not be destroyed if there are any failures in the tests unless they are plastered with ignore errors everywhere would love to see post tasks executed even if there was failure in the tests role test one role test two role test three post tasks name destroy test environment roles role destroy test environment >>>feature_idea
update with items variable example to remove unnecessary quotes if you use the example as written it does work fine but you re given warning message as pointed out in https github com ansible ansible issues 6407 issuecomment 37362386 it preferable to drop the quotes in this case for simplicity and elegance it be good to follow that in the docs too rather than lead people into confusing warning messages >>>docs_pull_request
no path in environment results in permission denied for tasks on localhost issue type bug report ansible version ansible config file etc ansible ansible cfg configured module search path usr share ansible environment debian jessie but should not matter summary if path is not set in the environment ansible uses an empty string for `ansible python interpreter` for localhost this leads to task failure with permission denied when running tasks on localhost the problem did not appear with ansible as shipped with debian and only appeared when switched to the development version steps to reproduce root foo env home root ansible shell localhost expected results localhost success rc actual results localhost failed rc bin sh root ansible tmp ansible tmp 1450293879 27 221034150901375 command permission denied here the same command with path root foo env home root path usr sbin usr bin sbin bin ansible shell localhost localhost success rc the reason for this is that in https github com ansible ansible blob devel lib ansible inventory init py l453 the python interpreter for localhost is set to `sys executable` which is empty if path is empty root foo python import sys print sys executable usr bin python root foo env python import sys print sys executable the shebang for the shell module is then set to while preparing the module for execution which leads to the `permission denied` message spotted this when running an ansible playbook from remote host through `remctl` which does not set path so there is an actual use case where this problem might occur could not find better way to reliably determine the python interpreter than using `sys executable` so would suggest to print warning message and ask the user to set `ansible python interpreter` in the inventory if `sys executable` is empty because it is really not obvious that no path results in permission denied >>>bug_report needs_info
with items variable name template broken worked in issue type bug report regression ansible version ansible f41dd578b340b76aa706af9540fd8fab2fbb0eb6 ansible configuration self packaged version based on above revision environment opensuse leap 42 summary substituting variable names based on other variables does not work in ansible but used to work in this should either be fixed or stated more prominently in the changelog as it breaks existing playbooks steps to reproduce example playbook expected results variable packages install 42 is used the packages bash and zsh are installed actual results the task fails >>>docs_report
unexpected exception execv arg must contain only strings issue type bug report ansible version ansible ansible configuration ssh connection ssh args environment ubuntu 12 04 ubuntu 15 04 summary running simple playbook with debug task produces the error unexpected exception execv arg must contain only strings steps to reproduce hosts all gather facts false tasks name test action debug msg hello stranger ansible playbook playbook json example com expected results play task test ok example com changed false msg hello stranger play recap example com ok changed unreachable failed actual results play task test unexpected exception execv arg must contain only strings to see the full traceback use vvv>>>bug_report p2
revert to standard port if non standard port not open if host is to be built and use non standard ssh port it is reasonable that changes to its configuration ssh iptables firewall etc be accomplished through ansible consider the following playbook which modifies the ssh port in the common role file cloud yaml build an openstack cloud hosts osctl oscmp roles common hosts osctl roles osctl hosts oscmp roles oscmp hosts osctl tasks include roles oscmp tasks verify yaml the playbook fails after the second play with an ssh port error the inventory has to be changed for both hosts and the playbook rerun this commit tests the non standard port on the target and if it is not open sets the standard ssh port the inventory can then be created with all non standard ports defined and will execute correctly even on the first execution this is particularly useful when repetitively rebuilding virtual machines this was developed and tested on ansible and second fix pull request submitted for version >>>feature_pull_request needs_info
bug with lookup of jinja2 templates the following line works in but fails in error message it works if you put quotes around the data structure but this is only test case my real use case is in the uri module with body format json this doesn work if the json body is surrounded in quotes thanks mike >>>bug_report
directly referenced roles in play collide if the base name is the same issue type bug report ansible version `ansible 0` installed via `pip install git https github com ansible ansible git devel egg ansible upgrade` environment local box os 10 11 target box ubuntu wily summary directly referenced roles in play collide if the base name is the same steps to reproduce set up play like this with two roles referenced outside the role search path expected results since the roles are the same names but different folders each role should be run distinctly actual results the first role runs as the first and second role like it cached or something >>>bug_report
bug report current working dir setted as shell working dir issue type bug report ansible version environment xubuntu 14 10 summary reported 13472 but https github com ansible ansible commit 6a252a3f7727649c61c007e73f04201fd6fbdfa8 commit doesn fix the first issue steps to reproduce playbook expected results like ansible actual results >>>bug_report
using yaml anchors and aliases does not work for include variables issue type bug report ansible version git201512071813 cc98528 stable20 unstable ansible configuration default environment ubuntu 14 04 summary tried to use yaml anchors and aliases to avoid repeating myself in left group right group playbook unfortunately task `include` using an alias did not get the include variables interestingly using deprecated variables at the top level of the task does work correctly steps to reproduce this playbook demonstrates the problem file `test yml` file `test tasks yml` expected results actual results note the debug output of the second task of the first play >>>bug_report
int filter not functioning properly operating system osx ansible version this playbook produces the following output expected is an integer value of and not string >>>bug_report
fix typo>>>docs_pull_request
test for filename option in apt repository module test for pr ansible ansible modules core 2696 tested on ubuntu 14 04 lts cc nitzmahone >>>feature_pull_request
feature idea diff output for lineinfile with diff breif issue type feature idea ansible version latest pypi ansible configuration nocows environment ubuntu lts based any summary `diff` mode support for `lineinfile` ansible version verbatim output ansible configuration environment host ubuntu14 04 or derivities linux mint cinnamon 17 target ubuntu 12 04 summary the core module `lineinfile` does not support the diff flag mode this leads to deploying changes with total blindness to what was removed and changed offering only what was intended to be added as described by the original lineinfile call reproduction steps to reproduce use core module `lineinfile` to change file with the diff` flag mode expected results diff style output of what changed similar to templates actual results no diff or change details displayed >>>feature_idea
devel handlers crashing with ssh error connection refused issue type bug report ansible version according to `git bisect` this is the first commit 120b9a7ac6274c54d091291587b0c9ec865905a1 where the error occurred jimi fyi ansible configuration environment summary ansible is going to crash when handler is fired in the current devel version steps to reproduce excepted results fired handler without an error actual results >>>p2
rc1 ansible galaxy no longer respects path in requirements file issue type bug report ansible version ansible f2225395f96d5c309dddc66fafd984862d99b708 ansible configuration no changes environment arch linux summary my existing requirements yml files from using and older now don install roles into their specified directories but instead tries to use the global roles directory steps to reproduce just using random role from github cd mktemp cat requirements yml eol src git https github com sfromm ansible epel git name epel path eol ansible galaxy install requirements yml expected results ansible galaxy install requirements yml executing git clone https github com sfromm ansible epel git epel executing git archive prefix epel output tmp tmp4uedr0 tar head extracting epel to epel epel was installed successfully actual results ansible galaxy install requirements yml extracting epel to etc ansible roles epel warning epel was not installed successfully error could not update files in etc ansible roles epel errno 13 permission denied etc ansible roles error you can use ignore errors to skip failed roles and finish processing the list >>>bug_report
task that uses delegate to references ansible ssh pass from previous host issue type bug report ansible version ansible configuration environment running ansible from mac os 10 10 managing ubuntu 14 04 lts summary tasks that uses delegate to references ansible ssh pass from previous host steps to reproduce expected results actual results additional notes managed to fix this issue temporarily by modifying line in the compute delegate method of the runner class in lib ansible runner init py from to >>>bug_report
do handler run takes at least arguments given issue type bug report ansible version `v2 rc2` ansible configuration `ansible cfg` environment control node os fedora 23 destination node os centos summary role wrote and maintain has `notify` for `get url` task this notifies handler which includes playbook when change for the `get url` task triggers the handler the following is returned steps to reproduce the `get url` task with the `notify` https github com rocketchat rocket chat ansible blob ansible tasks main yml l79 the handler https github com rocketchat rocket chat ansible blob ansible handlers main yml l6 the playbook included by the handler https github com rocketchat rocket chat ansible blob ansible tasks upgrade yml the meta flush handlers` task does not affect this in any way the same happens with or without it or regardless of its position in the playbook expected results the handler should run include the playbook and execute the tasks within said playbook thanks thanks in advance for any help on this please do let me know if there any further information can provide that would aid investigation >>>bug_report p2
feature request install dependencies with ansible pull hi `ansible galaxy` command has great feature install dependencies option with requirements yml however `ansible pull` can use directly this feature it clones and launch playbook we have to manually clone repository ansible galaxy repository playbook yml ansible pull or ansible playbook limit hostname local expected thank you emilien>>>feature_idea
enviroment provided vars are not properly quoted ansible this is my playbook and then ansible fails bin bash su root bin bash echo become success scmdgyaubdelofihozrflttaywwjxaaz lang cc gcc m32 lc ctype usr bin python tmp ansible tmp 1450188742 95 103516450292967 command rm rf tmp ansible tmp 1450188742 95 103516450292967 dev null m32 lc ctype usr bin python tmp ansible tmp 1450188742 95 103516450292967 command rm rf tmp ansible tmp 1450188742 95 103516450292967 dev null line unexpected eof while looking for matching m32 lc ctype usr bin python tmp ansible tmp 1450188742 95 103516450292967 command rm rf tmp ansible tmp 1450188742 95 103516450292967 dev null line syntax error unexpected end of file erasing is the same result >>>bug_report
host vars do not get fully loaded when using inventory directory and limit issue type bug report bugfix pull request ansible version ansible configuration environment inventory host vars h1 host vars h2 playbook yml summary host vars are not loaded when using inventory directory and limit flag steps to reproduce ansible playbook playbook yml h1 expected results actual results >>>bug_report needs_info
fix loading host group vars when inventory is directory and using limit fixes 13557>>>bugfix_pull_request needs_info
adds support for using ssh keys to ssh shared module updates the ssh shared module will try to use keys if the password is not supplied the current ssh shared module forces only password based authentication this change will allow the ssh module to use keys if password is not provided >>>feature_pull_request
use six lib to import urlparse properly fix part of python tests make tests py3 see https github com ansible ansible issues 13553 for more details >>>bugfix_pull_request
make tests and tests py3 is broken in devel issue type make tests is brocken in devel ansible version ansible configuration nothing special environment nothing special summary make tests is broken steps to reproduce make tests expected results actual results >>>bug_report
use wrapped connect to region everywhere in ec2 py this is bug fix which in particular adds respecting of `boto profile` when fetching elasticache data >>>bugfix_pull_request cloud
strange error the conditional check in the handler of role in ansible issue type bug report ansible version stable b6dac26 ansible configuration environment mac os el capitan 10 11 summary have playbook in which use certain roles that memcached role was written uses the pieses of bennojoy memcached module https github com bennojoy memcached here is the structure when execute playbook face this error `ec2 tag role` and `ec2 tag environment` come from ec2 py dynamic inventory script the same playbook works pretty fine with version expected results workeable handler>>>bug_report needs_info
make module utils known hosts get fqdn work on ipv6>>>feature_pull_request
add openstack inventory configuration there are two behaviors which want to be configurable for openstack inventory this adds the ability to configure them but defaults the behavior to the existing behavior this requires https review openstack org 246587 and https review openstack org 257437 to land and release before it useful but it should fail safely to current behavior without them >>>bugfix_pull_request feature_pull_request
ansible vault ask pass use default settings from ansible cfg>>>bugfix_pull_request
ansible pull should support skip tags issue type feature idea ansible version ansible configured module search path none ansible configuration none environment summary ansible pull should allow skip tags flag just as ansible playbook does it does support tags and the reverse would be very helpful steps to reproduce believe this features is equally useful as in ansible playbook command expected results actual results a>>>feature_idea
variables in ansible managed should be available for use in playbooks the default configuration for ansible managed is `ansible managed ansible managed file modified on by uid on host the variables uid host and file can be used directly in playbooks if you wanted to use the uid variable you have to run local task to obtain it hosts all tasks name get local username local action command usr bin whoami register local username connection local name output value of local username debug msg local username is local username stdout can we make these variables available for use in playbooks >>>feature_idea
fix multiple backup these commits fix problem when multiple backup files are created within the same second previously the original file contents would be lost this changes the behaviour to not overwrite existing backup files it is better to have only one backup file for number of related changes than to not have backup of the original file contents at all >>>bugfix_pull_request
user module set admin to standard on osx have task which needs to set the user default shell to zsh after run the user will be set from admin user to standard user thus lose admin privileges my osx version 10 10 ansible version >>>bug_report needs_info p2
add version check callback plugin this callback module checks if the ansible version that is used to run the playbook matches the ansible version specified in the requirements file >>>feature_pull_request new_plugin
add full flag to ansible pull man page add full flag that was added in 13502 >>>docs_pull_request
fix doc mistake fix doc mistake in ansible docsite rst playbooks variables rst>>>docs_pull_request
debug now validates its params simplified var handling made default message the same as in pre fixes 13532>>>bugfix_pull_request
debug action plugin silently ignores bad parameters after looking through the code and noticing the `fail` option for the `debug` action plugin decided to try it out messed up and set `failed yes` and was confused about why nothing happened the plugin should probably tell me that being an idiot >>>bug_report
tilde expansion fails with copy module issue type bug report ansible version ansible rc2 environment ubuntu server 15 04 vivid vervet cloud image on aws ec2 summary running the copy module with the dest requiring tilde expansion results in an index out of bounds error steps to reproduce run the copy module with tilde expansion in the dest path the following is output from vvv` run of the `copy` module with project build repo` as the dest manually expanding the tilde to home avoids the issue here the offending line https github com ansible ansible blob eefb4931dd4e9489ff68aa332493e5ef2468d121 lib ansible plugins action init py l336 >>>bug_report needs_info
choose random filename for the remote module file suggested fix for 13527 please see the issue for additional information >>>bugfix_pull_request
yum module doesn call rhnplugin because module file is named yum when rhel centos server is managed via spacewalk rhn satelite yum uses `yum rhn plugin` to get meta data from the spacewalk server instead of querying the repos directly example task `cityfan` http www city fan org ftp contrib yum repo rhel7 x86 64 generated output `rhnplugin py l94 l104` https github com spacewalkproject spacewalk blob 4d2d833a1d5baf92a4c01883e04ac2aa9f57aa0e client rhel yum rhn plugin rhnplugin py l94 l104 checks if the basename of the invoked command is `yum` and if there are no parameters `cmd args the problem is that ansible executes the yum module under path similar to home ansible ansible tmp ansible tmp 144929 24 4078098 yum` so the basename is `yum` and there are no parameters which causes `yum rhn plugin` to never actually query the server the repolist stays empty `centos x86 64 cityfan` is never found and the task fails here yum py l926 https github com ansible ansible modules core blob 74609ce42cb140dba528fee18422467a32acd995 packaging os yum py l926 with `enablerepo` being the repo name spacewalk yum isn the only project to check if it executed in certain way by checking its `argv so in order to fix this suggest to randomize the executable name just like the path to the dropped ansible module python file `yum 6812` what are your thoughts on this >>>bug_report
failed to connect to windows host at handlers section issue type bug report ansible version environment ubuntu 14 04 summary failed to connect windows host at handlers section the connection at handlers section seems to be ssh although the target host is windows steps to reproduce the playbook is below and the inventory is actual results with debug option >>>bug_report
deb package cannot be built from release tarballs on releases ansible com the release tarballs at https releases ansible com ansible cannot be used to build deb packages because they are missing most of the contents of the `ansible packaging directory the `make deb` run fails with it appears that all of these tarballs have this same problem >>>bug_report
dynamic set of module var fails with template error encountered unknown tag endif problem ansible `2 0` returns template error encountered unknown tag endif when using conditional module args such as in this example error steps to reproduce create `inventory hosts` file with content create `templates gitconfig` with content create `files ssh config` with content create `example playbook yml` with content run playbook with >>>bug_report
inventory file host processing order changed in earlier versions of ansible tried very hard to ensure my hosts were processed in specific order but in recent versions my hosts get processed in some unordered fashion understood this might happen if ansible were processing hosts in groups but am using serial to ensure the hosts are processed at time how can ensure that my hosts get processed in sequence this is how was ensuring sequence would run my playbook using deploy to verify for example as my targets the idea was that the sequence would be built based upon how the groups are defined >>>bug_report
subsequent plays in multi play playbook don run when block rescue runs ansible configuration yesterday stable branch environment centos summary in multi play playbook which contains block with rescue if the rescue runs due to failed task then subsequent plays don run steps to reproduce expected results should move onto the second play but doesn actual results stops after first play >>>bug_report
unhelpful error from apt repository module when python apt is not installed when try to use the `apt repository` type on host that doesn have the `python apt` package installed ansible gives an unhelpful error message running with vvv` gives me the full traceback >>>bug_report
issue 2625 we can use this as workaround until we decide what is to be done with the issue itself https github com ansible ansible modules core issues 2625 >>>bug_report needs_revision
v2 error with args form issue type bug report ansible version devel ansible playbook detached head e56efa49c4 last updated 2015 12 11 17 08 24 gmt 200 lib ansible modules core detached head 0d23b3df52 last updated 2015 12 11 17 08 46 gmt 200 lib ansible modules extras detached head 51813e0033 last updated 2015 12 11 17 08 46 gmt 200 config file configured module search path default overrides ansible configuration none environment debian steps to reproduce ansible playbook args1 yml ansible playbook args2 yml ansible playbook args3 yml expected results actual results notes same results with >>>bug_report
dynamic inventories with command options does not work using ansible 157230c3e83731e it seems that specifying dynamic inventory and parameters do not work as descried at http docs ansible com ansible intro dynamic inventory html other inventory scripts have python dynamic inventory file that want to use like inventory file inventories local hosts profile >>>docs_report
doc for gce module refer to outdated auth strategy the docs recommend using gce credentials in p12 format and converting to pem however running the module libcloud informs you that this is deprecated and you should download use credentials in json format instead upon trying this it does work >>>docs_report
task entry environment is not autotemplated the issue remarked here https github com ansible ansible issues 11912 seems to be back trying to use variable in environment field as follows the variable is defined in vars main yml as follows on reaching this task get the following error even the documentation says this should work http docs ansible com ansible playbooks environment html look at the code titled the environment can also be stored in variable and accessed like so my ansible version is as follows just did an install from the git repo could you please suggest me workaround for the time being thank you it great to use ansible has saved me so much time can imagine few hours for repeatable stack configuration is just beautiful >>>bug_report
error file for role user must contain list of tasks on simple role have simple playbook with few simple roles that work properly in in both rc2 built via make deb and nightly build from this morning get this error the entire contents of this file are this is with python on debian jessie ish it really raspbian >>>bug_report
clean up debug logging around low level execute command we were logging the command to be executed many times which made debug logs very hard to read now we do it only once also makes the logged ssh command line cut and paste able the lack of which has confused number of people by now the problem being that we pass the command as single argument to execve so it doesn need an extra level of quoting as it does when you try to run it by hand >>>bugfix_pull_request
create module update json function to return output before end this function would work like fail json exit json and could be used by modules to return data before the module end this would be the first step for in module updates ansible side code should also be modified to report on this data we should also modify run command with `update false true` option for when executing command line utilities that might also be sending back output >>>feature_idea
performance degradation between rc1 to rc2 of issue type bug report ansible version rc2 ansible configuration standard install environment summary steps to reproduce expected results timing to be 0rc1 timing increased see below results actual results >>>bug_report
fix default host for non vcd service types fixing bug addressed by this pr https github com ansible ansible modules extras pull 1355>>>bugfix_pull_request cloud
backport v2 dynamic connection args to winrm pywinrm has the ability to ignore cert validation on python but we don have way to tell it to do so in backport the ansible winrm args handler from to allow passing arbitrary args to pywinrm >>>backport easyfix p1
task includes are not processed on play compile this causes slew of issues with list options handlers and other functions as seen in the following 12718 13260 13292 >>>bug_report
explain how run once interacts with serial think this is an important piece of information and there are quite few google results showing people having trouble with this >>>docs_pull_request
regsiter no longer working this task used to work fine but now get fatal error `fatal machine failed failed true msg error result is undefined am using this version of ansible playbook >>>bug_report
use shallow clones by default in ansible pull allows shallow checkouts in ansible pull by adding depth 1` or higher number fixes 8620 maybe it would be nicer to do this by default and add full` option for complete checkout the patch is work in progress and not thoroughly tested yest >>>feature_idea
galaxy update improved documentation man page tweaks to galaxy rst added galaxy section to configuration doc quashed overloaded command options removed the helpful list of galaxy commands fixed handling of ignore certs fixed bug in search command terms were being added to the query in reverse order >>>bugfix_pull_request needs_revision
fix the markdown used for the windows module section>>>docs_pull_request
confusing ansible command with ansible playbook as new user spent considerable time trying to fix issues when ansible kept saying no hosts matched to the command ansible prod site yml only to realize that playbooks are run with ansible playbook ansible command should add hint warning about this in certain instances particularly like the error reply that the main usage which is obviously playbooks is via ansible playbook >>>feature_idea
feature request make version valid role metadata attribute problem due to the shifting changing behavioral nature that comes along with using any shared library dependencies it is important to be able to lock dependency to specific version to avoid breakage because ansible playbooks can depend on roles which may change behavior over time it important to be able to specify which version of role the playbook was built to work with `ansible galaxy` already has this functionality by means of leveraging git `ref`s or `tags` however when sourcing roles from the ansible galaxy site there is no way of determining or locking to specific version of role additionally other alternative ansible role dependency manager type tools such as librarian ansible have solved this problem by allowing `version` key to be specified inside role `meta main yml` file however with ansible `2 0` warning is produced for any roles which have been using the `version` key in their metadata proposed solution add feature to ansible `2 x` that allows the use of `version` key within role `meta main yml` file add feature to `ansible galaxy` that understands the `version` key when pulling roles from ansible galaxy http docs ansible com ansible galaxy html advanced control over role requirements files https github com bcoe librarian ansible specifying version s>>>feature_idea
do not fail when variable is not correct in debug action see https github com ansible ansible issues 13484 for more information you can retrieve original playbook at the following location https github com yannig ansible issue low speed blob master issue vars inconsistent typing yml without the patch with this patch >>>bugfix_pull_request
ansible galaxy fails with error unsupported galaxy server api version api v1 issue type bug report ansible version ansible devel ansible configuration no changes environment mac os 10 11 summary installing ansible roles from requirements file fails with error unsupported galaxy server api version api v1 this has been definitely working before at first glance ansible lib ansible galaxy api py galaxyapi supported versions list seems to contain something like v1 but url paths are tested against it api v1 steps to reproduce install role via requirements file with ansible galaxy you can see the error in action at https travis ci org benjixx goodplay builds 95871329 expected results install should succeed actual results error unsupported galaxy server api version api v1 >>>bug_report p2 pending_closure
mark added removed newlines in diff mode like in git diff output feature idea if only newline symbol was added removed output of diff mode may be confusing for user this leads to problems like this https github com ansible ansible issues 13476 https github com ansible ansible issues 8443 think it would be more convenient and error prone to explicitly mark newline add remove in diff output like `git diff` does >>>feature_idea
filters make it simple to get the next or previous element of list the usecase here is to build links between jenkins jobs in different stages stages test qa produdction and then in the job be able to trigger th in the next stage stages next elem current stage but not trigger anything after the production stage >>>feature_pull_request needs_rebase new_plugin
synchronize module breaks when ansible shell type fish using ansible devel https github com ansible ansible commit 04d74fd6804b5a851cc8762cecf07b100e4dcc6f using an account with fish as its shell can successfully use the synchronize module but if ansible shell type fish is set it breaks tried setting remote temp tmp in ansible cfg as the error message suggested but that made no difference >>>bug_report
galaxy added new commands login authenticate user prior to performing crud operations import and delete setup configure travis integration import import role from github repo into galaxy delete delete role from galaxy added travis yml see template in galaxy data added tests folder containing an inventory and test yml playbook to be used by travis added github branch to meta main yml if set travis notifications will be accepted from this branch installs will come from this branch unless the repo has tags if not set the repo default branch will be used reworked search to point at search roles endpoint provide author option and present more usable results defined galaxy server and galaxy ignore certs in constants py revised docsite rst galaxy rst and added documentation for all ansible galaxy commands >>>feature_pull_request
avoid persistent containers in attribute defaults moved from the field attribute declaration and created placeholder which then is resolved in the field attribute class this is to avoid unwanted persistent of the defaults across objects which introduces stealth bugs when multiple objects of the same kind are used in succession while not overriding the default values >>>bugfix_pull_request
make sudo requiretty and ansible pipelining work together pipelining is significant performance benefit because each task can be completed with single ssh connection vs one ssh connection at the start to mkdir plus one sftp and one ssh per task pipelining is disabled by default in ansible because it conflicts with the use of sudo if defaults requiretty is set in etc sudoers as it is on red hat and su which always requires tty we can and already do make sudo su happy by using ssh to allocate tty but then the python interpreter goes into interactive mode and is unhappy with module source being written to its stdin per the following comment from connections ssh py we can only use tty when we are not pipelining the modules piping data into usr bin python inside tty automatically invokes the python interactive mode but the modules are not compatible with the interactive mode unexpected indent mainly because of empty lines instead of the current drastic solution of turning off pipelining when we use tty we can instead use tty but suppress the behaviour of the python interpreter to switch to interactive mode the easiest way to do this is to make its stdin not be tty with cat python this works but there problem ssh will ignore if its input isn really tty so we could open pseudo tty and use that as ssh stdin but if we then write python source into it it all echoed back to us because we re tty so we have to use tt to force tty allocation in that case however ssh puts the tty into raw mode icanon so there is no good way for the process on the other end to detect eof on stdin so if we do echo print hello world ssh tt someho st cat python it hangs forever because cat keeps on reading input even after we ve closed our pipe into ssh stdin we can get around this by writing special eof marker after writing in data and doing this echo print hello world eof ssh tt someho st sed ne eof python this works fine but in fact use clever python one liner by mgedmin to achieve the same effect without depending on sed at the expense of much longer command line alas python really isn one liner friendly there are two things to be careful of that we use the new pipelining behaviour only for execute module and not say remote checksum and that we use it only with the ssh plugin because the others don know to write the magic eof marker but the ssh plugin can just do the pipelining entirely by itself because the build module command output may be wrapped by make become cmd we also enable pipelining by default as consequence >>>bugfix_pull_request p2
special case where handlers not triggered with force handlers with items and ignore errors when you have list of items and using ignore errors force handlers doesn trigger the notify if the errored items are before changed items providing examples playbook force handler not triggered results force handler not triggered working playbook results working >>>bug_report needs_info
handlers don execute handlers in included when include file in handler the tasks in the included file are not executed in ansible playbook redis yml roles firewall handlers main yml roles firewall tasks firewall open port yml for ansible roles firewall tasks iptables iptables open port yml for ansible roles firewall tasks iptables iptables open port yml result when replace in playbook to it work well it bug or my mistake >>>bug_report
inconsistent variable type preservation issue type bug report ansible version ansible rc2 also verified on v1 and ansible edx where feanil has committed the same changes for the edx build of ansible ansible configuration no config changes this is reproducible in fresh checkout of v2 rc2 environment verified on debian testing stretch ubuntu 14 04 summary in ansible and lower variables of basic type are consistently cast to string when referenced in variables of complex types list map during the development of feanil from edx has committed several changes 10465 10957 to conserve the type of numeric boolean and null variables these types are correctly conserved during direct reference of these datatypes but it does not work in cases of indirect reference like so num num ref num results in numeric value of map num num results in numeric value of num ref num ref results in string value of no level of type conversion using the bool or int jinja filters is able to convert these values to the correct type as result seeing errors from systems like mongodb or this error from an aws api steps to reproduce the below playbook creates variables of several types `num var` `bool var` `null var` and additional variables ref` referencing the original variables in the case of the numeric variable `num cast ref` also attempts to convert `num var` during assignment map `var map` is created containing all the variables and in the case of `num var` several different variations of converting to an int are attempted in the map two tasks are present one to display the map and second that results in an evaluation failure on ansible assume due to the same inconsistent typing expected results would expect that in ansible with feanil patches that types would be preserved unless an explicit conversion has occurred using jinja2 filter actual results playbook invoked via `ansible nocows ansible playbook test case yml hosts` in all cases ansible stock basic types are consistently cast to string ansible edx direct basic types retain their type information indirectly referenced types are cast to string ansible 7rc2 output direct basic types retain their type information indirectly referenced types are cast to string references to null defined via python `none` can result in an undefined error >>>bug_report
ansible does not copy the command file to remote server having very strange issue ansible seems to fail sending its command file to the remote server before executing them ansible version inventory file ansible cfg tried several options here is the version kept issue what sounds strange to me is the `put`line that differs between the two servers it looks like ansible is not able to determine where to put the local file on the remote location >>>bug_report
windows adding integration tests for win regmerge extras module hello now that the win regedit module has been fixed am able to contribute these tests for my win regmerge module the tests use win regedit as well as win regmerge to test you will need to pull https github com ansible ansible modules extras pull 1166 >>>bugfix_pull_request feature_pull_request
role dependency never included again when skipped in first role hi say that you have common role including vars that bunch of other roles always includes as dependency in playbook you call your different roles and the first one is skipped for some reason then the role dependency is skipped which is normal but it is never called again by the other roles understand the need to call the dependency only once but for me it has to be executed at least once if it is skipped in the first role then it must be called again by another role to be able to include our vars in our case please find below copy of our playbook execution and detailed explanation thanks ludo we have common role geppetto include vars which is included as meta in other roles geppetto create node and geppetto update component as you can see geppetto include vars is called by geppetto create node which is skipped which is fine but when executing the next role geppetto update component the geppetto include vars dependency is not called it should be as it has been skipped in the first role and the variables have not been loaded task geppetto include vars load geppetto vars if needed 10 22 24 117946 start tasks for all host skipping 127 task geppetto create node call geppetto web service 10 22 24 151637 start tasks for all host skipping 127 item geppetto create node nodename list task geppetto update component set geppetto update component namespace 10 22 24 264924 start tasks for all host fatal 127 127 one or more undefined variables geppetto is undefined >>>bug_report pending_closure
change output missing tags on ansible playbook list hosts list tags playbook1 playbook2 playbook3 have tool which takes the output of ansible playbook list hosts list tags playbook1 playbook2 playbook3 and builds database which playbook may run on which host and also for tags the output in was nice an clear wish for json but this is feature request the output of is way more verbose list all taks but misses the tags on plays in my playbook in >>>feature_idea needs_info
keyerror status when running get url over https and ssl module is not installed on target issue type bug report ansible version ansible configuration no custom configuration empty etc ansible ansible cfg` environment ansible is running on mac os target host is running debian lenny with python and without the ssl module summary when running the get url task over https url get the following error in the `msg` property of the json output the root cause is hidden and makes it tricky for end user to understand what is happening steps to reproduce run the previous command over machine that does not have the python ssl module installed the following configuration is used for the following commands expected results expected result actual results fix this has been fixed in the branch through the 28c933ce commit backport of the commit to the branch would fix the issue hopefully in next `1 5` release workaround the workaround is to disable ssl certificates validation with `validate certs false` >>>bug_report
jenkins playbooks this moves https github com chrismeyersfsu playbook ansible integration into the ansible repo the playbook is already running on jenkins as `test ansible integration easy and simple` this pr is also running on jenkins as `test ansible integration easy and simple chrismeyersfsu ansible jenkins playbooks` this shows that once this pr is accepted we need only flip the repo configured in jenkins >>>feature_pull_request
support for cowsay installed by homebrew support for cowsay installed by homebrew fixes 13465>>>feature_pull_request
failed attribute of task result works strangely in conditionals issue type bug report and or documentation report ansible version ansible ansible configuration default environment summary task results that can be saved to variables using `register keyword contain failed key however this key cannot be used in conditionals like another keys for example while works this doesn work steps to reproduce doesn work error while evaluating conditional doesn work error while evaluating conditional this works expected results either first or second version produce the same results as the third version or the documentation here http docs ansible com ansible playbooks error handling html controlling what defines failure explain why the first two versions don work actual results see inline here the debug of the `result` variable as you can see the failed key is there why it cannot be used in conditional >>>bug_report docs_report
adds the int hash filter int hash hashes string with sha512 and returns the hash in integer form truncated to range selected by the user useful to generate numbers in an idempotent way for example from hostname to an id or to mac address the result should not be trusted to be unique any more than randomly selected number in the same range example >>>feature_pull_request
rc2 ansible playbook role with relative path don work hi type bug report ansible version rc2 environment xubuntu 14 04 lts summary with ansible we can use relative path for roles in playbook use it for testing my roles with vagrant my playbook looks like expected results run my role like ansible steps to reproduce you can test with one of my roles vagrant up https github com hanxhx ansible nginx actual results cheers emilien >>>bug_report
issue 13438 abadger os el capitan moved the etc ssh files into etc ssh so in the get public ssh host keys method in lib ansible module utisl facts py have added an additional check for darwin systems if the distribution is macosx and the version is 10 11 key dir is set to the new location older versions use the old location ve tested this fix against systems running el capitan and yosemite previous version both find the host keys correctly also tested against debian jessie thanks david >>>bugfix_pull_request
make make webdocs compatible with python the `webdocs` make target fails under python it fails due to variety of syntax errors such as the use of `except foo e` and `print foo fix 13463 by making code compatible with both python and >>>bugfix_pull_request
per task silencing of warnings issue type feature idea ansible version ansible detached head 958da26d18 ansible configuration none environment summary if have an task like shell curl http some url example foo sed asdf get bright pink warning warning consider using get url module rather than running curl it be nice if this warning could be turned off on per task basis the warnings are useful in general but sometimes they are false positives and the author knows better steps to reproduce shell curl http some url example foo sed asdf ignore warnings yes would not have the bright pink warning >>>feature_idea
adhoc does not load plugins by default reimplemented feature from which kept additional callbacks from poluting adhoc unless specifically asked for through configuration >>>bugfix_pull_request
homebrew cowsay support for cowsay installed by homebrew echo brew prefix bin cowsay >>>feature_idea
add uppercase true false to booleans refix issue 4500 analogues to https github com ansible ansible commit 4833c2fdf06352835742cacac12043a1e5f0904d to solve the situation described in https github com ngoyal ansible bool sample>>>bugfix_pull_request
webdocs make target fails under python this bug was originally filed against version rc2 however this bug is also reproductible on the devel branch and probably other branches too keep that in mind when reading the remainder of this issue issue type bug report ansible version running ansible rc2 ansible version ansible detached head cc98528ecb last updated 2015 12 07 14 44 25 gmt 400 lib ansible modules core not found use git submodule update init lib ansible modules core lib ansible modules extras not found use git submodule update init lib ansible modules extras config file etc ansible ansible cfg configured module search path default overrides more precisely git status head detached at v2 rc2 nothing to commit working directory clean ansible configuration have changed nothing am running directly from the git repository environment running an up to date version of arch linux however that shouldn matter much given that ansible itself is running in virtualenv the virtualenv setup procedure is as follows do the same for python by setting `n 3` and repeating the procedure the python versions as reported by `python version` are `python 10` and `python 0` summary the `webdocs` make target fails for ansible v2 rc7 under python it fails due to variety of syntax errors such as the use of `except foo e` and `print foo steps to reproduce create virtualenv and install ansible from source as outlined in the environment section execute `make webdocs` expected results `make webdocs` completes and produces usable documentation actual results `make webdocs` completes under python but not python proposed fix according to community information contributing ansible users contributing code features or bugfixes http docs ansible com ansible community html contributing code features or bugfixes code developed for ansible needs to support python according to that standard it should be ok to do things like replace `except foo e` with `except foo as e` in my environment python 10 and the following change works allows me to execute `make webdocs` under python and however not sure how to properly test this change to ensure it does not break anything >>>bug_report
win template issue type bugfix ansible version environment ubuntu 14 04 lts summary win template module is not reporting the changed property steps to reproduce expected results changed property is reported fine actual results >>>bug_report
galaxy added new commands login authenticate user prior to performing crud operations import and delete setup configure travis integration import import role from github repo into galaxy delete delete role from galaxy added travis yml see template in galaxy data added github branch to meta main yml if set travis notifications will be accepted from this branch installs will come from this branch unless the repo has tags if not set the repo default branch will be used reworked search to point at search roles endpoint provide author option and present more usable results defined galaxy server and galaxy ignore certs in constants py >>>feature_pull_request needs_rebase needs_revision
adds support for converting mac address to an integer adds an int format to the mac address filter of ipaddr py useful for doing math with mac addresses such as ensuring series of mac addresses are in specific order when configuring vms example >>>feature_pull_request
fatal error caused by shell type on mac 10 ansible versions has an error caused by default shell on remote freebsd 10 guest default ssh to freebsd seems to use csh and thus give the error as below works fine since it does not generate the echo portion like configured ssh shell on vagrant and inside ansible privisioner through ansible shell type but still got the error >>>bug_report
ansible pull not working in on os 10 git version same command works in but failed in the underlying git module command works in in no matter what put in the command including key file that doesn exist should throw an error it always returns `repository has not changed quitting >>>bug_report needs_info
draft release documentation giving introspection into the process>>>docs_pull_request
ansible pull fails on python `ansible pull` won run on python because of print statements lacking parentheses >>>bug_report
fix issue when var name is the same as content see https github com ansible ansible issues 13453 for more details here is simple example without test variable defined now with test variable same without the patch >>>bugfix_pull_request
quit plays with an error if there were failed tasks and handler execu this pull request is to fix the below bug force handler is set to true for ansible any errors fatal is set to true for some play when some task fails plays for other hosts will still continue to execute >>>bugfix_pull_request
debug show variable is not defined on variable when content is the same as name variable issue type bug report ansible version last devel ansible configuration nothing special environment nothing special summary ansible show variable is not defined on variable when content is the same as name variable steps to reproduce an easy way to reproduce this behaviour is to launch the following test expected results actual results >>>bug_report
fixed doas from getting stuck when needing passwords also adjusted test to match new doas become output fixes 13449>>>bugfix_pull_request
bugfix for ios py shared module argument creation this patch fixes bug in module utils ios py where the the wrong shared module arguments are being generated this bug prevented the shared module from operating correctly this patch should be generally applied >>>bugfix_pull_request
doas become method hangs forever when executing commands using the doas become method the execution seems to hang forever how to debug this the best way my etc doas conf` using ansible 955710267c1992c5e3b5b9eb77f4c76e289e3313>>>bug_report
usability become methods should prompt for general become password instead of specific one currently become methods prompt for password `sudo password if single play makes use of different become methods that might be quite confusing since the same password is passed to all modules not only the first default become method loaded during ansible startup if the prompt would asks for `become password instead of `sudo password it clear that the same password is used for all become methods >>>feature_idea
become method parameter of ansible playbook ignored the become method` parameter of `ansible playbook` seems to be ignored test yml test inv execution with become method su` why does ansible execute `ssh exec ssh tt hanoi bin sh sudo s` when using `ansible become method su` within the inventory or `become method su` within the play ansible works as expected using ansible f89f906f87c2c4d850702404f70cfabaa63be351>>>bug_report
make no target syslog consistent no target syslog false do log on target>>>bugfix_pull_request
more meaningful string representation for meta tasks like noop and flush handlers makes debug log messages more helpful consider 31457 1449326406 09388 done getting next task for host localhost 31457 1449326406 09392 task is task meta vs 31457 1449326406 09388 done getting next task for host localhost 31457 1449326406 09392 task is task meta flush handlers >>>feature_pull_request
bugfix remove duplicates from host list before caching it ansible previously added hosts to the host list multiple times for commands like `ansible localhost local ping localhost localhost list hosts` 8d5f36a fixed the obvious error but still added the un deduplicated list to cache so all future invocations of get hosts would retrieve non deduplicated list this caused problems down the line for some reason ansible only ever schedules flush handlers tasks instead of scheduling any actual tasks from the playbook for hosts that are contained in the host lists multiple times this probably happens because the host states are stored in dictionary indexed by the hostnames so duplicate hostname would cause the state to be overwritten by subsequent invocations of something >>>bugfix_pull_request
add way to restrict gathered facts in ansible needed by the following feature idea https github com ansible ansible issues 12088>>>feature_pull_request needs_rebase
allow ini plugin to load file using other encoding than utf8 this pull request allow user to specify alternative encoding for ini java properties file >>>feature_pull_request
added back to inventory spliting this fixes the missing in hostpattern implementation in now will make it easier to transition for those that update to latest version of that tree to future 0>>>bugfix_pull_request
comma hostpatterns this fixes the missing in hostpattern implementation in now will make it easier to transition for those that update to latest version of that tree to future 0>>>bugfix_pull_request
add fullstop to make sentence make sense touch parargraph while at it >>>docs_pull_request
ansible ssh host key facts on os el capitan os el capitan moved the etc ssh files into etc ssh it looks like setting keydir in get public ssh host keys ansible lib ansible module utils facts py needs an additional check for version when system darwin thanks david>>>bug_report
comment examples in default hosts file when user does not specify the inventory file ansible by default will attempt to resolve and use the hosts specified in the default hosts file the examples however should not be resolved or attempted to be communicated with as that is not desirable or even safe linux distros package this file to etc ansible hosts by default >>>bug_report docs_report easyfix
galaxy 0>>>feature_pull_request p1
insufficient information in ansible parsing errors ansible ubuntu 14 04 writing creates in shell task in role somewhere time ansible playbook vvv something yml error creates is not legal parameter in an ansible task or handler of course have the editor open but if someone else would see this like someone commits change with the error and the other user runs into the problem they won know where to look without grepping the whole environment suggestion include filename linenumber and task name in the error error roles randomrolename tasks sometask yml line 112 creates is not legal parameter in an ansible task or handler shell cheers >>>feature_idea
add inventory script for lxc containers enables an lxc server configuration as an inventory source for lxc containers in lxc containers can be defined with an `lxc group` configuration option that is normally used with `lxc autostart g` here we are using the same option to build ansible inventory groups in addition to being grouped according to their `lxc group` entry or entries as lxc allows single container to be in multiple groups we also add all containers including those with no `lxc group` entry to the `all` group related pr for lxc connection plugin 13145 >>>cloud feature_pull_request new_plugin
adding an interface with nmcli sets defroute yes and configures route to the system default after using nmcli to configure new secondary interface default route is configured to the system gateway for that interface this causes dropped networking when the secondary interface does not have access to the network the system default route is on >>>needs_to_be_moved
host variables are not merged appropriately when using inventory directories issue type bug report ansible version ansible devel ansible configuration no changes environment mac os 10 11 summary host variables are not merged appropriately when using inventory directories steps to reproduce expected results would expect all three ``ansible playbook`` to return the same output without any errors actual results third test with inventory directory fails as it tries to use ssh connection this is very likely again an issue with host variables not being merged correctly >>>bug_report needs_info pending_closure
ansible ssh host is undefined try to wait for ssh port to become available for special host inside playbook this is the excerpt ansible fails with `fatal myhost 127 one or more undefined variables ansible ssh host is undefined` the same goes for `inventory hostname` not sure if missing something or this is bug>>>pending_closure
make deb fails because of inconsistency in the archive name `make deb` is first creating `dist ansible tar gz` but then tries to open `dist ansible tar gz` it should use the same name for that archive `>>>bug_report pending_closure
ssh connect tt` option failed running remote files local ansible version on archlinux remote server distro `rhel 6` have executed ansible command with `ansible keep remote files 1` to debug command by hand remote script was sudo guest mod start clean agent conf clean agent cfg bl remote script executed `bash start clean agent sh` had output but remote script running failed there was no process am running remote files with `ssh` by hand with tt` option remote script still failed to start up process if remove tt` option remote files would start up agent by remote script only find `pty false` for `paramiko connection` to disable pseudo terminal is there config option could disable ssh tt` option thx >>>bug_report
v2 inconsistent interpretation of backslashes ansible version summary updating properties file for java app it needs colons to be escaped with single backslash like this using the following task this works fine with ansible but produces `server url http localhost` with ansible >>>bug_report
allow setup of docker remote connections this pr replaces 13356 because switched to new branch sorry for inconvenience this pull request is proposal for solving issue 13294 maybe the changes in the `play context py` are not compliant to the current standard of this file and should be seen as proposal my intention was to introduce the ability to set the connection command and additional connection arguments independent of the connection type ssh local docker besides solving issue 13294 the changes within the `connection docker py` show the use of the two new variables in the play context hope those changes will be merged in the one or another form rely hardly on them and currently there is no other possibility to deploy playbooks to remote docker daemons here an example how to use the docker connection remotely inventory >>>cloud feature_pull_request p2
use remote user or become user in docker connection this commit makes ansible using the `remote user` aka `ansible user` when executing tasks against docker container with the docker connection plugin alternatively the `become user` is used when `become` is true this pr would solve issue 13388 side effect the `docker exec` way does not need `become method` because docker has its own user management thus the user is set by docker when starting the process with `docker exec` using an additional become method then is not just unnescessary but also disadvantage because the docker image needs to provide the become method don know how to disable the `become method` for the docker connection plugin anybody with enough knowledge could to that after merging this pr because then the `become method` becomes obsolete like described >>>cloud feature_pull_request needs_revision p2
unable to override local python interpreter with connection local unless on localhost issue type bug report ansible version ansible configuration minimized below environment minimized below summary it doesn seem possible to override `ansible python interpreter` when using `connection local` minimized example below cc bcoca whom spoke with about this on irc steps to reproduce test yml now run `ansible playbook vvvv other test yml` expected results both tasks run with my custom `python` interpreter actual results only the first task running against `localhost` uses my custom `python` interpreter the second one which uses `connection local` in the context of different host uses usr bin python` presumably from the shebang of the module it running here my actual log note the nix store python interpreter in the first task and usr bin python` in the second the first one is also the value of `sys executable` within `ansible playbook` >>>bug_report
galaxy changes added ability to authenticate import and remove roles setup travis integrations and manage ansible galaxy configuration items pointed the search command to the api v1 search roles endpoint added support for multiple search terms added search by author and improved the search output running ansible galaxy or ansible galaxy help now returns list of commands with help text >>>needs_rebase needs_revision
ansible galaxy install does not work in stable have successfully installed ansible and without difficulty when attempt to install ansible on linux get the following tried creating an empty readme in this location but that just shifts the error to is this known issue this was reported to me by another individual in my organization and duplicated it on different system >>>bug_report
`make check mode` integration test fails stumbled across this when trying to implement testing ci cd pipeline for my fork of the old unmaintained ansible base docker images trinitronx ansible docker base when running the `make check mode` integration test playbook it fails with errors you can also see the error on lines `7523 7533` of this travis ci test log it appears that when the playbook is first run in check mode` it simulates writing `template` file and asserts that the file is changed but is not actually written then the `template` module is run with `always run true` to actually write out file then is run again this time without `always run true` finally the playbook asserts that the task was marked as not changed in order to test that the `template` module run in check mode` knows the file does not need to be changed when it is already existing on the filesystem the failure seems to be because the file does not exist after the first `template` run with `always run true` the odd thing is that the `make check mode` playbook also runs the `test always run` role which indeed does test that `always run yes` on `command` module does actually run the command this was run against current `devel` branch `head` ansible ansible b85e6e008ddf0e5a3308afa8111bb058611a6f0b https github com trinitronx ansible docker base https travis ci org trinitronx ansible docker base https travis ci org trinitronx ansible docker base jobs 94680555 l7523 l7533>>>bug_report
unable to connect to winrm using domain account from computer not joined into the domain am struggling to make winrm work with ansible but it seems impossible ansible runs from linux machines and we need to execute some actions on windows machines as domain account the linux hosts are not joined into the domain as that clearly not an option the variables are mention that winrm is configured to allow http connections also tried to use the domain notation for user as in `svcacct xxx example com` but in this case it still fails because it does try to use kerberos which cannot work in fact it seems that it does something that does not make much sense to me it gets 401 response from the server over http port but after this it tries to connect using ssl on the same port >>>feature_idea windows
added playbook and options info to callbacks will display on certain verbosity levels both playbook file info and non empty options with which it running >>>feature_pull_request needs_rebase
transient failure caused by new pipelining patch ve been testing moderate sized playbook for fedora infrastructure the new requiretty pipelining patch is causing very strange problem the playbook has 136 tasks to create and configure certain host second host gets 123 tasks and skips 13 when run the devel branch with pipelining on the host that has 136 tasks always fails the one with 123 tasks never has however the task that fails is not stable in every run ve made so far it been different task all of the tasks that failed thus far have run on both hosts but think that just percentage chance don think the tasks necessarily have to run on both the traceback get back from the host is either syntaxerror or an indentationerror jimi pointed out that this is what happens if we pipe module into python and python thinks it has tty copy and paste module into the interactive prompt and that the error you get sure enough if set pipelining false in the ansible cfg can provoke the error anymore if switch to the stable branch also can provoke the error so it seems that something about the patch to use python to stream the module in pipelining mode is intermittently failing to do what it supposed to intermittently the python that actually executes the module thinks it has tty and runs in interactive mode causing the error >>>bug_report
solaris hosts can be pinged running into an issue with the latest commit 9bf1aaf7f5e86030 wed dec 12 11 16 2015 ansible code from github when trying to ping or really any ansible action solaris 10 hosts the following error is shown ansible version head n1 ansible devel 9bf1aaf7f5 last updated 2015 12 02 21 28 57 gmt 200 ansible ping projects ansible solaris hosts sol local sol local unreachable changed false msg error ssh error data could not be sent to the remote host make sure this host can be reached over ssh unreachable true however an older version of ansibe v1 works fine ansible version ansible ansible ping projects ansible solaris hosts sol local sol local success changed false ping pong the sol local machine is sunos unknown 10 generic 147148 26 i86pc i386 i86pc python output of vvvvv ansible vvvvv ping projects ansible solaris hosts sol local using etc ansible ansible cfg as config file loaded callback minimal of type stdout v2 establish ssh connection for user fboender ssh ansible cfg set ssh args controlmaster auto controlpersist 60s ssh ansible remote port remote port ansible port set port 8022 ssh ansible password ansible ssh pass not set kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no ssh ansible remote user remote user ansible user user set user fboender ssh ansible timeout timeout set connecttimeout 10 ssh playcontext set ssh common args ssh playcontext set ssh extra args ssh found only controlpersist added controlpath controlpath home fboender ansible cp ansible ssh ssh exec ssh vvv controlmaster auto controlpersist 60s port 8022 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user fboender connecttimeout 10 controlpath home fboender ansible cp ansible ssh tt 127 lang lc all lc messages python uc import sys sys stdout write for in iter sys stdin readline eof 942d747a0772c3284ffb5920e234bd57 lang lc all lc messages usr bin python sol local unreachable changed false msg error ssh error data could not be sent to the remote host make sure this host can be reached over ssh unreachable true output of only the ssh part without running any remote commands ssh controlmaster auto controlpersist 60s port 8022 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user fboender connecttimeout 10 controlpath home fboender ansible cp ansible ssh tt 127 debug output last login wed dec 22 46 23 2015 from 10 oracle corporation sunos 10 generic patch january 2005 bash so it doesn seem to be connection problem this part may help some output removed for brevity can provide full dump ssh vvv controlmaster auto controlpersist 60s port 8022 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user fboender connecttimeout 10 controlpath home fboender ansible cp ansible ssh tt 127 lang lc all lc messages python uc import sys sys stdout write for in iter sys stdin readline eof 942d747a0772c3284ffb5920e234bd57 channel will not send data after close bash line syntax error near unexpected token `s bash line `lang lc all lc messages python uc import sys sys stdout write for in iter sys stdin readline eof 942d747a0772c3284ffb5920e234bd57 details ansible version ansible devel 9bf1aaf7f5 last updated 2015 12 02 21 28 57 gmt 200 lib ansible modules core detached head cd9a7667aa last updated 2015 12 02 21 40 36 gmt 200 lib ansible modules extras detached head 3c4f954f0f last updated 2015 12 02 21 40 43 gmt 200 config file etc ansible ansible cfg configured module search path default overrides host master os linux mint 17 qiana ubuntu 14 04 with python guest os sunos unknown 10 generic 147148 26 i86pc i386 i86pc with python v2 4>>>bug_report
pull request 13200 pipelining requiretty fix breaks other connection plugins recently opened issue 13388 where tried to introduce the user option for ansibles docker connection plugin concluded within this issue that my changes made the execution of ansible tasks on docker containers really slow today started playbook on another machine at work where also deploy tasks to container with the docker connectio plugin and everything went fine till updated my ansible installation since then every task executed on docker containe takes very long and python consumes 100 cpu after some time of investigation it turns out that this behavior was caused by the pull request https github com ansible ansible pull 13200 which was merged yesterday https github com ansible ansible commit bebd2c5f3422b3c52ca0018d19ea4702c066c3e2 here is an example playbook which will reproduce the current behavior if you reset your local repository to the mentioned pull request this playbook will hang on the third task and python consumes 100 cpu for long time if you reset your local repository to the commit before everything works as expected and the playbook should be executed within seconds the changes made are too sophisticated for my humble python knowledge so amenonsen please have look what could cause the behavior maybe abadger has some good ideas too this issue would enable feature request 13388 >>>bug_report
v2 slack callback plugin this pr supersedes https github com ansible ansible pull 8955 and https github com ansible ansible pull 12889 of note here because we don have the ability to look into the playbook and play objects like before using `cli base parser` to get some of that data not super happy with that solution although it does get me that data open to suggestions however this is working well for us as is cc bcoca >>>feature_pull_request new_plugin
when roles are run with tags dependent roles are only run for the first role in playbook using ansible if have role `example 3` which depends on `example 1` then provisioning using tags example 3` will only run `example 1` if `example 3` is the first role in the list of roles below are is the output for each case dependencies do not run for tags example 3` playbook output dependencies do run for tags example 3` playbook output there is sample repo here https github com pajtai ansible tags example which runs the `example 3` tag on vagrant provisioning if you run `vagrant up` or subsequently `vagrant provision` or `ansible playbook` against the vm box then you can see the case where the dependencies do not run to get the dependencies to run comment out the first role https github com pajtai ansible tags example blob master ansible site yml l6 this problem is referenced by ghostwords here https github com ansible ansible issues 4339 issuecomment 160677433 >>>bug_report
get v2 playbook on start working this pr does the following move self tqm load callbacks earlier to ensure that v2 on playbook start can fire pass the playbook instance to v2 on playbook start add file name instance attribute to the playbook as it stands `v2 on playbook start` is never run this change ensures that it will and also changes it signature to pass in the playbook instance additionally due to how plan on using this it would be nice to also have the filename associated with the playbook instance available to the callback >>>bugfix_pull_request
make module lang default to whatever lang is set to on the control node>>>bugfix_pull_request
use cli expand tilde also for the vault output file this was just minor oversight in the initial submission which makes the newly added output option fail to work with filename like foo please merge into devel and stable >>>bugfix_pull_request
error ssh error data could not be sent to the remote host make sure this host can be reached over ssh issue type bug report related to 12594 ansible version configuration ansible version ansible config file configured module search path default overrides environment osx 10 summary upgraded to and started getting error above steps to reproduce cat ssh config remote site requires cert test requires password host test proxycommand ssh 22 me remote site 28194 ansible ping ssh root test test expected results no config file found using defaults ssh password test success changed false ping pong actual results no config file found using defaults ssh password test unreachable changed false msg error ssh error data could not be sent to the remote host make sure this host can be reached over ssh unreachable true >>>bug_report
catch additional assertion errors for load list of blocks this pr addresses few locations where `load list of blocks` was used but we were not catching the `assertionerror` this was partially addressed in https github com ansible ansible commit 53cd80225143d0011416041f4cd815a07c650772 however due to changing the exception that is raised the existing `except assertionerror statements are no longer useful and we are potentially losing additional useful data this pr brings the code into alignment with how it is done elsewhere in the codebase >>>bugfix_pull_request
problem with latest ansible build from source and debian unwanted environment variables am using ansible ping nodes2 root vvvv to ping my nodes they seem to be unreachable but in the end the following ssh command does not work sh exec ssh vvv controlmaster auto controlpersist 60s stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user root connecttimeout 10 controlpath home potato ansible cp ansible ssh tt 172 16 172 lang en us utf lc all en us utf lc messages en us utf python uc import sys sys stdout write for in iter sys stdin readline eof 942d747a0772c3284ffb5920e234bd57 lang en us utf lc all en us utf lc messages en us utf usr bin python the problem here are the lc all lc messages and lang variables as soon as remove them everything works fine guess this is because the locale is not available on my target system how do remove these variables or set them correctly >>>bug_report
host vars not merged between multiple host files issue type bug report ansible version introduced in v2 beta1 bug not present in v2 alpha2 ansible configuration in ansible cfg use directory as inventory debian jessie summary ve configured host files in hosts directory hosts and hosts both contains groups and one host is configured into groups in host files with one host var for each hosts hosts playbook test yml with ansible v1 or previous to v2 beta1 both host vars are accessible but since this version only one random host vars datacenter or bay is accessible tried with both hash behaviour merge and replace expected results actual results >>>bug_report
fix 13370 proposed fix for issue 13370 >>>bugfix_pull_request
replace delete with portable exec rm needed on openbsd which does not support delete running hacking env setup on openbsd with current devel prints the following error message find delete unknown option>>>bugfix_pull_request
can install package with wildcard version via apt issue type bug report ansible version ansible configuration environment mint lmde2 pip installation summary everywhere it says that ansible supports wildcards in package name and version yet can get it to work steps to reproduce expected results installs 11 on jessie or 11 bpo70 on wheezy actual results host fails with msg pkgname wildcard and version can not be mixed>>>bug_report
updated docs for api initial draft>>>docs_pull_request
v2 win iis webbinding module require additional parameters to run was run need run this it work >>>needs_info windows
fixes syntax issue with module utils eapi py this patch fixes an issue with the common args dict in the eapi shared module this patch is required for the eapi shared module to be properly imported and is therefore should be applied to all instances >>>bugfix_pull_request
set user for docker connection use the docker connection plugin introduced in ansible which executes tasks with `docker exec` inside docker container the command `docker exec` allows the u` or user` option to set the user you want to execute the task within the container it would be nice if ansibles `remote user` or `become user` would be applied to that option already tried my luck to implement that functionality by adding the option flag and value to the ansible connectors command list like this however the first task executed hangs there is no error message the python scrint is in process inside the container but nothing happens here is the docker connectors source file https github com ansible ansible blob devel lib ansible plugins connection docker py and here are three example tasks hanging when adding self play context remote user to both exec commands in the source file you can execute those task on your localhost if you have docker installed any idea why the third task is hanging >>>cloud feature_idea
windows support on v2 rc1 unicode bug hello testing ansible v2 host is lubuntu trusty fr utf8 guest is win10 virtualbox fr too installlanguage reg sz 040c got an unicode issue it seems for variable containing output of command on french system accent unicodedecodeerror ascii codec can decode byte 0xef in position 79 ordinal not in range 128 issue type bug report ansible version v2 rc1 steps to reproduce actual results expected results contents saved to file >>>bug_report
windows support on v2 rc1 raw command not supporting redirecting stderr hello testing ansible v2 host is lubuntu trusty fr utf8 guest is win10 virtualbox fr too installlanguage reg sz 040c stdout redirection stderr nok thanks>>>bug_report windows
unicodeencodeerror ascii codec can encode character u2018 using latest ansible from git am runnig this task my template file contents are am getting this result any ideas do not have anything non ascii anywhere can tell what is causing this all of sudden >>>bug_report easyfix
update ansible ssh changes note rst the ansible ssh pass ansible ssh password confusion costed me little bit time effort so hope it can clearly described >>>docs_pull_request
remove empty line breaking the formatting of the title>>>docs_pull_request
add documentation on how to loop over all inventory host related to 13343>>>docs_pull_request
allow shell plugin to affect remote module filename fix for 13368 added get remote filename to shell plugins powershell version appends ps1 if necessary base shell plugin no ops cc jimi >>>bugfix_pull_request windows
bug report tree option not working on using the following version using vvv ansible cfg is very simple using debian 64b the exact same commands works fine with let me know if you need more information >>>bug_report
include no longer relative in v2 hi behavior has changed in v2 if you include something in directory and then try to include from there resolving the include happens from the original playbook directory not the first include directory this is change from `playbook yaml` `subdir yaml` include yaml` `subdir yaml` debug msg success previously this would have worked in v2 ansible looks for yaml in the top level directory used strace to see what it was looking for not inside of `subdir` relative to where the include was launched from where used to currently on ansible devel 96fcfe45d0 last updated 2015 11 23 23 29 12>>>bug_report pending_closure
update intro windows rst the ansible ssh pass ansible ssh password confusion costed me little bit time effort so hope it can clearly described first pull thanks >>>docs_pull_request windows
ansible confusing error tag not found in playbook ansible version ansible configuration nothing special environment osx summary ansible returns confusing error error tag not found in playbook when role has tag but no tasks to execute my confusion with the error is that had not added any tags on any tasks inside the roles added them only on the inclusion of the role in the playbook ansible handling of tags on roles as opposed to on tasks seems to be inconsistent steps to reproduce with playbook as follows base playbook yml where role something exists but the contents of roles something tasks main yml is empty ansible fails in the following way expected results expected ansible would have succeeded execution as it would if no roles were in the playbook where empty yml contains only the following actual result because of the error that ansible returned me spent about trying to figure out why it did not seem to correctly parse the tag that added on the role in the playbook >>>bug_report
boolean should contain boolean literals it is natural that an argument spec with choises boolean accepts boolean literal true false though the current implementation allows only string or int >>>easyfix feature_pull_request
fix sorting of groups for host vars found this issue because we re using the hierarchy of groups to specify values on different levels how to validate fix compare result from ansible devel and my fork to see difference log >>>bugfix_pull_request
callbackmodule v2 runner on failed prevents tasks from running git bisect done issue type bug report ansible version ansible stable 204e27ca66 ansible configuration no changes from original environment ubuntu 14 04 hosts mixed ubuntu 14 04 debian wheezy summary according to git bisect 984729016e3ea20e27c60fa5110cfca19580370f is responsible for introducing the error described below when revert the changes introduced by this commit to lib ansible plugins strategy free py the error disappears unfortunately do not understand the changes well enough to provide patch but hope my report helps steps to reproduce run playbook with strategy free and few roles includes cannot provide further details at this point because this playbook is private expected results no error actual results preventing this task from running on the remaining hosts >>>bug_report needs_info p2
solution for 401 unauthorized winrm am not quite sure if this is the correct forum to correct documentation variables listed in the documentation http docs ansible com ansible intro windows html inventory does not work for windows servers am on latest stable version working not working >>>docs_report windows
win template has copy issues when templated file has powershell in it issue type bug report ansible version ansible ansible configuration no changes from original environment ubuntu 14 04 and centos hosts win managed computer summary including powershell shebang powershell in template causes ansible to give the source filename in the temp directory in users appdata local temp ps1 extension source ps1 instead of source and thus the file cannot be copied to its intended destination as win copy ps1 cannot find it expected results temporary file called source file copied to its destination actual results temporary file called source ps1 file not copied to its destination thanks >>>bug_report windows
`backrefs` doesn work when used with `with items` issue type bug report ansible version ansible configured module search path none ansible configuration installed via `pip` nothing changed environment control machine ubuntu 14 04 x86 64 managed node ubuntu 14 04 x86 64 summary was trying to replace portion of line using `lineinfile` module as you know the `lineinfile` module was designed to replace the whole line rather than part of it so thought can use the `backrefs` option to achieve this this module works fine when replace single line like this trying to remove the from configuration line here before key xxx after key xxx but there were dozens of lines need to be processed this way so for the sake of convenience let do this with `with items` before key xxx after what steps to reproduce to reproduce this scenario you ll need files host file playbook and plain file contains the line which gonna be processed host file hosts playbook replace string yml plain file tmp test txt run it with the command `ansible playbook replace string yml hosts root` expected results the line in tmp test txt was changed to `key xxx` actual results the line in tmp test txt was changed to `1`>>>bug_report
delegate to getting ssh errors issue type bug report ansible version working on doesn work on and doesn work on ansible configuration environment centos summary delegate to causing ssh key error steps to reproduce expected results ls of home dir of delhost actual results ssh error saying key errors looks like it can connect to delhost but not sure know that can ssh normally to delhost>>>bug_report
ansible pull security have dozens of hosts using ansible pull in cron job to auto update what happens if someone compromises my repo ansible pull fetches from that person could rewrite the playbook in the repo to install and run anything they wish create botnet no problem just update the playbook local yml then watch your hosts come online so how can we introduce code signing into ansible pull >>>feature_idea
prompt vars does not work for same variable again it is not possible to prompt variable twice or multiple times accross multiple plays maybe the list of already prompted for is being cached across plays here an example playbook which asks for another become password in each play as long as the variable name remains the same in both plays ansible become pass you will just get asked once for the variables value reference thread on groups google com https groups google com forum topic ansible project dnionrivamg >>>bug_report
playbook ignores command line become method and overwrites with config default try to use `become method su` to execute privileged commands on freebsd host but the command fails with `sudo not found` output using ansible devel cc36eedf765afcf4a2317468acbfcf48f986078f >>>bug_report
list index out of range while doing setup step environment os centos nodes centos ansible version ansible devel 6671d78f95 symptom have series of playbooks that already run correctly at ansible then upgraded my ansible to ansible devel 6671d78f95 recently and found weird thing that it sometimes failed at setup setup the possibility is around 50 not sure if anyone encounter similar issue like this the error traceback >>>bug_report
feature ios shared module this adds shared module support for building modules that connect to cisco ios devices it builds on the module utils ssh py shared module pr 13357 >>>feature_pull_request p2
initial add of ssh shared module this ssh shared module is used for building modules that require an interactive shell environment such as those required for connecting to network devices>>>feature_pull_request p2
allow setup of docker remote connections this pull request is proposal for solving issue 13294 maybe the changes in the `play context py` are not compliant to the current standard of this file and should be seen as proposal my intention was to introduce the ability to set the connection command and additional connection arguments independent of the connection type ssh local docker besides solving issue 13294 the changes within the `connection docker py` show the use of the two new variables in the play context hope those changes will be merged in the one or another form rely hardly on them and currently there is no other possibility to deploy playbooks to remote docker daemons here an example how to use the docker connection remotely inventory >>>cloud feature_pull_request plugin
adds device common argument to shared module the shared module now supports device argument the device argument accepts dict object with connection parameters any argument in device can be overridden with specific arguments per task>>>feature_pull_request p2
add plugin for uncompress module>>>feature_pull_request
now and or shell expressions depend on shell plugin this should fix issues with fish shell users as and are not valid syntax fish uses actual and and or programs fixes 13199>>>bugfix_pull_request
trying to install ppa results in invalid repository string on linux mint running ansible on linux mint 17 mate 64 bit while trying to get apt repository module working finally took an example literally from docs http docs ansible com ansible apt repository module html but anyway it fails with `msg invalid repository string ppa nginx stable` just in case tried other ppas but they all fail >>>needs_to_be_moved
put in trap for args being none normalize old style args can return none if it does the loop for args in args blows up >>>bugfix_pull_request
add an extract filter at its most basic this is nothing more than an array or hash lookup but when used in conjunction with map it is very useful for example while constructing an ssh keyscan command to update known hosts on all hosts in group one can get list of ip addresses with groups map extract hostvars ec2 ip address list this returns hostvars ec2 ip address hostvars ec2 ip address and so on you can even specify an array of keys for recursive lookup and mix string and integer keys depending on what you re looking up localhost map extract hostvars vars group names first hostvars localhost vars group names ungrouped includes documentation and tests >>>feature_pull_request plugin
use connection locking to protect against competing host key prompts we acquire the connection lock before executing ssh and release it as soon as the unknown host key prompt is negotiated or we can be sure it won be issued at all this fixes the problem where many prompts pile up and compete for input unfortunately we can only lock against other connections there no output lockfile that can prevent output from other subsystems see the fixme note this problem was the original motivation for pr 12276 but although the bulk of that pr was merged the locking changes were not submitted for v2 as requested in 13318>>>bugfix_pull_request
devel fix bomb shell fix for https github com ansible ansible issues 13269 consistent behaviour between old and new style notation and allow variables starting with now only variables starting with ansible are not allowed at all >>>bugfix_pull_request
vars main yml variables content overwritten by later roles in playbook issue type bug report ansible version ansible detached head f2225395f9 last updated 2015 11 28 17 55 43 gmt 1000 lib ansible modules core detached head 0e043f8c58 last updated 2015 11 28 17 55 04 gmt 1000 lib ansible modules extras detached head e46e2e1d6f last updated 2015 11 28 17 55 22 gmt 1000 config file configured module search path default overrides environment osx 10 11 running ansible from source v2 rc1 running boto 38 and boto3 python 10 summary when roles are included variables defined in the defaults of later roles are being included in earlier roles and if the variable is defined in both the latter role overrides the current running role steps to reproduce roles role1 defaults main yml roles role1 tasks main yml name debugging test variable inside role1 debug msg test variable is defined test variable is defined roles role2 defaults main yml testing variable setting variable roles role2 tasks main yml name debugging test variable inside role2 debug msg test variable is defined test variable is defined site yml name running play for testing variable importation hosts localhost connection local gather facts false roles role role1 role role2 expected results play running play for testing variable importation task role1 debugging test variable inside role1 ok 127 changed false msg test variable is defined false task role2 debugging test variable inside role2 ok 127 changed false msg test variable is defined true play recap 127 ok changed unreachable failed actual results play running play for testing variable importation task role1 debugging test variable inside role1 ok 127 changed false msg test variable is defined true task role2 debugging test variable inside role2 ok 127 changed false msg test variable is defined true play recap 127 ok changed unreachable failed additional notes it looks like this has been raised before late last year and jimi had added pr but think it regressed again since https github com ansible ansible issues 9168>>>bug_report
requirements yml not working using the following requirements yml as simple example the file got yml extension as required for ansible galaxy to detect it is yaml file and not simple list text file instructing ansible galaxy to use this file error mesage despite the user role exist https galaxy ansible com detail role 2509 this issue also occurs with other roles from ansible galaxy like with the example from the ansible docs http docs ansible com ansible galaxy html advanced control over role requirements files debian jessie amd64 ansible thank you and with best regards>>>bug_report
draft of common retry and rate limiting decorators for api based modules this should allow for common way to add retry and rate limiting to new and existing api calls>>>cloud feature_pull_request needs_revision
an expect script does not run properly via local connection issue type bug report ansible version ansible configuration unchanged environment rhel x86 64 summary different results can be obtained when running an expect script http expect sourceforge net via local or ssh connection in particular the expect script will execute properly when using ssh connection type but not when using local connection type steps to reproduce install rhel install ansible and expect create directory ansible expect local` populate the directory with the following files hosts localhost test expect expect usr bin expect spawn sbin grub crypt expect assword send 1234 expect assword send 1234 interact test yml yaml hosts all tasks command ansible expect local test expect register result debug var result stdout make the expect script executable chmod ansible expect local test expect run playbook using ssh connection cd ansible expect local ansible playbook hosts ssh test yml verify that the output includes hashed password 1234 visual verification of presence should be sufficient actual value does not matter run playbook using local connection cd ansible expect local ansible playbook hosts local test yml verify that the output includes hashed password 1234 visual verification of presence should be sufficient actual value does not matter expected results during step one can validate that output includes something along the lines of task debug var result stdout ok localhost var result stdout spawn sbin grub crypt npassword nretype password 0xek hfcpv jrrgf bmr0lqf9llubumc3txpxzcfhs 8znrqqptcwwjcije6ydsl2rmpi95m2uyn6u6bshjgkvpiuwsmjouzm1nys1 during step one can validate that output includes something along the lines of task debug var result stdout ok localhost var result stdout spawn sbin grub crypt npassword nretype password 0xek hfcpv jrrgf bmr0lqf9llubumc3txpxzcfhs 8znrqqptcwwjcije6ydsl2rmpi95m2uyn6u6bshjgkvpiuwsmjouzm1nys1 actual results during step expected output is observed during step the output includes output similar to hashed output seems to be completely missing task debug var result stdout ok localhost var result stdout spawn sbin grub crypt npassword nretype password additional notes as side note also tried using similar looking script written in python that utilises the `pexecpt` module and via this got consistent results so looking forward to ansible guess the python script that worked for me was python usr bin env python import pexpect pexpect spawn grub crypt child pexpect spawn grub crypt child expect assword child sendline 1234 child expect assword child sendline 1234 child wait print child read >>>bug_report
adds main yml to possible mains this is to allow better overview when having many included files in single role>>>feature_pull_request
next cloudstack cs instance add test for state restored>>>feature_pull_request
removes editorial feel that ansible is above the my hosted git community is better than yours discussion and thus removed the editorial around bitbucket>>>docs_pull_request
add assertions for ansible date time in setup result for windows tests https github com ansible ansible modules core pull 2558>>>windows
become fail if used on windows target v2 rc1 if using multiplatform role which has become yes statement role fails if executed on windows as it tries to call bin sh and sudo it probably should be ignored on windows >>>bug_report windows
typeerror iteration over non sequence when execute ad hoc command using the command module ansible pushes command file into tmp dir of the target manchine there is error in function literal eval node or string of the command file `return dict convert convert for in node items it shoud be change to `return dict convert convert for in node items `>>>bug_report needs_info
make deb fails when git is not installed tried building package for ansible rc1 inside docker container but it failed with an odd error after digging bit found the following line in the makefile it appears that `make` requires double quotes instead of single quotes the above line gets interpreted as assigning string with two literal single quotes rather than an empty string wondered why nobody had ever hit this bug it appears that this can only happen when you build without `git` installed was building inside docker container from github release tarball so there was no need to install `git` >>>bug_report
ansible freeze hang if remote command doesn exit by itself used ansible to install python simplejson on 200 linux server rhel it appears servers had rpm database corruption and would cause yum to never exit logon on the faulty node even ctrl would not exit yum it is known issue with yum when rpm database is corrupted because of single unhealthy node it caused my ansible task to never exit and finish while reproducing the problem killing the process on the faulty node allowed ansible to continue not real solution since it is not easy to find the faulty node symptom ansible doesn display the object in inventory it is processing and that is causing the hang ansible doesn time out after while to failed the faulty node ansible jobs hang for ever troubleshooting step running ansible task ansible all inventory production prod linux 32 84 txt shell yum install python simplejson raw ask su pass tee logs chg00039576 phase3 log loop all the node in inventory and echo missing node from the log 10 nodes was left on 200 while ifs read line line do grep line chg00039576 phase3 log echo missing line done inventory production prod linux 32 84 txt login to the nodes and find the faulty node and kill the task if you ctrl the ansible job you will miss some informations output of node processed but not yet displayed suggest resolution think there should be timeout mechanism that would kill the child process if it takes more than 300 seconds to complete the task on remote node customizable in playbook or the command line for exceptional normal long task display the node that hang the jobs after 30 60 seconds useful information display information of processed node that return their rc after the faulty node hang the jobs >>>feature_idea
multiple include conflicting action statements in this works in task main yml in error conflicting action statements >>>bug_report
delegate to with remote user on ansible issue type bug report regression ansible version devel ansible configuration default environment ubuntu 14 04 summary delegate to does not use user specified with remote user steps to reproduce following playbook works correctly on with output root and on devel it outputs normal user expected results actual results >>>bug_report
add example for regex replace using named groups>>>docs_pull_request
improvements request syntax check should not prompt on vars prompt issue type bug report improvement ansible version v2 rc1 summary when running ansible playbook with argument syntax check` prompts are executed instead of only syntax checked steps to reproduce yaml hosts hosts vars prompt name hosts prompt on which hosts you want to run it default none private no tasks debug msg test expected results syntax check does not stop on prompts actual results ansible playbook playbook yml syntax check on which hosts you want to run it none >>>bug_report
ssh host key prompts trample over each other this is known problem for which had submitted patch with 12276 although that pr was merged the actual locking part was rejected because it unavoidably waited too long if ssh timed out trying to connect to unreachable hosts bcoca said on irc that he may be prepared to reconsider this for v2 because otherwise it painful to deal with any number of newly provisioned hosts creating this just to keep track of the decision if the feature is definitely wanted for v2 then ll go back and rebase https gist github com amenonsen a2ecbea86b468e780608 the patch that had originally submitted which worked fine but by now needs rebasing and can also be slightly improved upon >>>feature_idea
changelog devel is is feature complete >>>docs_pull_request
no ansible date time minute in v2 rc1 it seems we lost something tested on ubuntu trusty for windows guest thanks>>>bug_report windows
windows path mangled on v2 rc1 hello testing ansible v2 host is lubuntu trusty fr utf8 guest is win10 virtualbox fr too installlanguage reg sz 040c please note executable path is not the same as in yml file check with vim set invlist and don see anomaly in source have other commands which works fine >>>bug_report windows
fix for https github com ansible ansible issues 13221 do not call set variable manager each time but only at the end of process pending results with the playbook described in https github com ansible ansible issues 13221 applied on 20 hosts ansible takes 35s vs minutes without this patch >>>bugfix_pull_request p2
potential fix for setup ansible selinux var incorrect on fedora 23 not 100 certain that this is the verbage we want but it makes more sense than false fixes http github com ansible ansible modules core issues 2432>>>bugfix_pull_request
user module documentation lists false requirements http docs ansible com ansible user module html lists useradd userdel usermod as requirements however the users modules work on bsd and perhaps other platforms which don have those utilities >>>docs_report
ascii codec error with string am recieving the following error when calling the ec2 module `msg ascii codec can decode byte 0xe2 in position 40 ordinal not in range 128 my task is am running `ansible 4`>>>bug_report
unrecognized status from pull for already exists or status image is up to date for it looks like ansible does not work with some good statuses target os fedora 22 docker python docker py ansible task name run jenkins container become yes docker image jenkins restart policy always state reloaded result failed 10 184 250 changes failed true status msg unrecognized status from pull fatal all hosts have already failed aborting >>>bug_report
fix missing word in developing modules rst>>>docs_pull_request
instances without an external ip address google cloud allows to run its instances without an external ip address it very useful in some cases saw in http docs ansible com ansible gce module html that the external ip parameter does not have an option to disable attach an external ip while new instance is creating can you add this feature or is the way around it now >>>needs_to_be_moved
implement normpath and win normpath filter since its pain for windows users to escape windows paths it would be cool that filter is implemented converting test test2 to test test2 and vice versa this could be handled with the normpath method of the os path and ntpath imports>>>feature_idea windows
explicitly accept become success in awaiting prompt state if we request escalation with password we start in expecting prompt state if the escalation then succeeds without the password the become success response arrives we must explicitly move into the next state awaiting escalation which immediately goes into ready to send so that we no longer try to apply the timeout otherwise if the results of the task don arrive with become success dependent on the exact timing we leak the success notification and eventually timeout but if the module response did arrive before the timeout expired the process has already exited test would do the right thing by accident which is why it didn fail more often fixes 13289>>>bugfix_pull_request
documentation mixed content warning on docs ansible com issue type documentation report ansible version ansible configuration environment summary visiting any page on https docs ansible com which embeds the google custom search box causes mixed content warning this is caused by the hardcoded `http` scheme for the gcs script url also the gcs script won load until the user forces the browser to accept mixed content steps to reproduce open browser and navigate to https docs ansible com ansible intro html expected results the browser should show the secure connection badge and the search form should show the google custom search watermark actual results the mixed content warning is displayed by the browser and the gcs script is not loaded correctly >>>docs_report needs_info
introduce ansible docker host parameter for connection docker the docker command line reference http docs docker com engine reference commandline cli lists parameter h` or host` this parameter should be accepted by the new docker connection introduced in ansible here two examples of possible usage within the inventory and within playbook label feature idea >>>feature_idea
delegate via it would be great to have `delegate via` option for playbooks roles and tasks which delegates to another host but via the host of the current playbook currently the `delegate to` option delegates directly from the ansible control machine imagine your ansible control machine is localhost your remote host is 175 13 81 and on the remote host you start virtual machine or docker container which has the ip 192 168 within private network on 175 13 81 now `delegate to` would directly delegate the task `localhost 192 168 3` which would not work because on localhost is none 192 168 machine with `delegate via` it should be possible to delegate the task via the remote host from your playbook `localhost 175 13 81 192 168 3` btw how do label this issue as feature idea >>>feature_idea
tags no longer exit with error about not found tags in ansible playbook playbooks test yml check diff tags nope error tag not found in playbook nope possible values tag1 tag2 tag3 in it just runs the playbook and says ok is this feature >>>bug_report
acl module changed behavior default acl also adds user acl type bug in ansible the acl module wants to be smarter than me if use it also adds the acl user test in it only adds new default acl >>>bug_report
default acl bug or bad documentation issue type bug report documentation report ansible version ansible devel documentation http docs ansible com ansible acl module html says can use defaul user user acl but with cant use it anymore so fix documentation or code expected results actual results >>>bug_report docs_report
become with password less sudo issue type bug report regression ansible version rc1 ansible configuration default environment ubuntu 14 04 summary if become sudo password is provided and host is configured to allow password less sudo ansible times out steps to reproduce enable password less sudo and try ansible playbook with become yes expected results playbook execution actual results fails in first step with timeout waiting for prompt>>>bug_report needs_info pending_closure
msg failed to set new url git hostname 973849 repo git for origin fatal no such remote origin playbook is like the following hosts hosts group default all vars destination var www html tasks name clone the repo git repo git hotname 973849 repo git dest destination accept hostkey yes force yes key file pem >>>bug_report pending_closure
ansible inline vault sometimes you want to define complex variable dictionary and do not want to create separate vault file for passwords it would be cool for history purpose to use plain yml file for variable definition and inline vault variable content like the following this feature is described by jpmens on http jpmens net 2014 02 22 my thoughts on ansible vault >>>feature_idea
wantlist missing from lookup in `wantlist` was introduced in and seems to have been omitted accidentally from you can see the functionality at https github com ansible ansible blob 57389d55b1722ec4358172fb4c58a61c513148f8 lib ansible utils template py l94 https github com ansible ansible blob 57389d55b1722ec4358172fb4c58a61c513148f8 lib ansible utils template py l105 l106 don fully understand the impact of using `unsafeproxy` so figured it would be safest to just report it currently not sure the method that should be used on `ran` to return it as is instead of joining it some thoughts or if we need to do each element >>>bug_report p2
fix typo in modules core rst>>>docs_pull_request
optimistically detect if params are coming from get aws connection in fo as discussed in dev mailing lists https groups google com forum topic ansible devel cajtw3v4dsk current version of boto3 conn seems to overrides params from get aws connection info which is already boto3 friendly here very simple patch to workaround the problem deliberately avoid to make the assumption that get aws connection info is systematically used thanks >>>bugfix_pull_request cloud
skippy callback module object has no attribute v2 playbook item on skipped version running from source git pull and submodule update as of this morning johnar acs trusty8 networkmanagement acs ansible sudo ansible bin ansible version ansible devel 70de8bc96f last updated 2015 11 24 18 28 34 gmt 000 lib ansible modules core detached head 0e043f8c58 last updated 2015 11 24 18 29 11 gmt 000 lib ansible modules extras detached head e46e2e1d6f last updated 2015 11 24 18 29 11 gmt 000 config file home johnar networkmanagement acs ansible ansible cfg configured module search path library library ixia error warning error when using bound method callbackmodule v2 runner on ok of callbackmodule object has no attribute v2 playbook item on skipped checked skippy py there is definitely no v2 playbook item on skipped in there >>>bug_report
refactored consul inventory script behaviour remains the same refactored inventory script decoupled consulinventory from consulconfig changed consulinventory init so it would return the data instead of printing it parameterized the ini file name moved main into block these changes enable using the inventory as python module since trying to link ansible inventory sourced from consul into rundeck also allows changing the ini file >>>cloud feature_pull_request
username is ignored when using `delegate to` issue type bug report ansible version ansible configuration default environment control ubuntu vivid target debian summary when using `delegate to` usernames defined in inventory are ignored which fails authentication when the usernames in the control and target machine don match steps to reproduce expected results playbook should run correctly actual results playbook fails passwordless login is working replacing `delegate to inf dev01` with `delegate to my user inf dev01` makes it work let me know if there is anything else should add >>>bug_report needs_info
changelog minor formating fix>>>docs_pull_request needs_revision
feature suggestion ansible to establish ssh session find myself in many situations executing ansible to deploy systems but frequently want to use the same credential set to ssh to those machines currently for static hosts am keeping two lists of the same information ssh config` and hosts file so what am suggesting would be to use ansible inventory to enable more rapid ssh connections including but not limited to connecting to static hosts and to dynamic inventory when the result set is single node >>>feature_idea
feature suggestion deploy role as one liner would be nice if there was command which did not require playbook to deploy role to host or host group>>>feature_idea
undefined attribute causes deprecation warning even if task should be skipped due to failed conditional check ansible version yaml block the failed when will never match it simply causes this task to not fail if the ls command fails to find any matching files name webcontent get list of any pre existing tarballs on target webserver shell ls backups tarball allwebcontent tgz register path tarballs target failed when failed in path tarballs target stderr changed when false tags webcontent name webcontent delete any pre existing tarballs file path item state absent with items path tarballs target stdout lines tags webcontent when migrate webcontent bool task webservers webcontent get list of any pre existing tarballs on target webserver skipping testbox f23 example com changed false skip reason conditional check failed skipped true task webservers webcontent delete any pre existing tarballs skipping testbox f23 example com changed false skip reason conditional check failed skipped true task webservers webcontent get list of any pre existing tarballs on target webserver skipping testbox f23 example com changed false skip reason conditional check failed skipped true task webservers webcontent delete any pre existing tarballs deprecation warning skipping task due to undefined attribute in the future this will be fatal error this feature will be removed in future release deprecation warnings can be disabled by setting deprecation warnings false in ansible cfg >>>bug_report
adds new device argument to nxapi command arguments the device argument allows dict of nxapi parameters to be passed to the module to simplify passing the nxapi parameters>>>feature_pull_request
playbook on stats callback is called at the end of every play issue type bug report regression ansible version rc1 ansible configuration default environment na summary for callback plugins playbook on stats was only called once at the end of the playbook run regardless of number of plays this made it effectively useful as an on playbook finish callback in playbook on stats is called at the end of every play which breaks accumulator style callbacks steps to reproduce grab sample callback plugin from https gist github com nitzmahone 90a2510226f42c7f6e49 drop into callback plugins run test play yml from same gist expected results on stats should show up only once at the end of the playbook run as it does in actual results on stats shows up at the end of each play filed on behalf of callfire>>>bug_report easyfix
embedded string list vars with handlebars bomb in conditionals issue type bug report regression ansible version rc1 ansible configuration default environment fails on osx and centos6 summary when statements containing embedded templates that resolve to list of strings fail conditional formatting with error the conditional check failed the error was error template error while templating string expected token got string steps to reproduce run the following playbook expected results successful run actual results this worked in can be worked around by ditching the unnecessary handlebars but what weird is that it works fine with non string lists and scalars something odd going on with the templating here we should either fix it or warn about the extraneous handlebars as we do in other places filed on behalf of callfire >>>bug_report
underscore in shell var set bombs in issue type bug report regression ansible version rc1 ansible configuration default environment breaks on centos and osx summary if preceding shell task with envvar sets underscores in the envvar names cause ansible playbook to bomb with the less than helpful error error invalid parameter specified with no contextual information as to what was happening or which file the error is in steps to reproduce run the following playbook hosts localhost tasks shell blar echo expected results stdout blar actual results error invalid parameter specified works as expected in can be worked around by using environment block to set envvars filed on behalf of callfire>>>bug_report
execution delay while using dynamic inventory zabbix issue type bug report ansible version devel 96fcfe45d0 environment debian summary ansible executes task longer when using dynamic inventory using only unmodified zabbix py from repository and not sure if this affects other inventory sources scripts additional notes ve checked what it was doing via strace and saw lot of stat lstat calls trying to read host vars group vars for each host group and at first thought that the problem is directly connected with number of entities in zabbix 184 hosts 18 groups but ve tested static inventory static file ansible hosts contains groups and approximately 150 hosts execute time ansible ansible hosts server hostname ping it takes 3s add additional 200 host records for id in 200 do echo test id done ansible hosts execute same command it takes 5s if you add additional groups and hosts time doesn change significantly to exclude the delay in zabbix py script itself execute time ansible contrib inventory zabbix py list and the result is steps to reproduce execute expected results actual results >>>bug_report
run once with delegate to and register doesn work for multiple hosts issue type bug report ansible version ansible stable 90021104d5 last updated 2015 11 23 15 20 43 gmt 600 lib ansible modules core detached head 191a672891 last updated 2015 05 29 17 54 15 gmt 600 lib ansible modules extras detached head 1276420a3a last updated 2015 05 29 17 51 40 gmt 600 config file home kevin ansible cfg configured module search path usr share ansible ansible configuration pretty standard environment rhel7 x86 64 and fedora rawhide summary if you have task that has run once set and register that variable only works for the first host to hit the task other hosts get undefined variable steps to reproduce use this playbook with valid hosts name test playbook for bug hosts td falcar gather facts false tasks name run test command command uptime register host uptime run once true delegate to localhost name use the output debug var host uptime stdout lines expected results all hosts will be able to use the registered variable actual results the first host gets the variable ok but further hosts have it undefined play test playbook for bug task run test command changed td task use the output ok falcar changed false host uptime stdout lines variable is not defined ok td changed false host uptime stdout lines 15 47 03 up 26 days 26 user load average 00 01 05 play recap falcar ok changed unreachable failed td ok changed unreachable failed >>>bug_report
critical bug report using the user module on mac os will kill your groups description think found really really critical bug at least if not completely wrong when you use the user module http docs ansible com ansible user module html to run task on linux and you don specify the `group` or `groups` parameters then the group membership isn touched if you do the same on mac os then your user groups will be wiped steps to reproduce create new task which changes the user info but not the group for example change the shell run the task on linux and on mac os warning make sure you add your user with the username to the sudoers file because you might end up without any groups and or admin access again don rely on sudo access via group permissions because you probably won have any groups after you ve executed the step above actual result on linux only the shell is changed to usr bin zsh` while the group aren touched on mac os the primary group and all additional groups will be wiped the primary group is set to `nogroup` while all required additional groups are removed `staff` `wheel` `admin` you end up with non privileged user and you can run `sudo` to get it fixed expected result as long as you don specify the `group` or `groups` parameter the groups shouldn be touched at all platform ansible mac os 10 11 python 10 temporary fix messed up my whole system when tried to change the shell as wrote above make sure you ve sudo rule for your user in place before testing the task above if you ve messed up your system reboot into single user mode hold `command s` while booting mount the filesystem for write access add your user to the etc sudoers` file hit `ctrl d` or enter `exit` to continue booting your system and after your system has booted run sudo to add your user back into the right groups not sure if these are the right groups because don have any backup of my group setup before ansible screwed me >>>bug_report
ssh port from inventory gets used on delegated hosts too issue type bug report ansible version ansible stable 1ab60564ae last updated 2015 11 23 21 28 22 gmt 000 lib ansible modules core detached head 572771d0b1 last updated 2015 11 16 16 30 29 gmt 000 lib ansible modules extras detached head e5362cc76a last updated 2015 11 16 16 30 32 gmt 000 config file etc ansible ansible cfg configured module search path srv web infra ansible library usr share ansible ansible configuration pretty standard environment rhel7 x86 64 summary when you specify ssh port to use in inventory the port is used in playbooks for that host even to try and contact delegate to hosts as well steps to reproduce create an inventory with somehost 222 make sure ssh is listening on port 222 on somehost run playbook with name test playbook for bug hosts td gather facts false tasks name task on host with non standard port command uptime name task delegated to another host that has standard port delegate to falcar command uptime expected results both tasks finish correctly actual results first task finishes fine second task fails trying to contact the second host on port 222 instead of 22 >>>bug_report p2
allow debug var parameter to accept list or dict this pr is proposal to fix the following bug report https github com ansible ansible issues 13252 let take the following playbook with this patch ansible is producing the following output >>>bugfix_pull_request
vars prompt allow variables substitution and conditionals issue type feature idea related to 11239 ansible version environment running ansible from what os are you managing summary it seems `vars prompt` does not allow variable substitution `default ansible default ipv4 interface is displayed as is `my prompt ansible default ipv4 interface conditional features even with `when my var is undefined` to `vars prompt` bloc and with the command line `ansible playbook my var test it still prompt for the value steps to reproduce add `vars prompt` to your playbook and call it by setting the variable `my var` expected results should not be prompted for `my var` value actual results am prompted for `my var` and default suggested value is ansible default ipv4 interface as is this issue has been initially erroneously posted on ansible ansible modules core https github com ansible ansible modules core issues 2517 >>>feature_idea
feature request looping over blocks issue type feature idea ansible version ansible rc ansible configuration na environment ubuntu 15 10 summary there are number of use cases where it would be valuable to be able to loop over block of tasks such that few tasks are done in order and that specific block of tasks are looped over for some set of values it seems that the new block functionality could lend itself well to this if you were to enable looping over blocks steps to reproduce expected results actual results >>>feature_idea
modify task executor to reuse connections inside loop also fixed winrm connection to set connected` attribute properly and display when remote shell is opened or closed add winrm integration test using raw with items fixes 9980 and 12910 >>>bugfix_pull_request windows
0r c1 list tasks does not respect tags issue type bug report ansible version ansible detached head f2225395f9 last updated 2015 11 23 17 22 15 gmt 300 lib ansible modules core detached head 64147ab795 last updated 2015 11 23 17 22 33 gmt 300 lib ansible modules extras detached head 1a0ff8a8c8 last updated 2015 11 23 17 22 37 gmt 300 config file etc ansible ansible cfg configured module search path default overrides ansible configuration can be reproduced with default configuration environment can be reproduced on centos as well as mac os summary in ansible rc1 `ansible playbook tags list tasks` lists all tasks in the playbook even if they would not be run with that tag it also lists bunch of meta tasks in this works as expected steps to reproduce playbook expected results output from ansible actual results >>>bug_report
service option must exist disappeared it was mentioned as becamde available in ansible in doc http docs ansible com ansible service module html it also was work as described in recent versions rc1 it produce error and doc does not contain it is that dropped why >>>bug_report
fixing errors with utf values fix for https github com ansible ansible issues 13240>>>bugfix_pull_request needs_revision
problem with dynamic inventory in openstack hi have some problems with dynamic inventory with openstack followed the following steps add metadata on funning instace list inventory in contrib inventory openstack py function get host groups from cloud not exists interface ip what do need to change the code do need to add metadata interface ip to my instance thanks >>>bug_report
v2 rc1 and v2 beta3 iterating over set fact list of dictionaries is broken issue type bug report ansible version ansible head detached at v2 rc1 ansible version ansible detached head f2225395f9 last updated 2015 11 23 10 17 38 gmt 1000 lib ansible modules core devel 0e043f8c58 last updated 2015 11 23 10 13 05 gmt 1000 lib ansible modules extras devel 0298f47df9 last updated 2015 11 23 10 12 09 gmt 1000 running ansible from source v2 rc1 environment osx 10 11 running ansible from source v2 rc1 running boto 38 and boto3 python 10 summary when iterating over set fact list of dictionaries using with items an error of typeerror unhashable type dict is received this works in v2 beta2 but appears to have broken since v2 beta3 it looks like change in ansible lib ansible executor task executor py may have had this affect steps to reproduce name setting fact set fact testing dictionary name number one value one name number two value two name debugging debug var item with items testing dictionary default expected results task allinone setting fact ok 127 ansible facts testing dictionary name number one value one name number two value two changed false invocation module args testing dictionary name number one value one name number two value two module name set fact task allinone debugging ok 127 item name number one value one invocation module args var item module name debug item name number one value one item name number one value one ok 127 item name number two value two invocation module args var item module name debug item name number two value two item name number two value two actual results task allinone setting fact task path testing yml 65 ok 127 ansible facts testing dictionary name number one value one name number two value two changed false invocation module args testing dictionary name number one value one name number two value two module name set fact task allinone debugging task path testing yml 73 an exception occurred during task execution the full traceback is traceback most recent call last file users etherdaemon ansible lib ansible executor process worker py line 134 in run shared loader obj file users etherdaemon ansible lib ansible executor task executor py line 90 in run item results self run loop items file users etherdaemon ansible lib ansible executor task executor py line 228 in run loop res self execute variables task vars file users etherdaemon ansible lib ansible executor task executor py line 387 in execute result self handler run task vars variables file users etherdaemon ansible lib ansible plugins action debug py line 46 in run result self task args var results typeerror unhashable type dict fatal 127 failed failed true stdout >>>bug_report
ansible interpolate filenames with variables copying question from question https groups google com msg ansible project a3wzasyswja px9rvfh3ewaj google group this include works on but fails in >>>bug_report
added instructions for non standard ssh ports and end sentences with periods this pull request exists in the public domain and cannot be licensed the integration of public domain writing is compatible with and pursuant to the terms mentioned in the copying file in this repository you can do what you wish with work in the public domain however it is cruel to coerce person into foreign jurisdiction with possible tax liability incurred upon entering that jurisdiction by making policy where person must to this to contribute to project rather than exercise free speech >>>docs_pull_request needs_revision
fixes to fetch action module now only runs remote checksum when needed fixes 12290 unified return points to simplify program flow>>>bugfix_pull_request
update the vagrant guide for upcoming vagrant release issue type docs pull request ansible version devel environment summary construction not ready for merge yet construction in continuation to 9890 this pull request propose to adapt this guide to usage based on upcoming vagrant guide based on vagrant the full ssh identity is now stored in generated inventory by default done in 2c88cec add section about the new `ansible local` provisioner add section about `ansible galaxy` support steps to reproduce expected results actual results a>>>docs_pull_request needs_revision
msg unsupported parameter for module instace tags error failed localhost failed true msg unsupported parameter for module instace tags code used tasks name provision ec2 instance ec2 key name abcdgrkey group riakgted security group instance type t2 micro image ami d05e75b8 ubuntu image wait yes wait timeout 500 region us east count instace tags name dead stage riak application db client asdfvbn environment staging volumes device name dev sda1>>>needs_info
make vault error type configurable in some cases diff users might want to use the same play with different access levels being able to change vault failure to decrypt to warning or something else allows for this >>>feature_idea
allow multiple vault passwords files vault password could keep prompting until empty password is supplied vault file could take list of files this allows for having multiple vault files with different keys good for ops team having access to all vaults but qa or dev having access only to specific ones>>>feature_idea
add generic pager to ec2 py most of the aws modules have limit on objects returned but most modules do not implement paging recently added this to ec2 elb instead of repeating this logic in all the modules we shoudl have pager function that can be used to wrap pass any function and get all the objects from an api call bit can be function call or maybe decorator >>>cloud feature_idea
add generic retry wrapper for cloud api functions many api calls including cloud services can fail for many reasons but retry might easily allow them to succeed generic function that can be called with retries delay can be added to module utils for modules to use and not have to redo this logic in each one >>>feature_idea
ansible does not allow special chars in sudo password have playbook which is configured with `become true` started it with the option ask become pass` when it asks for the sudo password entered password with many special chars like ai nt with this example password get the following error in ansible had no problems with `sudo yes` and ask sudo password` >>>bug_report pending_closure
we should give pipes quote string every time this fixes an issue in execute module` where we end up passing boolean values `module args ansible check mode `module args ansible no log and `module args ansible debug to `pipes quote which expects string this happens when executing an old style module and enabling either the check mode no log or debug options >>>bugfix_pull_request
need to support ansible playbook with hosts that are immutable for proxies we have use case were we go through proxy and want to copy files from local to remote through it local proxy all hosts we do this in steps copy to proxy distribute this works great however when we want to do this on subset we pass in the subset the intention is to run then run on the subset the actual result as expected is is skipped and run on subset what be useful is something to indicate cannot be subset ed copy to proxy >>>feature_idea
test filters fix add expanduser and test data for fileglob test jinja2 fileglob filter does not support user expansion existing test is always returning empty list when output dir contains as soon as you change output dir to absolute path test will fail because fileglob actually starts working this change will add clean subdirectory with known content for fileglob to work on the glob is passed through expanduser filter so that it would work even with default ansible testing output dir test after the change test is still passing with or without absolute `output dir` >>>bugfix_pull_request
add vault main yml to roles and include by default hi guys we are using ansible vault in order to secure our sensible data in order to keep our roles self contained we use the following role structure given that the include vars statement we loose the ability to do start at task one specific task from configure yaml because we might need variable defined in the vault yaml file it could be great if ansible by default load default vault file the same way it loads defaults main yaml or vars main yaml why not vault main yaml most of the time our use case is to encrypt aws credentials that are used in our roles either to configure software or to simply download the software from an s3 bucket we don want to have the playbook dealing with vault file includes as it could become really messy example feel free to comment if you know an other way to solve this problem thanks lot >>>feature_idea
user module `expires` option always fires changed issue type bug report ansible version ansible configuration no significant changes environment centos summary the `user` module will always fire changed when the `expires` option is set steps to reproduce use the `expires` option when creating user expected results run the playbook for the first time the user is created with an expiration date and changed is fired run the playbook second time nothing has changed and changed is not fired actual results run the playbook for the first time the user is created with an expiration date and changed is fired run the playbook second time nothing has changed and changed is fired >>>bug_report
unformatted pypi page hello https pypi python org pypi ansible looks like this which looks bit unprofessional screenshot https cloud githubusercontent com assets 159967 11303705 e6dbe908 8fac 11e5 9cd2 d83386890570 png if you convert the markup to restructuredtext it ll be rendered properly you can use pandoc for that many projects use the same text for their github readme rst and for their pypi pages by having the setup py reuse the same text not saying you should do that but maybe it ll make your life easier >>>docs_report
set fact cannot overwrite with complex data type parsed from string on the command line issue type bug report ansible version ansible rev d75e707 environment osx 10 11 summary trying to expand string into an array using set fact doesnt work when that argument was passed with e` on the command line steps to reproduce sample playbook run with `ansible playbook example yml test extra expected results `test extra` is an array actual results `test extra` is the same string as passed on the command line you ll see that `test inline` is an array when the string is literal in the playbook so this should be possible output of the above play >>>bug_report
option diff does not show changes when template module used with with items loop issue type bug report ansible version ansible devel d75e707af5 last updated 2015 11 20 15 57 21 gmt 200 lib ansible modules core detached head 88e0bfd75d last updated 2015 11 20 15 57 24 gmt 200 lib ansible modules extras detached head 7da1f8d4ca last updated 2015 11 20 15 57 27 gmt 200 config file configured module search path default overrides ansible configuration none default environment debian gnu linux jessie summary option diff` does not show changes when template module used with loops tested and check` option and with `with items` and `with first found` loops steps to reproduce test yml playbook test j2 template expected results actual results >>>bug_report
modules try to include json fail on hosts with simplejson type bug report ansible version git latest as of today environment ansible host debian ansible clients centos and summary some modules like the puppet module try to include json clients like centos which have simplejson install fail some module have nice try except for json or simplejson could use the try except and fix the other modules if you want and provide pull request my actuall problem wont work if move from json to simplejson but that is probably an other issue >>>bug_report
lifecycle for applying pre post tasks within role on dependent roles issue type question feature idea ansible version ansible configuration environment summary is there any way to apply certain tasks within role right before the role dependencies run am familiar with `pre tasks` and `post tasks` as stated here see below why like to avoid them steps to reproduce the simple playbook looks like where role nginx depends on why such approach like to run certain tasks before role `ansible role nginx` is applied and these tasks are definitely role related create some nginx directories think it sounds quite reasonable to define wrapper role and run whatever is needed there before or after dependent roles trying to isolate my playbook and like to avoid using `pre tasks` or `post tasks` because as the playbook grows it going to be spaghetti code expected results valid scenario to run certain tasks before after dependent role is being applied actual results as aware the only way to run pre post tasks for role is to put them into playbook and use tags eventually to distinguish which tasks run for what role https github com ansible ansible examples blob master language features roletest yml>>>feature_idea
allow groups by tag key values ec2 inventory can already be grouped by many properties like region security group tags keys and others this patch introduces an additional option for getting inventory groups tag values this allows to create tag ansiblegroups with comma separated values like webserver dbserver which will group the hosts into those tag values and if expand csv tags is set to true then you ll get group for each item in the tag list >>>cloud feature_pull_request
run once in role combined with when in playbook is erratic issue type bug report ansible version ansible configuration nothing special environment mac os 10 11 summary playbook that does apply role under certain circumstances using `when` is created within the role task is tagged with `run once` now it seems that run once just selects the first host that was matched from the playbook if that host however actually fails the `when` validation from the roles definition the task is never run skipped steps to reproduce basically look at the above example make sure your `hosts definition matches at least two hosts and your when definition matches only subset expected results expect the task in the playbook to `run once` on one of the hosts that actually are covered by the `when` statement from the playbook actual results sometimes depending on the order of your matched hosts the task is not run at all but marked as skipped for one host that `when` does not match on >>>feature_idea
expect given return code from the command module know that can do this shell do werk true but what would be really nice would be to be able to do this command do werk args return code want the given command to fail that to be expected so like to be able to expect given return code rather than just default to zero the actual use case thinking of is this want `find` to fail to find any broken symlinks >>>feature_idea pending_closure
yum groupinstall not working from the docs example name install the development tools package group yum name development tools state present this has stopped working for me using devel c97c101bd3 see this as result task install the development tools ok machine but when go to the machine and yum groupinstall development tools they are definitely not installed by ansible >>>bug_report p2
tasks with include vars take ages issue type bug report ansible version devel d75e707 ansible configuration environment mac os el capitan 10 11 summary have playbook which starts like this `game env` and `aws env` come from command line e` parameter in order to execute this step need to wait little less than an hour ansible executes that piece of cake in 30 seconds have up to 70 machines in my inventory expected results 30 seconds>>>bug_report needs_info
remote user not working in tasks somewhere between those commits the remote user specified at task level stops working cannot test between cause it not working at all here the sample playbook it should be sshing as test user right now both are ran on root tried to fix that here diff that makes that work again >>>bug_report p2 pending_closure
docker connection does not work with non root user hi have have started the official jenkins docker container named as my jenkins and set up my inventory as follows all tasks of the playbook which is targeted to `my jenkins` as host fail because the default user of the container is not root here the error message when start the container before with `docker user root` everything works fine >>>bug_report
inconsistent example in playbooks async html issue type documentation report summary http docs ansible com ansible playbooks async html has large blue note that states you shouldn use async with things like yum transactions later in the example usage section the example is yum transaction >>>docs_report
fix non module plugins picking up files that did not end in py this was caused by accessing the cache using the passed in mod type rather than the suffix that we calculate with knowledge of whether this is module or non module plugin >>>bugfix_pull_request p2
allow excluding and or overriding transitive role dependencies issue type feature request ansible version devel summary just hitting more and more often serious limitation in the role dependencies that especially restrain the potential to re use opensource roles that contain transitive dependencies the problem quite number of quality roles are split into multiple roles in way that currently we have no control over the lower level dependencies but sometimes you want to not use run transitive role or more often replace override that lower level transitive role with different role either you own or better another opensource role that is better suited for this task good example for this case is very low level role app dependency like java jdk an example illustrates this best myrole private depends on os role osuser role2a for ex azavea spark depends on os role osuser role2b for ex azavea java but myrole would prefer to not run osuser role2b but rather replace it by an alternative osuser2 role2b as far as see there no features yet neither in ansible nor in the branch but would be really awesome to have at least minimal solution in upcoming v2 like disable transitive deps to easier re use original roles without the hassle having to fork branch the existing github os role uncommenting the role dependencies commit have seen many forks just for this publishing the forked role only containing the excluded role when using ansible galaxy note that this workaround proliferates creation of unnecessary forks and hinders people re using improving the best role for purpose possible solutions see but im very open for alternative solutions allow to exclude all or better specific dependencies from depending role like all major jvm build tools support see gradle sbt maven this would be enough in many cases where it easy to directly depend on the replacing role relating to above example myrole could directly dependon run osuser2 role2b before osuser role2a more advanced feature allow to override any transitive role providing replacement role altogether in the supported dependency syntax including urls from github git etc this could also provide solution for following unanswered request pin transitive role dependencies https groups google com forum searchin ansible project 20transitive 20role 20dependencies ansible project 17qwmzbvhls 6tbtgrqjlaaj or introduce more advanced service concept as provided eg by docker compose respectively you could think about way that each role serves publishes specific services like the azavea java role is one provider for the java service but there are many and which role provides implements the service could be configured per role reference searched the mail list for transitive role dependencies https groups google com forum searchin ansible project 20transitive 20role 20dependencies http sdtimes com ansiblefest inside the redesigned ansible ixzz3rwrxvxqh were trying to make it easier for people to contribute code back to us said cammarata related issues https github com ansible ansible pull 10882 allow roles to use dictionary spec in dependencies >>>feature_idea
recommend using pywinrm from pypi instead of github version with nitzmahone recent updates to pywinrm https github com diyan pywinrm pull 74 and https github com diyan pywinrm pull 76 included in pywinrm think we should now recommend using pywinrm from pypi instead of github >>>docs_pull_request windows
fast winrm put file without size restrictions passes all integration tests jimi as requested>>>bugfix_pull_request windows
allow specifying vault password from the environment this would be extremely useful for ci systems such as travis ci org am currently having to take the vault password from the environment it provides save it to secure file and then finally pass `` vault password file`` which all seems waste and lot of busywork could replace this secure file with script that will echo the proposed environment variable but this turns out to be actually even more work and perhaps even uglier ie echo bin sh necho ansible vault password this patch factors out the calls to ``getpass getpass`` so we are not duplicating the the logic in all combinations of ``ask new vault pass`` and ``rekey`` signed off by chris lamb >>>feature_pull_request
async error with check mode issue type bug report ansible version ansible detached head 9b9fb51d9d last updated 2015 11 17 22 25 09 gmt 200 lib ansible modules core detached head b1c0249045 last updated 2015 11 17 22 25 22 gmt 200 lib ansible modules extras detached head 7da1f8d4ca last updated 2015 11 17 22 25 22 gmt 200 config file configured module search path default overrides ansible configuration none environment osx debian debian steps to reproduce ansible playbook hosts test async yml actual results play task async tasks fatal localhost failed changed false failed true msg the async task did not return valid json expected string or buffer play recap localhost ok changed unreachable failed 1>>>bug_report
variable ansible version is not documented the variable `ansible version` is not documented you have to search the google group or the github issues to know about it >>>docs_report
allow tree ish versions for ansible galaxy rebase of 10620 retaining credit for semifocused work for justification etc see 10620 >>>feature_pull_request
make pipelining work with su sudo requiretty while writing http toroid org ansible ssh pipelining it occurred to me that it possible to make pipelining work with su and sudo requiretty here working solution ve been using this for several days now and can say that it very pleasant to use this with pipelining and the recently speeded up v2 thanks to mgedmin for coming up with the python one liner that substituted for sed if the maintainers consider sed an acceptable dependencyas dothe sed version in the commit message is shorter and easier to understand note that this is change to the sh ssh plugins so it not relevant to windows cc abadger>>>feature_pull_request p2
error failed to transfer file to setup just installed ansible devel branch like so `pip2 install git https github com ansible ansible git devel upgrade when use any module besides `raw get an error when it tries to put the file to the host it seems the file name is messed up ansible works fine running openbsd current with python 10 and fish shell `>>>bug_report
copy module resolves paths relative to project root directory instead of role root in ansible on the devel branch the copy module fails to resolve paths relative to the role base instead it resolves them relative to the top level project base for example the following `copy` task in role `application` looks for directory `certificates` in home dmahar projects deployer` instead of home dmahar projects deployer roles application certificates` or home dmahar projects deployer roles application files certificates` should `copy` search for files relative to roles application files or roles application >>>bug_report
documentation compilation fails for latest ansible tried compiling the ansible doc on readthedocs org here https readthedocs org projects ansible builds 3486695 but encountered an error saying `ioerror errno no such file or directory home docs checkouts readthedocs org user builds ansible checkouts stable docsite build doctrees readthedocs index doctree filed an issue https github com sphinx doc sphinx issues 2119 with sphinx https github com sphinx doc sphinx but they said its misconfiguration in the ansible doc directory many builds prior to this one too have failed look here https readthedocs org projects ansible builds please check and fix >>>docs_report
unittest cover for run command all `os `subprocess is mocked to avoid side effects tests are skipped in py3 since run command is not py3 ready yet these tests add 50ms to test execution coverage report https coveralls io builds 4176064 source filename lib 2fansible 2fmodule utils 2fbasic py l1690>>>feature_pull_request
allow real addresses as dig lookup argument this small change allows real ip addresses to be given as arguments to dig lookup without this change `myres query 127 will generate nxdomain on output this change verifies whether the given value has inverse resolution and in that case it returns the ip address given as input know that adding ptr after should solve my issue but in that case the variable holding the addresses cannot be used anywhere else >>>feature_pull_request
add shared connection code for mysql modules>>>feature_pull_request needs_revision
running playbook in reverse order issue type feature idea ansible version devel summary have need to run playbooks in reverse order the reason being is that am using the amazon modules to create infrastructure and want to destroy the infrastructure after am done if some kind of reverse order was supported could pass in the state to each module using an extra variables like this and then each resource would be deleted of course the reverse order feature would need to be there have tried using tags and specifying them in the reverse order to accomplish this but it doesn seem this works example test yml is this how it is supposed to work or am doing something wrong if it doesn work this way can we do something to add this support my preference would be an option like that will reverse the order of the playbook as more and more people use ansible to manage cloud infrastructure this option would be very useful am looking to replace cloudformation with ansible at work and one of the requirements would be the ability to delete existing infrastructure easily having to write and maintain completely separate playbook for deleting is not good option it woudn seem like option would be all that hard to implement but don know enough about it >>>feature_idea
add replacer selinux back into module common selinux special filesystems wasn being replaced with copy template modules adding the replacer back into module common seems to have resolved the issue for me fixes 13188>>>bugfix_pull_request
not reading vars for host in multiple inventory sources it seems that ansible as of 07b588f6c0 does not support multiple inventory files in the same directory like it did before so here we have two inventory files named `generated` and `hosts` in each file we define variable for the host `elastic1` respectively `from generated` and `from hosts` and set is to the string yes with all is fine now ansible 0b3 if rename `generated` to `zippy` so it seems ansible now reads inventory from the first file found sorted alpha and stops here >>>bug_report
fix for dynamic add host hosts not available in hostvars looks like there are two pattern caches that need to be cleared for this to work added the second one added integration tests for add host to prevent future regressions if this pr runs its own tests they may fail until 13184 is merged >>>bugfix_pull_request
let ansible galaxy run on py3 it still has some issues with https certificate verification on my machine is it general >>>feature_pull_request needs_revision
hostvars should return j2 undefined as instance not type v1 v2 regression looks like someone forgot to create an instance of undefined here we were returning the j2 undefined type object on bogus host lookup in hostvars eg hostvars bogushost which broke all the undefined checks eg some obj is undefined changed it to return an instance instead which assume was the intended behavior based on the downstream checks added an integration test around add host that will catch this separate pr to follow >>>bugfix_pull_request
cloudstack add tests for cs volume ansible playbook cloudstack yml inventory cloudstack env yml resource prefix ansible testing afu1efnu tags test cs volume rc exit rc play localhost task test cs volume setup ok localhost changed false task test cs volume verify setup ok localhost msg all assertions passed task test cs volume setup instance changed localhost account admin affinity groups changed true created 2015 11 16t17 30 16 0000 default ip 60 147 41 103 display name ansible testing afu1efnu vm1 domain root hypervisor simulator id 745f919a e0f1 422b a39c cbcefd1025d2 instance name vm name ansible testing afu1efnu vm1 password enabled false security groups default service offering small instance state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs volume verify create instance ok localhost msg all assertions passed task test cs volume setup instance changed localhost account admin affinity groups changed true created 2015 11 16t17 30 22 0000 default ip 60 147 41 109 display name ansible testing afu1efnu vm2 domain root hypervisor simulator id 77ccd637 5c3c 44f1 a726 d0f6f2ad0995 instance name vm name ansible testing afu1efnu vm2 password enabled false security groups default service offering small instance state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs volume verify create instance ok localhost msg all assertions passed task test cs volume test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs volume verify results of fail if missing name ok localhost msg all assertions passed task test cs volume test create volume changed localhost account admin changed true created 2015 11 16t17 30 26 0000 domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state allocated tags type datadisk zone sandbox simulator task test cs volume verify results test create volume ok localhost msg all assertions passed task test cs volume test create volume idempotence ok localhost account admin changed false created 2015 11 16t17 30 26 0000 domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state allocated tags type datadisk zone sandbox simulator task test cs volume verify results test create volume idempotence ok localhost msg all assertions passed task test cs volume test attach volume changed localhost account admin attached 2015 11 16t17 30 32 0000 changed true created 2015 11 16t17 30 26 0000 device id domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk vm ansible testing afu1efnu vm1 zone sandbox simulator task test cs volume verify results test attach volume ok localhost msg all assertions passed task test cs volume test attach volume idempotence ok localhost account admin attached 2015 11 16t17 30 32 0000 changed false created 2015 11 16t17 30 26 0000 device id domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk vm ansible testing afu1efnu vm1 zone sandbox simulator task test cs volume verify results test attach volume idempotence ok localhost msg all assertions passed task test cs volume test attach attached volume to another vm changed localhost account admin attached 2015 11 16t17 30 38 0000 changed true created 2015 11 16t17 30 26 0000 device id domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk vm ansible testing afu1efnu vm2 zone sandbox simulator task test cs volume verify results test attach attached volume to another vm ok localhost msg all assertions passed task test cs volume test attach attached volume to another vm idempotence ok localhost account admin attached 2015 11 16t17 30 38 0000 changed false created 2015 11 16t17 30 26 0000 device id domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk vm ansible testing afu1efnu vm2 zone sandbox simulator task test cs volume verify results test attach attached volume to another vm idempotence ok localhost msg all assertions passed task test cs volume test detach volume changed localhost account admin changed true created 2015 11 16t17 30 26 0000 domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk zone sandbox simulator task test cs volume verify results test detach volume ok localhost msg all assertions passed task test cs volume test detach volume idempotence ok localhost account admin changed false created 2015 11 16t17 30 26 0000 domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk zone sandbox simulator task test cs volume verify results test detach volume idempotence ok localhost msg all assertions passed task test cs volume test delete volume changed localhost account admin changed true created 2015 11 16t17 30 26 0000 domain root id e57f39d3 31f6 4c48 8ec7 9ea35d14f7f8 name ansible testing afu1efnu vol size 5368709120 state ready tags type datadisk zone sandbox simulator task test cs volume verify results test create volume ok localhost msg all assertions passed task test cs volume test delete volume idempotence ok localhost changed false task test cs volume verify results test delete volume idempotence ok localhost msg all assertions passed task test cs volume cleanup instance changed localhost account admin affinity groups changed true created 2015 11 16t17 30 16 0000 default ip 60 147 41 103 display name ansible testing afu1efnu vm1 domain root hypervisor simulator id 745f919a e0f1 422b a39c cbcefd1025d2 instance name vm name ansible testing afu1efnu vm1 password enabled false security groups default service offering small instance state destroyed tags template centos 64 bit no gui simulator zone sandbox simulator task test cs volume verify create instance ok localhost msg all assertions passed task test cs volume cleanup instance changed localhost account admin affinity groups changed true created 2015 11 16t17 30 22 0000 default ip 60 147 41 109 display name ansible testing afu1efnu vm2 domain root hypervisor simulator id 77ccd637 5c3c 44f1 a726 d0f6f2ad0995 instance name vm name ansible testing afu1efnu vm2 password enabled false security groups default service offering small instance state destroyed tags template centos 64 bit no gui simulator zone sandbox simulator task test cs volume verify create instance ok localhost msg all assertions passed play recap localhost ok 32 changed unreachable failed >>>cloud feature_pull_request
cannot trigger handler with variable in name with ansible hi tested to call an handler with variable into notify like restart app found an closed issue similar https github com ansible ansible issues 12427 in this issue pmahoney replied it working on and it is correct also in but in it doesnt work here my test code logs error expected >>>bug_report
bug boolean values don work correctly in vars set to other vars if define variable using another variable in some cases its value is not interpreted correctly here sample playbook all tasks should be skipped but the third one is not hosts localhost vars myvar false anothervar myvar tasks both show as having value false debug var myvar debug var anothervar name this doesn run because myvar is false command bin echo whatever when myvar name this also doesn run because anothervar is the same as myvar command bin echo whatever when anothervar name however this runs while it should not maybe anothervar gets quoted when ansible evaluates the condition command bin echo whatever when anothervar and anothervar name interestingly when we use myvar the condition is evaluated correctly command bin echo whatever when myvar and myvar ansible version ansible os linux mint 17 1>>>bug_report
to json does not seem to handle mixed types properly ansible 0b4 worked ok on have variable defined as create user body active true first name admin last name admin email address admin admin co uk then have task which does this and get this error it seems to be escaping the strings when it doesn need to be if remove active true or turn it into string it seems to work ok but then the api using can parse the string as boolean>>>bug_report
ansible shell type and make become cmd are at odds while investigating 12290 found that if you set ``ansible shell type csh`` then we construct csh syntax command line using ``env python`` and `` dev null`` which works if you re not using privilege escalation but ``make become cmd`` doesn know about ``ansible shell type`` so it ends up issuing ``sh `` which results in bad fd errors from bash which doesn accept `` dev null`` >>>bug_report
fixes 13177 ec2 inventory elasticache using incorrect profile fixes 13177 by updating the connection method when getting elasticache details from aws >>>bugfix_pull_request cloud
dynamic inventory script ec2 py elasticache forbidden error noauthhandlerfound issue type bug report ansible version ansible detached head de54f26376 last updated 2015 11 13 13 35 35 gmt 1000 lib ansible modules core detached head 6e37f1dcef last updated 2015 11 13 13 31 27 gmt 1000 lib ansible modules extras detached head e52e015791 last updated 2015 11 13 13 31 27 gmt 1000 running ansible from source v2 beta2 environment osx 10 11 running ansible from source v2 beta2 running boto 38 and boto3 python 10 summary when utilising the ec2 py dynamic inventory with aws profiles and not setting elasticache false boto exception noauthhandlerfound is returned when no default profile is set or forbidden when default profile is set to incorrect keys it does not utilise the boto profile set in the ec2 ini file for elasticache calls like it does with ec2 calls steps to reproduce setup home aws credentials with no default profile set and profile name of something else set to what you require and setup the ec2 ini to call that specific profile and elasticache true or no elasticache declaration less home aws credentials default aws access key id aws secret access key personal aws access key id aws secret access key less home inventory ec2 ini boto profile personal elasticache true expected results inventory returned from personal aws account actual results python inventory ec2 py refresh cache boto exception noauthhandlerfound no handler was ready to authenticate handlers were checked hmacauthv4handler check your credentials or the below when default profile has keys not set error forbidden while getting elasticache clusters proposed fix update contrib inventory ec2 py with the following def get elasticache clusters by region self region makes an aws api call to the list of elasticache clusters with nodes info in particular region elasticache boto module doesn provide get all intances method that why we need to call describe directly it would be called by the shorthand method anyway try conn self connect to aws elasticache region def get elasticache replication groups by region self region makes an aws api call to the list of elasticache replication groups in particular region elasticache boto module doesn provide get all intances method that why we need to call describe directly it would be called by the shorthand method anyway try conn self connect to aws elasticache region >>>bug_report cloud
fix su doas support in make become cmd>>>bugfix_pull_request
wrong diagnostics in ansible galaxy on certificate issues issue type bug report ansible version ansible configuration clean out of box configuration on some os environment generic non mainstream os in my case alt linux sisypus unstable branch summary on non mainstream os with non standard ssl tls ca certificate paths not in etc ssl certs etc pki ca trust extracted pem etc pki tls certs usr share ca certificates cacert org etc ansible in my case diagnostics on any problem with certificate check in ansible galaxy is just plain wrong the api server galaxy ansible com is not responding please try again later steps to reproduce try to install any galaxy role just after clean ansible install ansible galaxy will fail to check correct ssl tls certificate of galaxy ansible com with wrong error message expected results actual results sane test workaround works for me >>>bug_report
consul kv lookup super invocation fix was getting this error with the latest devel build file usr local lib python2 dist packages ansible py2 egg ansible plugins init py line 331 in get obj getattr self module cache path self class name args kwargs file usr local lib python2 dist packages ansible py2 egg ansible plugins lookup consul kv py line 78 in init super lookupbase self init loader templar kwargs typeerror object init takes no parameters` this pr fixes it >>>bugfix_pull_request
removed erroneous apostrophe in installation documentation>>>docs_pull_request
backport fix for ignoring errors produced by non posix file systems requesting bugfix https github com ansible ansible issues 9526 to be applied to the mainstream release >>>backport
add test for changing git remote url integration test for https github com ansible ansible modules core pull 721 clone repo from one url clone an updated version of that repo from new url make sure the remote url and the working copy are updated>>>feature_pull_request
evaluate includes for skipped tags we cannot evaluate for include tags as underlying tasks might have them but skips override so this should be performance boost>>>bugfix_pull_request
do not try to load group host vars files if directory does not exist if the parent directory does not exist do not try to load various host or group file result in small speed improvement >>>feature_pull_request
trivial add release name to releases txt>>>docs_pull_request
patch to remove dependency on boto when only using boto3 as discussed here https github com ansible ansible modules extras pull 1223 this allows the use of `get aws connection info` boto when using boto3 exclusively>>>bugfix_pull_request cloud
error when invoke playbook in el capitan hello when invoke the playbook have this error actually get the same error even invoking ansible playbook alone traceback most recent call last file usr local bin ansible galaxy line 959 in main file usr local bin ansible galaxy line 953 in main fn args options parser file usr local bin ansible galaxy line 767 in execute install roles left map ansible utils role yaml parse yaml safe load file library python site packages ansible utils init py line 434 in role yaml parse if github com in role src and http in role src and not in role src and not role src endswith tar gz keyerror src >>>needs_info
make sure cloud modules deal with paging for example some of the aws apis will return limited amount of objects for each query but most of the existing modules assume that the calls will return all existing objects they need to be updated to check if paging is needed and then loop to get the results we might also want to consider allowing generic pagesize limit for those that don want to get huge number of objects >>>cloud feature_idea
connection local not using local connection on latest devel running with vvvv clearly shows it using the user of the remote host and attempting to ssh this issue doesn exist on the latest tag v2 beta2 at commit de54f26376968ebc6362137f34b5ecb584bc90eb >>>bug_report needs_info
debug task is run even though dependent task is skipped found case in ansible also present in where debug task with `when whatever success` runs even though the task that registers `whatever` was skipped was able to reproduce with this playbook which results in the following output >>>bug_report
ansible playbook prints traceback when there typo in role config issue type bug report ansible version ansible summary ansible playbook throws traceback instead of error when there typo in role meta main yml file steps to reproduce run ansible playbook on playbook using role with following meta main yml expected results ansible should print error message about incorrect syntax actual results >>>bug_report
ini file module does not create destination file issue type bug report ansible version ansible playbook devel 5d645f3a8b last updated 2015 11 13 13 27 13 gmt 200 environment ubuntu 15 04 summary ini file does not create the destination file when it does not exist steps to reproduce expected result etc foobar conf should be created as it does not exist actual result using ansible the destination file gets created just as expected>>>bug_report p2 pending_closure
lxc inventory scripts fix libvirt lxc this is minor fix to the `libvirt lxc py` inventory script which now correctly sets `ansible connection` to `libvirt lxc` instead of just `lxc` >>>feature_pull_request
if ssh died it an error not timeout see discussion in 12916 and 13147 >>>bugfix_pull_request
tags not added to tasks included with tags option type bug report version environment centos summary opening second time because made spelling mistake in previous issue submission but this is not the main problem checked this when execute playbook where tasks are included the same for tasks included in roles tasks and the taggs option is added to include statement tasks are not executed through ansible playbook tag unless each of tasks doesn have tag added independently the same tests with previous version for instance of ansible were working properly if someone can point me where should look around for this issue in code can volunteer to help to reproduce one can use files and commands like below my files looks like root cinek2 test cat test yml hosts localhost tasks include test inc yml tags tak root cinek2 test cat test inc yml name test debug var ansible all ipv4 addresses root cinek2 test ansible playbook test yml play task setup ok localhost task include tags tak included tmp test test inc yml for localhost task test ok localhost changed false ansible all ipv4 addresses 10 157 play recap localhost ok changed unreachable failed root cinek2 test ansible playbook tak test yml play task setup ok localhost task include tags tak included tmp test test inc yml for localhost play recap localhost ok changed unreachable failed and with ansible root cinek tmp cat tmp test yml hosts localhost tasks include test inc yml tags tak root cinek tmp cat tmp test inc yml name test debug var ansible all ipv4 addresses root cinek tmp ansible playbook test yml play localhost gathering facts ok localhost task test ok localhost var 10 151 10 151 play recap localhost ok changed unreachable failed root cinek tmp ansible playbook tak test yml play localhost gathering facts ok localhost task test ok localhost var 10 151 10 151 play recap localhost ok changed unreachable failed >>>bug_report pending_closure
bug report synchronize module asks password this is duplicate of 5934 https github com ansible ansible issues 5934 issue type bug report ansible version ansible configuration original environment os yosemite 10 10 14f1021 summary inventory provision yml steps to reproduce expected results `synchronize` should not ask for password as other tasks do actual results debugging steps ve go to `ansible modules core files synchronize py` and put `print cmdstr before rc out err module run command cmd module generated the next command and even more open the `ansible runner init py` and put `print cmd before `res self low level exec command conn cmd tmp become self become sudoable sudoable in data in data module generated something like when execute one of these raw commands then everything fine >>>needs_to_be_moved
bug unboundlocalerror local variable task action referenced before assignment hi when use ansible2 playbook to test loop nested it can not run correctly this is my test yml hosts all vars listvar1 tasks shell echo nested test item item with nested listvar1 when run ansible playbook test yml it return me an exception occurred during task execution to see the full traceback use vvv the error was unboundlocalerror local variable task action referenced before assignment when run ansible it can run correctly no errors please help me thanks >>>pending_closure
increase the escalation prompt timeout it was set to match the ssh connect timeout unfortunately they would race when we wouldn connect and the connect timeout usually failed this led to some misleading error messages fixes 12916>>>bugfix_pull_request
lxc connection plugin this plugin has been tested in production for more than year see https github com mic92 ansible lxc for reference >>>feature_pull_request new_plugin
ec2 inventory add instance metadata and additional groups based on vpc and subnet info adds around vpc subnet cidr name id and tags also incorporates another branch that consolidates the inventory push calls >>>cloud feature_pull_request
make jsonfile fact cache handle fancy paths properly basically fixes 13094 os path expanduser as well as path expandvars is applied before before storing cache plugin connection as instance attribute >>>bugfix_pull_request
update debian packaging documentation add docbook xml xsltproc packaging build dependencies in readme fix 13139 fix 13140>>>docs_pull_request
missing `xsltproc` debian packaging readme `packaging debian readme md` does not include installation of `xsltproc` which provides missing local eponym command make deb a2x docs man man1 manpage manpage docs man man1 ansible asciidoc a2x warning destination dir option is only applicable to html based outputs a2x error xsltproc stringparam callout graphics stringparam navig graphics stringparam admon textlabel stringparam admon graphics etc asciidoc docbook xsl manpage xsl docs man man1 ansible xml returned non zero exit status 127 makefile 117 recipe for target docs man man1 ansible failed make docs man man1 ansible error rm docs man man1 ansible asciidoc >>>docs_report
missing `docbook xml` debian packaging readme `packaging debian readme md` does not include installation of `docbook xml` which provides missing local usr share xml docbook schema dtd docbookx dtd` file make deb a2x docs man man1 manpage manpage docs man man1 ansible asciidoc a2x warning destination dir option is only applicable to html based outputs a2x error xmllint nonet noout valid docs man man1 ansible xml returned non zero exit status makefile 117 recipe for target docs man man1 ansible failed make docs man man1 ansible error rm docs man man1 ansible asciidoc >>>docs_report
fix coveralls code coverage report submitting code coverage report to `coveralls io` probably never worked this is adding the necessary command integration tests were also breaking this feature either because they cd to different directory or hack path pythonpath didn look into it too deep instead ve put them into sub shell for protection while working on this change it occurred to me that it would be prudent to separate unittest and integration tests into separate jobs just an idea note to enabled coverage reports someone with admin rights to `ansible ansible` would need to enable it on https coveralls io repos new >>>feature_pull_request
use of connection local prevents delgate to another host ansible version ansible configuraiton environment ubuntu 14 04 summary `connection local` specified in playbook or through command line prevents `delegate to` for non local hosts reproduction run playbook `ansible playbook connection local repro yml instance some host v` playbook follows expected remote tasks should indicate remote hostname this can be demonstrated by commenting out `connection local` in the above play actual remote tasks indicate the local hostname it is clear that the command is executing through local connection rather than through ssh workarounds remove connection local from the playbook and ensure ansible connection local is set for localhost in inventory `localhost ansible connection local` restructure to isolate connection local to playbook that does not need to use delegate to am recording this issue primarily to document the workarounds for others >>>bug_report
fix ordering quirks in changelog>>>docs_pull_request
now we don try to convert types if certain filters specially those specifically to return formated string>>>bugfix_pull_request
asynchronous failed retries logs as red just wanted to clarify if the following line is correct for the task executor py the line will be logged in red however in cases use it in would not consider it an error if it fails to do retry as have some long running tasks that may poll many times to get the result have changed this to yellow on my local install is the colour red planned to be used in the release would find it odd as it can be confusing as nothing has really gone wrong >>>bug_report
abnormal large task timings on the v2 beta1 tag currently getting abnormally large task timings all appear slightly different but start with 1447240 however some of the tasks do appear to log an accurate time running in centos ve been unable to identify pattern in terms of if it is related to specific module or action for given task it almost appears to be random wondering if anyone else has seen this on the dev branch >>>bug_report
copy module will move file instead copying it remote src true issue type bug report ansible version ansible devel b2a9111b22 last updated 2015 11 11 15 03 24 gmt 200 environment ubuntu 15 04 summary ansible will not copy but move file when called with force no and remote src true steps to reproduce expected result usr share php5 php ini production will be copied to tmp test conf actual result usr share php5 php ini production will be moved to tmp test conf source file is removed ansible will fail when source file system is read only as it cannot remove the file usr is mounted read only in this example fatal removed failed changed false failed true msg msg could not replace file usr share php5 php ini production to tmp test conf errno 30 read only file system usr share php5 php ini production failed true nexception oserror no such file or directory tmp ansible tmp8zpmhvtest conf in mode at 0x7f241188c4b0 ignored parsed false `>>>bug_report
elevate privileges when checking for file existence certain oss default to home directories as 0700 without elevating privileges checking for file existence fails >>>feature_pull_request
missing documentation for lookup plugin dig issue type documentation report ansible version ansible configuration environment debian jessie summary lookup plugin dig is not documented on the http docs ansible com ansible playbooks lookups html page expected results lookup plugin dig is documented actual results lookup plugin dig is not documented >>>docs_report
variables not interpolated in environment when using block issue type bug report ansible version ansible configuration no changes environment ubuntu 14 04 summary when using an `environment section in block variables are not interpolated this broke with commit 76ae5775192b03f390df0fd04b14b9d79324a9c5 steps to reproduce expected results actual results >>>bug_report
ec2 py dynamic inventory applies the replace dash in groups opposite of what is expected issue type bug report ansible version ec2 py inventory from devel branch on github git commit faeccb4 ansible configuration nothing running ec2 py directly environment fedora 21 x86 64 but probably summary the ec2 py inventory to safe method has the logic for replace dash in groups opposite of what is expected currently it this think it should be this notice the if not if this change is added to maintain backwards compatibility think you need to default it to false like this steps to reproduce add this to ec2 ini `replace dash in groups yes` run ec2 py directly `ec2 py refresh cache` notice in the output that the group name dashes have not been replaced as expected change ec2 ini to this `replace dash in groups no` run ec2 py directly `ec2 py refresh cache` notice in the output that the group name dashes have unexpectedly been replaced expected results when say yes to replace dash in groups it should replace the dashes when say no it should not replace the dashes actual results it applies the setting opposite of what is expected >>>bug_report
ansible doc doesn display modules deprecated field module docs have deprecated field that contains information about what module replaces module that we re getting rid of this information isn present in the output of ansible doc module name >>>bug_report
exit json and fail json improvements bugfix exit json fail json now allows to module dev to specify the json depth from 99 defaulting to 10 this is done to overcome bug where powershell will hang indefinetely if complex objects are converted to json when depth is set to 99 ref 13095 and discussion at https groups google com forum topic ansible devel n8kmlvi9wj4>>>bugfix_pull_request needs_revision windows
remote user on task doesn work issue type bug report ansible version ansible configuration standard environment aix control machine remote host summary when setting different remote user on task it doesn actually switch to it steps to reproduce expected results output should be user2 actual results output is user1 >>>bug_report
add initial support for arista eapi this commit adds the shared module support for arisat eos devices running eapi the shared module builds on top of module utils urls py >>>feature_pull_request
bug report limit no longer working hi limit option is no longer working after commit c753ae6 ansible version ansible playbook devel d8fb5efa90 last updated 2015 11 10 17 07 26 gmt 800 lib ansible modules core detached head fde6ee15d6 last updated 2015 11 10 17 11 10 gmt 800 lib ansible modules extras detached head 6cc43bbd56 last updated 2015 11 10 17 16 15 gmt 800 config file configured module search path default overrides ansible configuration clean version from github environment linux mint 17 rafaela python steps to reproduce create the inventory file and play yml inventory host1 ansible ssh host 127 ansible ssh port 22 host2 ansible ssh host 127 ansible ssh port 22 host3 ansible ssh host 127 ansible ssh port 22 myhostgroup host1 host2 host3 play yml hosts all connection local tasks debug var hostvars inventory hostname run playbook list host option to see affected hosts it will disregard the option and show all hosts ansible playbook inventory host1 list hosts play yml playbook play yml play pattern all hosts host3 host2 host1 checkout previous commit before c753ae6 git checkout e8f83dcba34ce7ea22d63b0e5f0b57b9dd49e853 re run playbook result will only show host specified in option ansible playbook inventory host1 list hosts play yml warning the variable environment appears to be used already which is also used internally for environment variables set on the task block play you should use different variable name to avoid conflicts with this internal variable playbook play yml play pattern all hosts host1 >>>bug_report
v2 typeerror super type obj obj must be an instance or subtype of type ansible version summary my vagrant test playbook failed with this error this playbook works with ansible using custom module https gist github com mgedmin 5f8ac034df0c371444be the module has custom action plugin needed to support diff on ansible but this doesn do anything on v2 just re imports actionmodule from ansible plugins action normal ll try to reproduce with smaller example >>>bug_report
the variable environment appears to be used already issue type bug report ansible version ansible ansible configuration ssh connection ssh args environment ubuntu 12 04 ubuntu 15 04 server summary after upgrading to the latest development version `ansible playbook` displays the warning warning the variable environment appears to be used already which is also used internally for environment variables set on the task block play you should use different variable name to avoid conflicts with this internal variable steps to reproduce `playbook json` expected results execution without warnings actual results execution with warning >>>bug_report
ipaddr does not adhere to rfc3021 31 masks issue type bug report ansible version summary the ipaddr filter introduced in ansible does not adhere to rfc 3021 using 31 bit prefixes on ipv4 point to point links according to this rfc 31 prefix can be used to address point to point link in this case the network and broadcast addresses are not applicable the two addresses within the 31 prefix are used in order to address the two ends of the link the ipaddr filter does not respect this rfc and it recognises the first ip within the 31 as network ip note someone could claim that adherence to this rfc should be classified as feature request but as 31s are practically unusable out of the context of rfc3021 file this as bug code address 192 168 31 ipaddr address network 192 168 31 ipaddr network expected results address 192 168 network none actual results address none network 192 168 0>>>bug_report
ansible fails with an exception in python sinply run command forever stopall but get this output from stdout when it fails fatal node1 traceback most recent call last file library python site packages ansible runner init py line 586 in executor exec rc self executor internal host new stdin file library python site packages ansible runner init py line 789 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file library python site packages ansible runner init py line 1005 in executor internal inner num args post self count module args module args file library python site packages ansible runner init py line 433 in count module args vargs split args args file library python site packages ansible module utils splitter py line 73 in split args args args strip attributeerror dict object has no attribute strip >>>needs_info
new method template no cache for template object this method do not compute hash and is used when you know that the result does not need to be cached like with items loop it also result in small speed improvement here some numbers playbook before 7e04947 last devel after issue vars yml 2s 1s 64s no vars mapping yml 5s 8s 9s real playbook yml 11 5s 25 4s 9s and of course the yum module with item is working >>>feature_pull_request
limit ansible pull to single matching hostname like to be able to use ansible pull and set some inventory variables for certain machines localhost ansible connection local updates testing vmf22 cora nwra com updates testing vars repo fedora updates testing enabled however don want to have to list every host in the inventory as also making use of cobbler at least on my ansible manager for inventory and so like to have localhost entry as well however when this runs on vmf22 get multiple matches task common template src fedora updates testing repo j2 dest etc yum repos fedora updates testing repo changed localhost ok vmf22 cora nwra com and in fact since localhost gets processed first it looks like the configuration is not correct think it would make bit more sense if ansible pull limited the run to the first matching host at put the hostname matches first >>>feature_idea
fix get dns facts on inexistent resolv conf this fixes the get dns facts function when etc resolv conf is not present or unreadable >>>bugfix_pull_request
securly pass passwords secrets for modules that need to do another level of authentication mostly geared to the syncronize module https github com ansible ansible pull 12704 https github com ansible ansible modules core pull 2247 but we should also look into making this usable by git svn get url etc other modules that can do subsequent authentications >>>feature_idea
fix get file lines on inexistent file noticed an error when etc resolv conf does not exist and tracked it down to the open call in get file lines this patch fixes the error by checking for the file and read access moving the open call inside the try block and returning an empty list >>>needs_revision
variable not found error in non templated file bug report ansible default vanilla configurations not os dependent have some files that are loaded in multiple ansible plays in some of my plays these files need to go through the jinja interpreter at other times jinja templating is not necessary and just want to load the files as raw string the problem is that when load the file as raw string accessing the string gives variable not found error note that this is not an issue with the debug module itself any sort of reference to `echo output` see below example in downstream tasks will give the same error in my play using an ansible role and in the task use loop the lookup module debug module and register block which may complicate things the error can be reproduced by using the below files expected results `echo output` is returned to the console since the example task succeeds am guaranteed to be able to print out echo output without error the content output was never instructed to be interpreted by jinja so some var remains in the output actual results jinja templating is applied to the `echo output` when the debug module references it since the variable is not defined at this time an error is thrown unimportant rambling are there any workarounds can use in the meantime in general ve seen the debug module fail depending on the content it is outputting due to jinja templating occurring when data is written out also since jinja is invoked when variables are referenced rather than when they are created lot of errors occur in downstream tasks rather than up front when the debug module fails it is very hard to figure out what is wrong can the debug module have turn jinja off or just print what you can setting being able to provide global default value for all vars in task so don have to modify ansible cfg would also help mitigate this issue >>>feature_pull_request
empty with should skip task this is ticket to remind about 1408 which remains unfixed so far >>>bug_report needs_info
exit json should be less nested referencing https groups google com forum topic ansible devel n8kmlvi9wj4 exit json by default converts strings up to 99 levels can think of any scenario where this is needed it actually makes my environment fail and causes powershell to die on me setup ps1 after my pr is eventually pulled and win msi are two modules that can potentially return huge strings imo this is big bug that should be fixed soon >>>bug_report windows
fact caching connection don handle path expansion of nor home version but probably also devel when configure fact caching directory using the jsonfile cache plugin am specifying its path using the or home variable this works with other parameters like retry files save path but not with fact caching connection ansible fails with message that the directory does not exist what is false >>>bug_report
unboudlocalerror local variable referenced before assignment version but also devel as the file handling code does not changed server client os ubuntu this is not duplicate of 2618 when defining caching path for the jsonfile caching plugin that is not writable by ansible ansible fails with the following message fatal my host traceback most recent call last file home david pip ansible lib ansible runner init py line 586 in executor exec rc self executor internal host new stdin file home david pip ansible lib ansible runner init py line 668 in executor internal inject self get inject vars host file home david pip ansible lib ansible runner init py line 611 in get inject vars combined cache self get combined cache file home david pip ansible lib ansible runner init py line 606 in get combined cache combined cache self setup cache copy file home david pip ansible lib ansible cache init py line 54 in copy return dict for in self iteritems file usr lib python2 abcoll py line 406 in iteritems yield key self key file home david pip ansible lib ansible cache init py line 35 in getitem return self plugin get key file home david pip ansible lib ansible cache jsonfile py line 69 in get close unboundlocalerror local variable referenced before assignment >>>bug_report
initial shared module support for nxapi adds shared module support for writing modules that work with cisco nexus devices over nxapi>>>feature_pull_request
v2 local action icw set fact not working on ansible this works as expected in develop however it does not >>>bug_report
synchronize module fails on hello using ansible vanilla from ubuntu 15 10 in one of the playbooks have task as follows few months ago it was successful now it fails also had to change all my playbooks don know if it is related to the sync issue for instance had an ansible set of playbooks the folder structure was containing top level files folder itself populated with everything that would eventually be copied remotely until few months ago my playbooks were running just fine using the copy module and omitting the files prefix in my paths now had to add the prefix to all my copy operations because ansible was unable to find the files as the logs showed that ansible was only looking inside each roles xxx files folders are there any regression tests done on ansible we are considering ansible tower on many of my company projects but given the various discrepancies we had over time we are still uncomfortable doing so do you recommend freezing the minor ansible version months ago when the playbooks were working was also using the branch and such differences between the same major version are bit scary >>>bug_report needs_info
v2 yum with items not working issue type bug report ansible version this was the commit that broke it ansible checkout 5040abaaf24a3de32ac665a35e83a5348de43098 ansible configuration environment centos summary steps to reproduce it just lists the the first item in yum pkgs as every item so if for example expected results it installs vim and gedit actual results it would install vim and vim it would act like the list was same thing for and >>>bug_report p1
yum honour package version pinning via yum plugin versionlock issue type feature idea ansible version ansible ansible configuration environment systems using yum with yum plugin versionlock ansible pkg mgr yum yum opts comnmand loaded plugins langpacks versionlock summary this feature would allow one to ensure desired package version is installed and ensure that the version is not changed outside of the current play general system maintenance windows the state latest option is less desirable due to the overhead of needing to update caches for repoquery working with state installed could ensure that the desired version is installed during play itself exposing new state would add undue complexity esp where default handling should be present yum state install ignores versionlock settings for matching package this appears to be due to the yum module checking if the package is installed though not if it is correct steps to reproduce install old version of package ensure newer package is avaialbe to system via yum rhn subscription manager update etc yum pluginconf versionlock list with nvr of newer package run play against host using yum name package name state installed expected results if the package is already installed and the package matches entry in etc yum pluginconf versionlock list and versionlock plugin is available replace states installed and latest with check if not matching nvr in file upgrade to desired version changed if it that fails error else ok actual results observe that the package is not updated to the version locked version >>>feature_idea
v2 win stat does not support hidden directorylike svn have iisroot tiger svn directory execution ansible iis01 win stat path iisroot tiger svn iis01 success changed false stat exists false win stat module not support this >>>needs_to_be_moved windows
strange inventory behavior with inventory directory find type xargs n1 cat cat inventory item1 hostname1 cat inventory item2 hostname1 ansible connection docker ansible host b0271bf10b34 cat playbook yml hosts hostname1 tasks ping ansible playbook inventory playbook yml play task setup fatal hostname1 unreachable changed false msg error ssh encountered an unknown error during the connection we recommend you re run the command using vvvv which will enable ssh debugging output to help diagnose the issue unreachable true play recap hostname1 ok changed unreachable failed ansible playbook inventory playbook yml play task setup ok hostname1 task ping ok hostname1 play recap hostname1 ok changed unreachable failed 0>>>bug_report
create mongo py adds inventory script for mongo db >>>feature_pull_request
replace pycrypto usage with cryptography io pycrypto is not installable on generic windows machine because it is not shipped with wheels http cryptography io can be used as replacement from crypto hash import sha256 hmac from crypto util import counter from crypto protocol kdf import pbkdf2 from crypto cipher import aes as aes from crypto pct warnings import powminsecurewarning from crypto random import atfork >>>feature_idea
use ansible host in synchronize module fixes 13073>>>bugfix_pull_request
synchronize uses deprecated ansible ssh host variable synchronize module doesn work for me http docs ansible com ansible intro inventory html states that ansible ssh host is deprecated the synchronize module tries to use this deprecated variable with fallback to the inventory hostname neither works for me ansible ssh host is not defined use ansible host inventory hostname is an alias that is not resolvable with dns think the module should try ansible host first then ansible ssh host for legacy inventories and fall back to inventory hostname thanks >>>bug_report
cache optimization small patch to enhance cache with ansible used playbook huge inventory yml host count before after 100 1s 5s 200 6s 39s playbook content >>>feature_pull_request
auto inclusion of vaulted files in group vars and host vars adds vaulted files to the autoloaded files in `group vars` and `host vars` files follow the naming conventions vault yml` for vault files in `host vars` and vault yml` for vault files in `group vars` >>>feature_pull_request
add check opts to ansible pull want to run ansible pull with diff >>>needs_revision
ppa on linux mint on ubuntu target add nginx stable repository from ppa and install its signing key on debian target adding ppa is not available so it will fail immediately >>>needs_info
ansible executing every other task running ansible devel 5b84bd6b5d last updated 2015 11 06 08 18 12 gmt 500 lib ansible modules core detached head 35707bcb3c last updated 2015 11 06 08 18 15 gmt 500 lib ansible modules extras detached head f281eb2b30 last updated 2015 11 06 08 18 17 gmt 500 when execute tasks it appears to be skipping every other task get the following output task baseserver role apt state installed pkg lynx task baseserver role apt state installed pkg links changed 10 27 task baseserver role apt state installed pkg elinks task baseserver role apt state installed pkg curl changed 10 27 task baseserver role apt state installed pkg wget task baseserver role apt state installed pkg mysql client ok 10 27 and when go to the server only every other package has been installed >>>bug_report needs_info
shell with items prompts for ssh key password on second command have seen something when running the shell module along with with items where it now prompts for key pass phrase it runs the first command with no password prompt but then on the second one it prompts for key password and fails the task name shell commands shell item with items echo test echo test when running the playbook you get prompted for key passphrase enter passphrase for key home vagrant ssh id rsa this previously worked on the v2 beta1 tag but no longer works on later tags and on the dev branch >>>bug_report
indexerror list index out of range due to commit 3c35655b529751e608403e88ccc9fc2ef68ccc42 issue type bug report ansible version from devel branch ansible configuration stock fedora 21 environment fedora 21 ansible from devel branch webservers `yaml name test hosts localhost gather facts false tasks name hello world command echo hello world traceback most recent call last file usr bin ansible playbook line 84 in sys exit cli run file usr lib python2 site packages ansible cli playbook py line 142 in run results pbex run file usr lib python2 site packages ansible executor playbook executor py line 140 in run result self tqm run play play file usr lib python2 site packages ansible executor task queue manager py line 229 in run return strategy run iterator play context file usr lib python2 site packages ansible plugins strategy linear py line 237 in run self queue task host task task vars play context file usr lib python2 site packages ansible plugins strategy init py line 150 in queue task worker prc main rslt self workers self cur worker indexerror list index out of range python num workers max min self options forks len self inventory list hosts >>>bug_report
v2 template fix regression bug in template in case force false fixes regression bug previously reported in 12844 fixed with 4b2088471909e9f785dc2d52ce3c46c95d54e463 re introduced with c64ac90560938811fac4ff32ae69e1e667dddc34 cat tmp test yml hosts localhost tasks template src etc hosts dest etc hostname force no without patch ansible playbook test yml check warning provided hosts list is empty only localhost is available play task setup ok localhost task template dest etc hostname src etc hosts force no changed localhost play recap localhost ok changed unreachable failed with patch ansible playbook test yml check warning provided hosts list is empty only localhost is available play task setup ok localhost task template dest etc hostname src etc hosts force no ok localhost play recap localhost ok changed unreachable failed >>>bugfix_pull_request
ansible is ignoring user settings on ssh config hi im trying to set remote ssh user via ssh config but ansible is not using that user on the changelog see the following line we do not ignore the explicitly set login user for ssh when it matches the current user anymore this allows overriding ssh config when it is set explicitly leaving it unset will still use the same user and respect ssh config but this is currently not happening the user is still ignored if set in the options in ssh config steps to reproduce set user on ssh config like create dummy playbook create dummy inventory file like run ansible playbook with different user than defined in user above and you will see that the ssh option user is passed as an argument with the username that it is running the playbook and not the one specified in the ssh config so it seems ansible is ignoring the ssh config options although defined username there >>>bug_report
add sles sap as suse family cat etc os release name sles sap version 12 version id 12 pretty name suse linux enterprise server for sap applications 12 id sles sap ansi color 32 cpe name cpe suse sles sap 12 >>>feature_pull_request
feature controlpersist optimization for each segment of jump via proxycommand the new `ansible ssh common args` lets me add `proxycommand` argument to the `ssh` invocation for entire inventory groups which simplifies use of an ssh jump host my understanding from reading tickets is that this was implemented to permit use of proxycommand without having to override the whole `ssh args` or alternatively without needing to use the ssh config` of the invoking user however when using `proxycommand` this way the control socket in the filesystem is keyed off the far hop inner tunnel of the jump which means the near hop does not use persistent socket if another host needs to be reached via the jump gate an entirely new socket will be set up even though we could reuse it for the inner portion first hop of the jump if reaching 1000 remote hosts via jump gate we will make 1000 separate ssh invocations each with its own control socket and no re use it only reuses if same far host is destination this could be optimized by using controlpath to describe only the near hop and then use another ssh with controlpath on the far side don know if this is real issue or not but thought it was worth submitting ticket for think it would involve making jump host scenario first class connection property that was implemented in code that could then be nested and duplicated on the remote end rather than just string append to ssh args if this is just totally crazy by all means close ticket think it could help some scenarios though it would avoid doing the first half of the jump circuit 999 times in the case of 1000 jump targets on the far side so it would have to do only 1001 total ssh setups rather than 2000 which could really be big win >>>feature_idea
fixes 13010 by updating boto3 methods fixes 13010 by updating boto3 methods to update boto3 conn to check for profile name and if detected remove from params and set new variable of profile which is passed into session separately resubmission of pr 13012 as it was easier to just recreate new branch with commit and the latest devel commits >>>bugfix_pull_request
feature support ansible cfg specify group vars and host vars paths we can already set `inventory` filename `roles path` and plugin paths in `ansible cfg` would really like to be able to use different names for `group vars` and `host vars` dirs too or possibly additional ones to search know there is already `vars files` and `include vars` but those have different purposes talking about renaming the actual path ansible searches for group and host vars so the sysadmin can make the tree with names that are to his liking >>>feature_idea
no install target for man pages have to be hand copied the man pages need to be copied manually at install time the install target does not install them and there does not seem to be target for installing them only building them in either `makefile` or `setup py` that can see looked at python setup docs https docs python org distutils setupscript html and it does not look like man pages are even supported so not sure how this would be implemented except by manual copy in the `makefile` or in `setup py` itself >>>feature_idea
template check mode not detecting change please see discussion about this on the mailing list here https groups google com msg ansible devel gt2sv9k3obk jqc2wqiccqaj that includes zip with reproducible test case ansible playbook local localhost site yml check diff here is my output play all gathering facts ok localhost task common template test before home ansitest hello after home home ansitest roles common templates hello txt j2 this is not the template this is the template changed localhost play recap localhost ok changed unreachable failed here is my output v2 beta2 git checkout play task setup ok localhost task common template test ok localhost play recap localhost ok changed unreachable failed 0>>>bug_report
install target in makefile creates new files in build tree running `sudo make install` after build as ordinary user leaves around new files in the build tree owned as the install user in this case root it should only install files as root not create new ones in the build tree these files are stray and cannot be subsequently removed as the user that did the build >>>feature_idea
makefile install target cannot specify destdir would like to install from the devel tree the `makefile` install target does not allow me to specify where the files go this means have to run install target as root and cannot inspect the actual install tree first both of which are bad with most unix tools that are installed from source specifying an install root is done using destdir` with typical usage pattern such as unfortunately there is no destdir support in makefile can workaround with `setup py install root tmp relocate` but that skips anything else the makefile wants to do and the makefile should probably support the standard destdir anyways >>>feature_idea
file descriptor leak in runner taskexecutor class in the branch including whats in the centos repo in the runner class it appears ansible is trying to duplicate the fileno for new stdin however this introduces file descriptor leak since the dup is never closed additionally self new stdin is not used anywhere else in this class in stable lib ansible runner init py l582 this file descriptor leaks one fd for each it appears in the master branch as well only its is being used by the taskexecutor however since its not being closed it will be file descriptor leak there as well >>>bug_report
local variable task action referenced before assignment works in 9e758d3 so this is probably small typo in 483491d caused by the following play unaffected by order of `apt` and `with items` sort of related what the recommended upgrade path checking out tagged versions like v1 gave me this error so wondering what should be doing if want to stay on stable versions the docs don mention any specifics about upgrading other than to do `git submodule update init recursive` and not too well versed with git submodules so not sure how to proceed staying on 9e758d3 for now >>>bug_report
etc ansible roles missing by ansible package debian jessie amd64 installed ansible as package ansible from official debian jessie repository but when pulling an ansible role as root user sudo using ansible galaxy get an error was able to fix it by creating the roles directory manually however as this should work out of the box it is probably bug that the roles directory isn created during installation and or ansible galaxy not creating it automatically with best regards>>>bug_report easyfix
provide git based example found it difficult to find documentation for how to pull from git based scm that wasn github the only way could find this option was to dig through the google group >>>docs_pull_request
use minimal number of forks taking serial forks and play patterns into account as we did in before 0>>>bugfix_pull_request
unexpected exception values instance has no attribute serial issue type bug report ansible version devel branch on github ve noticed the issue in commit 0abeff45115689cd8e1262c8c666c9263977c499 it was in this commit that the problematic use of self options serial is introduced ansible configuration stock fedora 21 environment fedora 21 ansible from devel branch summary attempting to run any playbook results in the following exception steps to reproduce install from devel branch run any playbook observe exception expected results playbook should run without throwing exceptions actual results running any playbook results in the following exception aditional notes the issue seems to stem from the introduction of self options serial in commit 0abeff45115689cd8e1262c8c666c9263977c499 is there missing import such as import serial or from serial import serial >>>bug_report
treat forks config parameter as max value instead of always creating that number of workers otherwise we have lot of workers with using resources without having any work to do this was exhausting resources on our jenkins server even when the plays were on pretty small inventories >>>bugfix_pull_request
synchronize module asks for password issue type bug report ansible version ansible devel 061b83c ansible configuration become yes environment debian summary synchronize module asks for password when using sudo become and ssh key based auth using ssh agent steps to reproduce setup ssh key auth ssh agent execute expected results synchronize module should not ask for password actual results >>>bug_report needs_info pending_closure
v2 valueerror circular reference detected have template for some debug informations it looks like tasks main yaml templates dumpall j2 this works with ansible but with the actual head this results in just can see any circular reference here >>>bug_report
can set user in ssh config issue type but report ansible version ansible configuration in `ansible cfg` refer to custom `ssh config` the `ssh config` configures ssh proxy through bastion inventory does not set `ansible ssh user` for the bastion host environment summary as of c271c0e ansible now overrides the ssh user option using my local username with user sheldonh` thus it is no longer possible to set the user in custom `ssh config` it must now be set with ansible ssh user in inventory if that was an intentional change it probably worth mentioning in the release notes not sure what the change was intended to fix so can recommend way forward yet steps to reproduce see `ansible configuration` above then apply play to `hosts bastion` which do to wait for ssh to become available on instances behind the bastion using `ansible playbook vvvv` to observe the ssh command expected results actual results note that the user option is now overriden since the command line option supersedes the one specified in the `ssh config` >>>bug_report
ansible galaxy init has different default directory than ansible galaxy install issue type bug report ansible version ansible configuration use ansible in standalone way so my stuff is not in etc but ve got an ansible dir under version control an ansible cfg and roles directory playbooks directory files directory too the ansible cfg has roles path roles environment ubuntu 14 04 trusty ansible from ppa summary when installing role with ansible galaxy it respects the roles path found in the ansible cfg in the current directory when do ansible galaxy init some role it does not respect the roles path found in ansible cfg but it uses the current directory as it in the manual as these features both create roles in my environment believe they should work symmetrically when standing in the same directory and working with the same ansible cfg the resulting role should born under the roles directory the current state ansible galaxy init help init path init path init path the path in which the skeleton role will be created the default is the current working directory so it works like documented but this behaviour it conflicts with the install actions default parameters ansible galaxy install help roles path roles path roles path the path to the directory containing your roles the default is the roles path configured in your ansible cfg file etc ansible roles if not configured so fixing the problem would need changing the init code need changing the init help text need fixing the docs cause some discomfort for the users who already use galaxy ansible init fortunately this is manual process it not too common usecase to programmatically generate roles am willing to create pull request with the changes if you decide this default setting harmonization would benefit ansible galaxy in the longterm steps to reproduce mkdir someansibletesting cd someansibletesting copy an ansible cfg here with roles path roles good result ansible galaxy install tommarshall mycli downloading role mycli owned by tommarshall downloading role from https github com tommarshall ansible role mycli archive master tar gz extracting tommarshall mycli to roles tommarshall mycli tommarshall mycli was installed successfully ls ld roles tommarshall mycli drwxrwxr vagrant vagrant 4096 nov 08 25 roles tommarshall mycli expected results the some role should born under roles as it set in the ansible cfg ansible galaxy init some role roles some role was created successfully ls ld roles some role drwxrwxr vagrant vagrant 4096 nov 08 26 roles some role ls ld some role ls cannot access some role no such file or directory actual results works as documented but does not work as expected ansible galaxy init some role some role was created successfully ls ld roles some role ls cannot access roles some role no such file or directory ls ld some role drwxrwxr vagrant vagrant 4096 nov 08 26 some role >>>feature_idea
allow blank lines and comments spaces in galaxy spec files fixes 10641 again regression added test to discourage future such regression >>>feature_pull_request
few changelog tweaks this corrects problem where the facts on delegated hosts item was inserted between the ``meta refresh inventory`` item and its description and fixes the wording in few other places >>>docs_pull_request needs_revision
can we add sts assume role to module utils ec2 py issue type feature idea ansible version devel summary know there is this module http docs ansible com ansible sts assume role module html but having this in the ec2 py module utility seems like much better way to go as it is lot of boiler plate to have to add sts assume role to every playbook that assumes roles we only assume roles at our company to do anything with aws so it is painful for us it would be pretty trivial for me to add this to ec2 py >>>feature_idea
certificate errors when using proxy issue type bug report ansible version ansible configured module search path none ansible configuration nothing environment debian python summary very similar to 12549 using proxy for https endpoints causes ansible to complain that the certificate doesn match the hostname added some print statements to the generated python file to reveal that the hostname it tries to compare to is that of the proxy it works with ansible but not or steps to reproduce https proxy http 10 41 16 10 3128 ansible get url url https www google com force yes dest dev null localhost all local vv expected results file is fetched without issue actual results >>>bug_report needs_info pending_closure
v2 performance issues issue type bug report ansible version ansible version ansible devel eb8ec73ff3 last updated 2015 11 03 14 30 56 gmt 400 lib ansible modules core detached head 22c2789b72 last updated 2015 10 28 23 03 02 gmt 400 lib ansible modules extras detached head c685b3d387 last updated 2015 10 28 23 03 10 gmt 400 config file configured module search path none ansible configuration none environment mac os 10 10 summary v1 playbook completes in 3s v2 playbook doesn complete steps to reproduce playbook here https gist github com andyhky 8c5ec9485eb059cf0226 but calling with limit which goes down to 100 hosts limit c0001 compute 100 or 100 for v1 am passing forks 100 to ansible playbook total inventory being passed has little over 5k hosts across 15 groups with the nova compute group at 400 with the limit passing expected results ansible v1 completes in 3s v1 specifics ansible version ansible configured module search path none actual results it hangs seemingly forever ve let it run up to 58 minutes before giving up with ansible debug true it hangs here 15102 1446579807 18443 got task handler to work on task debug msg inventory hostname 15102 1446579807 18449 running taskexecutor for removed task debug msg inventory hostname 15102 1446579807 18453 in run 15102 1446579807 18500 calling self execute 15102 1446579807 18600 no remote address found for delegated host localhost using its name so success depends on dns resolution 15102 1446579807 18921 starting attempt loop 15102 1446579807 18929 running the handler 15102 1446579807 18935 handler run complete 15102 1446579807 18943 attempt loop complete returning result 15102 1446579807 18948 execute done 15102 1446579807 18952 dumping result to json 15102 1446579807 18957 done dumping result returning 15102 1446579807 18964 done running taskexecutor for removed task debug msg removed 15102 1446579807 18966 sending task result 15102 1446579807 18972 done sending task result which think is somewhere around this part in the code https github com ansible ansible blob devel lib ansible plugins strategy init py l296 l309 if lower the forks the playbook ends up completing but slowly >>>bug_report p2 pending_closure
update readme md minor formatting change to tests readme>>>docs_pull_request
allow patch to list of valid http methods working on the kubernetes module and in order to cover the full kubernetes api patch operations http kubernetes io v1 docs devel api conventions html patch operations need to be supported for the rest calls using `ansible module utils urls` and `patch` is not supported this pr adds the `patch` to the list of allowed http methods https github com ansible ansible modules extras issues 1139 >>>feature_pull_request
dmidecode fails with permission denied running the setup ansible module utils facts py on machine without the required sys values fails with using the sudo switch does not help >>>bug_report
remove action>>>needs_info
feature idea yaml files as facts as of now the output of the output of file script should be in json format in order to use the output as facts it would be lot more convenient if we can just put yaml files in ansible facts directory >>>feature_idea
delegate to runs code as wrong user have inventories master main ls master int domain com all vars ansible ssh user ls deploy stage main ls stage int domain com all vars ansible ssh user ls deploy the problem is that on ls stage int domain com task with delegate to delegate to ansible fqdn runs as user that launched ansible instead of ls deploy which is defined in inventory the issue doesn exist on ls master domain com nor any combination of subdomain domain com that tried except ls stage whatever domain com it also works when cut int domain com part so main ls stage all vars ansible ssh user ls deploy is also fine >>>bug_report
make sure potential names is not dependent on hashing order for me `potential names` contains this in one run invocation of `find plugin` win restart computer ps1 win restart computer but in the next invocation of find plugin it as if it contains this win ad group win ad group ps1 this is because the items in set frozenset have no defined order thus the order in which the items are iterated varies based on the hash value of the item this means that the name without extension is returned win ad group which means that no shebang line will be found which means that ansible will fail with the error module is missing interpreter line impact on runtime should be minimal because the list of suffixes won contain more than two items >>>bugfix_pull_request
v2 regression delegate to in loop doesn show `` delegater delegatee `` in output with current ansible devel the following play displays the following output whereas with ansible it displays this because of the incorrect output can be sure if the delegation is actually working as intended as it did before because the hosts delegating to all have ``ansible connection local`` >>>bug_report
copy module doesn follow symbolic directory am copying folder foo which has subfolder foo1 which is symbolic link to another folder say root myfoo1 copy module won copy it to remote location >>>bug_report needs_info
fixes 13010 by updating boto3 methods with profile name fixes 13010 by updating boto3 methods to have separate profile name argument as specified in the proposed fix section of the issue>>>bugfix_pull_request
fix typo>>>docs_pull_request
aws boto3 profile support issue type bug report ansible version ansible detached head de54f26376 last updated 2015 11 03 08 46 06 gmt 1000 lib ansible modules core detached head e318be30ff last updated 2015 11 03 08 45 42 gmt 1000 lib ansible modules extras detached head 80f198a82f last updated 2015 11 03 08 45 42 gmt 1000 running ansible from source v2 beta2 environment osx 10 10 running ansible from source v2 beta2 running boto 38 and boto3 python 10 summary when utilising boto3 conn from module utils ec2 py and specifying boto profile name the connection fails due to profile name not being valid boto3 session session client parameter typeerror client got an unexpected keyword argument profile name steps to reproduce creating new module using boto3 for listing route53 entries host zones etc and allowing the user to provide boto profile same behaviour as in boto version connection setup in new module try region ec2 url aws connect kwargs get aws connection info module boto3 true route53 boto3 conn module conn type client resource route53 aws connect kwargs except boto exception noauthhandlerfound module fail json msg can authorize connection str boto3 conn section in question elif conn type client client boto3 session session client resource region name region endpoint url endpoint params return client setup play using the new module and specify profile name expected results task route53 entries testing custom module ok 127 hostedzones dictionary of returned hosted zones from aws actual results task route53 entries testing custom module an exception occurred during task execution the full traceback is traceback most recent call last file users etherdaemon ansible tmp ansible tmp 1446523327 09 207574321397669 route53 facts line 2208 in main file users etherdaemon ansible tmp ansible tmp 1446523327 09 207574321397669 route53 facts line 67 in main route53 boto3 conn module conn type client resource route53 aws connect kwargs file users etherdaemon ansible tmp ansible tmp 1446523327 09 207574321397669 route53 facts line 2033 in boto3 conn client boto3 session session client resource region name region endpoint url endpoint profile name profile name params typeerror client got an unexpected keyword argument profile name fatal 127 failed changed false failed true invocation module args profile personal type module name route53 facts parsed false proposed fix my initial thoughts are to do the following ve tested this for just my own scenario so obviously lot more thought has to go in for everyone use cases update module utils ec2 py with the following method get aws connection info remove profile name from boto params dictionary for boto3 requests move existing return region ec2 url boto params to be directly underneath the boto boto3 else statement to cater for boto connections add new return statement under the boto3 if statement to include the new profile name argument separately return region ec2 url profile name boto params method boto3 conn add new profile name none input parameter update the boto3 session statement to create the session with the profile and the client with the rest of the arguments this should then allow users to call the boto3 conn like so try region ec2 url profile name aws connect kwargs get aws connection info module boto3 true route53 boto3 conn module conn type client resource route53 profile name profile name aws connect kwargs except boto exception noauthhandlerfound module fail json msg can authorize connection str >>>bug_report feature_idea
known hosts giving cryptic error have task to learn store remote machine fingerprint on the machine being configured so that ssh tunnel works without prompting that task has run on vagrant and ec2 instances no problem but is failing on my latest ec2 machine which is copy of one it worked on so it should work name learn the admin machine fingerprint known hosts path etc ssh ssh known hosts name admin ip key lookup pipe ssh keyscan admin ip this is the output failed 99 64 132 failed true parsed false become success poodxqqnkfldwlcombboucraylwzgozd traceback most recent call last file home ubuntu ansible tmp ansible tmp 1446498622 78 229061994980780 known hosts line 1859 in main file home ubuntu ansible tmp ansible tmp 1446498622 78 229061994980780 known hosts line 249 in main results enforce state module module params file home ubuntu ansible tmp ansible tmp 1446498622 78 229061994980780 known hosts line 96 in enforce state if key is not none and key indexerror string index out of range openssh openssl 1f jan 2014 debug1 reading configuration data home gbell ssh config debug1 reading configuration data etc ssh ssh config debug1 etc ssh ssh config line 19 applying options for debug1 auto mux trying existing master debug1 mux client request session master session id shared connection to 99 64 132 closed ansible issue or something can should be debugging >>>bug_report
the else clause is the correct place to raise the recommended place to raise seems much more logical and idiomatic than the confusing trap for nameerror the code as proposed here is as explicit as it gets >>>pending_closure
ansible executable does not detect report unsupported invocation the core of this pull request is plain bug fix the `ansible` executable bin ansible is symlinked to in various forms from the bin directory ansible doc ansible ansible galaxy ansible ansible playbook ansible ansible pull ansible ansible vault ansible inside `ansible` which form to take is determined by looking at sys argv when the executable is invoked in an unsupported form an exception should be raised raise ansibleerror program not implemented me the code that does that is broken as proven by creating new symlink unsupported cd bin ln ansible unsupported unsupported the resulting exception shows that the unsupported check is implemented incorrectly unexpected exception name mycli is not defined the full traceback was traceback most recent call last file unsupported line 77 in cli mycli sys argv display display nameerror name mycli is not defined this pull request contains multiple commits which not only fix the problem but also improve the executable readability examples the core bug fix commit is https github com ansible ansible commit 3133f442ae1d32ef2ae40bdf96b2f8ad40561c90 explicit exit error codes https github com maroloccio ansible commit c1d816053b6cc268eafaed28041178bacb027cd2 for subjectively more readable final version of https github com maroloccio ansible blob devel bin ansible >>>bugfix_pull_request
clarify how tagged roles work this is confusing part of roles and tags most people assume that tagging role means that the tagged tasks inside the role will run based on the tags specified but in reality it tags the whole role with those tags >>>docs_pull_request
re add the service action plugin it was removed cause it created unexpected fact gathering and there are no split service plugins that would make this useful yet revert removed action plugin as service facts and separate modules don work yet and this forces gathering facts this reverts commit 7368030651aaaf45d97d2935b9b8829ce3d510cc >>>feature_pull_request
cache for do template call this pr is proposal to fix part of the following issue https github com ansible ansible issues 12997 may result in nice speed improvement times faster when used with big hash map take it with grain of salt has it may break things >>>bugfix_pull_request
ensure english dates are generated in debian changelog placeholder running `make deb` the script failed with error error parsing time at usr lib x86 64 linux gnu perl 20 time piece pm line 469 line makefile 228 recipe for target deb failed that because `dpkg parsechangelog` couldn parse the changelog anymore found that deb package changelog has placeholder for date and it getting replaced during the build my `lc time` is set to polish as default so the first item of the changelog looks like abu abu src ansible head deb build unstable ansible debian changelog ansible git201511011823 2ee5bb5 devel unstable unstable urgency low release ansible inc nie 01 lis 2015 21 53 49 0100 >>>bugfix_pull_request
performance regression with ansible v2 using include big hash map issue type this is bug report about speed regression between ansible and current devel version when combining big hash map and include statement ansible version ansible configuration nothing special the playbook work with local connection environment summary have speed regressions against various playbooks with ansible this playbooks was completed in about to 5s with last version of ansible they take more times all my tests use local virtual machine steps to reproduce you can retrieve playbook that reproduce this issue at the following location https github com yannig ansible issue low speed this repository have playbooks one using big hash map issue vars yml but not the other no vars mapping yml expected results actually using ansible the playbook take about seconds actual results ansible v2 is about times slower if take the other playbook no vars mapping yml which simply does not call vars mapper role ansible v2 takes seconds vs second for ansible >>>bug_report
retry files shouldn be stored in home after an unsuccessful deployment saw such message in the console see two problems programs should avoid creating random files directly at the root of the home directory of the user and rather store it under something like ansible retry the retry file should be appended with the date and time of the initial execution to avoid overwrite on further unsuccessful deployment >>>feature_idea
doc cloudstack guide fix up>>>docs_pull_request
avoid key names which are valid attributes for data types in python closes 12990 alternative to 12992 this pr excludes all attributes of the following data types lists tuples dicts sets integers floats strings and unicode objects it is expected that only the attributes of dicts and sets would cause an problem like in 12990 >>>docs_pull_request
doc add cloudstack guide to the guides am not really aware how rst works but this looks like it does what it should >>>docs_pull_request
doc cloudstack guide first effort for detailed cloudstack guide>>>docs_pull_request
ansible vault changes permission of files when encrypting decrypting when using ansible vault the file permissions are changed to rw expected them to be the same this is especially relevant when using ansible vault for keys that would have 600 that would otherwise have to open rights ansible devel 92dd563a75 >>>bug_report
avoid running facter ohai in setup if not needed with both package and service run the setup module to retrieve the ansible pkg mgr ansible service mgr variable this can trigger an unnecessary run of facter and or ohai at first thought that one could trigger off of the filter argument with something like def run setup module setup options dict module setup true facts ansible facts module filter param module params filter for in facts items setup options ansible replace for fact cmd in facter ohai only gather extra facts if we are going to want them if filter param or fact cmd filter param len fact cmd fact cmd path module get bin path fact cmd if fact cmd path is not none if facter is installed and we can use json because ruby json is also installed include facter data in the json if fact cmd facter fact cmd path fact cmd path puppet json rc out err module run command fact cmd path success true try fact ds json loads out except success false if success for in fact ds items k2 fact cmd replace setup options k2 setup result ansible facts for in setup options items if filter param or fnmatch fnmatch filter param setup result ansible facts but this then limits filter args to always be like ansible facter ohai etc which seems bit limiting so perhaps an extra option that would just turn off gathering non ansible facts that would generally be used internally >>>feature_idea
service module valueerror no json object could be decoded issue type bug report ansible version environment what os are you running ansible from ubuntu 14 04 lts and what os are you managing red hat enterprise linux server release santiago summary executing service task always fails with valueerror no json object could be decoded error steps to reproduce the failing task from role ansible role check mk agent https gitlab com mathieumd ansible role check mk agent expected results an ok status as xinetd is actually running `pgrep xinetd` on the server output `31637` actual results used `ansible keep remote files 1` to try directly on the server and it is also failing workaround fix found that it was necessary to modify the etc sysconfig i18n` file to modify line from `lc all fr fr euro to `lc all en us utf this looks like the issue 11055 is not really fixed by 12830 >>>bug_report
feature add src path to galaxy requirements spec this feature makes it possible to require role that is subdirectory within `src` for example role that is embedded in larger project the following entry in `requirements yml` would then install the above `ansible role` as `example` >>>feature_pull_request
v2 broke my custom module tests ansible version summary ve custom module to manipulate ini files https gist github com mgedmin aa629d5a4c5fe143a2ed wrote some tests for it the first test checks that the module fails when some arguments are missing this test https gist github com mgedmin aa629d5a4c5fe143a2ed looks like this essentially want to invert the normal failure status this does not work with ansible ve bisected the failure to commit 60c139e482c2084fb631c1cc7b606c8162d068fa >>>bug_report pending_closure
v2 runtimewarning parent module ansible plugins action not found while handling absolute import ansible version summary my custom ansible plugins cause warnings to be shown for every execution ve bisected this to commit 057712c1296794bacc4f8def85d6caae6f77738f you can look at my action plugin https gist github com mgedmin aec4678b25c2734f0d57 if you re curious but there nothing special about it note how even `import time` causes the warning >>>bug_report pending_closure
dependency deduplication seems to be applied before tag filtering hi have ansible on debian testing roles role1 role2 role3 depend on base role in site yml if run `ansible playbook etc ansible site yml tags tag1` then base role is correctly applied before role1 if run `ansible playbook etc ansible site yml tags tag2` or tag3 then only role2 or role3 is applied base role is omitted despite explicit dependency >>>bug_report
add wily in ppa https launchpad net ansible archive ubuntu ansible does not propose wily >>>easyfix feature_idea
package install with item list fails on el7 client with beta5 connecting with ansible beta5 from fedora 21 host to el7 client the following task name install common packages action ansible pkg mgr with items name bash completion state present name libselinux python state present name logwatch state present name sssd state present fails with failed vulcan7 cora nwra com item state present name bash completion failed true item name bash completion state present msg one of the following is required name list failed vulcan7 cora nwra com item state present name libselinux python failed true item name libselinux python state present msg one of the following is required name list failed vulcan7 cora nwra com item state present name logwatch failed true item name logwatch state present msg one of the following is required name list failed vulcan7 cora nwra com item state present name sssd failed true item name sssd state present msg one of the following is required name list it works with fedora 22 client and with ansible >>>bug_report
add missing configuration examples adds configuration examples missing from intro configuration rst closes 12963 >>>docs_pull_request
update playbooks lookups rst was caught out by the different behaviour of lookups local tasks and could not find the difference documented anywhere at all so took the liberty of proposing this change lookups are always relative to the role or play local tasks are relative to the cwd from which you execute >>>docs_pull_request
stdout callback instead of callback stdout the correct setting name is stdout callback>>>bugfix_pull_request
run once not working as expected with handlers issue type bug report ansible version ansible 479cbfc63c8261577b359b7703d7e6168c1a74f5 ansible configuration environment os yosemite python 10 summary when using handler with `run once yes` multiple notifications trigger the handler to run multiple times this differs from the behavior in ansible where `run once` would only cause the handler to run once steps to reproduce expected results actual results >>>bug_report
missing note on default locale for shell command modules documentation report default etc ansible ansible cfg contains the line `module lang c` was bit by this issue until realized that my locale was wrong in shell command this should be noted in the notes section of the command and shell modules perhaps with brief example of relevant correct locales like `module lang en us utf 8` `module lang zh cn utf 8` `module lang ru ru utf 8` >>>docs_report
missing configuration examples in intro configuration the configuration docs at http docs ansible com ansible intro configuration html general defaults are missing examples for `stdout callback` `callback whitelist` `gathering` `module lang` `transport` `special context filesystems` >>>docs_report
fixes options for ansible pull remove requirement for host patterns use the defaults require destination directory none in cwd is not good default fixed usage messages updated default inventory to use and not deprecated fixes 12955>>>bugfix_pull_request
temporary aws access keys results in auth failures issue type bug report ansible version ansible ansible configuration none environment mac osx 10 11 not applicable summary using temporary aws access keys results in auth failures steps to reproduce generate temporary access keys eg via sts or saml provider attempt to create ec2 resource expected results ec2 resource is created actual results aws authfailure exception from my investigation the issue appears in the module utils ec2 py get ec2 creds which returns>>>bug_report
note previous versions usage of colon delimiter doc site talks about the use of comma as the host group delimiter for and or not hosts patterns the comma does not work in version but only found out about the use of colon from closed github issue please check version claim have no idea which version introduced the change and simply wrote that it was version please correct before merging >>>bug_report
clarify module documentation make the position on facts modules more emphatic add documentation for return structure>>>docs_pull_request
added callback fallback to v1 methods for backwards compat with existing callbacks>>>bugfix_pull_request
ansible pull requires an argument with ansible beta2 get ansible pull url myurl key file key usage ansible pull options error missing target hosts man page still indicates that it should default to local yml seems something is messed up here >>>bug_report p2
fix proposal for issue 12952 debug var issue this pr remove code that seems to be unnecessary and fix display issue with debug var with items see https github com ansible ansible issues 12952 for more details>>>bugfix_pull_request
bug report debug with items is not working properly issue type bad var substitution using with statement and debug ansible version ansible configuration nothing special environment linux mint 17 summary debug with items does not work properly steps to reproduce use the following playbook expected results with ansible we get the following result actual results with the last version of ansible get the following output >>>bug_report
update callback plugin documentation this commit updates the documentation to make explicit the fact that plugins must be listed in `callback whitelist` in order to run and it adds configuration examples for both `callback whitelist` and `stdout callback` >>>docs_pull_request
ensure all fact gathering and informational modules support check mode issue type feature idea ansible version future summary add `support check mode true` to all fact modules or data gathering modules to make them more usable during check` runs as other tasks normally depend on these >>>feature_idea
v2 synchronize module copies to control machine not the remote have synchronise task that isn working correctly with checkout of devel went back to the first alpha release and they all show the same behaviour latest is atm 174de11 synchronize src files 000 default html dest var www html archive yes after some trail and error found that an attempt is made to synchronise to my local machine confirmed by creating var www html running the play and then listing it contents concluding it seems the command is incorrectly running as local action local action synchronize src files 000 default html dest var www html archive yes fatal s01 failed changed false failed true invocation module args local rsync path rsync archive yes dest var www html dest port 2222 src path to project provisioning ansible roles provision apache files files 000 default html module name synchronize msg sudo password is required parsed false note the `dest` property isn something like `vagrant 127 var www html` >>>bug_report needs_info pending_closure
tags with includes are broken in v2 ansible version playbook include yml expected results if ansible playbook is run with test it should run the include playbook actual results skipped the playbook >>>bug_report p2
typo fix invenotry to inventory documentation typo fix invenotry to inventory found on http docs ansible com ansible intro bsd html >>>docs_pull_request
resultprocess must not modify the taskresult it shares with its final serialization thread ansible version ansible version ansible devel 87269599a0 last updated 2015 10 27 20 54 45 gmt 000 lib ansible modules core detached head eeaeeb5a1f last updated 2015 10 27 21 09 39 gmt 000 lib ansible modules extras detached head 949b124e05 last updated 2015 10 27 21 09 39 gmt 000 environment linux amd64 smp debian 54 x86 64 gnu linux summary ansible intermittently issues the following error and then hangs traceback most recent call last file opt anaconda lib python2 multiprocessing queues py line 268 in feed send obj runtimeerror dictionary changed size during iteration the cause is the following code that sends the entire result object including any ansible notify items to the result queue and then proceeds to modify the result object with `result item pop ansible notify at the same time the queuing thread is serializing the result dictionary the queuing thread throws and hangs the result queue worker process executor process result py the python documentation for multiprocessing queue put https docs python org library multiprocessing html pipes and queues is misleading when it says when an object is put on queue the object is pickled and background thread later flushes the pickled data to an underlying pipe instead the object is put on queue and is then serialized in separate sending thread thus the queued object is shared between the thread that put the object and the pickling thread steps to reproduce this is difficult to reproduce consistently because it is multithreading problem of course it is happening often enough for me and the hanging is serious problem because ansible is part of larger automated system can just control and try again it helps to run task that has loop that generates many notify events workaround going to try eliminating line 142 result item pop and allow the internal ansible notify attribute through solutions just some thoughts add some code like strip internal keys that strips internal keys on the receiving side of the result queue instead of the sending side don send the whole result object as part of the notify handler send copy of the result object stripped of its internal keys thanks tim >>>bug_report
make sure bad includes mark hosts as failed properly example cat test yml hosts localhost gather facts false tasks include bad yml cat bad yml hosts all gather facts false tasks ping when run play task include included root testing cwang ping 20 yml for localhost warning error no action detected in task the error appears to have been in root testing cwang ping 20 yml line column but may be elsewhere in the file depending on the exact syntax problem the offending line appears to be hosts all here play recap localhost ok changed unreachable failed in the above situation the task is not marked as failed so it does not appear anything went wrong this can happen any time the yaml is invalid in the included file >>>bug_report
until loops never loop using ansible 57fe0d6aeda17ff93427e02d52c3354adc4f547d am seeing surprising behavior from the `until` loop construct the behavior am trying to produce is loop until given command returns exit code started with this command test flagfile register result until result success but that fails with task command fatal localhost failed changed true cmd test flagfile delta 00 00 001845 end 2015 10 27 14 58 16 372686 rc start 2015 10 27 14 58 16 370841 stderr stdout stdout lines warnings tried adding `ignore errors` command test flagfile register result ignore errors true until result success but that simply caused ansible to assume success and move on rather than looping task command fatal localhost failed changed true cmd test flagfile delta 00 00 001916 end 2015 10 27 15 02 48 349425 rc start 2015 10 27 15 02 48 347509 stderr stdout stdout lines warnings ignoring play recap localhost ok changed unreachable failed in discussion on irc with `sivel` it turns out that the default value of retries is `0` rather than `3` adding `retries value to the original task made it work as expected command test flagfile register result until result success retries see two problems here the default value for `retries is incorrect think and realize opinions on this differ that setting `retries` to `0` should result it in retrying indefinitely rather than ignoring the `until` clause >>>bug_report
add ability to automatically download roles when running play issue type feature idea ansible version future ansible configuration galaxy whitelist galaxy ansible com myrepo private com summary allow ansible playbook auto download roles when executing play if the role source is white listed and the auto download feature is enabled off by default >>>feature_idea
hostvars not updated after calling add host the following change to the get magic variables` method in `lib ansible vars init py` resolves the issue >>>bug_report
ssh key missmatch gives incomprehensible error message recently rebuilt one of my servers from scratch and then tried to connect to it again the error got was this which is hard to understand error message to say the least when trying to access the same box over fabric get much nicer error think you could do even better than that though give the two possible fixes that the user can choose from remove the old signature from ssh known hosts disable host key checking according to this http docs ansible com ansible intro getting started html host key checking that error message would make much more sense >>>feature_idea
ensure vars plugins work and adjust api accordingly if needed as the title says make sure vars plugins work with devel as things relating to vars have changed we may need to change the api to pass in variablemanager class and also ensure for there is base class to use >>>bug_report
ansible sharing connection will report error like issue for example ansible test echo ansible test echo test failed ssh error shared connection to test closed it is sometimes useful to re run the command using vvvv which prints ssh debug output to help diagnose the issue test failed ssh error shared connection to test closed it is sometimes useful to re run the command using vvvv which prints ssh debug output to help diagnose the issue know this situation may not always happen but wrote it in my program however don like this to happen at any time >>>bug_report needs_info
fxing typo found typo in code comment >>>docs_pull_request
uri module both 200 and 304 should be accepted by default because the request sent contains an etag header when specifying file status code of 304 not modified should be accepted as default status code not sure if this is new in or not example >>>bug_report
wrong error message when unable to connect via ssh version ansible playbook devel 8f77dd1cf2 last updated 2015 10 26 11 46 26 gmt 400 lib ansible modules core detached head 06f301b05b last updated 2015 10 26 11 46 28 gmt 400 lib ansible modules extras detached head 405c3cb2c7 last updated 2015 10 26 11 46 30 gmt 400 issue when the server is not online the error message is confusing what happens now get the error message what should happen >>>bug_report
passing dict variable defined in group vars to role fails when dict merging is enabled ansible version when dict merging is enabled passing dict as role parameter produces an error example consider the following ansible project ansible cfg group vars all inventory local ini roles demo tasks main yml test yml ansible cfg defaults hash behaviour merge test yml hosts localhost roles role demo role arg foo group vars all foo bar baz inventory local ini localhost ansible connection local roles demo tasks main yml debug var role arg expected behavior ansible playbook inventory local ini test yml play localhost task demo debug var role arg ok localhost var role arg bar baz play recap localhost ok changed unreachable failed actual behavior ansible playbook inventory local ini test yml play localhost task demo debug var role arg fatal localhost failed to combine variables expected dicts but got dict and unicode fatal all hosts have already failed aborting play recap localhost ok changed unreachable failed >>>bug_report
is it possible to bounce winrm on windows node have been having issues with winrm when using ansible one of the solutions is to restart winrm on each node manually after every playbook have tried creating playbook which can remotely restart winrm using the raw module and also tried the win service module but these both return http error 500 when running>>>windows
apt module doesn for install of python apt causing failure for private repo chicken and egg at hp we have private repo for our internal debian based distribution hlinux was trying to install some packages that weren signed and passed force yes and still it failed upgrading to gave me better error messages and realized it was actually line 689 module run command apt get update apt get install python apt use unsafe shell true check rc true using our internal repo it complains that is being provided without force fixed this with module run command apt get update apt get install python apt force yes use unsafe shell true check rc true like to provide way that this installation of python apt would use whatever is being passed in the actual play but the point in time in this code where this happens is before the options are read it seems to me one would want to force this module since it integral >>>bug_report
manpage fixes normalized descriptions for most man pages >>>docs_pull_request
winrm connections are not closed resulting in multiple winrshost exe and conhost exe processes on target node am running playbook which runs many tasks on remote windows nodes however after each playbook completes notice that there are still many winrshost exe and conhost exe processes running on the remote nodes this causes winrm to crash after while as it runs out of memory>>>bug_report needs_info windows
fix for sles 11 which has now also an etc os release file because messed up my previous pr https github com ansible ansible pull 12556 made new clean pr >>>bugfix_pull_request
ssh stopped working ssh stopped working for me sometime late thursday or early friday osx el capitan working fine previously no updates done to os can ssh natively outside ansible without an issue >>>bug_report p2
make notify templatable there no way to call notify with parameters like there re some workarounds but they look too complicated >>>feature_idea pending_closure
changed when inversion doesn work issue type bug report ansible version ansible configuration default environment mac os 10 10 applied on ubuntu linux 14 04 summary changed when inversion doesn work steps to reproduce set some bool variable roles role defaults main yml yml var false run task with changed when yml debug var var changed when not var yaml set fact not var not var debug var var changed when not var>>>bug_report
subnet id not found even though it exists am using ansible to deploy an autoscale group on aws have the following defined to create the asg name provision autoscaling group ec2 asg name asgtest region aws region load balancers elbtest vpc zone identifier subnet maps subnet1 subnet maps subnet2 subnet maps subnet3 subnet maps subnet4 launch config name lctest min size max size desired capacity state present get the following error when running the playbook ve removed original values and placed in there place not sure what am doing wrong ve confirmed that the subnets do exist via the aws console version of ansiblie am using 1ppa vivid can provide more info if required thanks in advance >>>needs_to_be_moved
improve ansible galaxy handling of role versions ensure that role versions are considered when deciding whether or not to re install role issue warning when the version of dependency conflicts with the version of an already installed role display what version of role is being installed show the versions when upgrading downgrading role implements 11266 note that the behaviour with galaxy roles with an unspecified version is little odd this is because `meta galaxy install info` gets told the version of the role that actually gets installed when installing under galaxy however if you re not fixing versions in your rolesfile then it fine to expect that the role will be reinstalled each time you run ansible galaxy install this is similar to the behaviour of `yum state latest` for example one fix for this would be for galaxy install info` to be told the version of the role specified rather than the version of the role installed >>>feature_pull_request
pipefail for shells recently experienced nasty issue that was caused by the following shell pipe the git command fails but the return code of the entire pipe is this is default bash sh behavior to fix this in bash one can `set pipefail` in bash is it possible to do that in ansible preferably globally for all my shell commands >>>feature_idea
sanatize results centralize the sanitation function now both callback output and registered vars are properly sanitized >>>bugfix_pull_request
simplified vault password functions also fixes 12864>>>bugfix_pull_request
special character in powershell stdout stderr causing playbook to fail issue type bug report ansible version ansible configuration fresh homebrew installation environment mac os 10 10 summary special character in stdout produced by running `npm install` in powershell will result in following error causing playbook to stop although the `npm install` did run without error steps to reproduce playbook powershell script >>>bug_report p2 windows
don set user to current user also remove condition to bypass setting user if user matches current user this enables forcing user when set to the same user as current user and ignoring ssh config while keeping ssh config with current user if nothing is specified fixes 10962 fixes 9079>>>bugfix_pull_request
change check for gce auth parameters to allow empty strings this currently you can run the gce cloud modules using instance service accounts on gce instances this requires initializing the libcloud auth with empty strings for the positional arguments the if not value checks were not allowing empty strings through changed the checks to if val not none which still catches unset values but lets empty strings work allows service accounts on gce instances to authenticate through libcloud by setting the email and pem files to empty strings>>>bugfix_pull_request cloud
potential fix for 12816 small change but this isn the way v1 did it >>>bugfix_pull_request p2
local library not being accounted for in ansible library ansible latest from source today its not reading custom modules from local library dir by default like its intended to do >>>bug_report p2
draft of slack callback module redo of 8955 with view to v2 cannot get arguments passed still not ready for inclusion>>>feature_pull_request needs_revision
repeat statments don work only last one is used hosts localhost tasks name test task debug msg test when false when true when false>>>feature_idea
too many internal attributes marked private in we tried to mark more attributes and methods private inside of classes to show that other things shouldn be using them however it appears that we went overboard in the marking without always considering them private we re using tremendous number of private attributes from other classes for we should start turning some of these into public attributes and evaluate others to see if we should no longer access them directly we want to have close to of those big offenders slightly undervalued generated by manually looking for popular names then doing grep pri self grep lib ansible modules grep self result grep result result 129 host 101 task 78 role 57 shell 31 block 23 >>>feature_idea
added docs for include with items and usage of multiple lopo vars item >>>docs_pull_request
error when using bound method callbackmodule fresh git pulled repo following official documentation and when execute ansible all ping warning error when using taskresult object has no attribute copy warning error when using taskresult object has no attribute copy `>>>bug_report needs_info p2
ca certificate file path hello have problem with ansible about the ca file path variable inside the config file ansible cfg redefined this variable for using another path but ansible always use the default path system etc ssl certificats for example want use the os file path tools product ansible cacert crt but he doesnt work see here https github com ansible ansible blob devel lib ansible module utils urls py method def get ca certs self tried to understand to simulate that method think the variable ca file path is never used thank you by advance >>>needs_info
ec2 vpc ignores profile parameter and uses default aws credentials from aws credentials this is what my aws credentials looks like this is what snippet in my role looks like given the `profile irakli aws line this should create vpc in my personal aws account this is how every other ec2 ansible module works verified but not ec2 vpc it clearly created vpc in the default big bummer obviously >>>bug_report cloud needs_to_be_moved
v2 keyerror while looking up role of handler in the role cache apologize for not having time to produce good quality bug report ll come back later and polish it my test playbook fails with this ansible version it worked couple of days ago the error is have two handlers with that name in different roles my playbook includes all of the roles including common eversheds and as the last one roundup reproduction of this bug takes 15 minutes at the moment and haven had the time to try and produce smaller reproductor >>>bug_report
fix for issue 11885 allowing json in lookup template calls fix for issue 11885 when json template is loaded via lookup template ansible tries to understand it as python dictionary by default as the convert data flag is by default true this commit allows to pass the convert data flag to the template plugin in lookup and therefore allow to load json templates >>>bugfix_pull_request needs_revision
amazon cloudformation stack resource and output lookup thanks to deanwilson for the initial work and mschurenko for the great work they did on extending this plugin open to guidance on improvements before this can be merged hopefully others will find this useful >>>cloud needs_revision new_plugin
allow include directive to work during exception processing prior to this commit an attempt to use the `include directive would fail in `rescue or `always block if there were failures in the main block task list resolves 12876 >>>bugfix_pull_request p2
invocation fix invocation was removed from the json output for v2 add it back in properly along with enabling tests also fixes the action plugins to not use mutable default parameter >>>bugfix_pull_request
vars not being unset between plays issue type bug report ansible version ansible configuration nothing really changed environment osx debian7 centos7 summary vars don get unset between plays you may have two plays one for `myapp india yml` and one for `myapp spain yml` now you run them both in sequence in your `site yml` provided `myapp india yml` sets var called special key and `myapp spain yml` doesn you will notice that if executed sequencially by `site yml` the value of `special key` won be unset after `myapp india yml` finishes so it will contaminate the subsequent play `myapp spain yml` steps to reproduce write two plays `play1 yml` and `play2 yml` include them both sorted in `site yml` make both of them render template `test j2` add var to `test j2` to get expanded only if it exists define `myvar` for `play1 yml` set it to the value `foo` expected results running `site yml` renders `test j2` and writes `foo` in `play1 yml` and nothing in `play2 yml` actual results running `site yml` renders `test j2` and writes `foo` in `play1 yml` and `foo` in `play2 yml` >>>bug_report needs_info
include fails during exception processing given playbook like this hosts localhost tasks block include failing tasklist yml always include cleanup tasklist yml where `failing tasklist yml` looks like this name fail on purpose fail msg breaking things and `cleanup tasklist yml` looks like this name clean up debug msg cleaning things up would expect ansible to run `cleanup tasklist yml` but the resulting playbook run looks like this play task setup ok localhost task include included home lars tmp block include testcase failing tasklist yml for localhost task fail on purpose fatal localhost failed changed false failed true msg breaking things task include play recap localhost ok changed unreachable failed so while it is parsing the `include` statement in the `always` section it doesn appear to be running it the `cleanup tasklist yml` tasklist is run if there are no failures in the `block tasks hosts localhost tasks block debug msg not breaking always include cleanup tasklist yml >>>bug_report p2
add integration tests for openstack modules add integration tests for openstack modules this commit adds some initial integration tests for the openstack modules see `test integration roles test openstack readme md` for details this commit includes three seperate test suites `test basic` basic tests no admin no neutron `test neutron` no admin but exercises neutron specific features `test admin` tests that require admin access these can be selected via the `openstack tests` variable writing these tests has flushed out several bugs and or inconsistencies before these tests will pass the following need to merge ansible ansible modules core 2336 ansible ansible modules core 2337 ansible ansible modules core 2338 ansible ansible modules core 2339 ansible ansible modules core 2343 ansible ansible modules core 2344 ansible ansible modules core 2345 ansible ansible modules core 2349 and we need resolution for 12876 this also uncovered https review openstack org 238552 which led to ansible ansible modules core 2335 >>>bugfix_pull_request cloud
using yum module to install gnome desktop environment on centos does not work hi the details of this issue are here in the ansible google group https groups google com forum utm medium email utm source footer topic ansible project resig2c regards nathan>>>bug_report docs_report needs_to_be_moved
fr handle undefined vars in ternary filter version ansible v1 description the ternary filter fails to be templated if the true param contains an undefined var even though it should be using the false param expected actual this works however >>>bug_report
invocation to use from callback plugin is missing in result issue type bug report or feature idea ansible version ansible 09899b7c438bb029bd5715792951d646a302a5de latest head ansible configuration nothing special environment mac summary invocation is not produced in callback plugin `result result` because want to log module name by using callback plugin invocation is always included in result at v1 but it seems v2 not include it want to run datadog callback https github com datadog ansible datadog callback on v2 found jimi said believe invocation was always in the output at issue 12787 could you add invocation into result steps to reproduce prepare callback module def v2 runner on failed self result ignore errors false print invocation in result result >>>bug_report
variables precedence reordering and added para to help explain precedence rules customer success team member had contacted me few weeks ago about the ordering of and variable precedence lists for this section he was working on customer support ticket around this and when he replied his response helped me understand the rules bit better figured it wouldn hurt to add little more text to support this as well reordered the list to match the list which seemed to make the most sense to me feedback suggestions changes etc always welcome >>>docs_pull_request
make callbacks declare needing whitelisting this will allow for custom or v1 callbacks locally loaded to automatically be triggered as they were in x>>>feature_pull_request
more inheritence make some task only directives groupable by encompassing objects fixes 12559>>>feature_pull_request
document setting environment variables in playbook looks like the docs from https github com ansible ansible pull 8651 issuecomment 52687343 never got done >>>docs_pull_request
feature request ansible vault should ask for password twice have non important feature request `ansible vault encrypt` command used to ask password twice in v1 but in v2 it just asks once am just looking to reduce the possibility of typo in password v2 v1 >>>bug_report
v2 role names variable doesn work it seems that the `role names` list no longer exists with dummy yml looking like v1 v2 >>>bug_report
allow meta main yml to include roles through spec file ansible playbook now works when run with playbook that includes role that includes another role specified using csv format updated one of the roles used in the tests to fix broken tests `make test galaxy` now works fixes 11486 also addresses the problem alluded to in 10620 >>>bugfix_pull_request
v2 local action does not appear to be handed off to local from remote issue type bug report ansible version ansible version ansible detached head 5ae74f7d38 last updated 2015 10 18 19 39 15 gmt 1000 running ansible from source v2 beta1 ansible config changes inventory china aws inventory ec2 py ansible python interpreter usr local bin python environment osx 10 10 running ansible from source v2 beta1 running boto 38 and boto3 python 10 summary when specifying remote host initially and then performing an action which is required on the local host the action is not handed off to the local from the remote testing of the same playbook on ansible works as expected steps to reproduce name termination script hosts ec2 gather facts false connection local vars region cn north tasks name gather ec2 facts local action ec2 facts debug var hostvars inventory hostname debug msg hostvars inventory hostname ec2 id name terminate instances local action ec2 profile china state absent instance ids ec2 id region region wait true expected results task debug msg hostvars inventory hostname ec2 id ok 10 237 62 msg f2fc90ca msg f2fc90ca task terminate instances changed 10 237 62 127 play recap 10 237 62 ok changed unreachable failed actual results task debug msg hostvars inventory hostname ec2 id ok 10 237 62 changed false msg f2fc90ca task terminate instances fatal 10 237 62 failed changed false failed true msg boto required for this module >>>bug_report
unexpected exception variablemanager object has no attribute display unexpected exception variablemanager object has no attribute display the full traceback was traceback most recent call last file usr local lib python2 dist packages ansible py2 egg egg info scripts ansible playbook line 80 in sys exit cli run file usr local lib python2 dist packages ansible py2 egg ansible cli playbook py line 142 in run results pbex run file usr local lib python2 dist packages ansible py2 egg ansible executor playbook executor py line 140 in run result self tqm run play play file usr local lib python2 dist packages ansible py2 egg ansible executor task queue manager py line 217 in run return strategy run iterator play context file usr local lib python2 dist packages ansible py2 egg ansible plugins strategy linear py line 214 in run task vars self variable manager get vars loader self loader play iterator play host host task task file usr local lib python2 dist packages ansible py2 egg ansible vars init py line 316 in get vars all vars ansible delegated vars self get delegated vars loader play task all vars file usr local lib python2 dist packages ansible py2 egg ansible vars init py line 388 in get delegated vars self display deprecated skipping task due to undefined attribute in the future this will be fatal error attributeerror variablemanager object has no attribute display >>>bug_report
ansible hanging on repoquery during yum command while running an ansible playbook it will intermittently hang during yum install it doesn happen all the time but it happens somewhat frequently it looks like it is waiting on socket response that never comes the environment is boot2docker version build master 7960f90 docker version build 0baf609 container is based on centos centos6 ansible version is when go into the actual box that ansible is trying to install on this is what see root um apache tmp ps efl grep repoquery root 637 512 637 21 17 pts 00 00 00 usr bin python tt usr bin repoquery show duplicates plugins quiet disablerepo enablerepo qf name version release arch unzip root 637 512 638 21 17 pts 00 00 00 usr bin python tt usr bin repoquery show duplicates plugins quiet disablerepo enablerepo qf name version release arch unzip that just sits around forever unless manually kill it when trying to debug the problem first was checking to see if repoquery might be conflicted over lock and this is what see root um apache tmp lsof grep 637 repoquery 637 root cwd dir 66 4096 206 home callidus repoquery 637 root rtd dir 66 4096 repoquery 637 root txt reg 66 4864 236 usr bin python repoquery 637 root mem reg 66 27424 186 lib64 libnss dns 12 so repoquery 637 root mem reg 66 50280 661 usr lib64 python2 lib dynload pyexpat so repoquery 637 root mem reg 66 165264 656 lib64 libexpat so repoquery 637 root mem reg 66 42392 653 usr lib64 python2 lib dynload elementtree so repoquery 637 root mem reg 66 25160 565 usr lib64 python2 lib dynload termios so repoquery 637 root mem reg 66 1382496 558 usr lib64 libxml2 so repoquery 637 root mem reg 66 1140496 556 lib64 libglib so 2800 repoquery 637 root mem reg 66 45320 271 usr lib64 python2 site packages sqlitecache so repoquery 637 root mem reg 66 77104 554 usr lib64 python2 lib dynload sqlite3 so repoquery 637 root mem reg 66 81256 553 usr lib64 python2 lib dynload datetime so repoquery 637 root mem reg 66 7208 546 usr lib64 python2 lib dynload weakref so repoquery 637 root mem reg 66 9080 527 usr lib64 python2 lib dynload grpmodule so repoquery 637 root mem reg 66 14288 512 lib64 libgpg error so repoquery 637 root mem reg 66 197792 510 usr lib64 libgpgme so 11 repoquery 637 root mem reg 66 78016 508 usr lib64 python2 site packages gpgme gpgme so repoquery 637 root mem reg 66 35696 503 usr lib64 python2 lib dynload bz2 so repoquery 637 root mem reg 66 23784 496 usr lib64 python2 lib dynload zlibmodule so repoquery 637 root mem reg 66 10312 144 lib64 libfreebl3 so repoquery 637 root mem reg 66 40400 131 lib64 libcrypt 12 so repoquery 637 root mem reg 66 106160 465 usr lib64 libsasl2 so 23 repoquery 637 root mem reg 66 60512 463 lib64 liblber so 10 repoquery 637 root mem reg 66 161856 461 usr lib64 libssh2 so repoquery 637 root mem reg 66 181176 459 usr lib64 libsmime3 so repoquery 637 root mem reg 66 254328 458 usr lib64 libssl3 so repoquery 637 root mem reg 66 326768 457 lib64 libldap so 10 repoquery 637 root mem reg 66 206672 455 lib64 libidn so 11 repoquery 637 root mem reg 66 347536 453 usr lib64 libcurl so repoquery 637 root mem reg 66 69504 268 usr lib64 python2 site packages pycurl so repoquery 637 root mem reg 66 9872 451 usr lib64 python2 lib dynload bisectmodule so repoquery 637 root mem reg 66 41408 444 usr lib64 python2 lib dynload arraymodule so repoquery 637 root mem reg 66 15432 441 usr lib64 python2 lib dynload hashlib so repoquery 637 root mem reg 66 14632 402 usr lib64 python2 lib dynload fcntlmodule so repoquery 637 root mem reg 66 12680 401 usr lib64 python2 lib dynload randommodule so repoquery 637 root mem reg 66 20976 400 usr lib64 python2 lib dynload binascii so repoquery 637 root mem reg 66 26408 399 usr lib64 python2 lib dynload mathmodule so repoquery 637 root mem reg 66 24432 392 usr lib64 python2 lib dynload selectmodule so repoquery 637 root mem reg 66 75664 386 usr lib64 python2 lib dynload cpickle so repoquery 637 root mem reg 66 110960 133 lib64 libresolv 12 so repoquery 637 root mem reg 66 10192 148 lib64 libkeyutils so repoquery 637 root mem reg 66 43728 146 lib64 libkrb5support so repoquery 637 root mem reg 66 174840 139 lib64 libk5crypto so repoquery 637 root mem reg 66 14664 141 lib64 libcom err so repoquery 637 root mem reg 66 946048 137 lib64 libkrb5 so repoquery 637 root mem reg 66 277704 135 lib64 libgssapi krb5 so repoquery 637 root mem reg 66 1963296 123 usr lib64 libcrypto so 1e repoquery 637 root mem reg 66 441256 385 usr lib64 libssl so 1e repoquery 637 root mem reg 66 34112 383 usr lib64 python2 lib dynload ssl so repoquery 637 root mem reg 66 60752 382 usr lib64 python2 lib dynload socketmodule so repoquery 637 root mem reg 66 115768 339 usr lib64 libmagic so repoquery 637 root mem reg 66 155344 337 usr lib64 librpmbuild so repoquery 637 root mem reg 66 12560 335 usr lib64 python2 site packages rpm rpmbmodule so repoquery 637 root mem reg 66 477712 211 lib64 libfreeblpriv3 so repoquery 637 root mem reg 66 583552 320 usr lib64 libsqlite3 so repoquery 637 root mem reg 66 262168 318 usr lib64 libsoftokn3 so repoquery 637 root mem reg 66 65928 37 lib64 libnss files 12 so repoquery 637 root mem reg 66 244624 151 lib64 libnspr4 so repoquery 637 root mem reg 66 14560 150 lib64 libplds4 so repoquery 637 root mem reg 66 18720 143 lib64 libplc4 so repoquery 637 root mem reg 66 179416 149 usr lib64 libnssutil3 so repoquery 637 root mem reg 66 90880 108 lib64 libgcc 20120601 so repoquery 637 root mem reg 66 18712 231 lib64 libattr so repoquery 637 root mem reg 66 43880 106 lib64 librt 12 so repoquery 637 root mem reg 66 183920 317 usr lib64 liblua so repoquery 637 root mem reg 66 134920 316 usr lib64 liblzma so repoquery 637 root mem reg 66 36360 314 lib64 libpopt so repoquery 637 root mem reg 66 88440 312 usr lib64 libelf 161 so repoquery 637 root mem reg 66 88600 127 lib64 libz so repoquery 637 root mem reg 66 67592 310 lib64 libbz2 so repoquery 637 root mem reg 66 1300048 142 usr lib64 libnss3 so repoquery 637 root mem reg 66 183968 308 usr lib64 librpmio so repoquery 637 root mem reg 66 1523064 306 lib64 libdb so repoquery 637 root mem reg 66 31280 229 lib64 libacl so repoquery 637 root mem reg 66 16600 305 lib64 libcap so 16 repoquery 637 root mem reg 66 122040 152 lib64 libselinux so repoquery 637 root mem reg 66 435400 303 usr lib64 librpm so repoquery 637 root mem reg 66 92872 301 usr lib64 python2 site packages rpm rpmmodule so repoquery 637 root mem reg 66 19248 359 usr lib64 python2 lib dynload cstringio so repoquery 637 root mem reg 66 37840 389 usr lib64 python2 lib dynload struct so repoquery 637 root mem reg 66 21608 410 usr lib64 python2 lib dynload localemodule so repoquery 637 root mem reg 66 12256 366 usr lib64 python2 lib dynload functoolsmodule so repoquery 637 root mem reg 66 25288 358 usr lib64 python2 lib dynload stropmodule so repoquery 637 root mem reg 66 54896 373 usr lib64 python2 lib dynload itertoolsmodule so repoquery 637 root mem reg 66 38608 370 usr lib64 python2 lib dynload operator so repoquery 637 root mem reg 66 28112 369 usr lib64 python2 lib dynload collectionsmodule so repoquery 637 root mem reg 66 20328 348 usr lib64 python2 lib dynload timemodule so repoquery 637 root mem reg 66 1920896 32 lib64 libc 12 so repoquery 637 root mem reg 66 596272 239 lib64 libm 12 so repoquery 637 root mem reg 66 14584 125 lib64 libutil 12 so repoquery 637 root mem reg 66 19536 30 lib64 libdl 12 so repoquery 637 root mem reg 66 142640 110 lib64 libpthread 12 so repoquery 637 root mem reg 66 1669840 237 usr lib64 libpython2 so repoquery 637 root mem reg 66 154664 25 lib64 ld 12 so repoquery 637 root 0u chr 136 0t0 dev pts repoquery 637 root 1w fifo 0t0 261194 pipe repoquery 637 root 2w fifo 0t0 261195 pipe repoquery 637 root 3w reg 66 2531 628 var log yum log repoquery 637 root 4u sock 0t0 261197 can identify protocol repoquery 637 root 7u sock 0t0 258410 can identify protocol when look at what the process is actually doing at that moment this is what see root um apache tmp strace 637 process 637 attached futex 0x12410c0 futex wait private null cprocess 637 detached root um apache tmp strace 638 process 638 attached recvmsg cprocess 638 detached >>>bug_report needs_to_be_moved pending_closure
ansible breaks here documents in shell scripts wanted to embed here document `cat eof in `shell script in my playbook like this shell credentials keystonerc admin cat eof auth url os auth url username os username password os password tenant name os tenant name eof in this breaks because the magic processing that looks for module arguments in the command string resulted in the following script credentials keystonerc admin cat eof auth url os auth url username os username password os password tenant name os tenant name eof note the extra space at the beginning of every line which breaks shell parsing it was possible to fix this by passing the script directly to the `cmd` parameter which would bypass the magic look for arguments processing shell cmd credentials keystonerc admin cat eof auth url os auth url username os username password os password tenant name os tenant name eof this worked great but then ansible came along and the above fails with unsupported parameter for module cmd and without the `cmd parameter it fails the same was as in >>>bug_report
make replacement in group names optional so people can control this themselves instead of toggling the hardcoded default alternate fix of 11165>>>cloud feature_pull_request
galaxy cli github sources adding extra subdirectory when using `ansible galaxy install requirements yml` to install roles with github source and setting `file` path an extra subdirectory is being created in the resulting output path ansible version example `requirements yml` entry resulting output path `roles bugi users and groups master master` extra trailing `master` directory if drop the `name` attribute resulting path is `roles bugi users and groups` >>>bug_report
in v2 exec command should return bytes and the caller will take responsibility for converting to unicode at the moment plugins action init py low level exec command which is the only caller of exec command should be able to handle returning unicode instead of bytes but we should match with the other connection plugins so that future code doesn accidentally break this >>>windows
feature request an ansible connect command for connecting to remote hosts using inventory information there lot of useful information in the ansible inventory including remote usernames connection methods etc wish could take advantage of that when need shell on remote host by running something like ansible connect hostname this would ideally launch an interactive shell on the target host taking into account ansible host remote user become become user connection type etc >>>feature_idea
v2 local action sudo no is not enforced failing the task the task is local action wait for port 22 host ansible ssh host delay 10 timeout 300 when playbook has sudo yes and local action task has sudo no it still uses root task local action establish local connection for user user server ip exec umask 22 mkdir home ansible tmp ansible tmp 1445383120 89 269045649329606 echo home ansible tmp ansible tmp 1445383120 89 269045649329606 server ip put var folders nn xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx tmpjqmenp to users user ansible tmp ansible tmp 1445383120 89 269045649329606 wait for server ip exec bin sh sudo root bin sh echo become success hcbrfqpuzguaycslnvsatztucccaykwz lang en us utf lc messages en us utf lc ctype en us utf usr bin python users user ansible tmp ansible tmp 1445383120 89 269045649329606 wait for rm rf users user ansible tmp ansible tmp 1445383120 89 269045649329606 dev null fatal server ip failed changed false failed true msg sudo password is required parsed false stating sudo no at playbook and not mentioning sudo at the task would not call sudo and task would successfully execute task local action establish local connection for user user server ip exec umask 22 mkdir home ansible tmp ansible tmp 1445383144 71 197741969101841 echo home ansible tmp ansible tmp 1445383144 71 197741969101841 server ip put var folders nn xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx tmpvncnvg to users user ansible tmp ansible tmp 1445383144 71 197741969101841 wait for server ip exec lang en us utf lc messages en us utf lc ctype en us utf usr bin python users user ansible tmp ansible tmp 1445383144 71 197741969101841 wait for rm rf users user ansible tmp ansible tmp 1445383144 71 197741969101841 dev null ok server ip changed false elapsed 10 path null port 22 search regex null state started ansible version ansible detached head 5ae74f7d38 last updated 2015 10 20 16 34 41 gmt 400 lib ansible modules core detached head d659c79db7 last updated 2015 10 20 16 34 57 gmt 400 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 20 16 35 01 gmt 400 >>>bug_report needs_info
documentation correction stat module stat lnk source the ansible docs http docs ansible com ansible stat module html state that lnk source is boolean when in fact it contains the actual symlink source pathname ok api82 smartpr dev var current symlink stat lnk source home foobar 21102015 1445431274 908472971 ansible version ansible >>>docs_report
v2 the windows iis modules how to obtain multiple application of information in the directory v2 my application directory structure www tiger com site internal directory v4 application v4 application can use the ansible iis01 win iis webapplication name v4 site www tiger com for v4 infomation but now how to obtain inetnal v4 information >>>needs_info pending_closure windows
remove mutable default arguments >>>bugfix_pull_request
make sdist xargs illegal option error after ansible v2 beta1 is checked out trying to build ansible tar gz fails ansible version ansible detached head 5ae74f7d38 last updated 2015 10 20 16 34 41 gmt 400 lib ansible modules core detached head d659c79db7 last updated 2015 10 20 16 34 57 gmt 400 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 20 16 35 01 gmt 400 config file configured module search path none venv username hostsystem ansible make sdist cleaning up distutils stuff rm rf build rm rf dist rm rf lib ansible egg info cleaning up byte compiled python stuff find type regex py co delete cleaning up editor backup files find type name or name grep test units inventory test data group vars noparse all yml xargs 1024 rm xargs illegal option usage xargs 0opt eofstr replstr replacements replstr number number maxprocs size utility argument make clean error 1>>>bug_report easyfix p2
v2 template with force no reports changed in check mode issue type bug report ansible version devel b46ce47a84 last updated 2015 10 20 20 10 50 gmt 200 summary in live mode task with template and force no would not overwrite an existing file and reports ok but when running in check mode it reports changed steps to reproduce cat test yml hosts localhost tasks template src etc hosts dest etc hostname force no ansible playbook test yml play task template dest etc hostname src etc hosts force no ok localhost play recap localhost ok changed unreachable failed ansible playbook test yml check play task template dest etc hostname src etc hosts force no changed localhost play recap localhost ok changed unreachable failed expected results reports ok in both cases actual results not reports ok in both cases >>>bug_report p2
v2 conditional include fails and not skipped if tags is used issue type bug report ansible version ansible devel b46ce47a84 last updated 2015 10 20 20 10 50 gmt 200 summary when using tag and task `include has condition the condition is going to be validated even the tag is not on that task steps to reproduce cat test yml hosts localhost tasks shell echo ok register result this should not fail if tag my tag is used right include somefile yml when ok in result stdout shell echo task with tag tags my tag ansible playbook test yml tags my tag expected results play localhost task shell echo task with tag changed localhost play recap localhost ok changed unreachable failed actual results play task include fatal localhost failed failed true msg error the conditional check if else false endif >>>bug_report
revert back to copying self task args reverts part of 892d9b8d>>>bugfix_pull_request
ansible galaxy install fails when requirements yml is empty it seems the issue is limited to the loop over the roles lib ansible cli galaxy py l313 possible solutions include checking if the result of yaml safe load read is none or enclosing the whole loop in try except block >>>bug_report easyfix
fixed docs typo>>>docs_pull_request
is handler really processed between role and tasks sections of playbook issue type documentation report ansible version tested with and devel a22cf8ffc1 ansible configuration environment os 10 10 python 10 summary as documentation says https github com ansible ansible blame devel docsite rst playbooks intro rst l390 handlers are automatically processed between `pre tasks` `roles` `tasks` and `post tasks` sections as far understand that means that any handler that are notified inside role should be triggered before `tasks` sections of playbook but actually it seems not so steps to reproduce add role with handler to playbook where handler is not manualy flushed inside role ansible playbook vagrant provisioners ansible inventory vagrant ansible inventory vagrant playbook yml check play all gathering facts ok centos task owox ntp install ntp pakcages ok centos item ntp ntpdate task owox ntp configure ntp service changed centos task owox ntp enable ntp service ok centos notified owox ntp restart ntp service changed centos task ensure essentials packages are installed ok centos item acl bash play recap centos ok changed unreachable failed ansible playbook vagrant provisioners ansible inventory vagrant ansible inventory vagrant playbook yml check play all gathering facts ok centos task owox ntp install ntp pakcages ok centos item ntp ntpdate task owox ntp configure ntp service changed centos task owox ntp enable ntp service ok centos task ensure essentials packages are installed ok centos item acl bash notified owox ntp restart ntp service changed centos play recap centos ok changed unreachable failed >>>docs_report p2
include tasks is broken in devel while works with issue type bug report ansible version ansible configuration environment os 10 10 python 10 summary include is broken in devel a22cf8ffc1 but it works with fine not sure but it seems issue with `included file py` steps to reproduce expected results actual results >>>bug_report p2
initial working prototype of salt bus connection plugin this pr add connexion plugin making ansible usable over the salt bus it must be run from the salt master and with uid with enough access to be able to give command to others minions while it could be useful to someone or for migration it is just meant as demo of the flexibility of ansible by offering more modern alternative to the previous func based plugin who was also nice demo it requires rather recent version of salt due to the use of some specific module >>>feature_pull_request
doc in yum examples pkg arg renamed to name alternating both pkg name in examples might be confusing even if pkg is working it is not documented in module refrence guide>>>docs_pull_request
v2 prompt call generates unhandled exception in step mode ansible playbook dies with an unhandled exception when being run in step mode full output with traceback >>>bug_report needs_info
fixes 11055 set locale via lc all pr to fix 11055 >>>bugfix_pull_request needs_rebase
no error when illegal variable is used in loops was trying to debug why one of my variables was not being used by `lineinfile` if have ansible passes the variable as string in the following format it was only when tried the variable on its own not using `with items` that got the reason why the variables weren being used hyphens are not allowed in variables would it be possible to create this error when looping too otherwise it very difficult to debug>>>bug_report
changelog add cs loadbalancer rule member cc bcoca this one as well btw tests covered both modules they must be used together >>>docs_pull_request
ec2 py add the feature of combining autoscaling groups tags if there re autoscaling groups fetch their tags set as propagate at launch and combine with the tags of these autoscaling groups this is specially useful for this https forums aws amazon com thread jspa messageid 588978 588978 so you can provision ec2 instances launched from autoscaling groups with codedeploy before the codedeploy using the tags from the autoscaling group as the ansible dynamic inventory requires http docs ansible com ansible intro dynamic inventory html example aws ec2 external inventory script >>>cloud feature_pull_request needs_revision
group by does not work with remote hosts on ansible devel issue type bug report ansible version ansible devel ansible configuration default `ansible cfg` environment debian ubuntu summary `group by` module doesn work with remote hosts in inventory works on ansible steps to reproduce example inventory example playbook expected results actual results >>>bug_report
simplify tox ini remove outdated comment>>>bugfix_pull_request
v2 delegate to shows incorrect delegated host issue type bug report ansible version ansible devel 1280e2296c last updated 2015 10 19 08 38 39 gmt 300 lib ansible modules core detached head 5da7cf696c last updated 2015 10 19 08 39 02 gmt 300 lib ansible modules extras detached head 632de528a0 last updated 2015 10 19 08 39 02 gmt 300 summary when you ve task running that delegates somewhere else ansible shows it as localhost localhost instead of localhost somewherreelse this doesn happen always but it very easy to reproduce steps to reproduce assume you ve got couple of machines called fridge and muskatas create an inventory file `hosts` create playbook `test yml` run `ansible playbook hosts test yml v` expected results actual results note the changed lines saying localhost localhost and fridge localhost instead of muskatas` note how the actual stdout from running `hostname` confirms that the task is being delegated correctly >>>bug_report
v2 delegate to runs task on local machine instead of vagrant vm issue type bug report ansible version ansible devel 1280e2296c last updated 2015 10 19 08 38 39 gmt 300 lib ansible modules core detached head 5da7cf696c last updated 2015 10 19 08 39 02 gmt 300 lib ansible modules extras detached head 632de528a0 last updated 2015 10 19 08 39 02 gmt 300 ansible configuration and the inventory file has summary ve role that sets up ssh authenticated backup pushing between two hosts one of the tasks is creating dedicated user testing this with couple of vagrant virtual machines called `trusty` and `precise` `trusty` is the target `precise` is the value of backup buddy here what ansible v2 does note how it using local connection and attempting to change stuff on my laptop instead of sshing into the vagrant vm this fails because sudo requires password thank you sudo unlike in vagrant >>>bug_report
delegate to hangs in v2 issue type bug report ansible version v2 beta1 70 g71a1a3c ansible configuration mostly default environment ubuntu summary delegate to appears to be causing the playbook to hang indefinitely possibly related to 12527 which was fixed by 3bd71d06195cdce01a85257545723e221f9c9698 here the inputs and the output there additionally long traceback upon hitting cntl that may be useful >>>bug_report p2
update yamlsyntax rst add example for multiline yaml items>>>docs_pull_request needs_revision
handler gets notified but not executed on target host hello all my ansible version is am testing against target hosts centos vm and fedora 22 vm am crafting play that deploys some configuration for daemon chrony it utilizes handler to restart chrony if the config has changed the play appearing to succeed without errors with the output including notified handler restart chronyd once for each testbox however the deamon does not actually get restarted on either test host have tried with without meta flush handlers to no effect at the time the play is executed chrony is already installed and running so the net change is merely to update the config and notify the handler here is the play here is the handler here is the vvv output on the ansible control host here is the syslog output on the fedora host here is the syslog output on the centos host >>>bug_report p2 pending_closure
win iis website failed when delete absent web site hi all on ansible at win iis website module there is bug when running absent web site the command and the exception got so have copied the win iis website to my local library and changed several things add new function and at the end of the powershell ps think the function should be part of powershell ps1 module util >>>needs_to_be_moved windows
command module removing characters from rvm command seemingly bizarre issue when try to run an rvm command `rvm omega zsl do compass compile` when run this in command task it actually runs `rvm do compass compile` is there something not aware of here that means it is stripping those characters >>>bug_report
ansible galaxy requirements support include directive context as the tasks file the first goal of this directive is to include files and combine them to form clean reusable abstractions tests update `2015 11 16` rebase add test part `2016 02 08` rebase thanks>>>feature_pull_request
added common user function to get global unique sid without include statement added common user function to get global unique sid since there are various parts where global user object is needed>>>feature_pull_request windows
update readme md clarify release naming clarify release naming policy pre closes https github com ansible ansible issues 12785 >>>docs_pull_request
run correct init system tests>>>feature_pull_request needs_revision
cloudstack add tests for cs loadbalancer rule and member tests for modules related to pr https github com ansible ansible modules extras pull 1042 cc dazworrall make test flags tags test cs loadbalancer rule ansible playbook cloudstack yml inventory integration config yml resource prefix ansible testing zyykmzsa tags test cs loadbalancer rule rc exit rc play localhost task test cs loadbalancer rule setup ok localhost changed false task test cs loadbalancer rule verify setup ok localhost msg all assertions passed task test cs loadbalancer rule setup instance ok localhost account moserre affinity groups changed false created 2015 08 31t15 14 03 0200 default ip 10 50 display name web02 domain stxt group web hypervisor vmware id 282fff02 4b2e 48d7 9e83 a52f4bf1f2c8 name web02 password enabled false security group security groups service offering 1cpu 1gb state running tags template debian 64bit base zone zuerich ix task test cs loadbalancer rule verify create instance ok localhost msg all assertions passed task test cs loadbalancer rule test rule requires params failed localhost failed true msg missing required arguments ip address name ignoring task test cs loadbalancer rule verify test rule requires params ok localhost msg all assertions passed task test cs loadbalancer rule test create rule changed localhost account moserre algorithm roundrobin changed true cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags task test cs loadbalancer rule verify test create rule ok localhost msg all assertions passed task test cs loadbalancer rule test create rule idempotence ok localhost account moserre algorithm roundrobin changed false cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags task test cs loadbalancer rule verify test create rule idempotence ok localhost msg all assertions passed task test cs loadbalancer rule test update rule changed localhost account moserre algorithm source changed true cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags task test cs loadbalancer rule verify test update rule ok localhost msg all assertions passed task test cs loadbalancer rule test update rule idempotence ok localhost account moserre algorithm source changed false cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags task test cs loadbalancer rule verify test update rule idempotence ok localhost msg all assertions passed task test cs loadbalancer rule test rule member requires params failed localhost failed true msg missing required arguments vms name ignoring task test cs loadbalancer rule verify test rule requires params ok localhost msg all assertions passed task test cs loadbalancer rule test add members to rule changed localhost account moserre algorithm source changed true cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state active tags vms web02 task test cs loadbalancer rule verify add members to rule ok localhost msg all assertions passed task test cs loadbalancer rule test add members to rule idempotence ok localhost account moserre algorithm source changed false cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state active tags vms web02 task test cs loadbalancer rule verify add members to rule idempotence ok localhost msg all assertions passed task test cs loadbalancer rule test remove members to rule changed localhost account moserre algorithm source changed true cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags vms task test cs loadbalancer rule verify remove members to rule ok localhost msg all assertions passed task test cs loadbalancer rule test remove members to rule idempotence ok localhost account moserre algorithm source changed false cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags vms task test cs loadbalancer rule verify remove members to rule ok localhost msg all assertions passed task test cs loadbalancer rule test remove rule changed localhost account moserre algorithm source changed true cidr domain stxt id 887b1abd 7e99 44c2 bd3d 41303fea7778 name ansible testing zyykmzsa lb private port 8080 public ip 185 27 109 50 public port 80 state add tags task test cs loadbalancer rule verify remove rule ok localhost msg all assertions passed task test cs loadbalancer rule test remove rule idempotence ok localhost changed false task test cs loadbalancer rule verify remove rule idempotence ok localhost msg all assertions passed play recap localhost ok 28 changed unreachable failed >>>cloud feature_pull_request
allow invoking clis through keywords allows for invoking `ansible playbook` as `ansible playbook` etc>>>feature_pull_request
start of ansible config to view manage ansible configuration settings right now it can only dump current settings or setttings with optional ansible cfg >>>feature_pull_request needs_rebase needs_revision
remove module param quotes fixes >>>bugfix_pull_request
tags from playbook execution infect included tasks in all the inclusion sites want to split out common functionality to simple task list which can call from some roles file downloading from remote server then in two different roles include the task the playbook is when run everything it looks ok but when run with single tag getterone or gettertwo get it looks like it executes only the include in gettertwo assume because of the tag which fails because the rest of the role is not executed is this expected the same thing happens even when move the get yml out of role to common tasks list think that re using includeable pieces is common usecase have server role and then helper that injects data to it this is on well devel >>>bug_report
filter out returned data from modules if it came from parameter marked as no log modules can have parameters marked as no log that way you can give for instance clear text password string and ansible won log it in the list of parameters that it sent to module however it doesn currently remove it from output of the module we should be able to look at all the strings we were given as values in parameters listed as no log and then check for their presence in the output if the values are present then remove them from the output >>>feature_idea p2
ansible shouldn overwrite existing files when creating retry files currently retry files are written to the user home directory by default moreover existing files are overwritten without asking maybe there is little chance that this can actually happen but what if user has an important mail in mail retry` before running ansible and executes `mail yml` playbook which fails ansible will overwrite his mail retry` file so why not change the default retry file save path to use directory the `ansible cfg` shipped with ansible already has suitable setting but it is commented out retry files save path ansible retry >>>feature_idea
update checksum make fail case fail>>>feature_pull_request needs_info
remove non existant state var>>>bugfix_pull_request easyfix
keyword not in ubuntu 14 04>>>bugfix_pull_request
parent module not found while handling absolute import issue type bug report ansible version ansible configuration using the ansible cfg from git with the following change need ssh to forwardagent yes still get the import warnings ssh args controlmaster auto controlpersist 600s forwardagent yes environment os yosemite 10 11 python python 10 summary started discussion https groups google com forum topic ansible devel lfwey gqftm on the ansible development google group wasn sure if the problem is ansible or my upgrade to el capitan 10 11 using bisect think ve narrowed the problem down to problem in ansible any play or playbook throws runtimewarning steps to reproduce any play or playbook produces this warning expected results no warnings actual results >>>bug_report
wrong attribution in readme ll be happy to submit pull request but can believe the first to notice releases are named after led zeppelin songs except most of the names in releases txt that checked are actually by van halen except the last two the kinks and david bowie >>>docs_report
v2 playbook stuck after setup with strategy free and tags issue type bug report ansible version ansible configuration ec2 dynamic inventory environment ubuntu 14 04 python boto 38 summary am using really simple playbook to test the `strategy free` feature when the playbook is used with the tags option it gets stuck after the setup step example when run the playbook without tags it works fine output now with the debug` option output steps to reproduce run the above playbook expected results it should run tasks roles that are set with the corresponding tag actual results the playbook is getting stuck after the setup task >>>bug_report p2
correct value of remote user for local connections when using local connections privilege escalation would fail if ansible ssh user was in the current context to the same value as become user this commit ensures that for local connections we reset remote user to the local username this fixes 12782 >>>bugfix_pull_request p2
ansible ssh user root breaks become when `ansible ssh user` is set to `root` for host trying to run local action in combination with `become` fails to escalate privileges setting it to any other user even non existant one causes the problem to go away it looks as if ansible assumes it already is `root` and skips the privilege escalation thanks to larsks for help in debugging this playbook to reproduce if run this playbook the `debug` task for the first play shows `root` but the task for the second play shows the username of the acount that ran ansible >>>bug_report
python print function in shell oneliner in makefile fixes file line import string random print ansible testing join random choice string ascii letters string digits for in xrange syntaxerror invalid syntax when running integration tests with hacking env setup tox py35 bin activate make test integration test var precedence >>>bugfix_pull_request
python avoid formatting of byte strings this is needed for python compatibility python can use `b bytestring` again also enable unit tests on python in tox and travis because they now pass yay >>>bugfix_pull_request
when condition evaluation is ignored for register issue type bug report ansible version environment red hat enterprise linux server release maipo for both control and configured node summary register is evaluated before when when task is ran this leads to situation when empty variable is registered even if when condition is false steps to reproduce run the following playbook hosts localhost tasks set fact ready to rock true name simple cmd command ls register download when ready to rock name simple cmd command ls when not ready to rock register download debug msg download expected results download variable should contain output of ls command actual results download variable is empty there is an old issue 5817 that was opened for the same case but correct behavior for multiple hosts should be to register var only for hosts for which when is evaluated to true >>>bug_report
ansible install via pip git https gives runtimewarnings issue type bug report ansible version devel environment ubuntu 14 04 python git pip summary installing ansible devel via pip install git https yields working ansible installation however using it yields lot of runtimewarnings steps to reproduce virtualenv ansible test cd ansible test source bin activate pip install git https github com ansible ansible rehash which ansible home ashemedai ansible test bin ansible cd path to ansible playbooks expected results ansible playbook playbooks test yml inventory local sudo password play test actual results ansible playbook playbooks test yml inventory local sudo password home ashemedai ansible test local lib python2 site packages ansible plugins filter ipaddr py 18 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import from functools import partial home ash ansible test local lib python2 site packages ansible plugins filter ipaddr py 19 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import import types home ashemedai ansible test local lib python2 site packages ansible plugins filter ipaddr py 22 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import import netaddr home ashemedai ansible test local lib python2 site packages ansible plugins filter ipaddr py 31 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import from ansible import errors home ashemedai ansible test local lib python2 site packages ansible plugins test core py 18 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import import re home ashemedai ansible test local lib python2 site packages ansible plugins test core py 19 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import from ansible import errors home ashemedai ansible test local lib python2 site packages ansible plugins test files py 18 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import from os path import isdir isfile isabs exists lexists islink samefile ismount home ashemedai ansible test local lib python2 site packages ansible plugins test files py 19 runtimewarning parent module home ashemedai ansible test local lib python2 not found while handling absolute import from ansible import errors play test and many more lines like this installing via git clone followed by git submodule update and installing via pip install yields working ansible installation in virtualenv though >>>bug_report p2
ansible pull is broken in v2 on all v2 branches next >>>bug_report p2
integration tests windows change win setup asserts as 0mb is legal amount of physical memory ansible currently reports for totalmem when running inside virtual machine this is because it is currently using wmi to retrieve the total physical ram this change just changes the test so the assert checks the amount of ram is greater than attempted to find way to retrieve the base memory allocation from the vm but could not find wmi class that reports the base ram although lot of other memory information appears available from get wmiobject class win32 operatingsystem namespace root cimv2 computername format table property totalvirtualmemorysize totalvisiblememorysize freephysicalmemory freevirtualmemory freespaceinpagingfiles see https technet microsoft com en us library dd315379 aspx >>>bugfix_pull_request easyfix windows
v1 templated delegate to with undefined variable fails even if task is skipped on when undefined it seems in 174ecb843c `delegate to gets templated even when the task would be skipped because the variable used to set the delegate is undefined this does not happen in following task snippet reproduces this source https github com bennojoy mysql blob master tasks main yml l85 this works fine in and used to work in at least until some months weeks ago testing with 174ecb843c this fails >>>bug_report
uncatched traceback running cowsay it seems cowsay is now ran at each cli invocation but if womething is wrong with the installation of cowsay there an uncatched traceback tested with 174ecb8 the issue causing the error is an old install of `cowsay` which happened to have it binary not executeable rw root root 203539 aug 19 2014 usr bin cowsay` this by itself is not an ansible problem of course but wanted to just report the ugly traceback that is not catched here >>>bug_report easyfix
bug report cannot set ansible python interpreter for the delegate to host ansible version environment arch linux before hacking env setup after hacking env setup summary am not able to change the `ansible python interpreter` variable for the delegate to host steps to reproduce modified workdir as follows and then ran `make test delegate to` especially notice the following line this would be expected to be using usr bin python2` rather than usr bin python` >>>bug_report
bundle new version of python six for compatibility along with some code to make it easy for distributions to override the bunndled copy if they have new enough version >>>feature_pull_request
document using the `raw` module to install py2 and simplejson in the installation guide the raw module is mentioned as an option for installing python or simplejson on managed nodes that don have them this change adds an example for users that may already be familiar with using ansible but are checking install docs because they don know the requirements for managed nodes or are using distribution that doesn include python by default >>>docs_pull_request p2
implemented inventory hostname lookup in v2 fixes 12531 >>>bugfix_pull_request
group names now includes all group hi before variablemanager existed the group names var was filled with the result of host get variables which strips down the all group https github com ansible ansible blob release1 lib ansible inventory host py l64 now magic vars seems to be populated with the variablemanager get magic variables https github com ansible ansible blob devel lib ansible vars init py l333 but the explicit strip down of the all group has disappeared is this change of behaviour wanted >>>bug_report easyfix
plugins callback profile tasks py wrong timing skipped tasks wrong timing for the last task when running handlers the report includes the total execution time of the handlers for the last task skipped tasks not handled when taks is skipped the following warning is printed >>>bug_report needs_info
global name os is not defined unexpected exception global name os is not defined the full traceback was traceback most recent call last file tmp ansible bin ansible playbook line 80 in sys exit cli run file tmp ansible lib ansible cli playbook py line 138 in run results pbex run file tmp ansible lib ansible executor playbook executor py line 77 in run self inventory set playbook basedir os path dirname playbook path nameerror global name os is not defined>>>pending_closure
fix unexpected exception global name os is not defined inadvertently introduced it in ca826508d992f99ab6cba75d03a34b804448dfef and didn notice because there are no unit tests for playbook executor py sorry the `from ansible errors import was used only to get the os module which makes me go what >>>bugfix_pull_request p2
python fix ansibleerror formatting if you convert the error string to bytes and embed it inside another error string you get prefix embedded nerror nstring which is not what we want but we also don want unicode in error messages causing unexpected unicodeencodeerrors when on python so let convert the error message into the native string type bytes on python unicode on python this fixes two failing tests on python >>>bugfix_pull_request
dnf and package modules fail to install previously not present package with state latest am running with ansible devel off github with targeted test box provisioned with fedora 22 minimal server the first example on the dnf module doc page http docs ansible com ansible dnf module html examples is however when run task that uses either the `package` or `dnf` module with `state latest` to install not present package in this case rsyslog the task reports success nothing to do and fails to install the package if re run with the task modified to specify `state present` then the task properly succeeds and installs the package the following playbook illustrates this by attempting the following tasks install rsyslog using module dnf and state latest install rsyslog using module package and state latest install rsyslog using module dnf and state present here is the playbook here is the actual output realize that using state present will probably certainly install whatever version is latest if no version was previously installed but that would seem to break idempotency if you re run the playbook month later >>>bug_report
building latest rpm git clone git github com ansible ansible git recursive cd ansible make rpm sudo rpm uvh rpm build ansible noarch rpm ansible version traceback most recent call last file usr bin ansible line 39 in from ansible errors import ansibleerror ansibleoptionserror ansibleparsererror importerror cannot import name ansibleoptionserror python version python 10 usr bin python2 from distutils sysconfig import get python lib import sys sys stdout write get python lib usr lib python2 dist packages rpm eval python usr bin python2 6>>>needs_info
flag to stop connecting to servers after the first sudo become password failure issue type feature idea ansible version ansible configuration environment summary flag to stop connecting to servers after the first sudo become password failure steps to reproduce connect to large number of servers and enter the wrong sudo password expected results with this flag the connections would stop after the first sudo become password failure actual results ansible keeps connecting to each server and repeatedly tries the same incorrect password since my accounts on these servers are tied to active directory this causes my account to be locked out after sufficient failed login attempts in short period of time >>>feature_idea
fix delegate to with sync action tima moved delegate to fix out here https github com ansible ansible pull 12704 single line fix this bit if delegate to dest host task vars get inventory hostname else otherwise dest host would be the delegate itself and not the inventory this we end up trying to run rsync locally on the same system used an exception to catch this to see why rsync was trying to use the delegate to host as endpoint itself vim lib ansible plugins action synchronize py 127 src host 127 128 raise exception nansible ssh host ninventory hostname task vars get ansible ssh host task vars get inventory hostname 129 dest host task vars get ansible ssh host or task vars get inventory hostname 130 144 if dest host delegate to 145 148 dest host 127 149 use delegate true file home ritesh projects github ansible ansible lib ansible plugins action synchronize py line 128 in run raise exception ninventory hostname nansible ssh host task vars get inventory hostname task vars get ansible ssh host exception inventory hostname 192 168 56 101 ansible ssh host 192 168 56 102 cat inventory 192 168 56 101 cat sync test yml vars staging server 192 168 56 102 tasks synchronize src etc dest tmp login password true delegate to staging server from ps aux on staging server serverb ssh none centos 127 rsync server logdtprze ilsf log format delay updates tmp if we are using delegate to action as per my understanding synchronize should on delegate to host and rsync to ansible inventory host with current code sync tries to run this locally src host is always localhost 127 dest host is set to ssh hostname or inventory hostname ssh hostname is the host module is running on which can be the delegate to host dest host needs to be inventory hostname as this is our dest in case of delegate to action >>>bugfix_pull_request
fix links to dynamic inventory script example doc`aws example` no longer existed >>>docs_pull_request easyfix
attempt to solve 12730 here my humble attempt to solve 12730 untested yet >>>feature_pull_request
allow holizontal scroll for oversized options table fixes 12745 cc bcoca >>>docs_pull_request
reordering entries in glossary for alphabetical order>>>docs_pull_request
docs styling preventing to read entire content of the pages hi all not sure if you re aware of this already but the content is not completely readable on the docs please see screenshot below page being http docs ansible com ansible docker module html>>>docs_report
bug report ec2 module is broken with error module is missing interpreter line issue type bug report ansible version ansible devel 2963bba901 last updated 2015 10 14 15 07 35 gmt 300 lib ansible modules core devel 95b10c9fdd last updated 2015 10 14 10 52 54 gmt 300 lib ansible modules extras devel 15480e3d04 last updated 2015 10 14 10 52 56 gmt 300 config file etc ansible ansible cfg configured module search path none ansible configuration issue exists even with the github version of ansible cfg environment macosx yosemite 10 10 summary in most recent devel usage of ec2 module is broken trying to use even the basic examples from the ec2 module page produces message fatal localhost failed failed true msg error module is missing interpreter line the error happens even before the module options are parsed the functionality has been broken since commit 18e2ee16ef0895831ead312550eb5de44c99524c couldn decipher why that commit broke the ec2 module steps to reproduce hosts localhost tasks ec2 key name mykey instance type t2 micro image ami 123456 wait yes group webserver count vpc subnet id subnet 29e63245 assign public ip yes expected results ec2 modules should function as before and allow creation of instances actual results following error is printed and playbook execution ends fatal localhost localhost failed failed true msg error module is missing interpreter line >>>bug_report
group vars and host vars in inventory dir not considered commit e6d3c67 introduced change which leads to group vars and host vars directories inside inventory dir are no longer being incorporated prior to this commit it worked as expected when executing playbook it errors with >>>bug_report p2
https galaxy ansible com intro incorrect example the example given is `ansible galaxy roles txt` but this fails in ansible it should be `ansible galaxy install roles txt`>>>needs_to_be_moved
custom filter plugins become unavailable part way through playbook issue custom filter may become unavailable part way through playbook after already having been used at least once without apparent problems git repo demonstrating this problem is provided here https github com rusdavies ansible plugin problem tree master the master branch provides playbook that demonstrates the issue whereas the works branch demonstrates the same playbook with an include statement commented out in roles eg role tasks main yml which then seems to allow success of note the playbook fails if the include is present at all even with all of the contents of the included file commented out the same playbook seems to work without issue on ansible issue type bug report ansible version ansible configuration stock per fedora 21 environment stock fedora 21 summary custom filter becomes unavailable part way through playbook even though it was successfully used at least once steps to reproduce success on ansible checkout the master branch of this repository https github com rusdavies ansible plugin problem install ansible from stock fedora repositories run ansible playbook vvv eg yml observe the playbook completes successfully fail on ansible 30 install ansible from git see here http docs ansible com ansible intro installation html latest release via yum rerun ansible playbook vvv eg yml on the playbook https github com rusdavies ansible plugin problem observe that the playbook outputs from task eg role debug var eg destroy indicating one successful use of the custom filter plugin observe that the playbook fails in task eg role debug var eg create with an error about the already used custom filter not being available quasi success on ansible checkout the works branch of this repo https github com rusdavies ansible plugin problem which merely comments out an include in roles eg role tasks main yml 10 rerun ansible playbook vvv eg yml 11 observe the playbook completes successfully albeit with missing functionality expected results the playbook should complete successfully with the custom plugin being available upon each invocation actual results the playbook in this git repo works on ansible but not on ansible wherein it fails with no filter named byattr `` error as follows >>>bug_report
win copy does not copy file if it contains powershell shebang line as 1st line hi for some reason when try to upload text file that starts like this the file is not present afterwards on the remote system however if insert some other text on the 1st line of the text file then it will be copied successfully this seems like bug of some sorts target system win10 powershell ansible version 3>>>bug_report windows
v2 failing apt task with items in include with items hi running the devel branch 7dfce28 found that following inconsistency have playbook with an apt install task with with items property that works fine followed by that have an include task again with items feature is now back in v2 and the reason running level as beta1 had bug with include and with items in the included task have an apt task https gist github com basz c74dff4fb6a333433ec6 file import s3 backup yml l7 the exact same as in the playbook where the item property isn populated correctly and the task is marked as skipped https gist github com basz c74dff4fb6a333433ec6 file sndout l26 perhaps am doing something wrong but when modify the include task such that it operates without the with items the apt task in the included file runs fine think item from the with items is somehow scoped into the apt task https gist github com basz c74dff4fb6a333433ec6>>>bug_report pending_closure
max fail percentage rolling update not user friendly to retry ran into this issue yesterday when applying rolling update to number of sites had the following in the playbook one of my batches of sites failed at once due to an ssh issue something wasn expecting this cause the whole playbook to stop in state like this site12 site13 site15 16 17 and 18 were all green but they didn run when see host that is green and has unreachable and failed tasks ve been accustomed assume everything was done only until angry customer phone calls come in this morning do realize wrong site8 site9 and site11 all rightly failed after using the handy limit site retry flag everything was great on those but because didn scrutinize the output missed another hosts that shouldn have think there needs to be usability improvement here would prefer some way to mark those as failed notes ansible 2>>>bug_report
added include for ansible ssh change to another section changes note added to another section of intro inventory rst for clarity>>>docs_pull_request
placement of network interface information as top level keys in ansible facts may cause conflicts ansible places information about network interfaces in top level keys of `ansible facts` named `ansible this will cause conflicts if happens to be the same as the suffix on another top level key if have ip addr show 302 system mtu 1500 qdisc noop state down group default link ether 5e 0b f5 15 e3 6a brd ff ff ff ff ff ff and then run ansible localhost localhost local setup will have no information about this interface because `ansible system` is an existing key containing the operating system name ansible system linux simply placing interface information under top level `interfaces` key would completely solve this issue and would also make it much easier to iterate over available interfaces >>>feature_idea
group names var ordered by name instead of level given the following tree wanted to generate via template iptables rules like that for db1 it works because db1 group names content is the following at first was happy because it seemed this array was sorted from the top group to the deepest but doing more tests showed that this array is simply alphabetically sorted which forbids to statically access the name of group if you know its level >>>bug_report feature_idea
add host can add chroot file paths when trying to dynamically set new host for chroot when using temporary directory as mount point the add host module errors out claiming that the hostname is invalid this is inconsistent with hostname specifications in the inventory file as documented which do allow file paths to be given as hostnames it doesn appear possible to work around this with templates as hosts line parsing does not appear to have any variables from play in scope my immediate solution to this has been to catch the normal parse address error and check if filepath matching the given host exists instead possibly though new action is needed instead >>>bug_report
python there no basestring fixes one failing test >>>feature_pull_request
make ansible vars unsafe proxy python friendly>>>bugfix_pull_request
v2 error while trying to read cache facts errno 21 is directory cache facts issue type bug report ansible version ansible devel 8277747a04 last updated 2015 10 13 08 59 15 gmt 300 lib ansible modules core detached head 92d25017ed last updated 2015 10 12 09 17 45 gmt 300 lib ansible modules extras detached head 205115ea1f last updated 2015 10 12 09 17 45 gmt 300 summary ve set of tasks that generate an ssh keypair on host then install the public key on host the tasks look like this the last task fails on ansible v2 it seems to me that there are two errors here getting the host name wrong edit no the bug is not skipping cache loading when the task is skipped unboundlocalerror in the error handling let focus on the error handling bug first >>>bug_report
unable to provide access to user on same database while repeating script hello ansible version environment ubuntu 14 04 summary am running mysql user module to create database and then add user and provide access to that user on defined items but when am running same script again it is failing on providing access script was using name create databases mysql db login host 127 login user root login port 3307 login password name db user state present collation utf8 general ci encoding utf8 name add deploy db user and allow access to database2 mysql user login host 127 login user root login port 3307 login password name db user password db pass host item priv db all grant state present with items ansible hostname 127 custom server it is failing on providing access to ansible hostname other items are working good and shows ok here is screenshot of error imgo https cloud githubusercontent com assets 6582086 10456910 4f7f13c0 71e1 11e5 8029 4c094d969f79 jpg when look into db users there is already username present with access to anible hostname variable have to then delete that user manually and it worked after that can you please let us know what should be possible reason for it or anything wrong am doing note it was failing only on one machine was not able to reproduce this error on other machines >>>bug_report needs_to_be_moved
inventory dir doesn expand in group vars when running playbook in subdirectory consider the following file structure hosts services main yaml group vars all when running ansible stable branch all variables are correctly expanded on latest devel branch two variables are not expanded it does however work when putting the main yaml in the top level directory >>>bug_report
start at tasks is no longer working this was working as few as weeks ago >>>bug_report
adding concat lists option to combine filter amenonsen pr for concatenation of lists in combine filter per discussion in irc >>>feature_pull_request
accessing default variables for other hosts issue type bug report ansible version ansible configuration default environment mac os 10 10 applied on ubuntu linux 14 04 summary default role variables are not available with hostvars steps to reproduce create role role roles role defaults main yml yml var create two hosts get var variable from host1 on host2 yml hosts all roles test tasks debug var hostvars host1 var ok host2 var hostvars host1 var ok dev05 reviseapp net var hostvars host1 var ok host2 var hostvars host1 var hostvars host1 var ok dev05 reviseapp net var hostvars host1 var hostvars host1 var >>>bug_report
hostvars with variables for different hosts issue type bug report ansible version ansible configuration default environment mac os 10 10 applied on ubuntu linux 14 04 summary accessing parametrised host variables from host puts host parameters to those variables steps to reproduce host vars yml and get this variable on host expected results >>>bug_report
update documentation yml>>>docs_pull_request
v2 ansible does not load dynamic vars files issue type bug report ansible version ansible configuration summary dynamic vars files are not loaded using ansible v2 beta steps to reproduce hosts local test playbook yml testvar yml expected results actual results executing the playbook results in the following if the `mandatory` filter is removed the values in the file are still not loaded correctly this previously worked without problems in ansible v1 >>>bug_report
support ok when condition for tasks issue type feature idea ansible version ansible ansible configuration default configuration environment debian summary add `ok when` condition to tasks when it evaluates to true dont run the task and show ok when it evaluates to false or it is missing and `when` evaluates to true run the task know could run the `install wordpress plugins` task for each plugin but that is time consuming when you have big list of plugins as the `wp` https github com wp cli wp cli command seems to have high startup time steps to reproduce example play https github com ypid debops wordpress blob manage plugins roles wordpress tasks manage plugins yml which would benefit form this feature expected results actual results >>>feature_idea
v2 cannot handle modules that set non string facts issue type bug report ansible version summary when custom module returns `ansible facts` with non string values ansible fails steps to reproduce enable fact caching in ansible cfg create custom module `library mymodule py` create playbook run `ansible playbook test yml vvv` expected results actual results with vvv` note this failure leaves broken cache file which triggers bug 12708 so be sure to `rm rf cache` before you repeat the reproduction steps >>>bug_report p2 pending_closure
v2 attributeerror cachemodule object has no attribute display issue type bug report ansible version summary was testing custom module and this happened at that point ansible playbook hangs until hit steps to reproduce create an `ansible cfg` create playbook `test yml` create an empty cache file or any other error condition read only cache` directory run `ansible playbook test yml` expected results either the empty cache file is ignored or there an error saying that the cache file is corrupt actual results there was no hang with this reproducible example >>>bug_report easyfix
run travis integration tests with the right python version fixes an issue abadger mentioned in the comments of pr 12627 >>>bugfix_pull_request
regression service module enabled always reports as changed issue type bug report ansible version ansible environment debian jessie x64 summary recurrence of issue 9074 the same steps may be used to reproduce this bug >>>bug_report needs_to_be_moved
improve module doc template and module return value doc in ansible ansible modules extras 832 was requested from reviewer to document module return values as per module checklist http docs ansible com ansible developing modules html module checklist actually my module has no special values to document however couldn find good way or good reason to mention it in an individual module doc and felt it would be better to fix the module doc template instead so made this pr this makes every module doc include mention to common return values http docs ansible com ansible common return values html which improves doc usability developers can easily declare there are no return values unique to their modules by putting in `return` variable so they are encouraged to document `return` in every module >>>docs_pull_request
allow for sshpass support for `synchronize` needs https github com ansible ansible modules core pull 2244 sshpass support env support for run command delegate to fix https github com ansible ansible pull 12752 security consideration proc pid environ are only readable by owner or root root can read almost everything based on selinux security policies including proc kcore ssh client tends to strip out env variables sshpass will not be seen by client process sendenv ssh config bit reasons to opt for env var module run command does not support passing an fd to command module ssh and sshpass do not support reading password from stdin pipe data arg of run command passing fd number to sshpass will not work as fd no can be random adding support for setting up env was the least invasive and most reliable change>>>feature_pull_request
adding the inventory file var back this fixes the formerly fixed https github com ansible ansible issues 8534 where `vars files` won expand the `inventory file` variable >>>bugfix_pull_request
ansible fails to lookup entries of dict issue type bug report ansible version ansible devel ansible configuration default configuration environment debian ubuntu summary ansible fails with the following error when trying to access data from dict task launch instance changed localhost localhost task add new instance to host group warning error when using global name get is not defined example playbook name create server nbsp nbsp hosts localhost nbsp nbsp connection local nbsp nbsp gather facts false nbsp nbsp vars files nbsp nbsp nbsp nbsp vars credentials yml nbsp nbsp nbsp nbsp vars ec2 yml nbsp nbsp tasks nbsp nbsp nbsp nbsp name launch instance nbsp nbsp nbsp nbsp nbsp nbsp ec2 nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp key name keypair nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp group security group nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp instance type instance type nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp image ami nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp wait true nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp region region nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp vpc subnet id subnet nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp assign public ip yes nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp aws access key access key id nbsp nbsp nbsp nbsp nbsp nbsp nbsp nbsp aws secret key secret access key nbsp nbsp nbsp nbsp nbsp nbsp register ec2 nbsp nbsp nbsp nbsp name add new instance to host group nbsp nbsp nbsp nbsp nbsp nbsp add host hostname item public ip groupname launched nbsp nbsp nbsp nbsp nbsp nbsp with items ec2 instances >>>bug_report needs_info pending_closure
try checking other environment variables instead of accepting empty ones also it marginally faster to just use dict get directly this way >>>cloud feature_pull_request
bugfix serial keyword can be specified as percentage the serial keyword can be specified as percentage 30 or number therefore it needs to be string to allow both types>>>bugfix_pull_request needs_revision
ansible running shell on wrong machine issue type bug report ansible version ansible devel 17c75df ansible configuration environment summary running basic shell command returns the output from the wrong host steps to reproduce expected results actual results >>>bug_report needs_info
fix an issue where cache plugins weren updated in certain scenarios the first call to persisting facts would work due to the assignment of mutablemapping calling setitem but subsequent module fact data would not be propogated to the fact cache plugins because update doesn invoke setitem this changes the behavior little bit and ensures set is called on cache plugins >>>bugfix_pull_request
add host followed by local action adds 127 to inventory in following plays issue type bug report ansible version from pypi ansible configuration using default configuration environment mac os 10 10 summary ve actively been using role to add host to new dynamic groups for while and it has been working fine until today when added `local action` to the play now all following plays have new host 127 in their inventory steps to reproduce reduced it to being something with `add host` and `local action` and made small playbook without roles to reproduce the issue expected results host 127 should not be added to inventory of chained plays actual results host 127 is added to inventory list output from playbook >>>bug_report p2
remove some warning of undefined name and fix classmethod syntax error remove some warning of undefined name and fix classmethod syntax error >>>bugfix_pull_request
ansible ssh changes docswork versioning note for removing ssh from ansible user variables in which doesn work in older versions>>>docs_pull_request p2
force ssl transport for pywinrm updates get host group vars pr change to pywinrm to allow server certs to be ignored but it only on the ssl transport which we were previously ignoring for this to work more generally eg when defined as group var we re also now pulling the named ansible winrm args from the merged set of host group vars not just host vars >>>bugfix_pull_request windows
new become method option sudo su found 8650 which was rejected as possible misunderstanding we have this same issue too we want to use ansible to control system but the system we wish to log in to is not controlled by us and has very strict permissions specifically the only way we can run commands on the system is with or alas this is not an available become method is there any chance of getting this option added >>>feature_idea
expose all cli options as variables with ansible prefix think this would be very useful for the purposes of notifications slack twilio email etc when notify want to specify which hosts were included `limit` sure there are many other uses haven thought of that this would enable >>>feature_idea
add ability to rate limit data transfer some of my playbooks require transferring large files to large number of hosts ve come across issues related to bandwidth first its fairly easy to max out my internet connection the second is on smaller ec2 instances network performance can become an issue like to know if we can get the equivalent of the sftp scp limit flag applied both globally via ansible cfg or command line option and as an option for individual tasks like unarchive >>>feature_idea
callbackbase runner on skipped not called anymore in callbackbase the v1 method runner on skipped is expected to be called an has been called in previous versions from the v2 method v2 runner on skipped but since commit 4c9f58a15 the v1 method runner on skipped is not called anymore >>>bug_report
vars prompt attributeerror nonetype object has no attribute send callback with current `devel` branch the `vars prompt` is broken while it is working well with branch `stable 9` the error is >>>bug_report
ansible v2 does not parse lookup template correctly issue type bug report ansible version ansible devel ansible configuration default configuration environment debian ubuntu summary output generated by `lookup template is not parsed correctly by ansible unsafeproxy involved steps to reproduce test case can be found in separate repository https github com drybjed ansible lookup test expected results actual results >>>bug_report p2 pending_closure
playbooks issue hi there after changing my linux distribution from debian to arch ve got little issue to run playbooks when ansbile was installed by pacman have error like but when uninstall package by pacman and install by pip ve got on this same playbooks version of ansible is in both cases version of python is many thanks for help >>>bug_report
fix some warning of undefined name >>>bugfix_pull_request
skipping hosts after adding the ec2 instances issue type bug report ansible version ansible configuration dynamic inventory is used no fact caching credentials of windows instances are stored in host file for working with winrm environment ansible controlling machine os ubuntu 14 04 summary ec2 instances are created in the playbook some configurations need to be changed in the newly created instances but it skips the newly created hosts in the playbook but on running the same playbook again it recognises and executes the task in the newly created ec2 instance steps to reproduce instance is created using ec2 module of ansible and ec2n is the registered variable after executing the module so after adding the hosts running the tasks for the newly created hosts by this setup skips host for the first run but by running the playbook again it recognises the newly created hosts and starts executing the tasks expected results starts executing the task at the first run itself actual results screen shot 2015 10 08 at 16 35 pm https cloud githubusercontent com assets 6481030 10357556 601b6fa2 6dbe 11e5 9236 f3b28a13b1d5 png >>>bug_report
unable to run ansible commands issue type bug report ansible version ansible devel d8769c93c7 last updated 2015 10 07 15 50 12 gmt 700 lib ansible modules core detached head d659c79db7 last updated 2015 10 06 19 38 32 gmt 700 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 06 19 38 33 gmt 700 ansible configuration defaults remote user root transport ssh ssh connection ssh args stricthostkeychecking true environment centos python summary basic ansible command returns errors steps to reproduce expected results actual results this is with vvv edited to remove some information put in place of full path to ansible directory >>>bug_report needs_info
cannot have emoji module traceback issue type bug report ansible version ansible config file etc ansible ansible cfg configured module search path none ansible configuration nothing other than passing module dir to my custom module environment fedora 22 summary steps to reproduce create module py create playbook that calls it attempt to run the playbook expected results happy cow actual results sad traceback cow >>>feature_idea
trivial fail if the vault password script returns non zero fixes 12673 not checking the error code could potentially lead to encrypting the data with the error message as the password before after if this looks acceptable ll add tests cc msabramo 0x9900>>>bugfix_pull_request
return code is not checked when executing vault password script which means the error message is treated as password and leads to potentially irreversibly encrypting the data with unknown password >>>bug_report
update playbooks blocks rst remove heading that appears to be extraneous >>>docs_pull_request
indicate that credstash plugin is new in v2 lost bit of time headscratching because the docs didn mention that the awesome credstash plugin isn in v1 ve also added simple poor man alternative in case like me people have already spent bunch of time setting up credstash by the time they realise they can use the plugin >>>docs_pull_request
expand cache plugin to include inventory issue type feature idea ansible version future ansible configuration environment all summary allow current fact cache plugin to also be used to cache inventory information this will remove the need for inventory scripts to keep their own cache and allow control of the cache from within ansible also this allows us to remove several different caching implementations done in the inventory scripts in ansible cfg inventory cache yes no or make it key returned from the inventory script itself cacheable yes no assume no if absent this will also allow the new `meta refresh inventory` directive to easily bypass the cache steps to reproduce expected results actual results a>>>feature_idea
unicode in variable file causes traceback in yaml error handler issue type bug report ansible version ansible config file etc ansible ansible cfg configured module search path none ansible configuration nothing particular environment fedora 22 summary create variables file with some unicode an example pass it to ansible playbook ansible playbook tracebacks in the yaml error handler interestingly if vault this file properly get steps to reproduce see summary expected results correct yaml error handling actual results traceback >>>bug_report
tilde is not expanded correctly in v2 issue type bug report ansible version ansible version ansible devel 9e364c2 last updated 2015 10 07 10 29 32 gmt 300 lib ansible modules core detached head d659c79db7 last updated 2015 10 07 10 29 43 gmt 300 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 07 10 29 53 gmt 300 config file home albert ansible ansible cfg configured module search path none ansible configuration environment arch linux as control machine centos as remote machine summary tilde is not being expanded in `remote tmp` configuration in ansible cfg steps to reproduce consider our working dir is at home name ansible put custom configuration in ansible cfg using tilde expected results tmp files dir should be home name ansible tmp` actual results tmp files dir is home name ansible ansible tmp` but in the log we would see this so the output is not correct as well >>>bug_report
ansible python interpreter is not being honored in v2 issue type bug report ansible version ansible version ansible devel 9e364c2eb5 last updated 2015 10 07 10 29 32 gmt 300 lib ansible modules core detached head d659c79db7 last updated 2015 10 07 10 29 43 gmt 300 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 07 10 29 53 gmt 300 config file home albert ansible ansible cfg configured module search path none ansible configuration environment arch linux as control machine centos as remote machine summary setting ansible python interpreter is not beind honored steps to reproduce if you re using control machine with python as default set `ansible python interpreter usr bin python2` on localhost run the following playbook with vvv expected results the playbook should run fine actual results playbook fails with the following error and you can see that it tries to use usr bin python` as executable and not usr bin python2` as we requested >>>bug_report
displays the absolute path of given task when verbosity is above level one of the main challenges we face in project with lots of roles is knowing exactly where given task is defined having the absolute task path and its line number would help lot on the development process >>>feature_pull_request
take into account cache file existence in do inventory even with force cache if cache file does not exist it should be created >>>bugfix_pull_request easyfix
add an example for map to the filters page >>>docs_pull_request
show nice error if the role name is missing without the patch >>>bugfix_pull_request
yum update fail issue type bug report ansible version ansible ansible configuration nothing special environment run from os 10 11 managing oraclelinux summary playbook with this task fail actual results >>>p2
pip module chdir option does not expand tilde correctly if give `chdir home ubuntu app` it works but giving `chdir app` doesnt seem to work after some digging it is because of the code joining this option with the temp directory this dir tempfile gettempdir if chdir this dir os path join this dir chdir from simple testing this method doesnt work for but it works for absolute paths >>>needs_to_be_moved
explictly set the version of strict mode to use for powershell modules like the version of strict mode to be set explicitly in case next update to powershell comes with new version of strict mode that also updated the module development windows modules checklist to state the version of strict mode in use >>>bugfix_pull_request
include with items don execute included file issue type bug report ansible version ansible beta1 configured module search path none ansible configuration defaults hostfile dev null gathering explicit remote user root environment running ansible from opensuse 13 harlequin x86 64 managing opensuse 13 harlequin x86 64 summary include with itmes shows include for every item but don execute the included file there is no problem when executing with ansible alpha2 steps to reproduce expected results alpha2 actual results beta1 >>>bug_report p2
inventory dir not getting passed via group vars in but was in issue type bug report ansible version jarrod jarrods macbook pro ansible version ansible devel 5ae74f7d38 last updated 2015 10 06 15 15 05 gmt 400 lib ansible modules core detached head d659c79db7 last updated 2015 10 06 15 15 11 gmt 400 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 06 15 15 15 gmt 400 config file configured module search path none os is osx 10 10 yosemite summary the inventory dir variable doesn get passed to task in role via the inventory group var file steps to reproduce playbook yml hosts target serial gather facts yes sudo yes vars target service pre tasks datadog event title deployment of service text begin service deployment priority low api key datadog api key post tasks datadog event title deployment of service text end service deployment priority low api key datadog api key roles service haproxy inventory service group vars haproxy yml haproxy fragments server src inventory dir roles service templates haproxy cfg j2 task service haproxy debug var inventory dir ok host amazonaws com changed false inventory dir null task service haproxy copy fragments failed host amazonaws com item value src roles service templates haproxy cfg j2 key haproxy failed true item key haproxy value src roles service templates haproxy cfg j2 msg ioerror errno no such file or directory roles service templates haproxy cfg j2 jarrod jarrods macbook pro ansible playbook inventory service playbooks service main yml extra vars target service ec2 user modules private key ssh root key expected results inventory dir path to inv actual results inventory dir null this works in but does not in latest >>>bug_report needs_info
ansible galaxy install tracebacks issue type bug report ansible version beta alternatively ansible configuration nothing special environment centos fedora 22 summary steps to reproduce see above commandline and requirements file expected results succeeds without traceback actual results succeeds with traceback >>>bug_report p2
type error concatenating string literal with lookup issue type bug report ansible version ansible devel 5ae74f7d38 last updated 2015 10 06 13 09 43 gmt 400 lib ansible modules core detached head d659c79db7 last updated 2015 10 06 13 10 23 gmt 400 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 06 13 10 24 gmt 400 ansible configuration none environment summary concatenating string literal followed by another file lookup causes type error but not the other way around localhost ansible connection local ansible hosts localhost tasks debug var abc lookup file test txt asdf>>>bug_report p2 pending_closure
certain variables are passed incorrectly to included tasks issue type bug report ansible version 1ppa vivid ansible configuration standard environment ubuntu 15 04 summary certain variables are passed incorrectly to included tasks steps to reproduce `hosts` `group vars all yml` `site yml` `roles master tasks main yml` `roles master tasks other yml` expected results correct values in both cases actual results `slave list` is in `other yml`>>>bug_report
add note about support of ansible ssh variables from the front page http docs ansible com ansible index html of the ansible doc site this documentation covers the current released version of ansible and also some development version features for recent features we note in each section the version of ansible where the feature was added after f56a6e0951af9ae68106a8f9569cc375f53d5b52 all traces of the `ansible ssh variables disappeared with no mention that they are the only supported versions in pre that is cannot use `ansible host` in but `ansible ssh host` works as expected there should be note or many based on that commit that users must use `ansible ssh variables if they are using pre versions of ansible >>>docs_report p2
delegate to localhost unsupported parameter for module on v2 issue type bug report ansible version ansible devel 5ae74f7d38 last updated 2015 10 06 17 05 11 gmt 300 lib ansible modules core detached head d659c79db7 last updated 2015 10 06 17 05 13 gmt 300 lib ansible modules extras detached head 0ff1776a84 last updated 2015 10 06 17 05 13 gmt 300 config file home albert ansible cfg configured module search path none ansible configuration environment arch linux remote machine centos summary when running task with `delegate to localhost` or `delegate to 127 1` an error is received no problem on steps to reproduce run the following playbook expected results the task should run on localhost actual results the following error is received the error is different for some modules this warning is received first and then similar error `shell` module `replace` module >>>bug_report needs_info
s3 module error message unclear if you download multipart s3 objects and dest folder if you download uploaded file with the s3 module the destination needs to be file if you set dest folder and the file is multipart upload the error message is misleading this task s3 bucket mybucket object my desired key txt dest usr local myfolder mode get will result in unclear error msg files uploaded with multipart of s3 are not supported with checksum unable to compute checksum while s3 bucket mybucket object my desired key txt dest usr local myfile txt mode get works as expected without any errors the core issue here is that the s3 object is multipart upload and ansible can handle it see 5442 which has the same error message if the s3 object is single part upload the error message you will get when using dest folder is obvious and will result in ioerror errno 21 is directory folder output>>>needs_to_be_moved
s3 module add option to change the file permission in the s3 module there is no option to set the file permission file user and group ownership after file was downloaded from s3 to the local system the workaround would be running file task afterwards s3 bucket mybucket object my desired key txt dest usr local myfile txt mode get file path usr local myfile txt mode 0644 owner foo group foo state touch>>>needs_to_be_moved
you can create private instances in softlayer without primaryipaddress currently the softlayer inventory script ignores any servers which don have public ip address which isn always ideal>>>feature_pull_request needs_rebase
ansible does not override ssh user in ssh config issue type bug report ansible version ansible ansible configuration environment linux mint 17 rafaela summary if in my ssh config set user then ansible allways connect with that username not specified in ansible cfg or by option steps to reproduce in ssh config set host user qweqwe and run ansible root ping expected results ansible connect as root user actual results ansible connect as qweqwe user>>>bug_report
fix ec2 inventory for potentially inconsistent data last week one of my ansible playbooks decided to terminate all instances on our account since talking to aws support have found that this is due to bug potential data inconsistency in the ec2 api incident have playbook as detailed in this blogpost http adamj eu tech 2015 04 09 cleaning up nameless ec2 instances with ansible that terminates all instances without tags that have been running hour it is intended to clean up accidental launches from aborted ci builds and thus runs every 15 minutes on our jenkins server last week on the nearly 27 000th run of the playbook it decided to terminate all instances this was because the ec2 api through the ec2 py inventory script returned the list of instances but no tagging information for them fix when contacted aws support private communication they confirmed that the ec2 `describeinstances` endpoint boto `get all instances` makes no guarantees about the tags being returned alongside the instances and that they have failed to document it they made two suggestions use `describetags` boto `get all tags` to fetch tag information in second request this is guaranteed to fail if it can fetch tags apply tag filter to `describeinstances` since number cannot be done and still return untagged instances number is the only option this pr implements number in `ec2 py` for testing ve run it my own inventory and `diff` of the before after results produces no output keen to know if there are other ways of testing >>>bugfix_pull_request cloud
add git commit hash to ansible version or version ve been using ansible for few months now and have just had problem after upgrading and had to downgrade back unfortunately didn know which commit to checkout and spent fair deal of time trying to find one that worked colleague of mine had working installation but didn know which commit both his installation and all the versions had had ansible version 0` like to propose adding the git commit hash to the output of version to aid in debugging upgrade problems especially since the what version to pick http docs ansible com ansible intro installation html what version to pick section of the installation guide recommends installing from the devel branch list of previously installed versions with the time of updating would be even better thank you for your time >>>feature_idea
add an expand csv tags setting to ec2 ini if enabled this will convert tags of the form to list and use the results to create additional inventory groups this is based on pr 8676 by nickpeck but not straight rebaseboth the code and the nomenclature have been changed here closes 8676 cc willthames bcoca >>>cloud feature_pull_request needs_revision
ansible copy does not work with sudo hi have problem where the copy module does not work with sudo enabled and it breaks with very specific combination of things my playbook name copy copy src tmp joan dest tmp joan sudo yes name copy copy src tmp joan dest tmp joan sudo yes oo ok icg1dbe01 dev oo fatal icg1dbe01 dev ssh connection error while waiting for sudo password prompt fatal all hosts have already failed aborting usr bin python python r266 84292 oct 15 2013 07 32 41 python python default may 2014 17 35 19 >>>bug_report p2
fix ansible vault rekey issue type bugfix pull request ansible version ansible devel d91b3c6b9d last updated 2015 10 05 15 41 58 gmt 500 lib ansible modules core detached head 144291120e last updated 2015 10 05 15 42 05 gmt 500 lib ansible modules extras detached head da426da308 last updated 2015 10 05 15 42 05 gmt 500 config file configured module search path none ansible configuration none environment mac os 10 10 summary running ansible vault rekey without the new vault password file option throws an exception steps to reproduce run ansible vault rekey secrets yaml after inputing the vault password it will throw an exception expected results after asking for the vault password it should ask for the new vault password without exception actual results mbp group vars user ansible vault rekey secrets yaml vvv no config file found using defaults vault password unexpected exception vaultcli object has no attribute new vault pass the full traceback was traceback most recent call last file users rcleere code ansible ansible bin ansible vault line 79 in sys exit cli run file users rcleere code ansible ansible lib ansible cli vault py line 103 in run self execute file users rcleere code ansible ansible lib ansible cli init py line 96 in execute fn file users rcleere code ansible ansible lib ansible cli vault py line 148 in execute rekey if self new vault pass attributeerror vaultcli object has no attribute new vault pass >>>bugfix_pull_request
galaxy many galaxy fixes overlaps with several bug reports and existing prs better error reporting on fetching errors use scm if it exists over src unified functions in requirements simplified logic added verbose to tests cleanup code refs unused options and dead code moved get opt to base class fixes 11920 fixes 12612 fixes 10454>>>bugfix_pull_request
playbook variables ignored when used vars files inventory dir issue type bug report ansible version ansible configuration default environment ubuntu 14 04 lts summary variables are ignored if provided through vars files playbook parameter with file name containing inventory dir magic variable if file name is provided as static path no issue also if include playbook into another playbook and run no issue there was similar issue https github com ansible ansible issues 8638 fixed and its commit is included in tags since release though our scenario is very similar but doesn work steps to reproduce we have several environments defined in the repository in different folders dev staging production so depending on environment we may run playbook with dev inventory or staging inventory etc so we want to use inventory dir variable to get correct path to variables file test variable file place to dev group vars test yml test playbook place to test file vars yml code to run we see that file path is validated correctly but its variables are missing static file path works well but that doesn allow us to parametrize environment when include playbook above into another playbook everything works well expected results debug message should be actual results getting error >>>bug_report
which version to pick in the docs because it runs so easily from source and does not require any installation of software on remote machines many users will actually track the development version just discovering this is terrible advice and wonder if it should be displayed so prominently in the docs this might make sense during some phases of development but it certainly doesn hold true at the moment with the to transition >>>docs_report
docker module links bug have this code the output during playbook execution is and clearly shows that pg alias has pg value however the generated container did not have the alias in its etc hosts file is this bug or am reading the docs incorrectly >>>bug_report needs_info
enable pushing become down to module run command issue type feature idea ansible version future summary find way to delegate become and become handling to the module at the point it is running system commands this would allow for usage of privilege escalation in more restricted environments steps to reproduce would essentially be passed to the module no privilege escalation would get done on the connection and when the module calls run command it would use it to enable sudo bin service restart uwsgi >>>feature_idea
ansible worker with full file system returns uninformative error to commands accidentally filled my ec2 host workers to the brim running ubuntu 14 04 their hard drives are utterly full to the point where tab completion no longer works am trying to ask ansible to delete their tmp directories but receive the following error think it could be helpful to look at why that error came up and create better error message just to confirm this was caused by the hard drive issue deleted files on one of the worker manually and received success message upon running the rm rf tmp command for that worker only >>>bug_report
inventory inheritence add new parent inventory option this is feature idea about inventory inheritance let take an existing plateform with huge quantity of variables parameters you don wan to copy this into the new plateform but instead just want to change the ini file with different server this option let you specify additional directories where you store your vars directories in order to reuse them there an example in the test integration inventory inheritence directory with the following content simple inventory hosts simple host file no vars specified inherit1 group vars all contain vars declaration and with inherit1 within inherit2 group vars all contain only with value inherit2 let run some examples run ansible to retrieve var value that does not exist ansible debug msg simple inventory hosts localhost now specify parent directory ansible debug msg inherit1 simple inventory hosts localhost and with additional parent directory ansible debug msg inherit1 inherit2 simple inventory hosts localhost >>>feature_pull_request
add python to tox ini and travis>>>easyfix feature_pull_request
more informative error message when field receives invalid json in task used string where dictionary was expected the error received was `msg dictionary requested could not parse json or key value` https github com idano home blob master lib ansible module utils basic py l694 this contained no information about which line in my configuration was wrong to figure out which of my values was wrong patched my local install of ansible to spit out the key and value of the field any interest in pull request >>>bug_report
add host groups should accept an array currently accepts comma separated list should also accept an array for ease of use>>>feature_idea
ssh and paramiko do not return errors anymore issue type bug report ansible version ansible configuration to produce an error set control path to something very long control path directory thisiswaaaaaaaaaaaaaaaaaaaytooooooooooooooooooooooooooloooooooooooooooooooooooooongofacontrolpathtobeavalidfiiiiiiiiiiiiiiiiiiiiiiiiiiiileeeee ansible ssh environment gentoo centos6 ubuntu12 14 summary show an example with ssh and an invalid control path but any other ssh error seems to be swallowed also tested with paramiko and invalid keys user server etc steps to reproduce with control path as set above establish connection for user bcoca remote module ping exec ssh tt controlmaster auto controlpersist 60s controlpath home bcoca ansible cp thisiswaaaaaaaaaaaaaaaaaaaytooooooooooooooooooooooooooloooooooooooooooooooooooooongofacontrolpathtobeavalidfiiiiiiiiiiiiiiiiiiiiiiiiiiiileeeee ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 192 168 bin sh mkdir home ansible tmp ansible tmp 1443842517 55 253998647901966 chmod rx home ansible tmp ansible tmp 1443842517 55 253998647901966 echo home ansible tmp ansible tmp 1443842517 55 253998647901966 192 168 failed ssh error controlpath too long it is sometimes useful to re run the command using vvvv which prints ssh debug output to help diagnose the issue loaded callback minimal of type stdout v2 establish ssh connection for user bcoca ssh exec ssh vvv controlmaster auto controlpersist 60s kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 controlpath home bcoca ansible cp thisiswaaaaaaaaaaaaaaaaaaaytooooooooooooooooooooooooooloooooooooooooooooooooooooongofacontrolpathtobeavalidfiiiiiiiiiiiiiiiiiiiiiiiiiiiileeeee ansible ssh tt 192 168 umask 22 mkdir home ansible tmp ansible tmp 1443842204 271487888765221 echo home ansible tmp ansible tmp 1443842204 271487888765221 192 168 unreachable >>>bug_report
can use variables with or issue type bug report ansible version configured module search path none ansible config don have etc ansible ansible cfg` which assume means running defaults env osx yosemite summary have some randomly generated values that have to drop into config files for example salt value sdfdf4325gfdghh3s ewf2 ss498 this type of value causes warning at the start of the run and an error when attempting to use the variable some suggestions given to me along with their results salt value sdfdf4325gfdghh3s raw endraw ewf2 ss498 salt value sdfdf4325gfdghh3s ewf2 ss498 is this possible >>>bug_report
feature idea way to stop long running async tasks it would be good to have mechanism to kill long running async tasks for ex if kickoff long running async task and realize need to change something and run it again there is no easy clean way to stop the task that could find had this happen earlier and had to connect to the remote machine and manually killall the ansible python tasks and the various commands the tasks were running perhaps command line util script that could both list the async tasks currently running and also allow stopping them by numbered id and or an ansible module that could stop async tasks by name or other parameters >>>feature_idea
added an option to use the private network ip address for digitalocean dynamic inventory >>>feature_pull_request
replace pipes quote for shlex quote pipes quote is considered deprecated https docs python org library pipes html pipes quote so think using six here is fitting compromise also this is step for bringing python3 compatibility to the ansible codebase >>>feature_pull_request
typeerror build module command got an unexpected keyword argument arg path issue type bug report ansible version ansible configuration source hacking env setup environment os yosemite 10 10 python python summary task setup fails with typeerror build module command got an unexpected keyword argument arg path steps to reproduce but the ip address of your favorite windows computer into testing group vars windows workstations expected results ping pong would return results >>>bug_report easyfix p2 windows
bugfix pull request hostvars is not json serializable issue type bugfix pull request ansible version ansible devel a1f6de8745 last updated 2015 10 02 20 50 10 gmt 100 lib ansible modules core detached head dbc860daaa last updated 2015 10 02 19 45 58 gmt 100 lib ansible modules extras detached head 9f5420e459 last updated 2015 10 02 19 45 58 gmt 100 config file configured module search path none environment tested on mac os 10 10 python 10 summary as reported in https github com ansible ansible issues 11877 issuecomment 140049113 `hostvars` is not json serializable is this intentional steps to reproduce expected results actual results additional infomation the root cause appears to be the use of the `ansible vars hostvars hostvars` object which isn serialisable by `to json` this pr replaces the `all vars hostvars object with dict and gives the expected output shown above however not familiar enough with the code to know whether this is correct or not is hostvars ever used without host context without `to json` the hostvars for the current host is output instead of an object reference >>>bug_report
ansiblemodules log fix for python3 also add unittests for ansiblemodules log fixes 12586>>>feature_pull_request
non python modules are broken on v2 you can try either of the ruby modules in https github com ansible ansible for rubyists to reproduce >>>bug_report
fix ansible galaxy only installing dependent roles by name this reuses the same code that is used for reading roles from the requirements yml thus it ensures that dependency specified in meta main yml with src attribute is installed correctly as well before ansible galaxy always tried to install dependant roles from galaxy server other fixes include missing import and wrongly used conditional >>>bugfix_pull_request
no log always applies to with items ansbile version os 10 11 playbook running with in this example but it shows the same problems when just running it without and you have multiple items expected results works in actual results dev branch >>>bug_report
wheels for ansible do you consider providing python wheels for ansible cf http pythonwheels com >>>feature_idea
include statement uses wrong path when not included from tasks main yml to reproduce playbook test role tasks main yml test role tasks test1 yml test role tasks test2 yml this fails with message >>>bug_report needs_info
paramiko transport hangs for minutes if bad sudo password is provided ansible dest host ks shell echo hello world sudo password rl02 mach rhev intra failed failed to parse sorry try again sudo via ansible key iqasdasddasdasdasdaadasdaasdsdcb password sudo incorrect password attempt>>>bug_report
bug report missing region parameter not validated in s3 bucket and env variable not used issue type bug report ansible version `ansible detached head 70677b030b last updated 2015 10 02 06 34 41 gmt 400 environment aws rhel summary trying to create an s3 bucket with just name s3 bucket name my test bucket results in the error this is fixed by explicitly specifying `region` parameter note that the ec2 region env variable is set correctly >>>bug_report cloud needs_to_be_moved
but report tags xyz not honered on include line ansible version pull from this morning environment ubuntu 14 summary want to skip an include in certain conditions so setup the include like this per doc http docs ansible com ansible playbooks tags html include monitoring yml tags host when run ansible playbook with skip tags host the include gets runs nonetheless however if change it to include monitoring yml tags host it skips the include >>>bug_report
variables expansion issues in role metadata issue type bug report ansible version ansible devel 3705d54485 last updated 2015 10 01 18 26 52 gmt 500 ansible configuration roles myrole1 meta min yml site yml environment summary for role `dependencies` variable expansion doesn work for shorthand form viz roles os family but it does work when listed as `dict` like so role roles os family fwiw there was related fix for the `dict` form recently cf 79e364d while at it would it make sense to support fact expansion for role dependencies as well to stay consistent with fact expansion support in `include` having include ansible os family yml `in tasks main yml works as expected after all >>>bug_report
fix bug in ipaddr netmask filter when cidr is 32 fixes 12065 >>>bugfix_pull_request needs_revision
improved function get ansibleparam now has aliasing support this commit adds support for aliases in the get attr get ansibleparam function usage simple usage or multi aliasing or with mandatory params we need to to some very thorough testing of this function since so many things depend on it ve tested it every way can using strictmode but there probably some scenario haven thought of >>>feature_pull_request windows
modules erroneously execute remote copy py if the system to be managed contains copy py it is executed instead of copying the temporary script to remote system here are steps to reproduce >>>bug_report needs_info
can connect via ssh after osx 10 11 el capitan upgrade upgraded my workstation to el capitan last night and now connecting to virtualbox hosted vm doesn seem to be working via ssh although can ssh locally using the latest source release fe0e4f27ad82c4b5844a3a18922fa1857242a33b see below dv ansible ruby master cat inventory vagrant 10 42 43 vagrant linux vagrant2 ansible ssh host localhost ansible ssh user root ansible ssh pass vagrant ansible ssh port 2200 dv ansible ruby master ansible vagrant linux inventory vagrant ping vvv 10 42 20 using redacted dv ansible ansible cfg as config file establish connection for user root on port 2200 to localhost vagrant2 unreachable dv ansible ruby master ssh root localhost 2200 10 42 23 root localhost password vagrant last login thu oct 14 42 14 2015 from 10 welcome to your vagrant built virtual machine root localhost exit logout connection to localhost closed >>>bug_report p2
since connection execute command returns bytes deal with the repurcussions follow up to https github com ansible ansible pull 12447 >>>bugfix_pull_request p2
ansible service check ignores exit code for status check with 22dbb65b13400db07b537cdfd38926cc03e48dfa the service status detection was changed this change breaks the status reporting of runit `sv status` the problem is that the code now checks for and subsequently ignores non zero return codes since runit reports on the service and its log supervisor together this causes problems http smarden org runit sv html http smarden org runit faq html lsb see two possible fixes first is to add check for down in the status line before checking for run or allow non zero return codes to override this heuristic >>>bug_report p2
python don pass byte strings to syslog journal fixes 12586 >>>bugfix_pull_request
ansible ssh problem when logging by script command for operation logging set these setting in etc profile can do ssh log via terminal but can execute ansible playbook ssh connection stopped >>>bug_report
remove an unwanted fixme annotation jimi ansible do you think it should be possible to add both foo 22 and foo 23 to the inventory no so we don want an invitation to fixme >>>docs_pull_request
windows updated docs added some clarification around strictmode and examples for using get ansibleparam >>>docs_pull_request
v2 regression group vars group yml not loaded for groups created via group by issue type bug report ansible version ansible devel 4cfcf5d61b last updated 2015 09 30 15 14 00 gmt 500 ansible configuration site yml group vars all yml group vars router yml group vars archlinux yml roles test tasks main yml environment summary based on above config would expect all of `group vars all` `group vars router` and `group vars os family` vars to be available however `group vars all` `group vars router` vars are available as expected but `group vars os family` is not >>>bug_report p2
alphabitize retry files enabled and retry files save path put retry files enabled and retry files save path into alphabetical order found when investigating 11491>>>docs_pull_request
windows added parameter validation to the get attr function get ansibleparam resubmitted was 12518 mproved get attr so that it also enables parameter validation this will implement standardizer way of validating params instead of each module having to implement it itself example if module requires the option state to be either present or absent this can be expressed like >>>feature_pull_request windows
ansible become cannot be overriden by host or task local action and delegate to both affected playbook yml inventory ini text j2 results can swap out the delegate to with the local action and get the same results if remove the ansible become definition from the originating node it will succeed related issue https github com ansible ansible issues 10906 >>>bug_report
ansible ssh extra args erroneously passed to scp issue type bug report ansible version ansible configuration environment ssh `openssh 9p1 openssl 2d jul 2015` from os `14 darwin kernel version 14 wed jul 29 02 26 53 pdt 2015 root xnu 2782 40 release x86 64 x86 64` to os `4 gentoo smp thu sep 17 06 41 50 utc 2015 x86 64 intel core tm i7 cpu 860 80ghz genuineintel gnu linux` summary `ansible ssh extra args` are erroneously passed to scp which does not accept the same arguments as ssh steps to reproduce add remote port forward argument to ssh via inventory `ansible ssh extra args r8000 localhost 8000` expected results during playbook run ssh connections will open reverse port forward back to originating host and scp executions still function correctly actual results any execution to scp will fail as the argument is not valid workaround patch in `connection build command of `lib ansible plugins connection ssh py` check to see if the binary parameter is actually ssh before adding arguments specific to ssh >>>bug_report p2
notifies run after post task when playbook run with tasks was supposed to be fixed in 11574 do not believe 11574 is fixed playbook run command output expected output >>>bug_report
facts correctly detect docker inside xen host fixes 12573>>>bugfix_pull_request
virtualization type gets reported wrong for docker running on virtualised hardware issue type bug report ansible version `1 3` ansible configuration environment ubuntu 14 04 guest inside docker on ubuntu 14 04 as host on top of amazon ec2 summary when running docker container on amazon the `virtualization type` gets reported as xen instead of docker steps to reproduce run `ansible localhost setup` inside of docker instance on amazon expected results ansible virtualization type docker should be visible in the output actual results ansible virtualization type xen is visible in the output >>>bug_report
make ansible vault view not write plaintext to tempfile when it can just feed the pager on stdin instead >>>feature_pull_request
add more exhaustive tests for various ipv6 address notations>>>feature_pull_request
bring groups handling in ini py up to date trivial fix since c8f2483d ini py expects to always be passed in pre created list of groups and can no longer deal sensibly with an empty list this just makes that expectation clear >>>bugfix_pull_request
python fix most tests for ansible module utils basic fix importerror builtin during test module import make most of the newly enabled tests pass the remaining failure needs some deeper thought so postponing it for later pr this patchset doesn reduce the number of failing tests but it increases the number of succeeding tests from 260 to 282 >>>feature_pull_request
unskippable tasks frequently have pattern where have set of vars that want to include for certain machine so for example ll have variable like instance type that can be things like t2 micro or t2 small then have role that wants to set specific instance variables depending on the type so ll include the vars at the top of my roles apache tasks main yml file like this this works great until do start at task foo because when do that my include vars doesn get executed would like an unskippable tag for tasks that should get executed even when using start at task or maybe we could reuse always for this purpose should also add that sort of get around this by adding it to my playbook this gets my the desired behavior but now you have to do the vars files includes whenever you include that role so if there was some way to specify vars files for role in the role files somewhere and you can use jinja2 with them then that would work as well >>>feature_idea
v2 task with assert run once only fails the current play ansible devel 8095b027bf last updated 2015 09 29 20 00 39 gmt 200 lib ansible modules core detached head a4ac171a07 last updated 2015 09 29 15 50 49 gmt 200 lib ansible modules extras detached head 3c8c716801 last updated 2015 09 29 15 50 49 gmt 200 config file etc ansible ansible cfg configured module search path none hosts all gather facts false tasks assert that false run once true debug hosts all tasks debug >>>bug_report
describe the units for fact caching timeout>>>docs_pull_request
inject existing groups at inventorydir initialization this fixes corner case where ini files live in subdir of the main inventory directory reproducing the original error mkdir inventory ini cat inventory ini hosts eof www www1 eof ansible inventory all ping error all or without the www group it would complain about ungrouped >>>bugfix_pull_request p2
blocks don take run once with ansible devel it possible to specify ``delegate to`` on block but ``run once`` isn accepted >>>feature_idea
bug while making rpm os centos and centos step installation by making rpm file while installing ansible on step make rpm face with such error error line 10 illegal char in release git201509290550 95ede22 heads v1931 el7 centos find that it is cause of parameter git branch in makefile so if delete git branch and git branch from next string of makefile than make rpm work fine also centos base repo provides too old version of python six so wget https pypi python org packages source six six tar gz md5 476881ef4012262dfc8adc645ee786c4 gzip dc six tar gz tar xf cd six pip install after that ansible start working ps sorry for my english >>>bug_report
fix for sles 11 which has now also an etc os release file suse added etc os release file with sles 11 sp4 and now the setup module returns in ansible distribution release instead of because version id is not an the last line of this file release was always set to in the loop for line in data splitlines here is an example of etc os release name sles version 11 version id 11 pretty name suse linux enterprise server 11 sp4 id sles ansi color 32 cpe name cpe suse sles 11 >>>bugfix_pull_request p2
created new action plug in config template created new config template action plug in this commit adds new action plug in named config template this action plug ins was created to allow overrides to be passed to to standard templates written in ini yaml or json which are often used for system configuration this allows project to carry configuration template without having to create specific variables for all configuration items that could potentially be used this keeps configuration templates clean and simple but enhances their ability to be used in different ways which is great for developers and deployers alike as no two deployment environments are ever the same functional overview the action plug in functions much like the regular template module allowing an ansible user to write the template containing dynamic data through the use of jinja variables the source template is rendered in transit and passed through particular configuration option method should any override data be present the override data is presented to the module through dictionary hash once the overrides have been applied the template it rendered once again to ensure all jinja variables are appropriately rendered which gives the user the ability to use variables in the override data as well as the base template if they so choose finally the resultant is passed through the copy module where it is transferred to disk signed off by kevin carter >>>feature_pull_request
win iis webapppool module is need attributes is bug was run ansible win win iis webapppool name newapp state restarted the error an exception occurred during task execution to see the full traceback use vvv the error was win01 failed changed false failed true msg property attributes cannot be found on this object make sure that it exists look at the introduction module attributes required is no >>>bug_report windows
ansible2 ambiguous output redirect error during task setup issue type bug report ansible version ansible configuration none environment management host centos release x64 target host centos release x64 summary after upgrading to ansible simple play fails during the setup stage with an ambiguous output redirect error this simple play works fine with steps to reproduce given simple play expected results this is what we get with ansible actual results but with ansible >>>bug_report
removed deletion of salt by password lookup rebased version of 10872 11734 removed deletion of salt param from lookup file by password lookup filter old behaviour leads to constant changed status when two tasks uses same lookup one with encrypt parameter and other without for example tasks name create user user password lookup password inventory dir creds user pass encrypt sha512 crypt lookup file creds user pass now contain password with salt name create htpasswd htpasswd password lookup password inventory dir creds user pass salt gets deleted from lookup file creds user pass next run of create user task will create it again and will have changed status>>>bugfix_pull_request
certificate errors from proxies with certain versions of python issue type bug report ansible version devel 132c14eb57 os osx yosemite tested module file with pyenv against 10 summary ve just encountered an issue with get url on github urls which are failing to verify certificates for some versions of python fairly sure it manifestation of https github com shazow urllib3 pull 385 which describes potentially breaking changes to tunnel in python backported to python this logic seems to be identical to the `connect` method in `lib ansible module utils urls py` and behaves similarly the error encountering is hostname webproxy uhnres utoronto ca doesn match either of github com www github com the same url can be requested just fine through browsers and `curl` so it seems to be python specific and version specific it does not affect python certificate verification issue with proxies think the modified logic in https github com shazow urllib3 pull 385 issuecomment 42783515 needs to be rolled into the `connect` method so that `self tunnel host` is used in place of `self host` if needed this is deep into the guts of various systems and not python person but ll make pr if you want me to steps to reproduce this task should do it if you have proxy all that matters is https github python expected results successful download actual results >>>bug_report
9130 rebase ec2 inventory boto profile support submitting as separate pr at the request of defionscode this is trivial rebase of pr 9130 with the controversial inventory changes removed see comments on that pr for more details cc willthames jeffb bt jalaziz>>>cloud feature_pull_request
add key split to subtags in ec2 py autodiscover script add the option to create subgroups based on splitting the value of the key tags by whitespace aws tag value private app app01 app02 app03 app04 app05 app06 ec2 py groups tag private app app01 172 tag private app app01 app02 app03 app04 app05 app06 172 tag private app app02 172 tag private app app03 172 the idea is to be able to have more fine grained groups like private app list of apps services the host is running like dns web db cache private env production staging testing and be able to combine it like ansible playbook limit tag private app cache tag private env staging >>>feature_pull_request
template is ignoring variables from defaults main yml macos 10 10 ansible error defaults main yml templates elasticsearch yml j2 tasks main yml >>>bug_report p2
guidance for pycrypto install on mac osx see 12454 regards nathan>>>docs_pull_request
add node private public ips to gce groups allow specifying gce hosts by node private or public ip addresses>>>feature_pull_request needs_revision
fix url lookup plugin httperror message not being reachable ansibleerror could never be raised with received http error since urllib2 httperror is subclass of urllib2 urlerror and the exception catching statements tests for urlerror first instead ansibleerror failed lookup url would always be raised regardless of the underlying problem this patch swaps the order so that both error messages are reachable >>>bugfix_pull_request easyfix
become broken on freebsd 10 with su hi am trying to execute this the user exists prior to running this task that tasks fails though due to using multiple options logging into the machine and looking at what ansible is doing reveals this however if try to manually to execute it get notice how it adds it twice removing the first option bin sh however does the correct thing do not wish to install sudo as this is intended to be production machine hence am trying to do this without sudo no human will be allowed on it anyway >>>bug_report
handler notifications across roles are ignored by ansible devel issue type bug report ansible version ansible devel ansible configuration default configuration environment debian ubuntu summary when role alpha has role beta in the dependencies or role beta is included in the play handler notifications from role alpha that notify handlers in role beta are ignored by ansible steps to reproduce an example playbook with roles that demonstrate the issue can be found at https github com drybjed ansible handler test run it with expected results this is the result on ansible `stable 9` actual results this is the result on ansible `devel` >>>bug_report p2
bugfixes uncallable things statement without effect and indentation issues >>>bugfix_pull_request
updated azure inventory script to reflect changes in azure python package issue type bug report bugfix pull request ansible version ansible the devel contrib inventory windows azure py https github com ansible ansible blob devel contrib inventory windows azure py file used was the latest version from the `devel` branch ansible configuration environment the `azure` python package has been installed through `pip install azure` and is at version summary the `windowsazureerror` exception has been changed to an `azureexception` child named`azurehttperror` see changelog https github com azure azure sdk for python blob fa3119c497e98343c7f789e07d108d1d2d457bd2 changelog txt l47 this fix gets the windows azure inventory file up to speed on that change steps to reproduce any call that attempts to run the python script breaks the simplest version being `python contrib inventory windows azure py` expected results expected result to `python contrib inventory windows azure py` is json payload actual results actual result is the following output failed true msg `azure` library required for this script >>>feature_pull_request needs_revision
list tags and list tasks do not honor skip tags parameter as playbook writer wanted to see which tasks would run without running them and which would not it seems that list tags and list tasks might be appropriate for that job but when combined with skip tags still see all tasks would expect to see only the tasks that apply when skip tags or tags is used >>>bug_report docs_report
v2 known regression with inventory hostnames doesn work this is what ``lib ansible plugins lookup inventory hostnames py`` says >>>bug_report p2
update outdated comment we now use sudo instead of sudo sudo >>>docs_pull_request
fix no self pointer out of class >>>bugfix_pull_request
task logging revamp allow global no log setting no need to set at play or task level but can be overriden by them allow turning off syslog only on task execution from target host manage syslog overlaps with no log functionality created log function for task modules to use now we can remove all syslog references will use systemd journal if present added debug flag to modules so they can make it call new log function conditionally added debug logging in module run command>>>bugfix_pull_request feature_pull_request p2
delegate to not working correctly in devel haproxy tasks fail issue type bug report ansible version ansible devel b757798f3e last updated 2015 09 25 21 12 40 gmt 500 ansible configuration defaults environment mac os 10 10 summary this might be related to https github com ansible ansible issues 12499 but basically if run particular task with delegate to and ansible devel the task fails if run the same task standalone in its own playbook directly on the host just removing `delegate to` it succeeds if run the same playbook with the failing task in ansible it succeeds only ansible devel is failing you can quickly emulate the entire environment and see the problem using the deployments balancer https github com geerlingguy ansible for devops tree master deployments balancer example it the exact playbook running using set of three virtualbox vms configured via the vagrantfile steps to reproduce set up an haproxy server and at least one server managed by haproxy as load balancer note this seems like it may be an issue that would affect other delegated tasks but ve only done testing with haproxy sockets so far set up playbook to run on an app server that not the haproxy host with task using the `haproxy` module to manage haproxy on delegated host run this playbook expected results the playbook should indicate change occurred delegated to the haproxy balancer this is the output from ansible actual results the playbook errors out with if take the exact same task and put it in playbook on its own and run that playbook directly on the balancer haproxy server in ansible devel without using delgate to basically everything works fine >>>bug_report p2
connection local not honored in blocks as discussed here https groups google com forum topic ansible devel zhvjg3tp ta that appears to be related any way using connection local with block doesn work the connection still ends up sshing and running all tasks in the block on the remote host >>>bug_report
temporarily disable strictmode strictmode introdoces number of errors in various modules for instance modules which are testing if an argument exists outside of get attr we need to possibly temporarily disable strictmode checking >>>bugfix_pull_request pending_closure windows
relative paths don work correctly when running multiple playbooks from one playbook issue type bug report ansible version ansible devel 41756be4d3 last updated 2015 09 25 10 05 38 gmt 500 ansible configuration no changes from defaults environment mac os 10 10 summary have setup where have one playbook that includes other playbooks if run `ansible playbook` with the parent playbook which includes other playbooks the relative pathing for tasks inside the other playbooks seems to get stuck or messed up if run `ansible playbook` with the child playbooks directly one by one relative pathing works as expected steps to reproduce this can be reproduced using the example lamp infrastructure example found here in the ansible for devops book repository https github com geerlingguy ansible for devops tree master lamp infrastructure have directory layout like this inside `configure yml` master playbook which simply includes the two children playbooks if run the varnish or memcached `main yml` playbooks directly everything works fine however if run the `configure yml` playbook that includes the two main yml playbooks it seems ansible mixes up the paths for tasks like `copy` everything works fine in ansible but fails in ansible expected results playbook completes successfully whether run standalone or as part of the master `configure yml` playbook actual results playbook completes successfully when run standalone playbook results in relative pathing error when run as part of the master `configure yml` playbook >>>bug_report p2
merge properties instead of reading only the first cfg file found use case have personal ansible cfg where configure some optims ssh args controlpersist 30m and pipelining true there is an ansible cfg in my repo that configures some structural patterns roles path public roles private roles for such setup would have to copy my personal configuration on the cfg of the project or create an environment variable with all the values for the cfg files if settings were overridden respecting the order of precedence that is describe in the doc can have settings splitted between files and override only what need >>>feature_pull_request
ansible doc and web page have the wrong synatx for newline sequence issue type documentation report ansible version environment ubuntu 12 04 windows summary the linebreaks in win template doesnt work so the round about solution is to add an header to the template file both ansible doc and web page has wrong and missing syntax back slash back slash update the ansible doc and web page steps to reproduce check the web page and ansible doc expected results with the newline syntax added actual results missing syntax >>>bug_report docs_report windows
windows added parameter validation to the get attr function improved get attr so that it also enables parameter validation this will implement standardizer way of validating params instead of each module having to implement it itself example if module requires the option state to be either present or absent this can be expressed like `get attr obj params name state default present validateset present absent resultobj resultobj failifempty true` this will fail calling `fail json` automatically if the option is anything other than present or absent and should save module devs some coding >>>feature_pull_request
ansible doc should ignore modules with missing docs and with non python extensions running `ansible doc l` when there are markdown files and or modules with bad documentation breaks the command and results in bad user experience as an example running `git clone git github com ansible ansible git recursive` on commit `82b33c381f110e3bfa82dd589ad6c06fbd6be374` will require you to delete multiple readme files deleting the following files results in expected behavior it would be better user experience to only display errors but to continue on if the command is marked as verbose and to ignore non doc plugins >>>bug_report
adding different variable types results in unsafeproxy error issue type bug report ansible version ansible devel ansible configuration standard config environment debian ubuntu summary templating different variable types results in unsafeproxy error steps to reproduce example variable assume that `ansible all ipv6 addresses` is an empty dict expected results ansible works without errors actual results during ansible initialization >>>bug_report p1
misleading error code with yml syntax error with ansible if syntax error in `vars main yml` ansible reports file as missing >>>bug_report p2
ansible all plays fail with error connect got an unexpected keyword argument compress issue type bug report ansible version ansible configuration environment management host centos release x64 target host centos release x64 summary all our plays which currently work fine with ansible are failing to connect to our hosts successfully with ansible steps to reproduce given simple play expected results this is what we get with ansible actual results but with ansible >>>bug_report p1
initial add of logentries callback plugin this callback plugin will generate json objects to be sent to the logentries service for auditing debugging purposes to use add this to your ansible cfg file in the defaults block defaults callback plugins callback plugins callback stdout logentries callback whitelist logentries copy the callback plugin into the callback plugings directory either set the environment variables export logentries api data logentries com export logentries port 10000 export logentries ansible token dd21fc88 f00a 43ff b977 e3a4233c53af or create logentries ini config file that sites next to the plugin with the following contents logentries api data logentries com port 10000 tls port 20000 use tls no token dd21fc88 f00a 43ff b977 e3a4233c53af>>>new_plugin
template creation failing when using sudo user issue type bug report ansible version ansible devel 5d3d9cfe0d9dd3943245c65b92fd91d33e446f2b summary we have task that writes template file to remote server as sudo user and it has broken in because of permission problems steps to reproduce expected results file will be written to tmp directory actual results `fatal 123 123 123 failed changed false failed true msg source tmp ansible tmp 1443108503 34 115637427635543 source not readable the source file was created as the initial ansible user with only read permissions for the user the error kicks out after it sudos to the sudo user and tries to copy the staged file to the final destination >>>bug_report needs_info p2
variables in dependency role names are not being expanded issue type bug report ansible version ansible devel 5d3d9cfe0d last updated 2015 09 24 07 54 36 ansible configuration nothing relevant changed here environment sles11sp2 summary variables in dependency role names are not being expanded steps to reproduce create role with dependencies in meta main yml use variable in role name define myrole in playbook expected results jinja will evaluate and execute the dependency this worked pre actual results >>>bug_report
python make test variable manager precedence pass going through failing unit tests one by one and making them pass this pr fixes test variable manager precedence from test units vars test variable manager py which was failing due to several unrelated issues shlex split cannot deal with bytes on python ansible inventory host host needs to be correctly hashable one count of dict iteritems one count of unicode in module thought already python ified this is why focus on making the tests pass on python so can submit pr to enable them in the default tox ini travis run >>>bugfix_pull_request feature_pull_request
with subelements tasks warn with not all arguments converted during string formatting issue type bug report ansible version ansible devel 5d3d9cfe0d9dd3943245c65b92fd91d33e446f2b summary initially was trying to use with subelements against the authorized key module but the task throws an error ve tested with the debug module and get the same results steps to reproduce you can use the example here quote placement is wrong in the example to begin with but once adjusted you ll get the error seeing http docs ansible com ansible playbooks loops html looping over subelements expected results ssh keys will be installed for each user that is part of the list actual results warning error when using not all arguments converted during string formatting` the play continues on but would think that this would be critical error and it should abort >>>bug_report p2
clarify select handling for ssh connections this change is motivated by an ssh oddity when controlpersist is enabled the first master connection goes into the background we see eof on its stdout and the process exits but we never see eof on its stderr so if we ran command like this ansible ssh pipelining ansible 30 vvv somehost someuser command whoami we would first do select stdout stderr timeout and read the command module output then select stdout stderr timeout again and read eof on stdout then select stderr timeout again though the process has exited and select would wait for the full timeout before returning rfd and then we would exit the use of very short timeout in the code masked the underlying problem that we don see eof on stderr it always preferable to call select with long timeout so that the process doesn use any cpu until one of the events it interested in happens and then select will return independent of elapsed time long timeout value means if nothing happens sleep for up to omitting the timeout value means if nothing happens sleep forever specifying zero timeout means don sleep at all poll for events and return immediately this commit uses long timeout but explicitly detects the condition where we ve seen eof on stdout and the process has exited but we have not seen eof on stderr if and only if that happens it reruns select with short timeout in practice it could just exit at that point but chose to be extra cautious as result we end up calling select far less often and use less cpu while waiting but don sleep for long time waiting for something that will never happen note that we don omit the timeout to select altogether because if we re waiting for an escalation prompt we do want to give up with an error after some time we also don set exceptfds because we re not actually acting on any notifications of exceptional conditions >>>bugfix_pull_request p2
item is undefined if using delegate to with with items issue type bug report ansible version devel master 89a78ba ansible configuration stock environment mac os 10 10 summary this task results in the error message run the playbook with the task above using this inventory file https github com geerlingguy ansible for devops blob master deployments balancer inventory you can reproduce the scenario exactly by downloading the project linked below and running through the setup in the readme md file if run in ansible get successful changed message during playback runs steps to reproduce testing some of the example playbooks have in ansible for devops and one of them deployments balancer https github com geerlingguy ansible for devops tree master deployments balancer which works fine in ansible fails with the above error on devel this example playbook follows the same style as the official lamp haproxy rolling updates example https github com ansible ansible examples blob master lamp haproxy rolling update yml expected results task should complete delegated to each of the items in the inventory list `groups balancers` actual results error message `error item is undefined`>>>bug_report p2
allow running task or play in check mode from playbook ansible check mode allows determining if task would have changed something but only on the level of an entire play but there are obvious cases where idempotency requires being able to change the order of events check if file would be changed if so stop daemon and change the file otherwise do nothing this can be replicated by comparing mtimes locally and remotely but leads to complicated syntax for something the existing feature can already provide ideally something like this would be possible this is simple and readable and helps in dealing with services which may be monitoring config directories for new files but which would might like to try and avert for changes like that exim with perl interpreter can be problem in this regard >>>feature_idea
powershell ps1 strictmode breaks ton of modules noticed set strictmode got turned on in recent commit this breaks ton of modules both in core and extra strictmode throws errors left and right and requires very correct language implementation my recommendation is that we turn this off for now if we want to enable strictmode later we need better testing harness for powershell modules so that we can test if each module can run with strictmode not against turning on strictmode down the line but now is definetely not the right time ping cchurch >>>bug_report windows
inform user that parallel execution is disabled because `host key checking true` ansible has `host key checking true` by default which effectively disables parallel execution making the `serial` parameter in playbook and the forks` parameter on the `ansible playbook` command line both irrelevant ansible should print warning message about this so that the user knows that these options are having no effect this should especially be the case since parallel execution is essentially disabled by default the effect of `host key checking` is discussed in this mailing list thread https groups google com forum topic ansible project 8p3xwlo83ho >>>bug_report
win iis webapppool the property value cannot be found on this object this is new error today 23 that does not exist on 15 the win iis webapppool task works in the older version properly creating the app pool or detecting that it is created and fails with today pull here is the task >>>bug_report windows
fix typo in checking select results it possible for more than one fd to be set so elif is obviously not the right thing to use >>>bugfix_pull_request p2
allow multiple vcenter esxi in single inventory allow multiple vcenter esxi server to be scanned from single inventory ini combo >>>feature_pull_request
problem found template error while templating string encountered unknown tag in 11366 wrote about problem had with version now that tried still get the error however got some more info apparently it is the shell prompt settings on the remote host that is causing the problem set the prompt to and isn available in python guess anyway changing ps1 co made it work this is not very practical solution though and the shell is forced thru etc passwd guess that ansible parses the output of the command and gets the shell prompt output also is there workaround that doesn involve changing prompts this seems to be quite dangerous if login files on the remote hosts can affect ansible that bad so is the solution only to use special users with bin sh as shell or is there an easier solution >>>bug_report needs_info
softlayer inventory to include private only instances the current inventory solution only allows the ability to list instances that have public interface these new changes will allow the ability to also list virtual instances that only have private interface this uses tags to identify the device group and prefixes with private >>>feature_pull_request
fix unicodeencodeerror when writing tree files this is the very same fix as in 10630 the fix there applies to writing the json fact files to the cache the same error occurs when you write the facts explicitly to directory with tree some directory` using tree` is no longer really needed now that there json fact cache but as long as the code is still there thought it best to fix it note based it off the stable branch as that looked like the bugfixes branch the devel branch looks to be for and the file fixed isn in there anymore >>>bugfix_pull_request
can build similar problem reported here and fixed on branch https github com ansible ansible issues 12166>>>bug_report
typeerror flatten takes exactly arguments given with `ansible devel c83f51b7f2 last updated 2015 09 23` and playbook like this get this error >>>bug_report p2
conditional import vars files does not work in given this code vars files config vars yml config zones zone yml config zones default yml config stages stage yml config stages default yml in play all localhsot not importing file home tyoma projects plays config stages prod yml task print vars ok localhsot var omitted in error the file name home tyoma projects plays config stages prod yml does not exist or is not readable ansible version ansible devel c83f51b7f2 last updated 2015 09 23 02 25 16 gmt 000 lib ansible modules core detached head e9139ba4fa last updated 2015 09 23 02 25 44 gmt 000 lib ansible modules extras detached head 8b83aa4c50 last updated 2015 09 23 02 25 37 gmt 000 >>>bug_report p2
clarified that yml yaml and json are allowable file extensions for inventory vars files>>>docs_pull_request
start at task evals on all plays v2 regression issue type bug report ansible version devel as of d27b73e7b5 environment summary running playbook with start at task applies the filter to every play in the playbook not just the first occurrence of the task as it did in steps to reproduce run playbook at https gist github com nitzmahone 6c310b32ea4d4346b2a3 with ansible playbook startatfail yml start at task start here expected results task this should run from the second play runs as it did in actual results task this should run does not run start at task condition appears to be evaluated again on each play instead of stopping on the first occurrence as it did in >>>bug_report
write sample inventory setups issue type feature idea summary add few examples of different inventory setups and classifications capture few styles and business needs as example use per environment inventory dev qa prod with groups for location dc1 dc2 and function lb web app db another can be using divisions by bu client etc >>>docs_report feature_idea
handle stray characters better ansible devel branch in playbook had stray on its own line and instead of nice error got the following crash >>>bug_report
ansible playbook much much slower after this check in ansible devel branch mac os client side have been able to reproduce this with the following steps ec2 host with ubuntu 14 04 use pem file to login and the ubuntu user use become sudo since this checkin https github com ansible ansible commit 81bf88b6e052cdf72aef079e551a5a075d6ac85c determined by git bisect the time to run playbook has increased significantly 4x what it was before before this checkin it was much much faster cc jimi >>>bug_report p2
extend cache plugins to cover inventory issue type feature idea summary extend the fact cache plugin to support generic cache that allows for inventory information and facts about host to be cached currently some inventory scripts implement their own caching system it would be nice to offer this to all inventories by default and let user configure it from ansible aside from consolidating many cache re implementations it would allow for consistent expiration controls >>>feature_idea
limit isn honored at all issue type bug report ansible version ansible configuration environment summary have simple inventory with four hosts master1 master2 slave1 slave2 in two different groups app server app slave when use host pattern to select one group app server and specify host with limit ansible just selects all hosts it does not matter if the host is contained in the selected group steps to reproduce hosts run some module with this inventory use host pattern and limit it with host ``ansible hosts debug msg foo app slave master1`` ``ansible hosts debug msg foo app slave slave1`` expected results actual results >>>bug_report easyfix p2
cloudstack improvements and tests common tags handling integration tested account and user extended tags handling in cloudstack utils is now idempotent thanks to jeffersongirao add common argument spec into cloudstack utils pr for modules implementing it will follow add general string to int handling for response values can be used in modules where needed >>>bugfix_pull_request cloud feature_pull_request
make pipelining connection variable ssh pipelining can be significant performance improvement but it will not work if sudoers is configured to requiretty with this change one could have pipelining enabled in ansible cfg but use sudo to turn off requiretty in separate play where pipelining is disabled hosts foo pipelining no tasks lineinfile dest etc sudoers line defaults requiretty state absent sudo user root note that sudoers has complicated syntax so the above lineinfile invocation may be too simplistic for production use but the point is that separate play can do something to disable requiretty >>>feature_pull_request
environment variable evaluated as template fatal error issue type bug report ansible version ansible configuration clean install in virtualenv with pip install ansible environment ubuntu 14 04 summary ansible seems to require that all environment variables can be evaluated as templates have simple case where the value of random environment variable some name in my shell causes fatal error in ansible fatal localhost failed to template ding template error while templating string encountered unknown tag if unset some name in the shell and don use fancy zsh prompt the playbook runs fine steps to reproduce the following setting in my shell causes the fatal error in ansible the value was taken from part of my normal zsh prompt export some name ding minimal playbook used to trigger the problem was name demonstrate ansible bug hosts localhost tasks name copy file copy src etc hosts dest tmp etc hosts copy expected results the playbook should run without any error actual results the error look like task copy file fatal localhost failed to template ding template error while templating string encountered unknown tag fatal all hosts have already failed aborting comments have seen the issue 6464 that describes almost the same problem it seems to me but it was closed so therefore wrote this new issue >>>bug_report p1
win get url fails to get the file from the url to remote windows server 2012 node need to copy file from jenkins server to remote windows server 2012 machine using win get url my playbook looks as follows hosts windows ip tasks name deploy to windows win get url url http jenkins server ip jenkins view trunk job router lastsuccessfulbuild artifact router conf router service context xml dest router however it gives the following error fatal windows ip failed changed false failed true msg error downloading http jenkins server ip jenkins view trunk job router lastsuccessfulbuild artifact router conf router service context xml to router exception calling downloadfile with argument an exception occurred during webclient request what is the issue over here >>>windows
v2 delegate to is not indicated in the output in ansible v1 any delegation was clearly visible whereas ansible v2 shows just like seeing which hosts are actually affected by the commands so like the old output back please you can use the steps to reproduce from 12464 to reproduce this one too >>>bug_report
v2 synchronize with delegate to badly broken issue type bug report ansible version summary attempting to synchronize some files between remote hosts and actually tries to synchronize from localhost to to itself this is all that remaining from 12347 steps to reproduce replace fridge and muskatas with two hosts you can ssh to expected results actual results >>>bug_report p2
fix option descriptions in ansible doc output fixes 12462 >>>bugfix_pull_request p2
ansible doc repeats module description for every parameter v2 regression issue type bug report ansible version summary ansible doc repeats the module description instead of showing parameter descriptions steps to reproduce `ansible doc command` expected results actual results >>>bug_report p2
python there no basestring fixes one failing test now technically filename can be bytestring even on python hope this is unlikely for ansible >>>bugfix_pull_request
roles breaking change role parameter from later invocation stomps on default value from earlier invocation ran into the following issue when upgrading from to latest `devel` here simple repro roles dep defaults main yml roles dep tasks main yml playbook yml this is the output get running on and here what happens when run on notice that in there appears to be change to the variable evaluation order whereby value gets assigned before the logical order of execution should even put it in scope >>>bug_report p2
detect if core modules aren installed and warn if that is the case fixes 11206>>>bugfix_pull_request
replace categories with tags galaxy is deprecating categories in favor of tags each tag is single word that describes or categorizes role role authors can supply set of tags that best describes their role in the next galaxy release users will be able to search roles by tags this pr is intended to update the metadata template and ansible galaxy search command to reflect this change to aid testing added ignore certs option for use with install and search commands helpful when using server to point to server with self signed cert >>>feature_pull_request
added methods for retrieving vapp and vm adds two new methods to support updated vca vapp module>>>feature_pull_request
added pass limit to inventory as discussed in https groups google com forum topic ansible devel zgwve7rgwtc the idea is simple if pass limit to inventory is used when running ansible playbook then when the inventory is called it will have the arguments list limit blabla so you can use it to narrow the scope of the inventory>>>feature_pull_request
installation update for people using fishshell>>>docs_pull_request easyfix
facts variables are not available in vars files issue type bug report ansible version devel environment mac osx 10 10 summary facts variables are not available in vars files it was working on version steps to reproduce test yml expected results actual results >>>bug_report p2
close module file once we re done reading from it we don use the module file once we ve read from it so we can close it immediately after that just code clarity change >>>bugfix_pull_request
documentation running from source suggestions improvements issue type documentation report ansible version devel environment ubuntu 14 04 ec2 instance summary when tried to setup http docs ansible com ansible intro installation html running from source from scratch found few problems on ubuntu for pip and subsequent pip install to work need at least sudo apt get install python pip python dev git according to http jinja pocoo org docs dev intro markupsafe dependency jinja2 require markupsafe module and for some reason pip did not install it automatically and ansible crashed think it can be included into pip install line explicitly versions from pip list pip jinja2 markupsafe 23 cloud modules require corresponding libs boto for amazon also worth mentioning my pip line look like sudo pip install paramiko pyyaml jinja2 httplib2 six markupsafe boto >>>docs_report
update docs playbooks loops rst playbooks filters rst playbooks filters rst the example for `first` and `last` filter shows its bare strings http docs ansible com ansible playbooks filters html other useful filters playbooks loops rst the example for `subelements` might be typo http docs ansible com ansible playbooks loops html looping over subelements >>>docs_pull_request
vmware inventory script rewrite to use official vmware python api pyvmomi vmware inventory script rewrite to use official vmware python api pyvmomi>>>feature_idea
added new module object to vca this pr is to help to stabilize and optimize the vca code and provide better common api for building vca modules >>>cloud feature_pull_request
update lookups doc with shelvefile example update lookups doc with shelvefile example>>>docs_pull_request easyfix
ansible ssh user not available as variable in become expr issue type bug report ansible version devel summary ansible ssh user cannot be used in become expressions steps to reproduce this playbook errors out with if you remove the become line it properly prints your user jimi the promised issue as followup to the become sudo discussions from yesterday>>>bug_report
support hosts foo and add tests for split apply subscript>>>bugfix_pull_request feature_pull_request
fix for get interfaces info with aix 12434 this patch fix gathering fact problem against aix host test aix yml test ansible playbook test aix yml >>>bugfix_pull_request
get interfaces info with aix hi tried to use ansible from linux host against aix host the previous version worked but now when gathering facts get it looks like this commit https github com ansible ansible commit 15ad02102ee79bf862d973041ae5f66dfb6884de changed the signature of `get interfaces info` for the aix platform now there is `ifconfig options parameter` but the superclass `genericbsdifconfignetwork` calls this method with only one parameter not sure what the correct solution would be either set default value for the parameter with `ifconfig options or change the caller to give an additional parameter whatever it would be for the `genericbsdifconfignetwork` >>>bug_report easyfix p2
update intro windows rst arch linux contains python2 and python3 using the standard pip command will target python3 >>>docs_pull_request windows
python there no xrange use six moves range instead aliased to xrange on python aliased to range on python also couldn resist replacing the elaborate chr ord randrange dance with the simpler random choice string ascii lowercase that was already used elsewhere in the ansible codebase >>>feature_pull_request
stops using groups list to check for host when using add host may be related to https github com ansible ansible issues 11957 using the add host function in current devel branch causes playbooks to return exceptions stating inventory has no attribute groups list this pr aims to use the existing attribute in the inventory and groups objects to work around this issue edit for context am using add host in the following manner >>>bugfix_pull_request p2
ansible error message says set accept hostkey to true when docs specify yes instead of true ansible error message for the git module says set accept hostkey to true but the ansible docs say the accepted values are yes or no with no true option happy to submit pr fixing this just not sure whether you want the docs updated or the error message updated if error message looks like there also test that needs to be updated as well >>>pending_closure
update synchronize module plugin to work on os as discussed at the commit 6c107258fad96fca53bea5a74960f54ac0d7b45e those changes broke synchronize module functionality on os where the built in rsync is and has some issues parsing the user hostname or ipv4 or ipv6 format in destination main issue is that it completely breaks the synchronize functionality even for ipv4 on current os the hack below seems to be working on both os and linux with newer rsync and with ipv4 addresses and and aaaa dns names the rsync especially on os is quite picky about the format of src and dest so some independent testing would be good still this allows for using the synchronize module again on stock os without having to reinstall rsync on all the servers and clients thanks for consideration >>>bugfix_pull_request needs_revision p2
cannot trigger handler with variable in name issue type bug report ansible version alpha2 ansible configuration environment running ansible on os 10 10 summary trying to parameterize role for managing number of very similar deployments the role tasks trigger restart handler which is identical for each deployment except for the name of the app this comment https github com ansible ansible issues 4853 issuecomment 28719258 implies it is possible to include variable in the name of handler however with ansible alpha2 am unable to successfully trigger the handler with variable in its name steps to reproduce example files modify the inventory file as appropriate then run expected results expect the following handlers to be run `echo test` `restart app1` `restart app2` actual results however only the statically named `echo test` is run is this technique supported if so did misconfigure something thanks patrick>>>bug_report p2
initial add of vca common module this pr refactors the common functions from the vca modules into common module utils>>>cloud feature_pull_request
remove deprecation warning now handled in split patterns>>>feature_pull_request
merge host ipv 46 address into address the earlier distinction was never used ipv6 address was always copy of ipv4 address and the latter was always used to set the remote addr field in the playcontext also uses the canonical ansible host ansible port names when setting the address and port from variables >>>feature_pull_request
create return value specs for ansiblemodule from internal discussions regarding documenting module return values we ve been discussing how it would be useful to make returns consistent regardless of which point and values to this end we would like to create return value spec akin to the module param spec which would be used to normalize returns from both fail json and exit json for module this spec could also potentially be used to auto generate the return value documentation used in the module docs >>>docs_report feature_idea
fix for user defined modules not overriding modules from core this fix takes into account that powershell modules are somewhat different than regular modules and have to be kept separate >>>bugfix_pull_request plugin windows
elasticache change false is missing or not working issue type bug report ansible version ansible configuration elasticache when adding new cache cluster in the main yml and re run the playbook environment amazon linux aws amazon summary changed false is missing or not working like it is there in ec2 and ec2 vpc steps to reproduce main yml main yml executing ansible playbook actual results >>>bug_report cloud needs_to_be_moved
ansible groups playbook variable is list the documentation in this place https github com ansible ansible blob devel docsite rst playbooks variables rst id47 is out of date since ``groups`` is now list of group names not dict will there be way to access the values of that dict in ansible >>>bug_report
documentation for retry files enabled and retry files save path these two commits add documentation for retry files enabled and retry files save path to the main documentation and some comments to the example configuration file >>>docs_pull_request
use instead of or to separate host patterns the earlier recommended pat1 pat2 pat3 notation doesn work well with ipv6 addresses so we recommend as separator instead we know that commas can occur within pattern so we can just split on it we still have to accept the foo bar notation because it so commonly used but we issue deprecation warning for it closes 12404>>>bugfix_pull_request p2
only use become if the target user difers from the current remote user the idea behind this change is as follows usually have bootstrap script which require sudo but if someone already has access as root there is no need for switch while this could be implemented in the playbook itself using something like `become ansible ssh user root which is currently not possible either it seems way nicer to to that in ansible itself personally cannot see any reason to use sudo if the target user is already the current user thoughts >>>bugfix_pull_request p2
synchronize uses wrong ssh user issue type bug report ansible version ansible configuration inventory environment tested with os client arch linux host and ubuntu 12 04 client debian host summary the synchronize module takes the wrong ssh user into account for the destination specification passed to rsync the client username is taken instead of the host username the code lines responsible for this are https github com ansible ansible blob 5d67420df042f052c2cd79b7d41983e4759ee50b lib ansible runner action plugins synchronize py l161 l162 dump of the ``inject`` dict can be found here https gist github com jonashaag 9452e60baee13d4ddbaa `` `` is the client user it looks to my like ``inject hostvars ansible ssh user `` should be taken not ``inject ansible ssh user `` steps to reproduce expected results rsync command should be actual results rsync command is full debug output >>>bug_report
ansible fails to load yaml file with equal sign as value ansible fails when loading yaml file like this the yaml file is valid see http www yamllint com but ansible fails with `error syntax error while loading yaml script putting quotes around the equal sign works but can do that in my case as this file will be generated by yaml parser so using workaround is not an option >>>bug_report
add to changelog why is not in the changelog 4rc1 is already out the changelog is taken from https groups google com forum searchin ansible project ansible project eacezxhp m4 u9pf55mzlgaj>>>docs_pull_request
add releases and for some reason the last stable releases don show up in the releases list please add them >>>docs_pull_request
fix example formatting in the documentation missing makes this example http docs ansible com ansible intro patterns html render badly ekrano nuotrauka is 2015 09 17 11 05 43 https cloud githubusercontent com assets 159967 9928085 150fd1da 5d2c 11e5 8849 afde6778b1b6 png >>>docs_pull_request
python basestring in play context py>>>feature_pull_request
fix ipv6 addresses getting dropped from hosts list devel branch also see 12329>>>pending_closure
bug get file parser takes exactly arguments given this recent commit https github com ansible ansible commit c8f2483d6d3ff6ef4aedc2572e287539dbb73a0b diff 614654ef35f5425c0270de89e92b1bedl37 requires updating the call site at https github com ansible ansible blob devel lib ansible inventory dir py l112>>>bug_report pending_closure
nested blocks lose conditions on parent blocks this is bug report for devel 2a50957a have playbook like this run it against an inventory with two hosts expected the actions inside the top most block to be executed only on magpie but this is what actually happened note how the innermost block is executed on raven even though neither of the two conditions on the outer blocks is true on that host this effectively makes nested blocks unusable >>>bug_report p2
documentation need clarification wrt ansible ssh hostvars in the inventory http docs ansible com ansible intro inventory html document page it lists `ansible ssh args` and `ansible ssh extra args` as supported hostvars that change the behaviour of the ssh connection was developing dynamic inventory script to take advantage of these until discovered that setting them did nothing looked into the code of ansible and few prs to see that these are v2 features not yet available the documentation really should be updated to reflect that these are currently unsupported in any official release >>>docs_report
always create all group create all even if host list is empty as this group needs to exist when creating the implicit localhost host fixes 12391>>>bugfix_pull_request p2
crash unhandled exception on playbook for localhost with empty inventory issue type bug report ansible version ansible devel 2a50957ad8 last updated 2015 09 16 11 56 18 gmt 200 ansible configuration environment freebsd melamine cuivre fr eu org 10 release p5 freebsd 10 release p5 tue jan 27 08 55 07 utc 2015 root amd64 builder daemonology net usr obj usr src sys generic amd64 summary crash unhandled exception on playbook for localhost with empty inventory steps to reproduce consider playbook ping yml hosts localhost tasks name ping action ping expected results ansible playbook ping yml warning provided hosts list is empty only localhost is available play task setup ok localhost task ping ok localhost play recap localhost ok changed unreachable failed actual results ansible playbook ping yml warning provided hosts list is empty only localhost is available unexpected exception nonetype object has no attribute add child group to see the full traceback use vvv >>>bug_report p2
sudo command results in query hanging over ssh on some machines the ansible shell command hangs if sudo privilege is necessary to execute the commands test mac playbooks ansible all shell tail var log secure ssh password nothing it hangs till ctrl is pressed any ideas to debug >>>bug_report needs_info
enable winrm put file to upload an empty file found when looking at `win lineinfile` tests `win copy` and related modules that depend on the `put file` method in the `winrm` connection plugin would not create remote file if the source file was empty >>>bugfix_pull_request windows
add powershell exception handling and turn on strict mode add exception handling when running powershell modules to provide exception message and stack trace enable strict mode for all powershell modules and internal commands update common powershell code to fix strict mode errors fix an issue with set attr where it would not replace an existing property if already set add tests for exception handling using modified win ping modules resubmission of https github com ansible ansible pull 12047 all core modules should work since https github com ansible ansible modules core issues 1956 was merged some extras modules may break >>>bugfix_pull_request p2 windows
bug with merge of hostvars from dynamic inventory into hostvars have simplified version of problem that ve been chasing hostvars information from the output of dynamic inventory script does not seem to be properly merged into hostvars alternate explanations include the possibility that the json generate is incorrect or that just generally mistaken using ansible on mac running 10 10 the remote systems are freshly built centos vms here simple fake dynamic inventory script here my playbook credit to steve midgley and enno grper answer on stack overflow http stackoverflow com questions 18839509 where can get list of ansible pre defined variables and lester wade snippet on coderwall https coderwall com 13lh6w dump all variables and here templates dumpall j2 ve include the gory details of all three variable dumps in this gist https gist github com 9855f9bede53e9347d81 check out the dump for `10 33 147 232` the host variables part has three sections one for each host but the only section that includes copy of `host specific var` is the section for `10 33 147 234` and the value that it has is that value should be in the section for `10 22 147 232` to say it differently as question on particular machine should file dumped out using the dumpall j2 template above have three sections in its host variables part my understanding is yes so that machine can look up info about the other machines should each of the sections include host variables declared in the meta` section from the dynamic inventory believe that they should but in my explorations only single section does bug should each section have the appropriate value from the dynamic inventory is it bug that on host 232 the host 234 section has 232 value believe that they should and that this is also bug thanks for reading this far please let me know if can provide any additional information >>>bug_report
added env string in async cmd noticed this unused env string in async py added it to the async command not completely sure what did here first time look under the hood with ansible but it did the trick for me in order to solve issue 12381>>>bugfix_pull_request p2
environment not taken into account when using async trying to set an env var display 99 in order to launch chromium with ansible but when use async get an error message gtk cannot open display similar to what get when connect manually in ssh and forget to do export display 99 before trying to launch chromium if remove the async action chromium launches successfully but then the playbook execution hangs there >>>bug_report p2
document vars now specific precedence for v2 also explaining scope and connection vars bit more >>>docs_pull_request
normalized plugin paths and names and configs now all configs directories and code match and are singular except vars which is really data loader fixes 12337 >>>bugfix_pull_request p2
typo fix>>>docs_pull_request
ansible win copy fails for local centos to remote windows machine hi im trying to copy file directory from my local centos control node to remote windows machine using win copy my playbook is follows hosts windows tasks name deploy the jenkins build on windows win copy src home router dest test it starts copying but in the final stage get the below error winrm put home router thirdparty lib spring web release jar to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 source offset 720650 size 1565 put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy winrm put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy ps1 offset size 2031 winrm put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy ps1 offset 2031 size 2031 winrm put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy ps1 offset 4062 size 2031 winrm put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy ps1 offset 6093 size 2031 winrm put tmp tmpl r4df to users administrator appdata local temp ansible tmp 1442321410 65 34546933940647 win copy ps1 offset 8124 size 646 fatal 192 168 199 93 traceback most recent call last file usr lib python2 site packages ansible runner init py line 582 in executor exec rc self executor internal host new stdin file usr lib python2 site packages ansible runner init py line 785 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file usr lib python2 site packages ansible runner init py line 1032 in executor internal inner result handler run conn tmp module name module args inject complex args file usr lib python2 site packages ansible runner action plugins win copy py line 256 in run module return self runner execute module conn tmp path win copy module args tmp inject inject complex args complex args delete remote tmp delete remote tmp file usr lib python2 site packages ansible runner init py line 507 in execute module argsfile self transfer str conn tmp arguments utils jsonify utils parse kv args file usr lib python2 site packages ansible utils init py line 787 in parse kv vargs split args args file usr lib python2 site packages ansible module utils splitter py line 185 in split args raise exception error while splitting arguments either an unbalanced jinja2 block or quotes exception error while splitting arguments either an unbalanced jinja2 block or quotes im using ansible 2>>>bug_report needs_info windows
documentation pr add kerberos configuration instructions to windows intro page please can these instructions be added to the windows intro page >>>docs_pull_request windows
v2 regression timeout doesn work with devel ``ansible 30`` doesn seem to set ``self play context timeout`` at all but setting ``ansible timeout`` in the environment does anyone working on this already >>>bug_report p2
remove duplicate su prompt localizations>>>bugfix_pull_request
authentication failed when delegating from windows to linux run playbook for new windows hosts that have to do certain things on on linux host too ex check mk config on our linux monitoring server so when try to run this in playbook get all my windows task work without any issues but delegation to seems to give an authentication failed also checked my groupvars and the windows authentication is only defined as groupvar only for those windows hosts and for all the linux things it should just take current user like what happens when we run linux only playbook >>>bug_report windows
docs minor fixes to playbooks variables similar to 12348 fix code block quoting boldface for modules name>>>docs_pull_request
contrib inventory nsot network source of truth flexible ipam cmdb by dropbox feel like this is good feature to have upstream didn notice any other similar choices ignoring cloud inventory providers because this enables network engineers to have better source of truth for their devices full readme is located over at coxley ansible nsot https github com coxley ansible nsot where have some integration tests for parameters and basic http mock ve tried to make it as easy for the user to take advantage of this >>>cloud feature_pull_request new_plugin
register does not handle yaml arrays trying to register multiple variables in yaml array syntax kk playbooks kris cat yml vim ft ansible hosts server user root tasks name test something command echo test register debug var debug var this explodes kk playbooks kris ansible playbook yml play server task test something changed server traceback most recent call last file usr local cellar ansible libexec bin ansible playbook line 324 in sys exit main sys argv file usr local cellar ansible libexec bin ansible playbook line 264 in main pb run file usr local cellar ansible libexec lib python2 site packages ansible playbook init py line 348 in run if not self run play play file usr local cellar ansible libexec lib python2 site packages ansible playbook init py line 789 in run play if not self run task play task false file usr local cellar ansible libexec lib python2 site packages ansible playbook init py line 540 in run task register play vars host result file usr local cellar ansible libexec lib python2 site packages ansible playbook init py line 514 in register play vars utils update hash self vars cache host task register result typeerror unhashable type list it is the type that makes it explode that is register is already sufficient to make it blow kk playbooks kris cat yml vim ft ansible hosts server user root tasks name test something command echo test notify one two handlers name one command echo one name two command echo two works just as expected so expect duplicating the parameter handling from handlers in register would fix the problem related to 12364 >>>bug_report
add support for purging local outdated backup files>>>feature_pull_request needs_info
replace degug with debug tiny typo fix >>>bugfix_pull_request easyfix
second register when task unregisters variable from first task have playbook where need to find out if xinetd is already running or not as do not want to restart it only reload it if it already running so created this much to my surprise this always fails on non debian systems because the second task although fenced with when debian actually unregisters xinetd running instead of merely being no op please either fix the behaviour or document it spent over an hour trying to figure out what on earth was doing wrong someone already opened another issue about improving the error message which presumably would have shortened the troubleshooting time considerably >>>docs_report
allow configureremotingforansible ps1 script from public zone fixes https github com ansible ansible issues 12362 the current script fails on machines which have network interfaces designated as connected to public networks choices for network designation being private domain public this commit adds the optional switch skipnetworkprofilecheck to configureremotingforansible ps1 when passed the switch causes the script to skip the check which enforces that only devices on private domain zones can have winrm initialized >>>bugfix_pull_request windows
configureremotingforansible ps1 fails when windows device connected via interface in public zone issue type bug report ansible version ansible configuration default environment mac os control host windows 10 remote managed node summary example script configureremotingforansible ps1 requires that interfaces on device be designated as either domain or private zone some organizations treat all interfaces as though they are connected to the equally untrusted public zone regardless of where they are connected script should have option to allow winrm to be initialized on public zone interfaces steps to reproduce run configureremotingforansible ps1 on windows machine with only public zone interfaces expected results successful winrm initialization actual results >>>bug_report windows
fix tiny typo>>>docs_pull_request
fix ansible v2 documentation for ini lookup plugin fix playbook example use properties instead of property >>>docs_pull_request
fix fetch to not fail for missing file when fail if missing false fixes `fetch` action plugin to not fail if file is missing and `fail if missing false` the default add tests to `test fetch` role to verify it works as expected also fixes an integration test failure from th `test win fetch` role >>>bugfix_pull_request p2
module unarchive doesn maintain file permissions from original archive on mac when using unarchive to unzip zip file the destination output gets drwxrwxrwx permissions which are not the same as the original zip file if unzip the original with unzip manually get the correct permissions aware of the mode however doing mode rwx rx rx leaves all files with executable bits turned on whereas mode rw leaves directories un enterable so not able to achieve the desired permissions without second task to call command to do another chmod >>>bug_report needs_info
fixed 12356 restored ansible become behavior >>>bugfix_pull_request p2
privilege escalation disables pipelining on v2 given this playbok results in on ansible and in on ansible v2 the put command seems to be an indication that pipelining is not use according to jimi transport is openssh with version openssh 9p1 debian openssl 2d jul 2015 operating system is linux apollo13 amd64 smp debian 2015 08 23 x86 64 gnu linux debian unstable >>>bug_report p2
jinja2 relative includes hang when using lookup template issue type bug report ansible version ansible configuration no `ansible cfg` using defaults environment but running on mac os summary when use `include` with relative path in jinja2 template and the template is expanded with `lookup playbook execution hangs steps to reproduce expected results completion of execution with `test fact` set actual results >>>bug_report p2
ansible galaxy keep clone of repositories appreciate if could use ansible galaxy to download the git repositories and keep them right now ansible galaxy does git archive to get the contents and then discards the cloned git repository like to keep the git repository because can then track changes more easily >>>feature_idea
multi play variable inclusion related to 12163 as pointed out by jimi this now works however in the scenario whereby you have multiple plays in your playbook it doesn for example playbook yml in this scenario the second play will fail when ran with tags echo variable >>>bug_report
docsite playbooks roles workaround for conditionally included tasks adding example of workaround for conditionally included tasks>>>docs_pull_request easyfix needs_revision
unsafeproxy errors with python commit from https github com ansible ansible commit 30399edadaae6917af4a5df77c7c50c33005972f creates bug for python centos showing the following error installing python and using virtualenv succeeds the task being played was from `jdauphant nginx` role not sure what the root cause of that behavior is fyi running latest ansible devel branch updated git submodules for the various modules >>>bug_report p1
docsite playbooks intro minor tweaks fix code block quoting boldface for modules name>>>docs_pull_request
v2 delegate to stopped working issue type bug report ansible version environment ubuntu summary ve got an ansible playbook that works on but fails on today v2 the failing task looks like this testing with two vagrant machines trusty is inventory hostname precise is the value of backup buddy ansible produces this output ansible v2 fails this way if run with vvv` also see the bug appears to be user none produces this in vvv mode >>>bug_report p2
port b723f9a09a91b125b684343815dc23dbd88f52ed to branch stable could you port commit b723f9a09a91b125b684343815dc23dbd88f52ed to branch stable centos epel repository doesn have see https github com ansible ansible commit b723f9a09a91b125b684343815dc23dbd88f52ed >>>feature_idea
add nagios livestatus inventory plugin this plugin can retrieve information from livestatus module and use it as an inventory script here is some examples calling inventory script nagios livestatus py list display livestatus address from nagios group linux ansible debug var livestatus address nagios livestatus py linux >>>feature_pull_request
add last error to rescue block issue type feature idea ansible version ansible configuration not modified environment ubuntu 14 04 summary add last error to rescue block steps to reproduce rescue block described at http docs ansible com ansible playbooks blocks html have no way to retrieve last error think error notification will be frequent use case for blocks something like this expected results last error playbook task name failure message actual results no variable defined>>>feature_idea
add no log parameter to common openstack args these bad boys can contain secret data so should be marked no log >>>feature_pull_request
correct default plugin search path have ansible installed and the configuration file in etc ansible ansible cfg` defines default plugin search paths as usr share ansible plugins rather than usr share ansible plugins >>>docs_pull_request needs_revision
docsite playbooks filters minor tweaks few minor tweaks grammar fix rst code block syntax>>>docs_pull_request
include with items breaks with multiple included tasks to repro get ansible alpha uncomment one or both of the commented out tasks here https github com ansible ansible blob devel samples include yml run samples test include yml result the first debug message works fine but the second comes out as it looks like jimi might be aware of this commenting out the extra tasks in this giant commit https github com ansible ansible commit 785c0c0c8ca8d90f3bccc7206f0c267977f77882 assuming this behavior is expected to work as part of the undeprecation of include with items right >>>bug_report p2
allow modules without py extension to override core modules following 12330 need to implement 4b895f04e398deb9c156d4e8b6435073fc2e6f18 in way that doesn break windows support fix order of loading of modules allows ansible library to overload core modules even if the module in ansible library doesn have py extension >>>bug_report
false error this task service has extra params consider this task block name restart the workers service name worker item nr state restarted args 60 with items web workers in ansible when run this produces the error error this task service has extra params which is only allowed in the following modules according to http docs ansible com ansible service module html this is valid syntax args is an alias for arguments if do use arguments rather than args the error does not occur bottom line args is not being respected in the service module as an acceptable alias for arguments >>>bug_report p2
revert fix order of loading of modules reverts changes introduced by commit 4b895f04e398deb9c156d4e8b6435073fc2e6f18 which breaks support for all windows modules it also breaks support for specifying python module by it complete filename `ping py` though not sure if anyone uses that approach except me attempting to run python modules on windows >>>bugfix_pull_request windows
fix ipv6 addresses getting dropped from hosts list note this was refactored and partially fixed on devel v2 branch >>>bugfix_pull_request
include pathing issue issue type bug report ansible version ansible configuration no `ansible cfg` using defaults environment but running on mac os summary to include files from other roles use `include`s like as of latest devel the pathing for this broke as shown below steps to reproduce expected results successful inclusion and execution of `included yml` actual results >>>bug_report p1
test for python must be against basename of interpreter followup on issue 12076>>>bugfix_pull_request p2
new filter get number list this filter should return list of numbers for instance use that list in with nested loop have added some documentation as well >>>feature_pull_request
freeze during gathering facts phase know am not the first to report this but have not found any conclusive solution to the issue basically during gathering facts ansible will hang on single host while executing setup via python on the target node the curious part is this issue is recurring after few months of running our cluster and starting from computers usually spreads through the cluster quickly quite sure it not virus or anything cannot rule out some weirdo hardware issue all computers are of the same make but if so cannot fix that only full re setup of each node machine fixes the issue for some time although this process is automated it is still somewhat annoying state and will now look for other solutions if this is python issue then it probably harmless to me as ansible is was the only program need that requires python anyhow in case can help to fix the issue here are the last lines of the trace if you want the full trace let me know but it 3mb before ctrl the process it hangs in the last lines for 30 minutes setup 2866 path kwargs get path kwargs get dest none setup 2867 if path is none setup 2868 return kwargs setup 3252 assert msg in kwargs implementation error msg to explain the error is required setup 3253 kwargs failed true setup 3254 print self jsonify kwargs modulename setup funcname jsonify setup 3231 for encoding in utf latin unicode escape setup 3232 try setup 3233 return json dumps data encoding encoding modulename init funcname dumps init py 239 if not skipkeys and ensure ascii and init py 240 check circular and allow nan and init py 241 cls is none and indent is none and separators is none and init py 242 encoding utf and default is none and not sort keys and not kw init py 243 return default encoder encode obj modulename encoder funcname encode encoder py 194 if isinstance basestring encoder py 207 chunks self iterencode one shot true modulename encoder funcname iterencode encoder py 222 if self check circular encoder py 223 markers encoder py 226 if self ensure ascii encoder py 227 encoder encode basestring ascii encoder py 230 if self encoding utf encoder py 236 def floatstr allow nan self allow nan encoder py 237 repr float repr inf infinity neginf infinity encoder py 259 if one shot and make encoder is not none encoder py 260 and self indent is none and not self sort keys encoder py 261 iterencode make encoder encoder py 262 markers self default encoder self indent encoder py 263 self key separator self item separator self sort keys encoder py 264 self skipkeys self allow nan encoder py 270 return iterencode encoder py 208 if not isinstance chunks list tuple encoder py 210 return join chunks msg traceback most recent call last file setup line 3424 in run command out err cmd communicate input data file usr lib python2 subprocess py line 799 in communicate return self communicate input file usr lib python2 subprocess py line 1409 in communicate stdout stderr self communicate with poll input file usr lib python2 subprocess py line 1463 in communicate with poll ready poller poll nkeyboardinterrupt failed true cmd usr bin lspci rc 257 setup 3255 sys exit modulename trace funcname unsettrace trace py 80 sys settrace none >>>bug_report
special case win slurp and win setup as well to work with the new module finder>>>bugfix_pull_request p2 windows
adding linode common functions to module utils they re needed for new changed linode functionality available in separate pr in ansible modules core linode cloud modules https github com ansible ansible modules core tree devel cloud linode >>>feature_pull_request
differing behavior when using inline vars vs vars dict with nested includes and with items with random choice issue type bug report ansible version ansible configuration no `ansible cfg` using defaults environment but running on mac os summary found while writing role that has an `include` using `with items where the included file uses `with items or `with random choice that things work as expected when use inline variables for the include but not when use `vars dict it seems like when use the `vars dict the `item` in the outer `with items is getting replaced by the `item` from the inner one steps to reproduce expected results expect the same results from both tasks in `tasks main yml` the first one with inline variable specification seems correct to me actual results >>>bug_report p2
environment variables templated again jimi 12191 has resurfaced please see that issue for test case which now fails again >>>bug_report p2
support etcd v2 use this version by default the etcd lookup plugin doesn work with version of etcd merge this pull in order to support etcd v2 there is new environment variable ansible etcd version in order to choose witch version you want default to v2 so you can still use ansible with an old etcd version >>>feature_pull_request
rename ansible ssh host port user in docs to ansible the ssh variants will continue to work but the shorter more generic names are preferred now >>>docs_pull_request
ansible pull git options ansible version ansible configuration default environment summary since force no is the default behaviour for git module and in case of using git from ansible playbooks this options is possible to change however when running ansible pull this option is impossible to change which may break the whole checkout on the machine running ansible pull in case some file in the playbooks repo has local change or smth else could you add some option to ansible pull that could be passed to the git module or make the git module read it options from ansible cfg expected results ansible pull is able to pass force yes to the git module actual results ansible pull always uses git module with force no which results in failing to run the playbook in case local modifications to the playbook repo exist >>>feature_idea
resurrection of the comment filter this patch is just resurrection of filter which was once already merged 10492 but got lost together with the `v1` directory have also added some documentation of the filter >>>bugfix_pull_request
doc fixes this patch is fixing some minor issues in the documentation >>>docs_pull_request
wait for with port search regex can run forever issue type bug report ansible version probably others ansible configuration stock environment summary wait for won always honour its timeout values in particular if you connect to socket which dribbles data out at rate that exceeds the specified timeout you ll wind up in loop reading data forever the problem lies with this inner loop in the wait for code there may be additional issues around the close timeout in the same body of code found that killing the nc side of the connection left the ansible playbook permanently in close wait this is down to not checking the result of recv directly for an eof the whole thing should be as follows steps to reproduce an example ansible task run this with the following running in another window expected results failure after seconds in the example above actual results the playbook will hang indefinitely either reading data or should you kill the server process nc in the example above stuck in close wait and looping forever >>>bug_report p2
winrm connection port schema hardwired issue type bug report ansible version summary in https github com ansible ansible blob devel lib ansible plugins connections winrm py l86 it is defined that http can only be used if port is 5985 you can not use http connection on different port although ssl should preferred this hardwiring should be avoided there is nat for vagrant cloud where other ports must be used for connection expected results there should be an option for specifing if ssl should be used or not http on default port ansible connection winrm nonssl http on 55985 ansible ssh port 55985 ansible connection winrm nonssl https default on default port 5596 ansible connection winrm >>>bug_report feature_idea windows
v2 regression template module fails to find the template in role templates issue type bug ansible version ansible configuration environment running on ubuntu 15 04 managing ubuntu 12 04 and 14 04 summary my `roles common tasks postfix yml` has my `roles common templates mailname j2` looks like this ansible fails with ansible is happy with this ansible was happy with this week or two ago steps to reproduce expected results actual results >>>bug_report p2
python use the right pyyaml saferepresenter for unicode pyyaml has saferepresenter in lib that defines def represent unicode self data return self represent scalar tag yaml org 2002 str data and different saferepresenter in lib3 that defines def represent str self data return self represent scalar tag yaml org 2002 str data so the right thing to do on python is to use represent str ansibleunicode is subclass of six text type str on python >>>bugfix_pull_request
set fact blows away registered variables issue type bug report or am completely misunderstanding something ansible version devel branch this issue appears to have introduced by this commit https github com ansible ansible commit 56d7f3889d5550ab6dc105bdb48471d29f71446e description when calling `set fact` and creating new variable with value from registered variable the registered variable value is replaced with variable is not defined the following playbook reproduces the issue expected behavior prior to commit 56d7f38 the output is as expected observed behavior from 56d7f38 on the output is environment mac os yosemite python 10>>>bug_report p1
vault missing dataloader for pwd file 12293 fix for 12293 with password file option was broken>>>bugfix_pull_request p1
cloudstack new integration test role test cs user integration test for new module in https github com ansible ansible modules extras pull 941 ansible playbook cloudstack yml tags test cs user diff play localhost task test cs user setup ok localhost changed false task test cs user verify setup ok localhost msg all assertions passed task test cs user test fail if missing username failed localhost failed true msg missing required arguments username ignoring task test cs user verify results of fail if missing params ok localhost msg all assertions passed task test cs user test fail if missing params if state present failed localhost failed true msg missing required arguments account email password first name last name ignoring task test cs user verify results of fail if missing params if state present ok localhost msg all assertions passed task test cs user test create user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com first name cs first name id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name state enabled username cs user task test cs user verify results of create user ok localhost msg all assertions passed task test cs user test create user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com first name cs first name id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name state enabled username cs user task test cs user verify results of create user idempotence ok localhost msg all assertions passed task test cs user test update user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state enabled username cs user task test cs user verify results of update user ok localhost msg all assertions passed task test cs user test update user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state enabled username cs user task test cs user verify results of update user idempotence ok localhost msg all assertions passed task test cs user test lock user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state locked username cs user task test cs user verify results of lock user ok localhost msg all assertions passed task test cs user test lock user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state locked username cs user task test cs user verify results of lock user idempotence ok localhost msg all assertions passed task test cs user test disable user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state disabled username cs user task test cs user verify results of disable user ok localhost msg all assertions passed task test cs user test disable user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state disabled username cs user task test cs user verify results of disable user idempotence ok localhost msg all assertions passed task test cs user test lock disabled user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state locked username cs user task test cs user verify results of lock disabled user ok localhost msg all assertions passed task test cs user test lock disabled user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state locked username cs user task test cs user verify results of lock disabled user idempotence ok localhost msg all assertions passed task test cs user test enable user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state enabled username cs user task test cs user verify results of enable user ok localhost msg all assertions passed task test cs user test enable user idempotence ok localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed false created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state enabled username cs user task test cs user verify results of enable user idempotence ok localhost msg all assertions passed task test cs user test remove user changed localhost account admin account type root admin api key vs9ommwp7lqxz60mf dkydssow9d76vxbvzosjrjnzmwxzqkheg uo4svltoqnzi2wkncf8y5thjumcromdq9a api secret wxzejjhaerfcirovqg7rtmowfn46mcbbxsqygsi0ytwmrishl47sh8mgxntjb57cmrtr6mkhizwsfumo4axu6q changed true created 2015 09 09t20 28 56 0000 domain root email cs example com1 first name cs first name1 id 9367d060 3bdb 4082 ba54 6e5435192fbb last name cs last name1 state enabled username cs user task test cs user verify results of remove user ok localhost msg all assertions passed task test cs user test remove user idempotence ok localhost changed false task test cs user verify results of remove user idempotence ok localhost msg all assertions passed play recap localhost ok 34 changed unreachable failed >>>cloud feature_pull_request
implement meta close connection this would allow forcing logins for when the remote user group auth information is updated so it can be immediately reused in play for this to happen task executor needs to stop closing connections after each task winrm connections either need to reuse connections or autoclose after each invocation re enable ssh connection closing for dealing with control master persist possibly put this in framework of redoing how we handle connections and connection caching user host port transport >>>feature_idea
vars prompt changes defaults to private yes while testing our playbooks with alpha2 discovered that unless include private no in the call cannot see any characters am entering also discovered that the compact form vars prompt variable name prompt string no longer works it did in and now requires an explicit name parameter >>>bug_report p2
ansible playbook fails with ipv6 address trying to run playbook using ansible on server using it ipv6 address but running into something weird which assuming is bug the gathering facts step returns ok but then the first task in the playbook fails with the following message fatal no hosts matched or all hosts have already failed aborting here is the full output when try to run the playbook here is my playbook here is my hosts file the same playbook works just fine if use an ipv4 address instead of an ipv6 >>>bug_report
ansible vault password file support broken issue type bug report ansible version ansible configuration none environment summary the vault password file` option to `ansible vault` was broken by ff9f5d7d steps to reproduce expected results as per the commit prior to ff9f5d7d actual results >>>bug_report p1
zypper repository dont changes repo url first added repo with ``zypper repository name name repo file path to repo state present`` then we switched to http repo ``zypper repository name name repo http rpm exampe org repo state present`` but ansible didnt changed something until removed the repo by hand maybe there is something wrong with l150 https github com ansible ansible modules extras blob devel packaging os zypper repository py l150 guess this part was for comparing if the repo url name has changed >>>needs_to_be_moved
v2 regression fetch su is broken using the latest unmodified devel e2e9319f task like this produces this in the debug output notice the `` bin sh line syntax error near unexpected token ``>>>bug_report p1
ec2 asg termination policies termination policies is not defined hi ve just pulled the latest devel and creating an aws asg group at least for me fails when this worked in the past the following is code snippet of the playbook task an exception occurred during task execution the full traceback is the docs section of `ec2 asg py` says that `termination policies` default is set to value of default so my guess is that it not required in my task definition `termination policies` and `default cool down` were introduced in the following commit https github com ansible ansible modules core commit f7f621839ad2063c707506f7eaf5663f113664a7 diff 689b2e5ce09076c21c9915e50f8a9140 can anyone else verify if they get the same error my colleague also reproduced this issue with the same error >>>needs_to_be_moved
ansible firewalld fact this is proof of concept implementation of `firewalld` fact the detection logic is lifted from the firewalld` module in extras my web server deployment playbooks can run on bare metal setups that include firewalld and on openstack vms which rely on neutron for firewalling the playbooks use ansible firewalld module which understandably errors out if no firewalld support is present in my case just want to skip firewalld tasks with this fact can use simple `when` clause as shown below at the moment doing exactly the same thing for selinux taking advantage of the existing `ansible selinux` fact this works quite well for me think this fact should be provided by ansible because it integrates well with the existing firewalld module without this fact need to write my own detection logic it not difficult but it makes the plays bit less elegant manually tested the code in this pr against fedora server installation that has firewalld and fedora cloud installation that does not willing to put in the time to write automated tests if bit of guidance is provided thank you for ansible heart >>>feature_pull_request
python use six string types instead of basestring reduces the number of failing tests from 35 to 17 warning not 100 confident in the correctness of this change on python nothing changes six string types is basestring wrapped in tuple on python this means byte strings won be acceptable here which think is right but rather somebody double checked >>>bugfix_pull_request
docu acceptable compiler is missing in dependencies following http docs ansible com ansible intro installation html executed git clone git github com ansible ansible git recursive cd ansible source hacking env setup but executing sudo pip install paramiko pyyaml jinja2 httplib2 six throws the followign error configure error in tmp pip build zl5v6l pycrypto configure error no acceptable compiler found in path one solution was to install python crypto via aptitude install python crypto>>>docs_report
devel logic vs if hosts in play don respond die do not continue to play ve got playbook like testing in vagrant don always spin up foo in this gives vs in devel where it dies expected that devel does what does or at least has flag option to allow it actual different behavior quesiton is this expected >>>bug_report p1
rpmbuild rpm build when followed these instructions the generated path was rpm build not rpmbuild my rpm build version is rpm build 11 25 el7 x86 64 if that relevant maybe this is just me but wanted to feed back in case it the same for everyone >>>docs_report
misleading deprecation message on running playbook with `ansible devel 2d251cba45 last updated 2015 09 04 15 50 24 gmt 400 got this error message this was very hard to track down and should have line number or task name or something after while was able to pin it down to this section of role where was running several files in an include as root switching from sudo to become fixes this problem so think what happening here is that because sudo is deprecated it not on the acceptable attribute list that leads to sudo being seen as variable being passed to the task in deprecated way rather than as an attribute of the task recommend both improving the error message and including deprecated attributes in second check performed before the variable passing deprecation check >>>bug_report
update intro windows rst fix typo that broke rst html parsing >>>docs_pull_request
environment variables are not recognized in task name issue type bug report ansible version ansible configuration no extra changes applied environment summary in role when variable is substituted into task name if one is taken from role invocation like role role variable value it is substituted correctly into task name name task variable results in `task value` however if variable is not provided in role definition but provided in any other way such as playbook invocation argument it is not recognized mentioned above task name results in `task variable however variable itself is recognized and substituted correctly in task details see steps to reproduce for details steps to reproduce create playbook create role `my role` run playbook as `ansible playbook playbook yml variable1 value1` expected results actual results as you can see variable is correctly substituted in debug statement but is not recognized in task name however if we replace role invocation as we receive expected result `default default is used because in case if variable is not defined we will receive recurcive loop when templating the variable also if we replace task name as without `variable1` definition in role invocation we get >>>bug_report
update doc to use become instead of sudo with latest version of ansible sudo is deprecated as argument and become is new argument as replacement so it will be good to have example which uses become also >>>docs_pull_request
variable precedence on include is spuriously overridden by set fact ve test case here https gist github com jan grant 5327259cc56f4e1f95fe basically if variable is set anywhere by set fact then the following will not override it this is think design flaw one should as much as possible be able to determine the behaviour of piece of code by examining it locally rather than taking global context into account ansible at least >>>bug_report p2
improve ssh py organisation and state machine had to reorganise the internals of ``ssh py`` to make the connection handling clearer ve tested this with various combinations of ``ansible pipelining n`` ``ansible scp if ssh n`` ``become n`` ``become method su sudo`` etc but more testing would be appreciated >>>bugfix_pull_request p2
winrm connections are not closed resulting in multiple winrshost exe processes on target node issue type bug report ansible version latest running from devel ansible configuration using kerberos winrm authentication environment ubuntu 14 04 control node windows 2012r2 nodes summary after running big playbooks see lot of processes from the ansible user account get the feeling that ansible doesn correctly hang up the connection working on repro across more nodes steps to reproduce fire multi task playbook against windows node using taskmanager view all the winrshost exe processes that get spawned but not terminated expected results ansible should close the winrm connection causing the winrshost processes to terminate actual results see steps to repro>>>bug_report p2 windows
add managed nodes requirement sftp subsystem hello availability of sftp subsytem appears to be crucial requirement that may render ansible broken if not met currently ansible doesn detect nor describe lack of sftp subsystem in meaningful way that would suggest to user that may need to make sure their managed systems meet this requirement or alternatively fails to suggest that scp if ssh true can be used to work around this problem request that http docs ansible com ansible intro installation html managed node requirements gets updated with note about sftp subsystem as managed nodes requirement ivan>>>docs_report
ansible won run on os if file permissions in library saved application state are incorrect in the `ansible utils plugins py` file in the `find plugin` function ansible is checking paths but fails if it can access files folders see https github com poetic short stack issues 48 my suggestion is that ansible should continue checking the other locations and not fail on permissions issue >>>needs_info
added support for generating otp tokens using filters adds two new filters secret totp token and secret hotp token at requires pyotp and complains if it not installed >>>feature_pull_request
upload alpha releases to pypi issue type feature idea summary it would be great if you could upload alpha versions to pypi pip will not install them by default requires usage of the pre` flag or manually specifying the version this would also allow testing if packaging is done properly before the final release is done as well as making it easier to install testcopy in venv etc>>>feature_idea
fix rsync connections to ipv6 addresses similar to https github com ansible ansible pull 11816 we can unconditionally wrap the host address in square brackets this is required by rsync for ipv6 addresses >>>bugfix_pull_request plugin
python fix typeerror unorderable types in test the full error was experiments show that python magicmock is true so setting the async property on mock task to if set it to the test fails anyway >>>feature_pull_request
add the new module replacer fixes 12266>>>bugfix_pull_request p2
add replacer for non python modules in v2 the module arguments file are no more passed to any modules even if the style of the modules are `non native want json` or `old` so we have to embed replacer in non python nor ps1 modules to pass module arguments it seems the name of the replacer is some kind of confusing and adding the new replacer the alias of would be helpful >>>bug_report p2
have module docs take advantage of multiple fragments in we added the ability for the extends documentation fragment field of module docstrings to take list of fragments the fragments are merged with the module docstring to form the complete documentation for the module this is especially useful when there an argument spec which is composed of several sub specs for instance the ec2 argument spec is composed of the aws common argument spec region parameter so we want the module docstrings for things which use the ec2 argument spec to use docstring extends documentation fragment like as part of this we also may have to create the new documentation fragments from the existing docstrings in modules >>>feature_idea
port modules from type str to type path in both the core and extras repositories we have modules that take file system path as parameter in the past each module needed to expanduser and expandvars on those to expand things like and home in we added new type to the argument spec path we need to port all of the modules to use that instead change the argument spaec to switch from type str the default to type path and change the code to not run expanduser and expandvars on the path second time good first approximation of the work is seen via grep expanduser lib ansible modules >>>feature_idea
added manjaro as an archlinux family fixes 12169 >>>bugfix_pull_request
unexpected exception maximum recursion depth exceeded when defining many vars at runtime issue type bug report ansible version `v2 alpha2` ansible configuration environment mac os 10 10 yosemite summary common pattern use in ansible roles to allow for variable defaults per os platform is to define variables like variable` in two platform specific `vars` files of which one is included at runtime then when the role is run there is task that checks if `variable` is defined without prefix if `variable` is defined then it will remain set as is but if not `set fact` sets `variable` to the value of variable` for example see the actual failing example in this role https github com geerlingguy ansible role php blob master tasks main yml l21 l24 what strange is that three earlier variables in the same role are defined the same way and they work correctly it bails on this fourth var steps to reproduce run playbook defining many variables at runtime one that uses the `geerlingguy php` role from ansible galaxy note that this error has so far been mainly tested by running the ansible playbook that part of drupal vm http www drupalvm com the quick start guide shows how to install dependencies and run the playbook locally using vagrant expected results the playbook run completes successfully actual results the playbook bails on the `define php extension conf path step full traceback >>>bug_report p1
setting forks 20 results in unexpected exception errno 24 too many open files issue type bug report ansible version `v2 alpha2` or latest devel and way back pre june at least ansible configuration environment mac os 10 10 yosemite summary ve had my ansible cnf `forks` set to `25` so certain operations would run bit faster across large numbers of hosts however when was using ansible devel branch tested with many releases from the past few months would get the following error if reduce the number of `forks` to 20 or fewer ansible runs fine and this error is never shown note that could set forks to astronomical numbers tested 100 200 500 and even 5000000 on my mac and there were no issues completing basic `ansible` commands like pinging all hosts steps to reproduce make sure you re running ansible devel either set `forks 25` in ansible cfg or run the following command with forks 25` run `ansible all ping` expected results ansible pings all hosts actual results ansible fails with the following debug output >>>bug_report needs_info
picklingerror can pickle issue type bug report ansible version ansible version ansible devel 70677b030b last updated 2015 09 04 20 34 36 gmt 500 lib ansible modules core detached head 2520627fe7 last updated 2015 09 04 20 34 36 gmt 500 lib ansible modules extras detached head 5cd0fab9d0 last updated 2015 09 04 20 34 36 gmt 500 config file users tanner projects ansible git playbooks git ansible cfg configured module search path none ansible configuration source hacking env setup environment os yosemite 10 10 python python summary please summarize your request in this space you will earn bonus points for being succinct but please add enough detail so we can understand the request thanks steps to reproduce inventory file vagrant inventory nagios server yml expected results expect the playbook to complete like it does with release actual results >>>bug_report p1
unable to run ansible commands issue type bug report ansible version ansible devel 70677b030b last updated 2015 09 04 16 32 33 gmt 700 lib ansible modules core detached head 2520627fe7 last updated 2015 09 04 16 32 38 gmt 700 lib ansible modules extras detached head 5cd0fab9d0 last updated 2015 09 04 16 32 42 gmt 700 ansible configuration transport ssh environment centos summary unable to run any ansible commands steps to reproduce ansible host1 ping expected results actual results as of commit 87f75a5 it worked but not with commit ff9f5d7 or devel>>>bug_report p1
create standard way to specify parameters to lookup plugins couple recent bugs lead me to find that lookup modules have variety of ways of specifying their parameters https github com ansible ansible modules core issues 1968 https github com ansible ansible modules extras issues 857 after some discussion we probably want to add an additional standard ways to specify and parse parameters to lookup plugins we officially support something like the following examples only exact syntax subject to change as it thought through we would deprecate the former methods of specifying parameters don know if we continue to support the current style of arg passing that has support from the code when used via lookup but not when used via when and that some plugins for instance password are currently ignoring these are ideas for post not enough time until then to work one of these solutions to completion >>>feature_idea p2
async status until with items issue issue type bug report ansible version ansible devel e32d887609 last updated 2015 08 10 11 43 41 gmt 300 lib ansible modules core detached head dea5f5d15e last updated 2015 08 10 11 44 11 gmt 300 lib ansible modules extras detached head 210ee3febc last updated 2015 08 10 11 44 34 gmt 300 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 10 11 45 01 gmt 300 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 10 11 45 29 gmt 300 ansible configuration default nothing changed environment running ansible on centos and managing centos summary want to start the set of async tasks and then check their status inside until loop during the checking ansible fails with error dict object has no attribute ansible job id steps to reproduce expected results no errors actual results >>>bug_report needs_info p2
synchronize with items doesn work with dev synchronize with items doesn work with branch devel works with stable d444ab507e >>>bug_report needs_info p2
feature request inventory ini py pattern matching support when used with dynamic inventories working on hybrid environment where there mix of different dynamic inventories not all supporting tags and some static ones it seemed logical to use the static files to group the dynamic hosts based on glob matching https gist github com halberom 17f12d67a11e64e49323 unfortunately the inventory ini py file only parses for static hosts or ranges would really like the ability to group based on globs regex this would allow me to easiliy say do things like which would allow nice single group currently have to do of the following manually add hostnames into the static file for grouping which defeats the point of using dynamic inventories use tags in aws to define groups and static entries in vmware and vagrant with completely different group names edit the dynamic inventory scripts ec2 py vmware py and vagrant py and add hosts to groups based on some regex format do dynamic grouping at the beginning of each play using add host >>>bug_report
add new filter strftime use the well known function to format date output here few examples ansible debug msg strftime localhost ansible debug msg strftime localhost ansible debug msg strftime localhost ansible debug msg strftime 1441357287 localhost >>>new_plugin
become clean fixed few misconceptions in the code cleared play context prompt as simple test for become password requirements >>>bugfix_pull_request p2
since version yum name state latest doesn work anymore hi since ansible yum update all packages doesn work anymore the same command works on ansible ansible yum name state latest failed changed false errors unexpected state failed true msg we should never get here unless this all failed results regards >>>bug_report needs_to_be_moved p1
unexpected syntax when using multi line tasks and local action local action should be task parameter issue type documentation report feature idea ansible version am currently using version `1 2` but this is probably true since `local action` and the syntax `module options` as opposed to `action module options as described here http docs ansible com ansible playbooks intro html tasks list both exist ansible configuration apart from personal coding style of multilining every options environment summary when using multi line yaml for module and its options using `local action` requires us to explictely type `module action` steps to reproduce for example consider this non local action to runs fine considering the local version of is one would expect this to work but this results in this however works but using single line or that last example is not suitable when all your playbooks are using this first syntax for consistency across your playbooks another solution that works is expected results am not flagging this as bug report because it not bug it merely how yaml works in the first place however documentation report it might be worth documenting the necessary `module action` statement in my opinion maybe in the yaml gotchas http docs ansible com ansible yamlsyntax html gotchas as it quite confusing when you stumble upon this feature idea what would be better though for user experience but also consistency with pretty much all every module parameter in ansible `name` `sudo` `with items` `tags` `notify` would be this yaml uri header content type application json url https api example com method post body status code 201 created local action yes>>>docs_report
verify aws key secret has sufficient permission to access aws services before hand have ansible pem to access ec2 instances through ssh and have setup `aws access key id aws secret access key` env variables on local machine for command line interaction using awscli tools if my aws keys does not have sufficient right ec2 vol module fails to attach ebs volume with error task ebs attach an ebs volume failed xx xxx xx xxx failed true parsed false become success fdqcthxzjixxkijwubcwvbrpewsoddzq traceback most recent call last file home ubuntu ansible tmp ansible tmp 1441346127 43 122295948181124 ec2 vol line 2260 in main file home ubuntu ansible tmp ansible tmp 1441346127 43 122295948181124 ec2 vol line 420 in main reservation ec2 get all instances instance ids instance file usr local lib python2 dist packages boto ec2 connection py line 585 in get all instances max results max results file usr local lib python2 dist packages boto ec2 connection py line 681 in get all reservations item reservation verb post file usr local lib python2 dist packages boto connection py line 1186 in get list raise self responseerror response status response reason body boto exception ec2responseerror ec2responseerror 400 bad request invalidinstanceid notfound the instance id xxxxxx does not exist 742e5c72 211e 4c65 8f88 797b9b5f5e4f openssh 2p2 osslshim 8r dec 2011 debug1 reading configuration data users xxxxxx ssh config debug1 reading configuration data etc ssh config debug1 etc ssh config line 20 applying options for debug1 auto mux trying existing master debug1 mux client request session master session id shared connection to 54 203 61 209 closed particular task that fails attach new ebs volume name attach an ebs volume ec2 vol instance ansible ec2 instance id volume size ebs volume size region ansible ec2 placement region device name sd next ebs device aws access key aws access key aws secret key aws secret key register ebs now from command line when run command aws ec2 describe instances output table query reservations instances instanceid instancetype don see particular instance in the output which confirm that aws keys does not have sufficient access rights or scope to access the instance so my question is how can validate that the aws keys have sufficient access rights to specific aws services what tried is list ebs volume name validate aws credentails ec2 vol state list instance ansible ec2 instance id region ansible ec2 placement region aws access key aws access key aws secret key aws secret key when attach ebs true register ebs instances however this task does not give me any error as above probably `list` command requires different level of access rights what was expecting was it should also fails as instance in question is same ansible version `ansible 2` am not sure if there is any way to verify access to certain services before hand so playbook does not fail in the middle >>>cloud feature_idea
v2 does not load host vars yml files issue type bug report ansible version devel ansible detached head a6de4b86a8 last updated 2015 09 04 09 54 40 gmt 200 lib ansible modules core detached head bbcfb1092a last updated 2015 09 04 09 54 04 gmt 200 lib ansible modules extras detached head b8803306d1 last updated 2015 09 04 09 54 04 gmt 200 config file configured module search path none ansible configuration none environment control host osx remote host debian summary hi version does not load host vars yml files steps to reproduce ansible playbook hosts load yml yml expected results actual results >>>bug_report p2
python use six text type instead of unicode replace unicode with six text type everywhere but in module utils >>>bugfix_pull_request easyfix
don try to run ssh stop in connection close the taskexecutor calls connection close after it finishes executing each task running ssh stop here would defeat controlpersist and force each task to create new connection that this didn actually happen was merely happy accident what was in self common args was actually controlmaster yes while the test only looked for controlmaster >>>bugfix_pull_request p1
authorized key module has documentation error documentation example authorized key user root key public keys doe jane state present exclusive yes but key public keys doe jane is not valid way to point to key file this error happens failed localhost failed true msg invalid key specified public keys doe jane fatal all hosts have already failed aborting the correct code should be lookup file public keys doe jane state present exclusive yes>>>docs_report easyfix
literal newlines in yaml vars are being ignored when using jinja filters in templates issue type bug report ansible version ansible playbook devel 7ece767767 last updated 2015 09 03 10 59 37 gmt 700 lib ansible modules core detached head bbcfb1092a last updated 2015 09 02 17 49 00 gmt 700 lib ansible modules extras detached head b8803306d1 last updated 2015 09 02 17 49 00 gmt 700 config file configured module search path none ansible configuration environment osx yosemite 10 10 to ubuntu 14 04 summary newlines within yaml var files don seem to be observed as they should within template with usage such as `environment app environment mandatory replace the behavior seemed to have changed it was working as described within the last couple of days or so since had last pulled to refresh ansible locally dev the current work around that have in place is just to flatten the environment variables myself ahead of time but it makes it more difficult to manage as you start to load in extra env vars steps to reproduce followed the steps provided in http blog paulopoiati com 2015 03 01 how do configure environment variables in ansible for supervisor configuration with ngnix unicorn rails relevant variables template expected results actual results >>>bug_report p2
task include lines with tags issue type bug report feature idea ansible version devel ansible detached head b2cb3153f1 last updated 2015 09 03 23 07 37 gmt 200 lib ansible modules core detached head bbcfb1092a last updated 2015 09 03 23 07 39 gmt 200 lib ansible modules extras detached head b8803306d1 last updated 2015 09 03 23 07 39 gmt 200 config file configured module search path root ansible library ansible configuration none environment debian summary version shows all task include included lines even when using tags it could become very noisy and confusing when it plays few tagged tasks on big playbook lots of task include lines vs few task name suggestion what about hide task include and included lines via new ansible cfg option steps to reproduce ansible playbook hosts include tags yml expected results actual results >>>bug_report feature_idea
low performance issue type bug report ansible version devel ansible detached head b2cb3153f1 last updated 2015 09 03 23 07 37 gmt 200 lib ansible modules core detached head bbcfb1092a last updated 2015 09 03 23 07 39 gmt 200 lib ansible modules extras detached head b8803306d1 last updated 2015 09 03 23 07 39 gmt 200 config file configured module search path root ansible library ansible configuration none environment debian summary hi unfortunately version seems slow down with real playbook v2 run within 32 secs v2 stable 19 secs same conditions target machine control machine no network congestions local net no network downloads steps to reproduce time ansible playbook hosts simplespeedtest yml dev null expected results ansible stable ansible detached head 066b7079ef last updated 2015 09 03 23 19 28 gmt 200 lib ansible modules core detached head dccef8f89a last updated 2015 09 03 23 17 15 gmt 200 lib ansible modules extras detached head 25595b4ecc last updated 2015 09 03 23 17 15 gmt 200 configured module search path root ansible library real	0m2 608s user	0m1 776s sys	0m0 464s real	0m2 476s user	0m1 656s sys	0m0 468s real	0m2 497s user	0m1 688s sys	0m0 444s actual results real	0m3 848s user	0m2 484s sys	0m0 496s real	0m3 524s user	0m2 208s sys	0m0 376s real	0m3 926s user	0m2 396s sys	0m0 544s>>>bug_report
handlers don execute tasks in included files issue type bug report ansible version ansible configuration no `ansible cfg` using defaults environment but running on mac os summary when include file in handler the tasks in the included file are not executed when the handler is called steps to reproduce `roles test tasks main yml` `roles test handlers main yml` `roles test handlers included yml` expected results the debug task in `included yml` should be executed actual results >>>bug_report p2
v2 extra new line after templated var defined in yaml as var issue type bug report ansible version ansible devel 7ece767767 last updated 2015 09 03 19 40 16 gmt 200 lib ansible modules core detached head bbcfb1092a last updated 2015 09 03 19 40 19 gmt 200 lib ansible modules extras detached head b8803306d1 last updated 2015 09 03 19 40 19 gmt 200 config file home serge src ginsys ansible data ansible cfg configured module search path none git bisect leads to following commit as the culprit ansible configuration environment ubuntu summary when defining variable with the yaml construct an extra newline is introduced when that variable gets templated steps to reproduce using following parts of role original files at https github com ginsys ansible role seafile tree relevant variables task template file expected results no changes in the templating when the role ran initially fine and made the template in v1 actual results in said version of v2 devel new line is introduced for what seems variables defined with the yaml `var construct >>>bug_report p2
ec2 dynamic inventory script can query stopped instances hi think found bug the script for getting the dynamic inventory of hosts from ec2 https github com ansible ansible blob devel contrib inventory ec2 ini has an option https github com ansible ansible blob e0a5003b275c0dc3dab98cf9759fbc934710e4cd contrib inventory ec2 ini l64 for specifying which states to query but according to my tests when set it to `stopped` won return any stopped instances even if have few for `running` instances it works all right it would be great if this could be fixed >>>bug_report cloud
fix typo to avoid traceback during testing if used as per document then test module will throw exception as below but after using updated code can able to get desired result also debug the issue using pdb and looks like we use first method then it will not able to get required option from argument and failed to parse it >>>bugfix_pull_request
python avoid iteritems in template don think six iteritems is available here but also don expect there to be enough platforms to ever make the speed difference between items and iteritems noticeable >>>bugfix_pull_request easyfix
template with force no reports changed only in checkmode issue type bug report ansible version ansible configured module search path none ansible configuration not relevant environment fedora release 21 twenty one 64bit intel summary subsequent runs of plays using template with force no work fine in normal run but trigger changed in checkmode steps to reproduce template no force check yml template j2 expected results one would expect the following in both cases actual results after initial first run >>>bug_report p2
make the way we build search pathes easier to understand get bin path build search path from three different sources an opt dirs argument the system path and fixed list of sbin directories the original implementation does not apply all sanity checks to all sources some are not checked for none for duplicates or for existence this implementation builds total list of directories in the same order as before and then applies all three checks to every directory must not be none must be unique and must exist in the filesystem with the resulting clean path list the same logic as before is applied >>>feature_pull_request
delete all compiled python files when running hacking env setup switching between branches got errors about modules missing error classes think this is because the errors module in lib ansible was moved to its own directory this clears our any compiled artifacts that shouldn be there >>>feature_pull_request
systemctl status on stopped process in handler fails with ansible devel 843138e7d9 last updated 2015 09 02 18 58 01 gmt 100 lib ansible modules core detached head bbcfb1092a last updated 2015 09 02 19 18 09 gmt 100 lib ansible modules extras detached head b8803306d1 last updated 2015 09 02 19 18 09 gmt 100 config file users matt development ansible ansible cfg configured module search path none yaml name ntpd restart service name ntpd state restarted enabled true running handler ntpd ntpd restart fatal testvm failed changed false failed true msg failure running systemctl status for ntpd root testvm systemctl status ntpd ntpd service network time service loaded loaded usr lib systemd system ntpd service enabled active inactive dead since wed 2015 09 02 19 34 27 bst 3min 16s ago process 21871 execstart usr sbin ntpd ntp ntp options code exited status success main pid 21872 code exited status success root testvm echo 3>>>bug_report p1
systemd check is slow in ansible devel 843138e7d9 last updated 2015 09 02 18 58 01 gmt 100 lib ansible modules core detached head bbcfb1092a last updated 2015 09 02 19 18 09 gmt 100 lib ansible modules extras detached head b8803306d1 last updated 2015 09 02 19 18 09 gmt 100 config file users matt development ansible ansible cfg configured module search path none the following code in pauses for several seconds whether the service has changed or not target os is centos systemd localhost is mac os under there is no pause >>>bug_report needs_to_be_moved p2
fix no log leakages to local output add tests re fixes 11946 for after 12188 re introduced the issue also fixes number of other leakages introduced with and adds integration tests to check most cases fixed herein >>>bugfix_pull_request p1
fact cache being ignored on ansible devel 843138e7d9 last updated 2015 09 02 18 58 01 gmt 100 lib ansible modules core detached head ef1f31c652 last updated 2015 08 31 21 19 36 gmt 100 lib ansible modules extras detached head 5b39e19387 last updated 2015 08 31 21 19 36 gmt 100 config file users matt development ansible ansible cfg configured module search path none default gathering smart fact caching jsonfile fact caching connection factcache fact caching timeout 86400>>>bug_report p2
error in included file doesn abort playbook run issue type bug report ansible version ansible configuration `no config file found using defaults` environment but am running on mac os summary failed task even in an included file should abort execution but as of the rev noted above it just skips the rest of that included file and playbook execution continues steps to reproduce `roles test tasks main yml` `roles test tasks included yml` expected results execution should stop after the `false` task in `included yml` actual results >>>bug_report p1
ansible vault trys to use raw unicode ciphertext for variables when using tag limitation issue type bug report ansible version ansible configuration default environment linux debian kali summary under specific circumstances ansible vault will fail to unpack the ciphertext and instead appears to pass raw unicode or the presented error is misleading as the variable content when using tags repeatable test case follows known workaround ensure you set tags for the `include vars` statement also steps to reporduce have provided basic files which demonstrate the issue as follows the ansible vault password for these basic files is `12345` where relevant hosts playbook yml role1 vars yml role2 vars yml roles role1 tasks main yml roles role2 tasks main yml expected results undefined variable error due to the tags missing on the `include vars` statement on role2 actual results success on no tag limits failure on tag limits >>>bug_report
documentation for vars plugins at http docs ansible com ansible developing plugins html there is not much about writing vars plugin there is link to https github com ansible ansible tree devel lib ansible inventory vars plugins but that is not pointing to anything useful please update the documentation on how to write vars plugin this is follow up to https github com ansible ansible issues 12156 >>>docs_report
vsphere guest parameters are required together resource pool cluster while provisioning vm using template there can be situations where resource pool is there but no clusters are configured present in such situations creating vm from template fails msg parameters are required together resource pool cluster can parameters resource pool cluster be made to work independently ansible regards alok>>>feature_idea
using variables in literal blocks strips trailing newlines issue type bug report ansible version and also v2 ansible configuration none whatsoever environment ubuntu 15 04 summary module argument loses the trailing newline if you use variables inside it steps to reproduce create `test yml` with the following contents `ansible playbook test yml` expected results actual results >>>bug_report p2
copy content var loses the explict trailing newline issue type bug report ansible version ansible configuration none whatsoever environment ubuntu 15 04 summary files created with the `copy` module using `content` lack trailing newlines despite me explicitly adding one this used to work in steps to reproduce expected results actual results >>>bug_report
test regex replace produces literal in v2 when used in standalone template issue type bug report ansible version ansible configuration none whatsoever environment ubuntu 15 04 summary commit 7f5080f64ab4a82648cb746990587c1aaff3f61d introduced regression now backslashes in standalone template files are doubled breaking them steps to reproduce expected results this is what expect and also what get with ansible also note that the file ought to have trailing newline since there was one in the source template actual results also note that the file lacks trailing newline >>>bug_report p2
added suport rsync protocol added suport rsync protocol work with ansible ansible modules core 1999>>>feature_pull_request
environment variables are templated issue type bug report ansible version ansible configuration environment but running on mac os summary get `error template error while templating string unexpected when trying to use jinja2 filter steps to reproduce `roles test tasks main yml` expected results successful playbook execution in this case just printing baz actual results >>>bug_report p2
ec2 py list of tags linting fixes add part of changes from 7601 tag based ec2 inventory names add support list of tags many linting fixes including 11901 linting fixes for ec2 dynamic inventory script >>>bugfix_pull_request cloud feature_pull_request
errors when using different hostnames am using python centos hosts file c3puimmsrv1 premierinc com c3puhiws2 premierinc com c3puhiapp1 premierinc com c3dumcoamq1 premierinc com get different errors with the same command vagrant devops ansible hosts all ping jegger c3puimmsrv1 premierinc com success changed false ping pong c3puhiws2 premierinc com failed changed false failed true msg error ansible requires the stdlib json or simplejson module neither was found c3puhiapp1 premierinc com failed changed false failed true msg file home jegger ansible tmp ansible tmp 1441131111 73 207143967228926 ping line 213 return dict convert convert for in node items nsyntaxerror invalid syntax parsed false c3dumcoamq1 premierinc com success changed false ping pong >>>bug_report needs_info
search filter on an undefined variable returns non descriptive error in templates trying to use this template fails with non descriptive error when `stringg` is undefined the error is typeerror expected string or buffer the error should be ansibleundefinedvariable one or more undefined variables stringg is undefined in plays the error is failed to template if undefined search abc true else false endif an unexpected type error occurred error was expected string or buffer>>>bug_report
problem with ansible on os hi guys have some trouble can anybody help me ve reinstalled all that can python ansible what may do thanks lot omykolaichenkos macbook pro playbooks oleg ansible testserver hosts ping traceback most recent call last file usr local cellar ansible libexec bin ansible line 197 in runner results cli run options args file usr local cellar ansible libexec bin ansible line 121 in run inventory manager inventory inventory options inventory vault password vault pass file usr local cellar ansible libexec lib python2 site packages ansible inventory init py line 128 in init self parser inventoryparser filename host list file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 43 in init self parse file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 47 in parse self parse base groups file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 108 in parse base groups tokens shlex split line file usr local cellar python frameworks python framework versions lib python2 shlex py line 279 in split return list lex file usr local cellar python frameworks python framework versions lib python2 shlex py line 269 in next token self get token file usr local cellar python frameworks python framework versions lib python2 shlex py line 96 in get token raw self read token file usr local cellar python frameworks python framework versions lib python2 shlex py line 191 in read token raise valueerror no escaped character valueerror no escaped character >>>bug_report needs_info
bug report variable defined in `group vars` not picked up by `when` version ansible configuration vanilla environment summary repro steps actual results expected results made repo with repro steps here https github com blagarde ansible groupvars bug tree master >>>bug_report
make combine vars compatible with python fixes typeerror unsupported operand type for dict items and dict items on python making very small pull requests to make review easier please tell me if you find that inconvenient >>>bugfix_pull_request
with subelements example from documentation doesn work hello really get lost spent days with playbook trying to use `with subelements` feature after all tried to run example from documentation http docs ansible com ansible playbooks loops html looping over subelements use `debug` module here but playbook fails on sub loop and issue happens only if second list uses nested subkey like `mysql hosts` and you can see at `debug var users` and fatal error report that `mysql hosts` does exist indeed was thinking that it issue with key declaration but mysql hosts `mysql hosts or mysql hosts do not help sorry if missed something but really was too close to commit my mental disorder while was debugging this ansible is with python thanks >>>bug_report needs_info
moved winrm setup script test after config the original placement of the connectivity test prevents the https configuration from being applied on machines that weren previously configured for https and where http is disabled by default moving the test to the end ensures the highest probability of success >>>bugfix_pull_request windows
ansible hostvars directory seems to assume different path for host vars with limit is used this bug report is result investigating https groups google com forum searchin ansible project limit 20hostvars 20 ansible project zz12kpioe2s rfdotpnmkgaj it turns out that the host vars directory must be relative to the inventory file when the host is not included in limit ansible can define any such requirement but note that it is inconsistent to be more liberal with the placement of the host vars directory when file is not excluded with limit if the host is included in the run either the directory relative to the playbook can be used or the directory relative to the inventory file to reproduce see the project in http feliksik nl ansible limit tgz structure which structure looks as follows modify inventory to your environment of course there is the following calls possible root1 ansible playbook inventory playbook yml limit inlimit root2 ansible playbook inventory playbook yml limit inlimit outlimit sub1 ansible playbook sub inventory playbook yml limit inlimit sub2 ansible playbook sub inventory playbook yml limit inlimit outlimit expected behaviour if root2 works then root1 should also work if sub2 works it is legal for the host vars directory to not be in the same directory as the inventory file then sub1 should also work actual behavior root1 works root2 works sub1 fails sub2 works >>>bug_report
with fileglob requires full path am using ansible version the issue is when use variables in the path of withfile glob ansible play is skipping this step and continuing with fileglob roles files vob name app name version number config j2 sample out from the play task getting the list of j2 config files to be copied for bridge skipping ld chctf appl03 cttest local but when use values for those variables and run it then the play is able to find the files sample output below task getting the list of j2 config files to be copied for bridge changed ld chctf appl03 cttest local item somepath esomename cfg j2 changed ld chctf appl03 cttest local item somepath esomename xml j2 is this known bug or am doing something wrong thanks robin>>>bug_report pending_closure
support for serial on an individual task feature idea the natural way to handle configuration or other updates that require rolling restart would be to perform updates in parallel then notify handler which performs restart with `serial` but this is not possible requiring either manual rolling restart or ugly hacks see https groups google com forum topic ansible project rbcwzxjt xc>>>feature_idea
ansible os family na on manjaro host issue type bug report ansible version ansible ansible configuration standard environment running virtualenv on arch summary ansible os family returns na for my manjaro machine steps to reproduce ansible setup grep ansible os family expected results actual results >>>bug_report
minor tweaks to the blocks documentation >>>docs_pull_request needs_revision
become pbrun doesn allow to execute multiple commands pbrun doesn allow to run multiple commands by joining them with or ansible v1 pbrun v7 02 hence the command generated by ansible to launch python remotely together with echo become successfull fails at every attempt the culprit seems to be line 1256 in lib ansible utils init py becomecmd exe flags user pipes quote echo success key cmd have no idea why to run the echo with elevated rights maybe someone could explain it to me but when changing this line to becomecmd echo success key exe flags user cmd seems to resolve the issue >>>bug_report needs_info p2
error while building the rpm rpm build errors file not found by glob usr local src ansible rpm build buildroot ansible git201508310021 6b73cac devel amzn1 x86 64 usr lib python2 dist packages ansible make rpm error usr local src ansible rpm build buildroot ansible git201508310021 6b73cac devel amzn1 x86 64 usr lib python2 site packages ansible >>>bug_report
be systematic about parsing and validating hostnames and addresses this adds parse address pattern utility function that returns host port and uses it wherever where we accept ipv4 and ipv6 addresses and hostnames or host patterns this is proof of concept for how think it should be done some changes are needed for example we may want to be bit more restrictive about hostnames foo should be disallowed and few other details may need to be cleaned up but this is solid foundation and it should be backwards compatible as well see also discussion in 11747 welcome feedback reviews testing cc abadger srvg ryanpetrello>>>bugfix_pull_request feature_pull_request
change hacking scripts to python3 syntax improve compatibility with python3 >>>easyfix feature_pull_request
fact gathering service mgr info one of the steps needed for 12091>>>feature_pull_request p2
getting ssl issue again msg failed to validate the ssl certificate for get docker com 443 use validate certs false or make sure your managed systems have valid ca certificate installed paths checked for this platform etc ssl certs etc pki ca trust extracted pem etc pki tls certs usr share ca certificates cacert org etc ansible this is with ansible version read on another bug that this is fixed in development branch does this mean my only options are to do this insecurely false or run the alpha branch >>>bug_report
importerror cannot import name ansibleoptionserror in v2 alpha1 release hi there am huge fan of ansible and just figured out some new features in the `v2 alpha1` that immediately wanted to give try when download and extract this release though on my mac get the following error when invoking bin ansible` this error does not happen in any of the previous releases of v1 >>>bug_report needs_info pending_closure
configuration variable for the openssh known hosts file issue type feature idea ansible version ansible ansible configuration environment summary please add way to configure the openssh known hosts file `ansible ssh known hosts file` steps to reproduce have playlist that builds up an openstack cluster and another playlist that configures the systems in the cluster my first playlist generates known hosts file and want to use it in my other playlists expected results like to be able to set `ansible ssh known hosts file keys known hosts` in my `ansible cfg` and have that `known hosts` file get picked up by ansible actual results currently plugging the `known hosts` file into the second playlist via `ssh args userknownhostsfile in my `ansible cfg` the downside of the workaround is that must specify all the arguments that ansible would use like `controlmaster auto controlpersist 60s` in my `ansible cfg` this isn elegant and would introduce extra work every time want to upgrade ansible looked around the codebase bit and can probably put together pr if this is desirable and if get bit of advice the relevant code for openssh seems to be here https github com ansible ansible blob devel lib ansible plugins connections ssh py l100 the paramiko code seems to be here https github com ansible ansible blob devel lib ansible plugins connections paramiko ssh py l152 https github com ansible ansible blob devel lib ansible plugins connections paramiko ssh py l157 haven looked into how configuration variable gets plugged all the way to the connection plugins also not sure of how test the code the unit test for connection plugins is rather slim https github com ansible ansible blob devel test units plugins connections test connection py please help >>>feature_idea
include with sudo yes not working in latest devel 6154ed hey it seems that included tasks ignore the sudo yes specifier ve pushed new commit on my https github com sebi hgdata ansible test repo to reproduce the issue jimi >>>bug_report p2 pending_closure
feature master plugin path in configuration v2 brings sanity to the organization of plugin code with core by placing them under one master plugins path with subdirectories of the different types https github com ansible ansible tree devel lib ansible plugins that sanity should be reflected in the configuration with the ability to configure external master plugin paths for all plugin types with one line in ansible cfg rather than multiple configuration parameters for each plugin type paths for callbacks filters etc so where you have external ansible plugins like you currently have to do with this proposed feature user would only need this master plugin path configuration directive could support multiple paths like others of its kind jimi bcoca >>>feature_idea
feature idea extendable variable manager would like to be able to extend replace the ansible variablemanager so that would be able to define custom hierarchy of groups group category stage contains groups dev test preprod and prod other groups web db whatever is defined as group vars for web or db should be overriden by anything in the group category stage this could be mapped to directory structure web db dev db web test this hierarchy could be defined as group categories stage dev test preprod prod other groups web db hierarchy stage stage other groups other groups >>>feature_idea
include with items passed last list items multiple times given srvio yml gets called three times but interface is always eth2 expectation is that each of eth0 eth1 eth2 get passed in order >>>bug_report p2
variable in handler regression issue type bug report ansible version ansible configuration environment local darwin heron local 15 darwin kernel version 15 mon aug 10 17 09 09 pdt 2015 root xnu 3247 99 release x86 64 x86 64 i386 macbookpro11 darwin remote centos summary in the role handlers mail yml throws replacing the variable with the service name works this worked under steps to reproduce see above expected results variable value gets inserted service reloads actual results see above >>>bug_report p2
directory with the name home is created when ansible playbook is called from java program we have java program that will run ansible playbook when it launches new vms in aws it creates directory named home in the directory from which call the java program the contents of this directory look like this the java program is using apache commons exec library to call ansible playbook the actual call looks something like this the playbook actually executes just fine but pretty sure this behaviour was not intended and it definitely little weird looking to see home just appear all of sudden this is happening using ansible version on ubuntu 14 04 >>>bug_report needs_info
unable to splat arguments in windows script ansible version os rhel recently upgraded from ansible to since then splatting has stopped working this was originally fixed in https github com ansible ansible pull 10664 as discussed on https groups google com forum starred ansible project jojvfohowqm this pull request included some unit tests that seem to have been removed added them back and ran test flags test win script etc ansible hosts make test winrm task test win script run test script that takes parameters passed via splatting changed server changed true rc stderr stdout task test win script check that script ran and received parameters via splatting failed server assertion test script with splatting result stdout lines this evaluated to false failed true fatal all hosts have already failed aborting if you change line 60 of usr lib python2 site packages ansible runner shell plugins powershell py to be return join cmd parts and then re run the unit tests they all pass task test win script run test script that takes splatted parameters from variable changed server changed true rc stderr stdout this nthat nother task test win script check that script ran and received parameters via splatting from variable ok server msg all assertions passed >>>bug_report windows
devel logic difference vs start at task passes gather facts and goes directly to task the logic seems to have changed for the start at task flag in v1 it will run gather facts if enabled and then jumps to the task while in devel it jumps straight to the task is this intentional expected devel acts the same as and runs gather facts actual it skips>>>bug_report p2
fixed spelling error on line 67 noticed while running ansible from the current build throws error nameerror global name tself is not defined due to the fact that self is misspelled edit have confirmed this fixes my error with the unarchive module after editing my local copy to reflect accordingly and thus this change should be good to go>>>bugfix_pull_request p2
link to `constants py` in the source tree from the documenation `constants py` is referenced in the environmental configuration section of the documentation this change provides link from the documentation to the source code >>>docs_pull_request
role foo when bar is defined runs without evaluating the condition heya found some weird behaviour going on in response to the construction in ansible role blah when blah is defined for this snippet get this output expected behaviour comparators work the same for tasks and roles actual behaviour comparison operators other than `is defined` seem to evaluate correctly for roles this works fine for example role check mk when random var 45 running role conditionally on an `is defined` statement always runs the role the `is defined` comparator does not seem to be evaluated correctly any insight into it much appreciated even if it just oh that was fixed in version >>>bug_report needs_info
add no syslog option in order to prevent ansible syslog its actions on the remote host rebase 11502 add no syslog option in order to prevent ansible syslog its actions on the remote host syslog on remote hosts can be turned off by no syslog option inside ansible cfg no syslog command line options ansible and ansible playbook rebased version of 11502>>>feature_pull_request
add rudder inventory plugin dynamic inventory script using groups and nodes from rudder https www rudder project org site inventory requires six httplib2 environment variables rudder ini path optional rudder api uri rudder api token rudder api version optional >>>feature_pull_request
restore ansible library lookup add to ansible doc verified that lookup order is the same as modules in library are preferred to built in follow on fix for issue 12016 bcoca >>>feature_pull_request
python use print as function under contrib this fixes the remaining python syntax errors so re enable compileall for contrib again >>>bugfix_pull_request
mention combine and the vault improvements in the changelog>>>docs_pull_request
fixed line break causing part of the text to display as definition list which sphinx renders in bold >>>docs_pull_request
module not found when using delegate to 127 in playbook delegating to 127 this errors out with module not found when running off the v2 codebase the actual task can be found here https github com trondhindenes ansibleroles winreboot blob master tasks main yml when running on the v1 codebase everything works using the same module in an ad hoc command works fine on both v1 and v2 the stat module is exactly where it should be so guessing there some bug with delegate to using v2 >>>bug_report p2
new version of vaultaes256 no padding base64 output plus some cleanups these don alter any functionality but they set the stage for comprehensive improvements in the aes256 cipher while maintaining backwards compatibility more easily than was possible before these simplifications will eventually also make it simpler to complete the ``vaultfile`` prototype and enable transparent vault usage from playbooks >>>feature_pull_request
when pip installing pip check mode is always changed with task that tries to install specific version of pip if run in check mode the task appears as changed even if the correct version of pip is installed pip filters pip out of freeze output https github com pypa pip blob ec46a3bac4cc19930e1da8abc1a0d704ab05841c pip operations freeze py l16 maybe `pip list` can be used instead of `pip freeze` to check that version of package is installed since `pip list` does not filter as aggressively >>>bug_report
role dependency task include file respects vars main yml vars differently seen with ansible this is very specific case when role has dependency on another role and the dependent role conditionally on variable set in `vars main yml` includes task file in its `tasks main yml` it does not respect the overwritten variable set in upper role `vars meta yml` here is an example test yml roles test role tasks main yml roles test role tasks included yml roles test role vars main yml roles test role meta main yml roles test role2 vars main yml roles test role2 tasks main yml roles test role2 tasks included yml output the `included yml` in `test role2` should have never been included because when the outer role defined the dependency `second role include false` the variable that was passed in was honored note that when the outer role was called in the `test yml` `first role include` was respected if the `second role include` is defined in `roles test role2 defaults main yml` it is respected >>>bug_report
`delegate to` not using any ssh user issue type bug report ansible version `devel` 5ba3452b7ee0e2abdf61d528e385057faff9e584 ansible configuration added default `remote user` and default ssh key file environment tried on ubuntu 14 04 and amazon linux 2015 03 summary when `delegate to` the ssh connection is tried without an ssh user steps to reproduce delegate like so on amazon ec2 expected results disable server in haproxy backend actual results gathering facts about haproxy in an earlier step works but ssh cannot connect to haproxy when delegating user none >>>bug_report needs_info p2
remove deprecated and unused vaultaes encryption code now that vaultlib always decides to use aes256 to encrypt we don need this broken code any more we need to be able to decrypt this format for while longer but encryption support can be safely dropped >>>bugfix_pull_request p2
using group by with ansible container causes everything to be added to the same group issue type bug report ansible version ansible configuration reproduced with default config environment solaris 10 11 summary with certain keys `group by` dumps all hosts into the same group regardless of expected differences in the keys can reproduce the below problem using the `ansible container` variable but not the `ansible virtualization type` variable it not clear to me how these variables differ in nature steps to reproduce in this example `host z` is container and `host g` is not container expected results actual results >>>bug_report
template with home as dest searches for the dest file ansible error failed vagrant item root failed true item root path root file state absent msg file root file is absent cannot continue this solves the problem >>>bug_report
error when rendering stdout output that contains sequence have command that greps ps output for varnish processes one of these processes is the varnishncsa process which has log format syntax similar to jinja2 when the debug command tries to render the lines it generates an error have not found way to work around this without modifying the grep command for example adding either of the following will fix the problem this seems rather hacky though and distorts the output obviously it would be nice to have filter or something to mark the output as to not be templatized >>>bug_report p1
adding support for archlinux and slackware in fallback in some cases archlinux and slackware is not detected by platform dist this should solve the issue >>>easyfix feature_pull_request
vault files are times bigger than they need to be the current vault formats encode binary data as hex add some newlines encode it as hex again then wrap at 80 columns this results in data files that are times bigger than the encoded binary data suggest using base64 once instead which would result in data files that are only 35 times bigger my primary motivation is shorter `git diff` output for changes in encrypted vault files this could perhaps be done at the same time as dropping the unneeded pkcs padding pr 10634 since it would require introducing new format version >>>bug_report feature_idea
synchronize destination host not interpolated issue type bug report ansible version environment gentoo summary having defined `ansible ssh host some variable in group vars results in synchronize calling `rsync path to src root some variable path to dest` the destination host is not replaced by the actual value before the call resulting in an error `could not resolve hostname some variable steps to reproduce in playbook in etc ansible group vars your group in etc ansible host vars some host expected results expect synchronize to call `rsync path to src root xxx xxx xxx xxx path to dest` actual results >>>bug_report p2
some steps towards python support this makes tox py34 pass the compileall step successfully and actually start running the tests plus fixes some but not all of the test failures want to keep this pr small and as close to obviously correct as possible to avoid the fate of 10838 >>>bugfix_pull_request easyfix
make sanitze output function catch other forms of passwords the motivation for this change is that we have some shell commands that contain passwords in the arguments and when running ansible with verbosity vv in build environment like jenkins those passwords would then get captured in the logs this change detects some other common password keys that one might find in cli tool argument like those passed to the mongo shell includes strings like foo password foo password foo password foo >>>feature_pull_request
synchronize wrong error reported using synchronize with ansible the real cause for the error was that rsync was not installed please let me know if it solved or related to another issue >>>bug_report needs_info
added oracle virtual manager inventory provider very similar in philosophy as the ec2 inventory script configuration is in the script for compatibility with tower if there way to have multiple files as inventory scripts with tower please let me know >>>feature_pull_request
fixed hostvars access in conjunction with limit usage ignore limits and restrictions is only checked for false value but decided to leave it this way to emphasize that this is opt out functionality not opt in >>>bugfix_pull_request p2
add optional logging to consul io inventory script configured with environment variables ansible inventory consul io log enabled ansible inventory consul io log level debug path to consul io py list this gives some verbose logging including showing all http requests being made which am finding useful as am trying to improve the performance of this script cc sgargan sudarkoff aconrad>>>feature_pull_request
implement cat like filtering behaviour for encrypt decrypt as discussed on irc this includes some minor functionality preserving cleanups for vaulteditor and uses this to implement the stdin stdout encryption decryption semantics requested by bcoca and abadger >>>feature_pull_request p2
some options not preserved from ansible cfg issue type bug report ansible version devel ansible configuration ask pass true environment sles11sp2 sp3 summary some options from ansible cfg are not preserved during processing similar but didn fix all affected options https github com ansible ansible commit 0de83ad2890ff6bb7a98572010e9148cc192a864 steps to reproduce set ask pass true in ansible cfg run ansible it will not prompt for password expected results ansible should prompt for password actual results ansible does not prompt for password notes looking at the fix linked above found the following in lib ansible cli init py 306 should use the values from constants py similar for others as well parser add option ask pass default default ask pass dest ask pass action store true >>>bug_report
ansible lockdown added minor editing added info link for ansible lockdown to mailing list section minor editing can help myself it seems to the paragraph about subscribing from non google account>>>docs_pull_request
duplicated role dependencies don get executed hi ve made very basic gist to demonstrate the current issue that having https gist github com thegiantbeast 90efb8cb1a08cdef8c0b the problem is that role installversion pkgversion currentversion is only executed once although the `currentversion` keeps changing between executions check output believe this is related with what ve seen people mention as signature because the task content variables never change between them only the actual variables content even tried with `allow duplicates true` before `dependencies but it didn work either this might be related with 9578 and 11707 as well but can confirm if that the case the current workaround that ve found for this is to add an extra read never used variable that changes between the execution blocks example but this is not scalable if you have block with 10 or more roles has anyone ever saw this issue not 100 sure if this is bug or an expected behaviour and if it an expected behaviour what the best way to do implement other than adding an extra variable >>>bug_report needs_info
vars plugins not gathered when inventory is string when passing inventory as hostlist form ansible playbook foo yml host1 vars plugins are not assigned correctly and do not get executed this worked for me it moves the self vars pluigins assignment out of the if elif of parse inventory diff git lib ansible inventory init py lib ansible inventory init py index d25409b 00002aa 100644 lib ansible inventory init py lib ansible inventory init py 124 124 class inventory object should never happen but jic raise ansibleerror unable to parse as an inventory source host list self vars plugins for in vars loader all self self vars plugins for in vars loader all self fixme shouldn be required since the group host vars file management will be done in variablemanager am not sure if there some other change in behavior that should be accounting for in my vars plugin rely on the get host vars function being called from my plugin >>>bug_report p2
synchronize fix error ran into an error using synchronize it is not valid to delete dictionary elements while iterating it >>>bugfix_pull_request p1
v2 fails to pick up plugins from action plugins steps to reproduce create module `library foo py` create plugin `action plugins foo py` create playbook that runs task `foo` run the playbook expected behavior ansible uses the actionmodule defined in `action plugins foo py` and this is in fact what happens with ansible actual behavior ansible v2 actually imports `action plugins foo py any print statements at the top level are executed but then ansible v2 uses `ansible plugins action normal actionmodule` to run `library foo py` >>>bug_report p2
don compile py files under tox tox py26 would fail for me because python compileall would crawl under tox py27 and unsurprisingly get syntaxerrors on files from the python standard library using syntax features not supported by python >>>bugfix_pull_request easyfix needs_info
fix typo remove redundant paragraph the bit about git rebase vs git merge is repeated in the paragraph below the bit about test integration is repeated in the paragraph above and the bit about aliasing git pull to git pull rebase is unclear since git aliases cannot override builtin operations >>>docs_pull_request
should not scan for ssh host key for git urls issue type bug report ansible version also `devel` source by inspection ansible configuration being run under vagrant but nothing here should affect the code involved environment vagrant linux ubuntu 12 04 14 04 x86 64 summary please see https github com ansible ansible blob 9f9891df2ca87d6adf9b6267846432abd7d3b3f3 lib ansible module utils known hosts py l72 if given an unencrypted git url `git host repo git` ansible should not scan for the ssh host key the host might not have ssh server running at all it makes sense to scan in case of `ssh user host repo git` and `git ssh user host repo git` though in both of those cases the first part of the compound condition matching `ssh` will be hit note that the `git protocol is the unencrypted thing that runs on port 9418 which is probably not good idea to be running on the internet steps to reproduce somewhere in the playbook make sure `host` does not in fact run sshd expected results ansible does not attempt to fetch the ssh host key actual results workaround add `ssh opts stricthostkeychecking no to the config this gets tricky if git submodules are involved and you do need the hostkey for some repositories but `git urls for others thanks for reading >>>bug_report
minor visual issue on the search page with the sort by drop down issue type documentation report environment chrome 44 osx summary the search page filter copy extends outside of the box steps to reproduce search for anything expected results sort by text is inside of the box actual results it not inside of the box >>>docs_report
incorporate ansible shell from the existing https github com dominis ansible shell blob master ansible shell as was attempted here https github com ansible ansible pull 8030>>>feature_idea p2
ansible inventory cli this would incorporate the existing 3rd party ansible inventory shows hosts and associated vars https github com srvg ansible plugins blob devel bin ansible inventory ansible inventory grapher shows graph of inventory group and host relationships https github com willthames ansible inventory grapher ansible inventory enable feature to help users setup and manage dynamic inventory sources included with ansible contrib inventory >>>feature_idea
split service module service in devel is now like package wrapper to existing service modules but right now its is just service like package it allows user to override detection two more steps are needed ansible service mgr fact must be added to setup py systemd upstart rc initd etc service modules must be created mostly from splitting code from existing service py this will allow the individual modules to support more custom options that only affect those init systems related 12023 https github com ansible ansible modules core issues 1616 https github com ansible ansible modules core pull 1955 https github com ansible ansible modules core pull 1909 https github com ansible ansible modules core issues 1673 https github com ansible ansible modules core issues 1749 https github com ansible ansible modules core issues 1479 https github com ansible ansible modules core pull 1478 https github com ansible ansible modules core issues 191>>>feature_idea p2
update cobbler py inventory script to more fully leverage cobbler management fields refactored to leverage cobbler system profile and management class parameters to produce more robust and exact output all configurable in cobbler ini assigning system objects to groups based on owners and or status and or profiles and or management classes assigning groups to parent groups based on the special management class parameter parent only one parent per class is currently supported assigning group and hostvars based on either or both ks meta params or management parameters optional have system objects inherit vars from their respective profiles optional only include system objects with at least one interface management limitations there is no good way to assign groupvars or children to groups based on owners or status currently parents can not be assigned in profiles and only one parent can be assigned per child group this could be added easily tested with cobbler also refrained making two other changes before got some maintainer feedback first while the script will still support earlier cobbler versions that lack management groups it seems to me that using the system object management tab as the primary driver of the ansible inventory is the best practice moving forward with that in mind only coded parent children management to be based on management class params not ks meta or mgmt parameters from systems or profiles secondly next good step should be to add parents field to the management class dict separate from mgmt class params where multiple parents are separated by whitespace wasn sure if we should support multiple parents before that change but if we did also wasn sure what the best cobbler way to make this assignment either comma separated whitespace or something else finally this is the most python coding have ever done am very green so please provide suggestions if my code is messy or too complicated thanks greg chavez>>>feature_pull_request
autodocument all plugins as we currently keep module docs in the modules themselves and use that to generate docs both in ansible doc and docs ansible com we should be able to do the same for lookup callback connection filter inventory vars etc plugin types the current python variables way is bit onerous something based on docstrings might be easier and not interfere with execution >>>feature_idea
allow fine grained fact gathering allow doing subsets of current facts or the inclusion of any existing facts module default is current setup module full facts >>>feature_idea
add vault unvault filters they should take in string and create vault hash vault or take in vault hash and return the containing string unvault >>>feature_idea
make with loops configurable how forks pause squash name label item name end on fail with items >>>feature_idea
allow for multi record yaml documents currently if you put more than one yaml record document in file ansible will error out be it play or vars file changing the loading from load and safe load to load all and safe load all will allow for multi record yaml files this also needs to document behavior when there is conflict >>>feature_idea
v2 doesn find variables in playbook scope have very very simple playbook located at cluster client yml` running it with this command works in ansible v1 but fails in ansible v2 with error cluster user is undefined the inventory file is located at environments prod cluster inventory` and there environments prod cluster group vars cluster cluster client yml` file that contains cluster user admin importantly variables defined in that file work everywhere else if hardcode remote user to admin in the playbook the initial error is bypassed and cluster user as well as other vars defined in the same yaml file work as expected in the `cluster client` role >>>bug_report
speed up execution `if method in dir self is very inefficient it must construct list object listing all the object attributes methods it must then perform linear scan of that list replace it with the idiomatic `if hasattr self method which is expected time hash lookup should fix 11981 or at least part of it >>>bugfix_pull_request p2
variable gets overwritten by another role in v2 have playbook that includes two roles my `roles app defaults main yml` has this my `roles roundup defaults main yml` has this my `roles app tasks main yml` tries to use the `home` var when run this playbook with ansible get user `app test` with home directory apps zopes app test` when run this playbook with ansible get user `app test` with home directory apps roundup bugs` thought ansible was supposed to be 100 backwards compatible with playbooks tested with ansible >>>bug_report p1
delegate to an ip adress not working playbook lineinfile dest etc hosts regexp inventory hostname insertafter ansible plateform plateform line ip inventory hostname inventory hostname novalocal state present delegate to 10 222 123 321 sudo yes result ssh tt vvv controlpersist 15m users jeff ssh config controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user toto connecttimeout 10 audvndb01 umask 22 mkdir home ansible tmp ansible tmp 1440494310 89 46378754806660 echo home ansible tmp ansible tmp 1440494310 89 46378754806660 ansible try to execute the command on the host audvndb01 instead of 10 222 123 321>>>bug_report p2
back out buggy optimization backing out implicit block squash optimization which causes include files to skip next task in playbook see so question for details http stackoverflow com questions 32194194 ansible multiple include with multiple tasks 32194489 32194489>>>bugfix_pull_request p1
remove python style encoding from the beginning of custom modules not written in python v2 adding python style encoding to the beginning of custom modules not written in python prevents execution https github com ansible ansible blob devel lib ansible executor module common py l45 seems to be the cause of this in nodejs as is not valid comment and results in the following error the same custom module is currently working in >>>bug_report p2
unicode and other fixes for vault the python3 work on vault broke vault handling of unicode this patch fixes vault so that it only deals in byte strings inside of the ciphers vaultlib and vaulteditor can take in either byte strings or unicode strings and will convert using utf before passing the data on to the ciphers nonessential changes include prefixing variables in vaultlib containing byte strings with so that it easier to tell what the contents of var are vaultlib is the only class that needs to know whether its dealing with bytes or unicode the other classes should only be given byte strings by vaultlib or else pass their data on to vaultlib to do the conversion so it seemed like the class most in need of this make sure that when we read in file in parsing init py that it is read as byte string nad then we convert it to unicode type either via vaultlib or inside of that method if it paintext convert lists to frozensets since they are only being used to do containment tests correct few typos in the to be used in the future vaultfile code fix the optimization that does not resave unchanged vault files to still resave the file if the old vault was vaultaes instead of vaultaes256 made conversions from bytes to unicode throw errors instead of replacing unknown chars with in this case we re dealing with very precise formats so we don want to mess those up here set padding bytes to encode in the ascii encoding this should never matter believe that the character can only be codepoint 16 here but the code will definitely do the wrong thing if the padding is multibyte character so doing this may catch future coding errors >>>bugfix_pull_request
new filter human bytes convert string ex 1mo 1k into bytes this pr replace part of this one https github com ansible ansible pull 11896 add human bytes filter this filter take an input string and convert it into bytes here some examples 2m bad size unit foo bad number or no number at all as side note add tests for human readable and human bytes filters in test filters yml playbook >>>feature_pull_request
add new size computation on mountpoint used space block size used this pull request is split of the following pr https github com ansible ansible pull 11896 during fact gathering the module compute new values including used space block information size total available used inode information total available used >>>feature_pull_request
no attribute ansible facts after registered set fact task with loop and when condition hello followed recommendation how to use set fact but get either bug or feature this code works great and get list of ips for all hosts in mytest group problem come when want to exclude host which is currently in play use rax py as dynamic inventory but it seems not cause result is failed on second set fact task though `debug var servers result` shows expected data structure where `servers result results` has list of dict with `ansible facts servers item` element and an ip there and there is no host where this task is currently playing because excluded by `when` ansible is thanks >>>bug_report needs_info
typecast variables are not preserved issue type bug report ansible version ansible ansible configuration environment summary have role like below that typecasts variable to an int however this appears to be converted back to string by jinaja2 ansible then throws this error msg value of payment term must be one of 12 24 got because it was not valid int steps to reproduce at the moment this is breaking the linode module or any module that relies on an int with choices in the linode example it seems to be caused by https github com ansible ansible modules core blob devel cloud linode linode py l452 expecting one of the int choices but jinaja is giving it string this may or may not be related to https github com ansible ansible issues 5463 expected results linode should not error actual results errors >>>bug_report
new filter getmountfrompath retrieve corresponding mount from given path this commit replace part of the following pr https github com ansible ansible pull 11896 >>>feature_pull_request
ipaddr filter returns empty netmask for host address issue type bug report ansible version ansible ansible configuration nothing environment ubuntu 14 04 lts summary ipaddr filter incorrectly return empty string for ipv4 host netmask 32 it should return 255 255 255 255 steps to reproduce hosts site yml expected results actual results >>>bug_report
add regex capture jinja2 filter this pull request adds jinja2 filter to get the value of the first capturing group within regular expression the use case is reusing variables and command returns directly while being more flexible and limiting the number of grep sed awk workarounds wrote an integration test in this pull request but integration tests for filters do not seem to be currently enabled think this issue belongs to another pull request sincerely >>>feature_pull_request
csvfile delimiter should use string not unicode issue type bug report ansible version ansible ansible configuration nothing special environment mac os yosemite python summary when use csvfile lookup with variables it cauces error steps to reproduce expected results lookup works actual results there is another person who met same problem on the ml https groups google com msg ansible project wccpzhg6ucm 3awr koozuj it seems csv delimiter should be string not unicode in my environment changing these files https github com ansible ansible blob d35b9569006be8b6fb2090b24969b678166386e2 lib ansible plugins lookup csvfile py l33 https github com ansible ansible blob 5be384bab02a4a6cfdc6854e84b005bfcb162034 v1 ansible runner lookup plugins csvfile py l32 to works fine >>>bug_report
fix the binary copy wart core edition neither of the following obvious approaches work for storing etc ssh ssh host key` in an ansible vault vars file yaml binary` spec http yaml org spec tag draft http yaml org type binary html because the parser fails `copy` with `content` set to ssh host key b64decode because the jinja2 template engine corrupts the result https groups google com forum topic ansible devel lr0k2s0giqw discussion all the workarounds ve found involve writing to temporary files and decoding them plus use of `register` and `changed when` to detect whether the target really changed or not could we add the binary` parser to avoid the need to use jinja2 or fix our use of jinja2 or fix jinja2 see also ansible ansible modules core 1961>>>feature_idea
feature request add way to sign and verify data in ansible variables would like to see in ansible way to store facts on remote hosts that can be authenticated by ansible controller using secret known only by the controller the problem ansible does not currently have good way to create global variables that already have content can be used by every role at any time with different combination of tags and can be modified by the user if neccessary currently to achieve that we can use correct me if something changed ansible inventory which is strictly under user control it can override default variables of all roles and can be accessed at any time and is explicitly trusted in regards to data integrity but user has to manage it either manually or by script role default variables they can be easily overriden by user using the inventory and they are explicitly trusted since they come with the role itself but they are not available all the time when ansible is executed with tags roles that hadn been tagged aren evaluated and variables defined there are not accessible during the execution `playbooks group vars and `playbooks host vars directories and yaml files stored there they are read by ansible on each run and are available everywhere and are trusted since they come with the playbook but they cannot be overriden by the inventory variables each of these has its own issues and cannot be used to provide default variables that are available globally at all times there also another way use separate role as dependency which is loaded by all other roles that presents hindrance because this role needs to be included in all roles and playbooks explicitly otherwise it loses its value and is ineffective one other place that have found to be effective as the solution to store data that needs to be accessible at all times is to store it as ansible local facts on remote hosts themselves ansible loads thee facts on each run and they are accessible from anywhere special role https github com debops ansible core can be crafted that creates set of local facts which other roles can then use and depend upon during ansible execution the big disadvantage of this system is that the local facts cannot be trusted to be genuine third party gaining access to the `root` account on host can alter them and gather data during periodical ansible execution which could be automated and unattended which poses security risk what would like to see implemented in ansible is way to authenticate information gathered in facts using secret known by ansible controller it could be implemented using jinja filter which could create digest using input data hashed data both gathered from remote host hash algorithm and secret an example template which can be used to to create signed hash that can be stored in local facts on remote host data is signed using lookup plugin way to verify the data using filter plugin if the result is correct filter plugin returns the contents of `ansible local facts data` which can be string list dictionary if the verification is unsuccessful ansible should return an error which can indicate data tampering on remote host and possible breach this solution still requires for the user to define `secret string` in ansible inventory if we are to avoid creating separate role just for it but it can be just well known variable that needs to be set which is used thruought the roles and playbooks if user creates her own playbooks or roles that use the data without checking the authenticity explicitly data is still available in their original form >>>feature_idea
cloudstack more integration tests and updates ansible version ansible detached head 176b5bc502 last updated 2015 08 23 22 26 55 gmt 200 lib ansible modules core detached head c021abbef3 last updated 2015 08 23 22 26 56 gmt 200 lib ansible modules extras detached head d48d1ac72f last updated 2015 08 23 22 26 56 gmt 200 v2 ansible modules core detached head 85c8a892c8 last updated 2015 08 23 22 26 59 gmt 200 v2 ansible modules extras detached head 70ea058563 last updated 2015 08 23 22 27 01 gmt 200 configured module search path var lib jenkins workspace ansible cloudstack base ansible cloudstack var lib jenkins workspace ansible cloudstack base ansible modules core whereis ansible ansible usr local bin ansible var lib jenkins workspace ansible cloudstack base ansible bin ansible cd var lib jenkins workspace ansible cloudstack base ansible cloudstack tests export test flags tags simulator export vars file cloudstack env yml echo test cs instance template centos 64 bit no gui simulator test cs instance offering small instance test cs instance offering medium instance test cs instance networking type basic cat cloudstack env yml test cs instance template centos 64 bit no gui simulator test cs instance offering small instance test cs instance offering medium instance test cs instance networking type basic make cloudstack ansible playbook cloudstack yml inventory cloudstack env yml resource prefix ansible testing gyqynyby tags simulator rc exit rc play localhost task test cs project ensure project does not exist ok localhost changed false task test cs project verify project did not exist ok localhost msg all assertions passed task test cs project test create project changed localhost account admin changed true display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state active tags task test cs project verify test create project ok localhost msg all assertions passed task test cs project test create project idempotence ok localhost account admin changed false display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state active tags task test cs project verify test create project idempotence ok localhost msg all assertions passed task test cs project test suspend project changed localhost account admin changed true display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state suspended tags task test cs project verify test suspend project ok localhost msg all assertions passed task test cs project test suspend project idempotence ok localhost account admin changed false display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state suspended tags task test cs project verify test suspend project idempotence ok localhost msg all assertions passed task test cs project test activate project changed localhost account admin changed true display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state active tags task test cs project verify test activate project ok localhost msg all assertions passed task test cs project test activate project idempotence ok localhost account admin changed false display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state active tags task test cs project verify test activate project idempotence ok localhost msg all assertions passed task test cs project test delete project changed localhost account admin changed true display text ansible testing gyqynyby prj domain root id b617e1db 0f92 416f ac60 83b85a1c20f9 name ansible testing gyqynyby prj state active tags task test cs project verify test delete project ok localhost msg all assertions passed task test cs project test delete project idempotence ok localhost changed false task test cs project verify test delete project idempotence ok localhost msg all assertions passed task test cs iso ensure iso is deleted ok localhost changed false task test cs iso verify ensure iso is deleted ok localhost msg all assertions passed task test cs iso test download iso changed localhost account admin changed true display text ansible testing gyqynyby iso domain root id 0d520d3c 6ee4 45d9 a187 cbfdf89f46ba is ready false name ansible testing gyqynyby iso tags zone sandbox simulator task test cs iso verify test download iso ok localhost msg all assertions passed task test cs iso test download iso idempotence ok localhost account admin changed false display text ansible testing gyqynyby iso domain root id 0d520d3c 6ee4 45d9 a187 cbfdf89f46ba is ready false name ansible testing gyqynyby iso tags zone sandbox simulator task test cs iso verify test download iso idempotence ok localhost msg all assertions passed task test cs iso test remove iso changed localhost account admin changed true display text ansible testing gyqynyby iso domain root id 0d520d3c 6ee4 45d9 a187 cbfdf89f46ba is ready false name ansible testing gyqynyby iso tags zone sandbox simulator task test cs iso verify test remove iso ok localhost msg all assertions passed task test cs iso test remove iso idempotence ok localhost changed false task test cs iso verify test remove iso idempotence ok localhost msg all assertions passed task test cs domain setup ok localhost changed false task test cs domain verify setup ok localhost msg all assertions passed task test cs domain test fail if missing name failed localhost failed true msg missing required arguments path ignoring task test cs domain verify results of fail if missing params ok localhost msg all assertions passed task test cs domain test fail if ends with failed localhost failed true msg path ansible testing gyqynyby domain must not end with ignoring task test cs domain verify results of fail if ends with ok localhost msg all assertions passed task test cs domain test create domain changed localhost changed true id 23e779e1 5ba6 4f81 ab47 175268c5b768 name ansible testing gyqynyby domain parent domain root path root ansible testing gyqynyby domain state absent task test cs domain verify results of test create domain ok localhost msg all assertions passed task test cs domain test create domain idempotence ok localhost changed false id 23e779e1 5ba6 4f81 ab47 175268c5b768 name ansible testing gyqynyby domain parent domain root path root ansible testing gyqynyby domain state absent task test cs domain verify results of test create domain idempotence ok localhost msg all assertions passed task test cs domain test create subdomain changed localhost changed true id 9e35d875 d268 451a 99d9 e8171151d5b4 name ansible testing gyqynyby subdomain parent domain ansible testing gyqynyby domain path root ansible testing gyqynyby domain ansible testing gyqynyby subdomain state absent task test cs domain verify results of test create domain ok localhost msg all assertions passed task test cs domain test create subdomain idempotence ok localhost changed false id 9e35d875 d268 451a 99d9 e8171151d5b4 name ansible testing gyqynyby subdomain parent domain ansible testing gyqynyby domain path root ansible testing gyqynyby domain ansible testing gyqynyby subdomain state absent task test cs domain verify results of test create subdomain idempotence ok localhost msg all assertions passed task test cs domain test delete subdomain changed localhost changed true id 9e35d875 d268 451a 99d9 e8171151d5b4 name ansible testing gyqynyby subdomain parent domain ansible testing gyqynyby domain path root ansible testing gyqynyby domain ansible testing gyqynyby subdomain state absent task test cs domain verify results of test delete subdomain idempotence ok localhost msg all assertions passed task test cs domain test delete subdomain idempotence ok localhost changed false task test cs domain verify results of test delete subdomain idempotence ok localhost msg all assertions passed task test cs domain test create subdomain changed localhost changed true id c2ed5e79 690c 4ed2 965f 4bbee02ff9af name ansible testing gyqynyby subdomain parent domain ansible testing gyqynyby domain path root ansible testing gyqynyby domain ansible testing gyqynyby subdomain state absent task test cs domain verify results of test create subdomain ok localhost msg all assertions passed task test cs domain test delete domain with clean up changed localhost changed true id 23e779e1 5ba6 4f81 ab47 175268c5b768 name ansible testing gyqynyby domain parent domain root path root ansible testing gyqynyby domain state absent task test cs domain verify results of test delete domain with clean up ok localhost msg all assertions passed task test cs domain test delete domain with clean up idempotence ok localhost changed false task test cs domain verify results of test delete domain with clean up idempotence ok localhost msg all assertions passed task test cs vmsnapshot setup instance changed localhost account admin affinity groups changed true created 2015 08 23t20 27 50 0000 default ip 60 147 41 52 display name ansible testing gyqynyby vm snapshot domain root hypervisor simulator id b1e086f6 7c51 4e9f 9ffd 9bdc76ddbd0d instance name 28 qa name ansible testing gyqynyby vm snapshot password enabled false security group account admin description default security group egressrule id e1d0049d 46b4 11e5 b5c1 0242ac110008 ingressrule name default tags security groups default service offering small instance state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs vmsnapshot verify create instance ok localhost msg all assertions passed task test cs vmsnapshot ensure no snapshot exists ok localhost changed false task test cs vmsnapshot verify setup ok localhost msg all assertions passed task test cs vmsnapshot test fail if missing name failed localhost failed true msg missing required arguments vm name ignoring task test cs vmsnapshot verify results of fail if missing params ok localhost msg all assertions passed task test cs vmsnapshot test create snapshot changed localhost changed true created 2015 08 23t20 27 56 0000 current true display name ansible testing gyqynyby snapshot id 602af426 815a 4c9e 91a2 c7af3aba048f name 28 qa vs 20150823202756 state ready type diskandmemory task test cs vmsnapshot verify test create snapshot ok localhost msg all assertions passed task test cs vmsnapshot test create snapshot idempotence ok localhost changed false created 2015 08 23t20 27 56 0000 current true display name ansible testing gyqynyby snapshot id 602af426 815a 4c9e 91a2 c7af3aba048f name 28 qa vs 20150823202756 state ready type diskandmemory task test cs vmsnapshot verify test create snapshot idempotence ok localhost msg all assertions passed task test cs vmsnapshot test revert snapshot changed localhost changed true created 2015 08 23t20 27 56 0000 current true display name ansible testing gyqynyby snapshot id 602af426 815a 4c9e 91a2 c7af3aba048f name 28 qa vs 20150823202756 state ready type diskandmemory task test cs vmsnapshot verify test revert snapshot ok localhost msg all assertions passed task test cs vmsnapshot test remove snapshot changed localhost changed true created 2015 08 23t20 27 56 0000 current true display name ansible testing gyqynyby snapshot id 602af426 815a 4c9e 91a2 c7af3aba048f name 28 qa vs 20150823202756 state ready type diskandmemory task test cs vmsnapshot verify test remove snapshot ok localhost msg all assertions passed task test cs vmsnapshot test remove snapshot idempotence ok localhost changed false task test cs vmsnapshot verify test remove snapshot idempotence ok localhost msg all assertions passed task test cs vmsnapshot cleanup instance changed localhost account admin affinity groups changed true created 2015 08 23t20 27 50 0000 default ip 60 147 41 52 display name ansible testing gyqynyby vm snapshot domain root hypervisor simulator id b1e086f6 7c51 4e9f 9ffd 9bdc76ddbd0d instance name 28 qa name ansible testing gyqynyby vm snapshot password enabled false security group account admin description default security group egressrule id e1d0049d 46b4 11e5 b5c1 0242ac110008 ingressrule name default tags security groups default service offering small instance state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs vmsnapshot verify destroy instance ok localhost msg all assertions passed task test cs sshkeypair setup cleanup ok localhost changed false task test cs sshkeypair test fail on missing name failed localhost failed true msg missing required arguments name ignoring task test cs sshkeypair verify results of fail on missing name ok localhost msg all assertions passed task test cs sshkeypair test ssh key creation changed localhost account admin changed true domain root fingerprint 97 ef 3d 24 17 3f 3f 1e 19 2a 05 a5 f7 fa c0 29 name ansible testing gyqynyby sshkey private key begin rsa private key nmiicxgibaakbgqd14yrhcde1e8g70zijfh3pukfozhmudnqvprwpqd0b mfo2bge n9pxdlejk fv06htweuf0s3zlg8o2dqbiwf sfq4aug92g36lbzwmfvticyckpe nrkgno f1hn4pojcbiomdoz5ngsdejvztx ecrze1wl7jytnm9fln1k9kjwidaqab naogbajhej7xmjn 0atlootdblzj8hpaeerzo q8qcgkz0nra1n0kxsh1l0he6amz n85d9ukeyujahbv1aiistubchbifajw7kzomsmwdm8353nqjim9ron6716y9y1nxn ncbop8htrz o6xxfz1c0gzdysoil eczbu lfcwyv2s9dizqjakea k09eqspeqbh nx8qjpr uo6nqan0rztgei9ygeamnwab3okkorshkdyu88ltxzrthnbasyhdpkywk n8zejd7g84wjbapkfcr4a9wldzspl7fhphy2t9ih7gdhptxd6ua0cghp83aq3m2nv nrip offjj84ithxttm342pp1qum7fuebqu0cqcmzvz9asarzt3cj8gbp6lcsl0uk nmrejvaiw7jzgx luediq2nrlsjlsrvyxlobdi ta2fyhcnqvaf0m4xtfvbucqqc6 ns4t9eqomzf pwguuk6rn1imu9vxfehyzwazmnvfxevn hjsaca7p7qzsbqol6gi5 n2xmxv n4e fvhlfjipbrakeavnt47umisz bppzfxfpmxplhmrpc7ukrpbho1pxs nfccrgcpr8ylztcxvxqjkwxqn9ywpkpalebod2iqi4zra2q end rsa private key task test cs sshkeypair verify results of ssh key creation ok localhost msg all assertions passed task test cs sshkeypair test ssh key creation idempotence ok localhost account admin changed false domain root fingerprint 97 ef 3d 24 17 3f 3f 1e 19 2a 05 a5 f7 fa c0 29 name ansible testing gyqynyby sshkey task test cs sshkeypair verify results of ssh key creation idempotence ok localhost msg all assertions passed task test cs sshkeypair test replace ssh public key changed localhost account admin changed true domain root fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name ansible testing gyqynyby sshkey task test cs sshkeypair verify results of replace ssh public key ok localhost msg all assertions passed task test cs sshkeypair test replace ssh public key idempotence ok localhost account admin changed false domain root fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name ansible testing gyqynyby sshkey task test cs sshkeypair verify results of ssh public key idempotence ok localhost msg all assertions passed task test cs sshkeypair test ssh key absent changed localhost account admin changed true domain root fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name ansible testing gyqynyby sshkey task test cs sshkeypair verify result of key absent ok localhost msg all assertions passed task test cs sshkeypair test ssh key absent idempotence ok localhost changed false task test cs sshkeypair verify result of ssh key absent idempotence ok localhost msg all assertions passed task test cs affinitygroup setup ok localhost changed false task test cs affinitygroup verify setup ok localhost msg all assertions passed task test cs affinitygroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs affinitygroup verify results of fail if missing name ok localhost msg all assertions passed task test cs affinitygroup test present affinity group changed localhost account admin affinity type host anti affinity changed true domain root id 671a8cfe 5c8b 4073 8b73 e1637145dbad name ansible testing gyqynyby ag task test cs affinitygroup verify results of create affinity group ok localhost msg all assertions passed task test cs affinitygroup test present affinity group is idempotence ok localhost account admin affinity type host anti affinity changed false domain root id 671a8cfe 5c8b 4073 8b73 e1637145dbad name ansible testing gyqynyby ag task test cs affinitygroup verify results present affinity group is idempotence ok localhost msg all assertions passed task test cs affinitygroup test absent affinity group changed localhost account admin affinity type host anti affinity changed true domain root id 671a8cfe 5c8b 4073 8b73 e1637145dbad name ansible testing gyqynyby ag task test cs affinitygroup verify results of absent affinity group ok localhost msg all assertions passed task test cs affinitygroup test absent affinity group is idempotence ok localhost changed false task test cs affinitygroup verify results of absent affinity group is idempotence ok localhost msg all assertions passed task test cs securitygroup setup ok localhost changed false task test cs securitygroup verify setup ok localhost msg all assertions passed task test cs securitygroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs securitygroup verify results of fail if missing name ok localhost msg all assertions passed task test cs securitygroup test present security group changed localhost account admin changed true domain root id fb79091d d615 4fb5 9a53 e796b476ede8 name ansible testing gyqynyby sg tags task test cs securitygroup verify results of create security group ok localhost msg all assertions passed task test cs securitygroup test present security group is idempotence ok localhost account admin changed false domain root id fb79091d d615 4fb5 9a53 e796b476ede8 name ansible testing gyqynyby sg tags task test cs securitygroup verify results present security group is idempotence ok localhost msg all assertions passed task test cs securitygroup test absent security group changed localhost account admin changed true domain root id fb79091d d615 4fb5 9a53 e796b476ede8 name ansible testing gyqynyby sg tags task test cs securitygroup verify results of absent security group ok localhost msg all assertions passed task test cs securitygroup test absent security group is idempotence ok localhost changed false task test cs securitygroup verify results of absent security group is idempotence ok localhost msg all assertions passed task test cs securitygroup rule setup custom security group changed localhost account admin changed true domain root id ae54079f 7a8d 4fb7 a67e eaa18c264e26 name ansible testing gyqynyby sg tags task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs securitygroup rule setup default security group ok localhost account admin changed false description default security group domain root id e1d0049d 46b4 11e5 b5c1 0242ac110008 name default tags task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs securitygroup rule setup remove icmp rule ok localhost changed false security group default type ingress task test cs securitygroup rule verify remove icmp rule ok localhost msg all assertions passed task test cs securitygroup rule setup remove http range rule ok localhost changed false security group default type ingress task test cs securitygroup rule verify remove http range rule ok localhost msg all assertions passed task test cs securitygroup rule setup remove single port udp rule ok localhost changed false security group default type egress task test cs securitygroup rule verify remove single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test create http range rule changed localhost changed true cidr 32 end port 8888 protocol tcp security group default start port 8000 type ingress task test cs securitygroup rule verify create http range rule ok localhost msg all assertions passed task test cs securitygroup rule test create http range rule idempotence ok localhost changed false cidr 32 end port 8888 protocol tcp security group default start port 8000 tags type ingress task test cs securitygroup rule verify create http range rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test create single port udp rule changed localhost account admin changed true end port 5353 protocol udp security group default start port 5353 type egress user security group ansible testing gyqynyby sg task test cs securitygroup rule verify create single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test single port udp rule idempotence ok localhost account admin changed false end port 5353 protocol udp security group default start port 5353 tags type egress user security group ansible testing gyqynyby sg task test cs securitygroup rule verify single port udp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test icmp rule changed localhost changed true cidr icmp code icmp type protocol icmp security group default type ingress task test cs securitygroup rule verify icmp rule ok localhost msg all assertions passed task test cs securitygroup rule test icmp rule idempotence ok localhost changed false cidr icmp code icmp type protocol icmp security group default tags type ingress task test cs securitygroup rule verify icmp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove http range rule changed localhost changed true cidr 32 end port 8888 protocol tcp security group default start port 8000 tags type ingress task test cs securitygroup rule verify create http range rule ok localhost msg all assertions passed task test cs securitygroup rule test remove http range rule idempotence ok localhost changed false security group default type ingress task test cs securitygroup rule verify create http range rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove single port udp rule changed localhost account admin changed true end port 5353 protocol udp security group default start port 5353 tags type egress user security group ansible testing gyqynyby sg task test cs securitygroup rule verify remove single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test remove single port udp rule idempotence ok localhost changed false security group default type egress task test cs securitygroup rule verify remove single port udp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove icmp rule changed localhost changed true cidr icmp code icmp type protocol icmp security group default tags type ingress task test cs securitygroup rule verify icmp rule ok localhost msg all assertions passed task test cs securitygroup rule test remove icmp rule idempotence ok localhost changed false security group default type ingress task test cs securitygroup rule verify icmp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule cleanup custom security group changed localhost account admin changed true domain root id ae54079f 7a8d 4fb7 a67e eaa18c264e26 name ansible testing gyqynyby sg tags task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs instancegroup setup ok localhost changed false task test cs instancegroup verify setup ok localhost msg all assertions passed task test cs instancegroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs instancegroup verify results of fail if missing name ok localhost msg all assertions passed task test cs instancegroup test present instance group changed localhost account admin changed true created 2015 08 23t20 29 19 0000 domain root id afdce467 0361 4ebb 90fc 645dfca6da64 name ansible testing gyqynyby ig task test cs instancegroup verify results of create instance group ok localhost msg all assertions passed task test cs instancegroup test present instance group is idempotence ok localhost account admin changed false created 2015 08 23t20 29 19 0000 domain root id afdce467 0361 4ebb 90fc 645dfca6da64 name ansible testing gyqynyby ig task test cs instancegroup verify results present instance group is idempotence ok localhost msg all assertions passed task test cs instancegroup test absent instance group changed localhost account admin changed true created 2015 08 23t20 29 19 0000 domain root id afdce467 0361 4ebb 90fc 645dfca6da64 name ansible testing gyqynyby ig task test cs instancegroup verify results of absent instance group ok localhost msg all assertions passed task test cs instancegroup test absent instance group is idempotence ok localhost changed false task test cs instancegroup verify results of absent instance group is idempotence ok localhost msg all assertions passed task test cs instance setup ssh key changed localhost account admin changed true domain root fingerprint 08 73 d1 e1 1b ab 28 28 8e 0b bd 31 a2 75 dd 0f name ansible testing gyqynyby sshkey private key begin rsa private key nmiicxaibaakbgqcwwzcfmpjwdpkeyz7p4gir pfhqvklgoffmzpfopjdqh7x5cro nm6q8ct9sb wkeziocw5j2sznkzdkrs4nv8q7wmeb zwt9ornz4fj 6v2zhgafps nteieyx77ax2obqdoki av2jtodgjoffxfw4ywm0rvrkvpywhnswglk6 4qidaqab naogavqmtgj4x wbbm9j5itc42wwk8bmx6rwgcfebnxwwj01n0aok6rktygoufobs nd7tjfce907d7cwpeubnc0qaohscnt2jy1xekggwprxd8dvrjayjbqhswrv2g9eig nmyujfrxtr7d7cthfson1tanfkxki6g to4x 68nlknbiywecqqd67po2siiuaasa nx3omd 5pcnoqnpzpw6iubmy2i4azd2pczxddzfokgbrmqahuomg3vw huron ykz n7q67fdplakeamwlyagw01nodsiqgvisovxjh43zpigbluumt1bokko mk hxa5ja nzyki fwn6brxlncamenyfzzr1u7uqqw0tqjadry gt87fgm fnm6tgedht7lxb noltybhovxm7rxwjvxvgitklzl7ngys8n lhoscthc g8jwbkahlpj9hpbqjbairx nf3fmbzphfuww laakctfkbjrzqrmlnce1pjlaj a2tglulalregzertrxgeo704o nyrq0pxmpqwlxwmlzd5ecqcsg6 2tf278lokcehyl5roh5ig9wij6bo3ta oxx8rx nv ppottyzph9lcxdklccgccmjkvjlhc dr4dzuc 9xu end rsa private key task test cs instance verify setup ssh key ok localhost msg all assertions passed task test cs instance setup affinity group changed localhost account admin affinity type host anti affinity changed true domain root id bd00a90a 1fb1 43f6 85a9 f935d7e45db1 name ansible testing gyqynyby ag task test cs instance verify setup affinity group ok localhost msg all assertions passed task test cs instance setup security group changed localhost account admin changed true domain root id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 name ansible testing gyqynyby sg tags task test cs instance verify setup security group ok localhost msg all assertions passed task test cs instance setup instance to be absent ok localhost changed false task test cs instance verify instance to be absent ok localhost msg all assertions passed task test cs instance test create instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify create instance ok localhost msg all assertions passed task test cs instance test create instance idempotence ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify create instance idempotence ok localhost msg all assertions passed task test cs instance test running instance not updated ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify running instance not updated ok localhost msg all assertions passed task test cs instance test stopping instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state stopped tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify stopping instance ok localhost msg all assertions passed task test cs instance test stopping instance idempotence ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state stopped tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify stopping instance idempotence ok localhost msg all assertions passed task test cs instance test updating stopped instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby display domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering medium instance ssh key ansible testing gyqynyby sshkey state stopped tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify updating stopped instance ok localhost msg all assertions passed task test cs instance test starting instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby display domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering medium instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify starting instance ok localhost msg all assertions passed task test cs instance test starting instance idempotence ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby display domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering medium instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify starting instance idempotence ok localhost msg all assertions passed task test cs instance test force update running instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify force update running instance ok localhost msg all assertions passed task test cs instance test force update running instance idempotence ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state running tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify force update running instance idempotence ok localhost msg all assertions passed task test cs instance test destroy instance changed localhost account admin affinity groups ansible testing gyqynyby ag changed true created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state destroyed tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify destroy instance ok localhost msg all assertions passed task test cs instance test destroy instance idempotence ok localhost account admin affinity groups ansible testing gyqynyby ag changed false created 2015 08 23t20 29 29 0000 default ip 60 147 41 57 display name ansible testing gyqynyby vm domain root hypervisor simulator id 7f69a573 4caa 4a60 8c02 e370ee4f3bec instance name 29 qa name ansible testing gyqynyby vm password enabled false security group account admin egressrule id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 ingressrule name ansible testing gyqynyby sg tags security groups ansible testing gyqynyby sg service offering small instance ssh key ansible testing gyqynyby sshkey state destroyed tags template centos 64 bit no gui simulator zone sandbox simulator task test cs instance verify destroy instance idempotence ok localhost msg all assertions passed task test cs instance cleanup ssh key changed localhost account admin changed true domain root fingerprint 08 73 d1 e1 1b ab 28 28 8e 0b bd 31 a2 75 dd 0f name ansible testing gyqynyby sshkey task test cs instance verify cleanup ssh key ok localhost msg all assertions passed task test cs instance cleanup affinity group changed localhost account admin affinity type host anti affinity attempts changed true domain root id bd00a90a 1fb1 43f6 85a9 f935d7e45db1 name ansible testing gyqynyby ag task test cs instance verify cleanup affinity group ok localhost msg all assertions passed task test cs instance cleanup security group take while unless instance is expunged changed localhost account admin attempts 11 changed true domain root id 8b17abd1 bbed 4eb1 b9f8 e4d071db5b61 name ansible testing gyqynyby sg tags task test cs instance verify cleanup security group ok localhost msg all assertions passed task test cs instance cs instance ok localhost changed false failed false failed when result false task test cs account setup ok localhost changed false task test cs account verify setup ok localhost msg all assertions passed task test cs account test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs account verify results of fail if missing params ok localhost msg all assertions passed task test cs account test fail if missing params if state present failed localhost failed true msg missing required arguments email username password first name last name ignoring task test cs account verify results of fail if missing params if state present ok localhost msg all assertions passed task test cs account test create user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state enabled task test cs account verify results of create account ok localhost msg all assertions passed task test cs account test create user account idempotence ok localhost account type user changed false domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state enabled task test cs account verify results of create account idempotence ok localhost msg all assertions passed task test cs account test lock user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state locked task test cs account verify results of lock user account ok localhost msg all assertions passed task test cs account test lock user account idempotence ok localhost account type user changed false domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state locked task test cs account verify results of lock user account idempotence ok localhost msg all assertions passed task test cs account test disable user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state disabled task test cs account verify results of disable user account ok localhost msg all assertions passed task test cs account test disable user account idempotence ok localhost account type user changed false domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state disabled task test cs account verify results of disable user account idempotence ok localhost msg all assertions passed task test cs account test lock disabled user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state locked task test cs account verify results of lock disabled user account ok localhost msg all assertions passed task test cs account test lock disabled user account idempotence ok localhost account type user changed false domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state locked task test cs account verify results of lock disabled user account idempotence ok localhost msg all assertions passed task test cs account test enable user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state enabled task test cs account verify results of enable user account ok localhost msg all assertions passed task test cs account test enable user account idempotence ok localhost account type user changed false domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state enabled task test cs account verify results of enable user account idempotence ok localhost msg all assertions passed task test cs account test remove user account changed localhost account type user changed true domain root id ba54cd5f c899 4082 b6a6 ab27143dae22 name ansible testing gyqynyby user network domain ansible testing gyqynyby local state enabled task test cs account verify results of remove user account ok localhost msg all assertions passed task test cs account test remove user account idempotence ok localhost changed false task test cs account verify results of remove user account idempotence ok localhost msg all assertions passed play recap localhost ok 226 changed 51 unreachable failed finished success >>>feature_pull_request
deprecate groupname syntax in favour of groupname this series of prs cleans up and documents various aspects of the parsing of ``hosts groupname `` and deprecates the earlier `` `` subscript syntax in favour of the inclusive `` `` syntax that the only real functional change though there are various simplifications improvements to the code this is based on extensive discussion on irc had originally planned to make it possible to use ``nongroupname `` range syntax to match hostnames the way they can be specified when defining the inventory but it became clear that the ambiguities introduced by the change in light of the existing slicing syntax as well as the ``fnmatch`` character classes made this more complicated than wanted this finally supersedes 10543 by willthames cc bcoca abadger >>>bugfix_pull_request feature_pull_request
integration test failure make test winrm fails in test win fetch issue type bug report ansible version ansible devel 9bb95b5235 last updated 2015 08 21 06 47 52 gmt 100 lib ansible modules core detached head 4721d6d8b5 last updated 2015 08 21 06 49 37 gmt 100 lib ansible modules extras detached head 785cd24a02 last updated 2015 08 21 06 49 17 gmt 100 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 10 18 29 52 gmt 100 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 10 18 30 43 gmt 100 config file configured module search path none ansible configuration stock ansible configuration environment ansible controller lubuntu 12 04 i686 managed host windows server 2012 r2 summary the windows integration tests fail at the first task of test win fetch steps to reproduce git checkout devel git fetch upstream git rebase upstream devel git submodule update init recursive ansible version cd test integration export test flags etc ansible windows test win fetch vvv make test winrm expected results all winrm integration tests complete actual results playbook run fails with the following fatal win testbox1 failed failed true msg error the module file was not found in configured module paths >>>bug_report needs_info windows
copy action plugin strips leading character on recursive copy issue type bug report ansible version `ansible devel 47d9e7ca93 last updated 2015 08 23 10 26 42 gmt 200 ansible configuration etc ansible ansible cfg` clean version from github `ansible cfg` in current directory environment ubuntu 14 04 fedora 22 summary copy action plugin strips leading character when recursive copy is performed this is caused by the change introduced in 3a4dd523 11470 steps to reproduce have role named `bash` in `roles bash files` there is `home` directory which contents should be copied to on localhost expected results actual results `source files` https github com ansible ansible blob 3a4dd523d3649facc6d88d94cb67f5531a51af2a lib ansible plugins action copy py l87 looks like >>>bug_report p2
support additional options for winrm connections via inventory variables as discussed in https groups google com topic ansible devel cpz0c7na9ci discussion will allow explicitly specifying scheme https or http and transport kerberos or plaintext for additional configuration of winrm connection cc trondhindenes would also allow specifying custom paths to the winrm endpoint to support multiple hosts behind an http proxy as discussed in https groups google com topic ansible devel bhxcyxamiui discussion cc blakfeld>>>feature_pull_request windows
local action attempts to establish remote connection running against devel 47d9e7ca93808383568c3019ac32de7e7ba05ac5 given an inventory that specifies `ansible connection` for host example ansible connection ssh running playbook that executes local action on behalf of host attempts to establish an ssh connection to run the local task hosts all gather facts false tasks local action command echo doing stuff needed to bring up host action ping it was broken by e7b2308b66c7930df87d77232d5e48769ab03f58 as described in 12005 but doesn appear to have been fixed by 635fa0757b06b560a7812053f8de298fc5fc2c4c >>>bug_report p2
pass windows command as is without splitting rejoining parameters fixes extra spaces added between parameters from https github com ansible ansible modules core issues 1929 correctly decode powershell command encoded as utf 16 le so that it displays correctly in debug messages fixes the other issue from https github com ansible ansible modules core issues 1929 add test to verify that script parameters are passed as is so true is interpreted as boolean fixes https github com ansible ansible issues 10947>>>bugfix_pull_request windows
add tests for creates parameter to win msi module >>>feature_pull_request windows
add integration tests for win group module >>>feature_pull_request windows
add powershell exception handling and turn on strict mode add exception handling when running powershell modules to provide exception message and stack trace enable strict mode for all powershell modules and internal commands update common powershell code to fix strict mode errors fix an issue with set attr where it would not replace an existing property if already set add tests for exception handling using modified win ping modules hold off on merging until strict mode errors have been fixed for core extras modules >>>feature_pull_request windows
templated variables do not work when accessed through hostvars variables defined in group vars host vars with templates that reference other variables do not return consistent results when accessed through `hostvars` expected behavior hostvars hostname variable evaluated on any host yields the same value as variable evaluated on host `hostname` actual behavior hostvars hostname variable may yield different results when evaluated on different hosts example consider the following ansible project inventory ini playbook yml host vars my host inventory ini my host ansible connection local other host ansible connection local hostvars my host my var inventory hostname playbook yml hosts all tasks debug var hostvars my host my var debug var hostvars my host inventory hostname assert that hostvars my host my var hostvars my host inventory hostname this playbook should run successfully in ansible this playbook fails at the `assert` task on `other host` notice how the first debug statement produces different result on each host ansible playbook inventory ini playbook yml play all gathering facts ok my host ok other host task debug var hostvars my host my var ok my host var hostvars my host my var my host ok other host var hostvars my host my var other host task debug var hostvars my host inventory hostname ok other host var hostvars my host inventory hostname my host ok my host var hostvars my host inventory hostname my host task assert ok my host failed other host assertion hostvars my host my var hostvars my host inventory hostname evaluated to false failed true play recap to retry use limit home nicholas gaya playbook retry my host ok changed unreachable failed other host ok changed unreachable failed related https github com ansible ansible issues 7844>>>bug_report
lineinfile dropping quoted empty strings issue type bug report ansible version ansible ansible configuration ansible cfg` no etc ansible ansible cfg` environment os 10 10 summary can create quoted empty string with ansible `lineinfile` it seems should be able to use `lineinfile` `regexp` and `line` to match an existing line with quoted string and remove the contents from inside the quotes instead ansible is removing the quotes also even though they are specified in `line` steps to reproduce start with `foo txt` and `lineinfile yml` and then run `ansible playbook localhost lineinfile yml` expected results `foo txt` should be actual results instead `foo txt` is am missing something >>>bug_report
poor error message when ansible cannot find include resources issue type bug report this is bug about poor quality error message ansible version ansible configuration default ansible config environment macos 10 10 ansible installed via homebrew summary was trying to figure out way to share tasks meant for re use in different roles was doing this at first which works and then thought clean things up little by defining variable decryptandcopy within group vars all yml to capture the paths to the modules intended to reuse and changed this to this generates an error before any task is run my inference is that something walks the role and include references statically up front in order to locate all the task resources referenced and produces the error during this pre execution context during this pre execution context ansible does not resolve variables or only resolves subset of variables this is great and good and makes sense but when non existent file is include better error message would be nice the error should indicate the file containing the problematic include usage some additional verbosity explaining the rules for what variables are expanded within this context might also be nice not entirely sure why the above example with playbook dir variable works but not with variable defined in group var all foo yml think this is probably an intentional design choice to avoid the possibility of someone referencing variable defined in group var all which is overridden in host inventory it would be confusing for that that variable to resolve to different values at parse time than during the runtime context so think the behavior is probably fine as is but the error message could be improved steps to reproduce supply include directive with path to non existent file as argument expected results more descriptive error message maybe something like error file included from could not be found actual results >>>needs_info
syntaxerror in usr local bin ansible playbook hello when do vagrant provision with that in vagrantfile get sorry but beginner with ansible and vagrant thanks >>>needs_info
second role dependency ignored and strange effect hello i`ve very strange behavior of the latest git release of ansible2 the first strange effect is that only the first dependency defined in the meta main yml would be running if change the lines of two than the other role who is then in the first dep definition is processed the second effect in this constellation is that the running of the role is skipped only the first dependency is processed and then ansible stopped with an all ok recap when uncomment the second dependency with than all works as expected the meta main yml looks this >>>needs_info
jinja filters fail after using set fact variable definition bug report ansible version latest dev branch for ansible configuration jinja2 extensions jinja2 ext do environment os yosemite summary if you register variable then use set fact to define it to another variable the jinja filters fail on it with the following error steps to reproduce expected results should be able to use jinja filters as before actual results error with expected dictionary line this changed recently probably in the last couple of weeks >>>bug_report needs_info
role main yml stops after first include roles myrole tasks has files yml yml yml main yml and main yml includes yml etc but only the first include gets executed no error warning when swap yml with yml still only the first one get run can add task above the first include and it gets executed just fine anything task or include after the first include does nothing >>>bug_report p1
ansible doc list terminates with error in python issue type bug report ansible version ansible configuration no change environment centos or debian 10 python summary `ansible doc list` raises an error this problem does not occur on centos python and ubuntu 14 04 python steps to reproduce execute `ansible doc list` expected results displays the available module list by less actual results terminates with error >>>bug_report
vault encryption breaks with non ascii data issue type bug report ansible version devel ansible configuration na environment linux summary if there any non ascii data in the file to be encrypted ansible vault breaks with the stack trace shown below in my case the non ascii data in question was the single character steps to reproduce ansible vault vvvv create yml enter password enter in the editor save quit expected results encryption is successful actual results traceback most recent call last file home ams extern ansible bin ansible vault line 79 in sys exit cli run file home ams extern ansible lib ansible cli vault py line 83 in run self execute file home ams extern ansible lib ansible cli init py line 97 in execute fn file home ams extern ansible lib ansible cli vault py line 89 in execute create this editor create file file home ams extern ansible lib ansible parsing vault init py line 258 in create file self edit file helper cipher self cipher name file home ams extern ansible lib ansible parsing vault init py line 240 in edit file helper enc data this vault encrypt tmpdata file home ams extern ansible lib ansible parsing vault init py line 132 in encrypt enc data this cipher encrypt data self password file home ams extern ansible lib ansible parsing vault init py line 601 in encrypt crypteddata cipher encrypt data file usr lib python2 dist packages crypto cipher blockalgo py line 244 in encrypt return self cipher encrypt plaintext unicodeencodeerror ascii codec can encode character xe4 in position ordinal not in range 128 >>>bug_report p2
get mount facts find bind mounts and add info to options field since many recent linux distributions use symlink etc mtab proc mounts the information about bind mounts is missing from the ansible mounts fact this fix uses the findmnt command also available on recent distributions to check for bind mounts and adds the info back to the options field so that it can be used in conditional in templates like when monitoring file system disk space no need to monitor the bind mounted mount points too >>>feature_pull_request
only first include of role is executed issue type bug report ansible version ansible version ansible environment ubuntu 15 04 summary have role with tasks main yml like this include packages yml include config cluster yml include config yml include service yml include cluster yml include rabbitmq yml include queues yml tags queues meta flush handlers when use this role from my playbook only first include is executed hosts serverdev user root roles role rabbitmq expected results run all includes actual results this is the output of command ansible playbook serverdev yml play task setup ok trr rabbit dev2 ok trr rabbit dev1 task tierra rabbitmq include included packages yml for trr rabbit dev1 included packages yml for trr rabbit dev2 task tierra rabbitmq ensure epel is installed ok trr rabbit dev2 ok trr rabbit dev1 task tierra rabbitmq ensure erlang repo is installed ok trr rabbit dev2 ok trr rabbit dev1 task tierra rabbitmq ensure rabbitmq rpm key is present ok trr rabbit dev2 ok trr rabbit dev1 task tierra rabbitmq ensure rabbitmq is installed ok trr rabbit dev2 ok trr rabbit dev1 play recap trr rabbit dev1 ok changed unreachable failed trr rabbit dev2 ok changed unreachable failed >>>bug_report p1
either the yaml parser or shell module insert leading whitespace on non first lines demo copy the following to `leading whitespace demo yaml` `ansible playbook vi localhost leading whitespace demo yaml` output note `cmd` is echo first echo second space has been inserted at the beginning of the second line run the same yaml through `yaml load` and there no extra space reproduced on mac os and centos with ansible >>>bug_report pending_closure
cant find vars from host vars me file issue type bug report ansible version ansible configuration default environment fedora 22 python steps to reproduce create ansible playbook role my examle name create db mysql db name item db name encoding utf8 with items mysql databases when mysql databases is defined name create db users mysql user name item user priv item db name all password item pass host item host with items mysql databases when mysql databases is defined create inventory file or add to the default inventory file record mysql any site me create file mysql any site me in your host vars folder my example mysql databases db name some site kz user some site kz pass lookup password home user ansible work credentials ansible nodename mysql some site kz length 15 chars ascii letters digits host expected results playbook from my example must create mysql db actual results ansible can see vars from vars file but when change host in inventory file from mysql some site me to mysql some site kz and have to change vars file name to mysql some site kz everything works like expected something ansible or python ignore me readme files >>>needs_info
allow vault to operate from stdin to stdout plaintext never hits the disk this is something ve mentioned on irc few times but not submitted as pr before with this and the semi related 11767 it possible to automate various vault operations without ever leaking plaintext to disk even in the form of temp files >>>feature_pull_request
remove unused copied before comment method this was copied from inventory ini py but the rewritten version doesn use it and shows that it isn needed >>>bugfix_pull_request
ec2 py instance filters support for negatation trying to filter instances from ec2 py where security group name is not monolithic trying `>>>needs_info
rfc template be able to inject user values to template hello come from chef community and miss behaviour in ansible have theses vars and have this task and finally my template if you use this code it will fail because `user` and `color` variable are not defined at the template layer would like to be able to do why does want to do that because writing item in my template make it very hard to maintain and to review reference https docs chef io resource template html search `a hash of variables that are passed into ruby template file `>>>feature_idea
variable evaluation in task names inconsistent version ansible playbook it appears that variable evaluation within task names is inconsistent if task name inside role contains variable it appears to be only be evaluated if passed as role parameter even if that variable is overridden via command line the task name will still use the old variable evaluation test play yml roles test tasks main yml normal playbook run displays the following however overriding testvar to baz on the playbook command line will return an interesting result >>>bug_report
update faq guru is not thing any more >>>docs_pull_request
raw execution with become hangs forever issue type bug report ansible version ansible version ansible config file home pasha projects ansible cfg ansible cfg configured module search path modules rpm ansible ansible git faf4c3b fc24 noarch ansible configuration irrelevant environment fedora 22 summary and hangs forewer please note there allowed sudo without password steps to reproduce playbook expected results run task and register var actual results hangs forever >>>needs_info pending_closure
add win splitdrive filter for windows users another little filter addition of use to those targeting windows its more advanced usage than other similar filters as it returns list of items but put example usage in the docs so hopefully not too confusing >>>plugin windows
add get service mrg facts it adds variable that holds the name of the system initialization>>>feature_pull_request needs_revision
show version without supplying dummy action fixes 12004 >>>feature_pull_request
fact caching is not working with redis issue type bug report ansible version environment host macos 10 10 installed ansible and redis 17 by port target centos steps to reproduce enable the redis server the settings in ansible cfg file check redis from python the response when run the ansible playbook try to deploy summary after upgraded ansible to version when enabled the fact caching with redis the ansible playbook seems not working with redis the host environment was working on ansible v1 http docs ansible com ansible playbooks variables html fact caching >>>bug_report needs_info
module resolution broken in the default library path library as well as command line overrides module path are broken in modules in either of these locations will not be found as they are in the only functioning mechanism to load custom modules in appears to be setting the library directive in ansible cfg jimi as requested>>>bug_report needs_info p1
failed to find required executable cpanm ansible version module cpanm want to install lwp protocol https using cpanm with the following task getting the following error message `msg failed to find required executable cpanm` have cpanm installed in `usr local bin cpanm` and the command works if log in and run it as the `ansible ssh user` it looks like the cpanm module also doesn include an executable parameter to specify where to look either can currently use the `environment` task parameter to include the bin directory in my path but that isn very clean am running this as user other than root >>>bug_report
error when using nonetype object has no attribute loop get the following error when testing my playbooks with the latest devel version >>>bug_report needs_info
ansible incorrectly reports all sslhandshakeerror as certificate errors simple test case as you can see the author specified 8000 for the port but their site is setup for 8443 for ssl instead of helpful error ansible returns unable to validate server certificate against available ca certs which leads to much tail chasing the real error is which if allowed to propagate would have made it much more clear that fundamental error was made >>>bug_report
cloudstack fixes and consistency change>>>bugfix_pull_request docs_pull_request
blank null hosts pattern defaults to all issue type bug report ansible version and ansible devel ab355218a0 environment summary play with blank empty null hosts value will default to run on all hosts steps to reproduce have playbook like this expected results would expect to see skipping no hosts matched actual results the playbook runs on all hosts in inventory this could be especially problematic if you parameterize your hosts line and forget to pass in extra vars or pass in the wrong value ps the pattern setting in ansible cfg seems like it should change this behavior but doesn >>>bug_report p2
tasks that take long time give no indication of how long when running playbook some tasks might take quite while to finish it would great if there was some feedback as to the progress of that task should expect it to take minute or 30 or is it stuck and will make no progress at all >>>feature_idea
rewrite inventory ini py the new code parses ini format inventory files in single pass using well documented state machine that reports precise errors and eliminates the duplications and inconsistencies and outright errors in the earlier three phase parsing code three ways to skip comments it is also much easier now to follow what decisions are being taken on the basis of the parsed data this has from srvg after review and testing cc abadger bcoca jimi c>>>feature_pull_request p2
update playbooks intro rst hosts separated by semi colon issue type documentation report ansible version devel summary small tweak that list of hosts in playbook should be separated by semi colon not colon as described >>>docs_pull_request
cannot retrieve facts from hostvars issue type bug report ansible version ansible configuration no change environment centos summary if playbook includes hostvars hostname the task fails with an exception like this problem does not occur on v1 after `git checkout v1 1` steps to reproduce execute `ansible playbook localhost hostvars yml vvv` hostvars yml is as below expected results facts on localhost are displayed actual results the task fails >>>bug_report p1
ansible galaxy won show it version if called without an action issue type bug report ansible version devel 1b810e3101 ansible configuration environment gentoo linux python summary to see the version of ansible galaxy one has to provide fake action because without an action ansible galaxy will just show the usage and an error message steps to reproduce clone current devel switch to hacking and execute ``ansible galaxy version`` expected results actual results >>>bug_report
rfe expose runtime tags to play issue type feature idea ansible version ansible configured module search path none environment ansible exposing invoked tags should be implemented cross platform summary when running playbook it would be handy to be able to determine which tags were used during invocation steps to reproduce the variable would be accessible alongside the other environment runtime variables such as original file inventory dir play hosts playbook dir role names role path role uuid expected results variable play tags would be set as list of tags passed to ansible playbook my play tags actual results there is no variable at this time >>>feature_idea
make get group run in log instead of by using cache 9437 rebase for ``ansible all ping`` on an inventory with 15k groups before 6615582 function calls 6579393 primitive calls in 29 742 seconds after 6616072 function calls 6579883 primitive calls in 540 seconds >>>feature_pull_request
double the speed of loading 10k host inventory file 10034 rebase before 104411688 function calls 104398055 primitive calls in 46 653 seconds after 4431688 function calls 4418055 primitive calls in 21 034 seconds>>>feature_pull_request
changed local action to alias to connection local vs delegate to locahost fixes 11998 but still leaves issue of delegate to localhost not working>>>bugfix_pull_request p1
variables defined in group vars don seem to be overriden by extra vars with parameterized includes issue type bug report ansible version ansible ansible configuration default environment ubuntu 14 04 lts summary variables defined in group vars are not overriden by extra vars when they are passed into includes parameterized include steps to reproduce playbook yml hosts localhost tasks debug var the variable include sometasks yml vars the variable as param the variable sometasks yml debug var the variable as param inventories group vars all the variable group vars wins inventories local localhost ansible connection local command line ansible playbook playbook yml inventories local the variable extra vars wins expected results when running this ansible play with the command above would expect to see the message extra vars wins in both debug statements as extra vars should always take precedent actual results we see that the two debug statements output different values as shown below task debug var the variable ok localhost var the variable extra vars wins task debug var the variable as param ok localhost var the variable as param group vars wins see here for git repo and bash script to recreate the issue https github com phillbarber ansile bug>>>bug_report
local action being run on target host instead of local machine issue type bug report ansible version ansible devel 86100da3a0 last updated 2015 08 18 13 23 59 gmt 700 lib ansible modules core detached head dea5f5d15e last updated 2015 08 18 13 23 11 gmt 700 lib ansible modules extras detached head 210ee3febc last updated 2015 08 18 13 23 11 gmt 700 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 18 13 23 11 gmt 700 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 18 13 23 11 gmt 700 ansible configuration we define remote user to be root and transport to be ssh environment centos summary when running from ansible devel 464a436f8f local actions run on the local machine as they should when running from ansible devel 86100da3a0 last updated 2015 08 18 13 23 59 gmt 700 lib ansible modules core detached head dea5f5d15e last updated 2015 08 18 13 23 11 gmt 700 lib ansible modules extras detached head 210ee3febc last updated 2015 08 18 13 23 11 gmt 700 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 18 13 23 11 gmt 700 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 18 13 23 11 gmt 700 they run on the inventory host machine even thought it is local action steps to reproduce run playbook hosts sample host tasks name testing localaction local action shell hostname register testingoutput debug var testingoutput expected results ansible devel 464a436f8f task testing localaction changed sample host changed true cmd hostname delta 00 00 002314 end 2015 08 18 13 59 34 326815 rc start 2015 08 18 13 59 34 324501 stderr stdout ansible server sample stdout lines ansible server sample warnings task debug var testingoutput ok sample host changed false testingoutput changed true cmd hostname delta 00 00 002314 end 2015 08 18 13 59 34 326815 rc start 2015 08 18 13 59 34 324501 stderr stdout ansible server sample stdout lines ansible server sample warnings actual results ansible devel 86100da3a0 task testing localaction changed sample host changed true cmd hostname delta 00 00 003015 end 2015 08 18 13 55 46 846948 rc start 2015 08 18 13 55 46 843933 stderr stdout sample host sample stdout lines sample host sample warnings task debug var testingoutput ok sample host changed false testingoutput changed true cmd hostname delta 00 00 003015 end 2015 08 18 13 55 46 846948 rc start 2015 08 18 13 55 46 843933 stderr stdout sample host sample stdout lines sample host sample warnings >>>bug_report p1
ansible playbook stops execution once it reaches an unreachable host if the serial keyword is defined issue type bug report ansible version ansible devel 5eeeb87d82 last updated 2015 08 18 20 05 58 gmt 200 lib ansible modules core detached head dea5f5d15e last updated 2015 08 17 19 13 02 gmt 200 lib ansible modules extras detached head 210ee3febc last updated 2015 08 17 19 13 06 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 17 19 13 09 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 17 19 13 13 gmt 200 config file etc ansible ansible cfg configured module search path usr share ansible ansible configuration source hacking env setup environment debian jessie amd64 python python pip freeze cheetah ipy 81 jinja2 m2crypto 21 markupsafe 23 pillow pyyaml 11 pygments soappy 12 22 sphinx ansible argparse astroid chardet colorama configobj croniter defusedxml docutils 12 ecdsa 13 feedparser html5lib 999 httplib2 logilab common lxml meld 12 msgpack python numpy paramiko 15 pep8 pycrypto pygobject 14 pylint python apt 11 python dateutil python debian 27 python debianbts 11 pytz 2012rc0 pyzmq 14 reportbug reportlab requests roman salt 2015 six smbus urllib3 vboxapi wsgiref wstools wxpython wxpython common summary if the serial keyword is defined in playbook and one of the hosts in the inventory is unreachable ansible playbook reports no more hosts left and doesn execute the plays on the rest of the hosts steps to reproduce clone the ansible git repository and run source hacking env setup create several vms with ssh configured write their ip addresses into an inventory file create playbook with serial the value of doesn matter and several plays just used shell echo test to test this run the playbook to test if it works properly ansible playbook vvv root inventory test playbook yml shut down one or more of the vms so they are no longer reachable run the playbook again expected results expected ansible playbook to report fatal error about the unreachable host but continue with the next batch until the tasks are run on all hosts at least that the behaviour get from and couldn find any mention in the changelog that this has been changed on purpose actual results once ansible playbook encounters the first unreachable host it will correctly report fatal 192 168 failed however it will only execute the tasks on the hosts that are selected by the current serial batch and will stop after that with the message no more hosts left even if there are more hosts remaining in the inventory tried it with different serial values 50 and also tried defining max fail percentage that is definitely above the percentage one failing host would cause relatively to the serial value and even tried inventories with 2000 hosts and raising the serial value it doesn seem to make difference >>>bug_report p2
variable from include vars in previous role not overridden by vars main yml in subsequent role issue type bug report ansible version please note that this appears to be fixed in devel for so feel free to close but this should obviously be turned into test case if one doesn exist ansible configuration default environment amazon linux summary if role sets variable using ``include vars`` and role sets the same variable in vars main yml the value from vars main yml is ignored steps to reproduce create these files main yml roles vars main yml roles vars dev yml roles tasks main yml roles vars main yml roles tasks main yml expected results play 127 gathering facts ok 127 task include vars dev yml ok 127 task debug var service ok 127 var service dev task debug var another var ok 127 var another var foo task debug var service ok 127 var service dev task assert failed 127 assertion service evaluated to false failed true >>>bug_report
third task of block is ignored in an included file issue type bug report ansible version ansible ansible configuration no change environment gentoo linux but probably does not matter summary if playbook includes another file for its tasks and this second file contains block of multiple tasks the third task of the block is not executed in all the tests ve done when trying to understand the problem it was always the third task which was ignored steps to reproduce run `ansible playbook test yml` with these files test yml include yml expected results all five tasks are executed actual results the third task is ignored >>>bug_report p1
handlers don fire when using tags issue type bug report ansible version ansible environment mac osx yosemite summary when running playbook with the tags option the tasks that are run that have `notify do not fire any handlers steps to reproduce create playbook that calls role in the role specify task that has `notify and place handler task in handlers main yml call your ansible playbook with tags config` and observe that the notify handler won be run example task note the above task may not be the best representation of this issue but rather just the basic outline of how we have tasks setup it could just be as simple as copying file and calling notify afterwards expected results the task with the tags should still honor the notify directive and fire any necessary handlers at the end of playbook execution actual results the playbook will complete without executing the handler at the end or when specifying the `meta flush handlers` task >>>bug_report p2
unable to use dict for defining scm dependency in meta main yml want to define role dependency in meta main yml that is dependency to role stored in github and want to provide `tags` for that dependency normally the dependency would be defined as such the code that handles parsing this spec https github com ansible ansible blob v1 lib ansible utils init py l417 doesn provide means to specifying `tags` within this style the next attempt was to convert the above to style similar to `requirements yml` file running with this definition results in the following message `error expected role name in dictionary scm git src git github com myorg ansible foo git version name foo tags bar this error comes from this line of code https github com ansible ansible blob v1 lib ansible playbook play py l218 however looking at the surrounding code https github com ansible ansible blob v1 lib ansible playbook play py l214 l221 it appears that if you define dependency as `dict` than you need to specify the `role` entry this results in ansible trying to install `foo` from ansible galaxy instead of from the scm so it appears there is no way to accomplish this construct other than unnecessarily decomposing the dependent role my suggestion would be that when defining dependency using `dict` that it should not error if either `role` or `name` are specified `role` should be priority and if not defined use `name` this is occurring using `1 1`>>>feature_idea
ansible manpage document that the command module is used by default the change documents that when module name is not given then the module command is used by default please pull>>>docs_pull_request
make ssh binary path configurable variable add ssh binary path to the list of configuration variables and make the existing code respect its value >>>feature_pull_request
changed check to avoid os broken sem getvalue hopefully fixes 11988 cc jimi >>>bugfix_pull_request p1
ansible play hangs on macosx ansible version installed from 7eaacaf66e070106035227ea4bd2a13a41691426 ansible configuration nothing special environment mac os yosemite python summary ansible playbook command hangs up after this error thinks because `queue qsize is not implemented at mac os see https github com python cpython blob 829b49cbd2e4b1d573470da79ca844b730120f3d lib multiprocessing queues py l116 steps to reproduce run any playbook like expected results play runs actual results it seems play hang up >>>bug_report p1
fatal no hosts matched or all hosts have already failed aborting issue type bug report ansible version ansible configuration force handlers true environment all my server is centos summary hi all have enabled force handlers true in ansible cfg file but when my playbook has failed to perform task handler task will all fail steps to reproduce expected results after playbook task fails the task before the fails can be performed notified tasks properly actual results task init add monitor fatal 10 11 146 one or more undefined variables sid is undefined fatal 10 11 134 one or more undefined variables sid is undefined notified init restart iptables fatal no hosts matched or all hosts have already failed aborting notified init apply sysctl fatal no hosts matched or all hosts have already failed aborting notified init restart crond fatal no hosts matched or all hosts have already failed aborting notified init restart nrpe fatal no hosts matched or all hosts have already failed aborting>>>needs_info
added boolean to return security groups as list rather than scalar need to iterate over the list of security groups rather than parsing locally every time consume them modified ec2 py to return list >>>cloud feature_pull_request
support any mapping for with dict lookup this resolves 39393482865201532da778f103aef35d35c38026 breaking `with dict hostvars` >>>bugfix_pull_request
unexpected exception nonetype object has no attribute run state when host is not reachable with strategy linear issue type bug report ansible version ansible devel 4068598c15 last updated 2015 08 17 19 12 58 gmt 200 lib ansible modules core detached head dea5f5d15e last updated 2015 08 17 19 13 02 gmt 200 lib ansible modules extras detached head 210ee3febc last updated 2015 08 17 19 13 06 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 17 19 13 09 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 17 19 13 13 gmt 200 config file etc ansible ansible cfg configured module search path usr share ansible ansible configuration source hacking env setup environment debian jessie amd64 python python pip freeze cheetah ipy 81 jinja2 m2crypto 21 markupsafe 23 pillow pyyaml 11 pygments soappy 12 22 sphinx ansible argparse astroid chardet colorama configobj croniter defusedxml docutils 12 ecdsa 11 feedparser html5lib 999 httplib2 logilab common lxml meld 12 msgpack python numpy paramiko 15 pep8 pycrypto pygobject 14 pylint python apt 11 python dateutil python debian 27 python debianbts 11 pytz 2012c pyzmq 14 reportbug reportlab requests roman salt 2015 six smbus urllib3 vboxapi wsgiref wstools wxpython wxpython common summary when host is unreachable ansible playbook throws an attributeerror nonetype object has no attribute run state if strategy linear is selected in the playbook or none is selected explicitely steps to reproduce clone the ansible git repository and run source hacking env setup create several vms with ssh configured write their ip addresses into an inventory file create playbook with strategy free and several plays just used shell echo test to test this run the playbook to test if it works properly ansible playbook vvv root inventory test playbook yml shut down one or more of the vms so they are no longer reachable run the playbook again once the host which is not reachable is reached ansible playbook stops execution and throws the exception expected results expected that fatal error would be reported like it happens with other ansible versions tested with but the playbook run would finish even if one or more hosts are down actual results unexpected exception nonetype object has no attribute run state the full traceback was traceback most recent call last file tmp ansible test ansible bin ansible playbook line 79 in sys exit cli run file tmp ansible test ansible lib ansible cli playbook py line 135 in run results pbex run file tmp ansible test ansible lib ansible executor playbook executor py line 141 in run result self tqm run play play file tmp ansible test ansible lib ansible executor task queue manager py line 192 in run return strategy run iterator play context file tmp ansible test ansible lib ansible plugins strategies linear py line 147 in run host tasks self get next task lockstep hosts left iterator file tmp ansible test ansible lib ansible plugins strategies linear py line 109 in get next task lockstep return advance selected hosts hosts lowest cur block playiterator iterating tasks file tmp ansible test ansible lib ansible plugins strategies linear py line 91 in advance selected hosts if run state cur state and cur block cur block attributeerror nonetype object has no attribute run state >>>bug_report p1
include statements are slower as the playbook run and memory rockets up through the roof hello edit sorry forgot to say using the devel branch and have no idea if these speed are reproducible on the branch as using some functionality blocks that isn available except on the devel branch so my specs are ansible devel branch on yosemite 10 10 the version of python using is 10 as installing it using homebrew the vm is running ubuntu on vagrant virtualbox provider edit clarification understand why includes are being ran even when nothing will be performed parsing the tags inside of each sub task seems relevant for the correct behavior of ansible what don understand however is the memory consumption cpu usage going up the roof and the run times slowing down as the application performs noticed that this was accentuated by my usage of dictionary based variables maybe it wasn clear in the first place consider this role each of these sub tasks are themselves including files that themselves include other files since most of the functionality is dry across the role am noticing an insanely slow speed unrelated to the connection speed just have set up vm to make sure of that if run all the commands manually verbatim from what the ansible logs give me end up with minute 20 seconds run total time again commands equivalent as if was running the role without tags at all if run them via ansible only using the last tag of the playbook takes more than 35 minutes also have played around and after simply copy pasting ansible commands in one single ugly big playbook the timings are back to something acceptable maybe my poking around will solve the issue but having fat playbook of 2k lines instead of nice and tidy packed dry approach seems quite unmaintainable to me if start the playbook with the last tag only `realtime dasherize` here is what happens here is snippet of the included files because really think it could profit the community as had incredible problems using the builtin docker module the one that is the most slow is `build container yml` as it takes up to 30 seconds once the playbook reaches the end so noticing inconsistent timings as the memory goes up memleak stacked variables after around 35 minutes running here is snapshot of the process resources usage thanks for your time reading this admit very long report >>>bug_report p2
fix variable name mis match in website docs for ansible library also clean up some dangling whitespace in docsite rst developing modules rst>>>docs_pull_request
with sequence skips if start and end are equal ansible version ansible actually task with with sequence skips if the set start and end would be equal would expect that the task would run once example given instance count stdout the actual count of running container instances the number of container which should run so if got two container running which means instance count stdout int and want to increase the count up to three container instances would expect that ths task would run once otherwise if set instances it would run the task two times and got two container more from my point of view this could not be handled similar to the count of btw know that there docker module but it seems that it too fragile at the moment best markus>>>bug_report
unicode bug when using copy module ansible im having an issue with the following jinja2 template playbook yml name testing hosts dev vars you say hi tasks name copy copy dest home jefurry tmp test txt content you say it works fine but hosting dev home jefurry tmp test txt file contents is messy code like this hi thanks >>>bug_report
cloudstack add more common returns>>>feature_pull_request
improve site documentation edits add constants py link clarify command warnings update intro to playbook to improve readability the following sections are updated yaml dictionary module idempotent name attribute handlers>>>docs_pull_request
add become support for openbsd doas this adds new become method `doas` to support openbsd `doas` there are few things about this that not big fan of but couldn see cleaner way to do this `doas` treats its first argument as the command to execute so we can `doas foo bar python path to python script this will fail as there is no binary called `foo bar python path to python script` similarly environment variables aren commands as far as can tell `ansible` always starts command by setting environment variables so this patch makes the assumption that this is always the case this seemed easier and less fragile than trying to parse `cmd` to determine if environment variables were in fact being set perhaps this can be made safer with env ansible true s` overall it pretty rudimentary and still requires modifications to ansible modules core commands command py https github com ansible ansible modules core blob devel commands command py l146 but it at least functional on my system fixes 11972>>>feature_pull_request needs_revision p2
template module breaks jinja2 include context issue type bug report ansible version ansible version jinja2 version obtained from pip install on os described hereafter ansible configuration no change environment ubuntu 14 04 03 lts no virtualenv pip installed summary jinja added the possibility to use the variable yielded by for loop into an included template from jinja website http jinja pocoo org docs dev templates include note in jinja the context that was passed to the included template did not include variables defined in the template as matter of fact this did not work the included template render box html is not able to access box in jinja as of jinja render box html is able to do so although use jinja along with ansible this feature is unavailable broken by the ansible template module this report is not feature support request but stop breaking feature request steps to reproduce to reproduce the bug use the following playbook tmp tmpl contains tmp do smth with elmt expected results no error message from ansible and rendering of the template actual results output from ansible is comment if had to do some fingerpointing would blame the `new context` system of the `j2template` class https github com ansible ansible blob stable lib ansible utils template py l212 l213 since am totally unfamiliar with ansible source code might be wrong though at any rate the following python script runs flawlessly on my machine thank you >>>bug_report
pre connect and post connect scripts looking some nice feature like pre connect and post connect options in inventory file which could allow me execute script with inventory data like user host or port information before and after establishing connection to host over ssh this could be useful to disable enable firewall execute port knock etc >>>feature_idea
compatibility with openbsd doas hello am currently playing with ansible on openbsd to be released later this year am having issues with privileges escalation as openbsd has replaced sudo with doas cf http www tedunangst com flak post doas http www openbsd org 58 html have tried setting this in my config file sudo exe usr bin doas sudo flags but think ansible still pass more parameters to sudo than just and therefore get the following error doas unknown option usage doas ns config user command args am missing something if not it would be very helpful to be able to use doas as replacement for sudo in ansible thanks >>>feature_idea p2
update intro installation rst improve documentation >>>docs_pull_request
fix 11968 use the real python interpreter in templates fix https github com ansible ansible issues 11968 am unsure of how to test that correctly however this piece of code fixed the bug for me >>>bugfix_pull_request p1
devel python interpreter not taken in account for template checksum issue type bug report ansible version latest version of `devel` ansible configuration also `ansible python interpreter` is set to home core bin python` on the relevant servers ran the same tests with `pipelining` to false as well environment try to send template to my coreos servers they have no python by default so the interpreter is manually installed in home core bin python` summary trying to use the `template` action will result in an error which is no python interpreter steps to reproduce on server bootstraped with the `defunctzombie coreos bootstrap` playbook try to send template expected results the file generated by template should be uploaded to the remote server this is what happens in `1 9` actual results as you can see it seems that the python interpreter is simply `python` and not the one specified in `ansible python interpreter` this results in an error code `4` the value for the servers in question is home core bin python` >>>bug_report p1
fix rm call in hacking env setup since it is sourced from user shell rm can have an alias to rm which will make sourcing hang when is enabled squashing went wrong so redid the pr closes 11951 >>>bugfix_pull_request easyfix
update the irc channel address the irc channel address was out of date pointing to blank page also make it link not sure if this is the right place to make this change >>>docs_pull_request needs_revision
typeerror nonetype object is not iterable when host is not reachable with strategy free issue type bug report ansible version ansible devel 4fc905b1d5 last updated 2015 08 14 22 36 03 gmt 200 lib ansible modules core detached head dea5f5d15e last updated 2015 08 14 22 36 07 gmt 200 lib ansible modules extras detached head 210ee3febc last updated 2015 08 14 22 36 11 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 14 22 36 14 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 14 22 36 17 gmt 200 config file etc ansible ansible cfg configured module search path usr share ansible ansible configuration source hacking env setup environment debian jessie amd64 python python pip freeze cheetah ipy 81 jinja2 m2crypto 21 markupsafe 23 pillow pyyaml 11 pygments soappy 12 22 sphinx ansible argparse astroid chardet colorama configobj croniter defusedxml docutils 12 ecdsa 11 feedparser html5lib 999 httplib2 logilab common lxml meld 12 msgpack python numpy paramiko 15 pep8 pycrypto pygobject 14 pylint python apt 11 python dateutil python debian 27 python debianbts 11 pytz 2012c pyzmq 14 reportbug reportlab requests roman salt 2015 six smbus urllib3 vboxapi wsgiref wstools wxpython wxpython common summary when host is unreachable ansible playbook throws an typeerror nonetype object is not iterable if strategy free is selected in the playbook steps to reproduce clone the ansible git repository and run source hacking env setup create several vms with ssh configured write their ip addresses into an inventory file create playbook with strategy free and several plays just used shell echo test to test this run the playbook to test if it works properly ansible playbook vvv root inventory test playbook yml shut down one or more of the vms so they are no longer reachable run the playbook again once the host which is not reachable is reached ansible playbook stops execution and throws the exception expected results expected that fatal error would be reported like it happens with other strategy plugins linear but the playbook run would finish even if one or more hosts are down actual results fatal 192 168 178 97 failed failed true msg error ssh encountered an unknown error during the connection we recommend you re run the command using vvvv which will enable ssh debugging output to help diagnose the issue unexpected exception nonetype object is not iterable the full traceback was traceback most recent call last file tmp ansible ansible bin ansible playbook line 79 in sys exit cli run file tmp ansible ansible lib ansible cli playbook py line 135 in run results pbex run file tmp ansible ansible lib ansible executor playbook executor py line 141 in run result self tqm run play play file tmp ansible ansible lib ansible executor task queue manager py line 192 in run return strategy run iterator play context file tmp ansible ansible lib ansible plugins strategies free py line 77 in run state task iterator get next task for host host peek true typeerror nonetype object is not iterable>>>bug_report p1
ansible gets confused and converts to the issues is described in this stakoverflow thread along with temp workaround http stackoverflow com questions 31969872 why ansible always replaces double quotes with single quotes in templates 32014283>>>bug_report
ssha py convert term to ssha encoded password this is to encode string in an ssha password used in ldap>>>feature_pull_request
playbook ignoring vars files entry issue type bug report ansible version ansible configuration none environment osx summary the 2nd vars file is not loaded steps to reproduce put the above in playbook and observe expected results loading variables from dynamic file by name actual results the file is not included and silently ignored instead when the file doesn exist it is ignored as well where normally decent error is shown >>>needs_info
add host module returns nonetype object trying to use the add host module to add fresh servers to group for tasks later in the playbook keep getting this error it will fail the first run but during the second run will work fine ve included the two previous tasks to show how the with items works my tasks the errors >>>bug_report
fix typo on aws guide page assume this should read ansible modules rather than ansible ansibles>>>docs_pull_request
another include pathing issue issue type bug report ansible version ansible configuration `no config file found using defaults` environment running on mac os summary someone suggested should use playbook dir roles instead of to include files from outside the current role did this partially in response to 11895 now found that this breaks in similar way to 11895 pre fix steps to reproduce expected results proper inclusion and execution of `roles test 11955 tasks yml` actual results >>>bug_report p2
update readme md for legacy v1 correct formatting of bullet points>>>docs_pull_request
small inventory host range parsing fixes this removes some dead code revises few comments and fixes the problem of parsing foo bar baz into list >>>bugfix_pull_request p2
different behaviour with include and include vars ansible version include vars filename works as expected but include filename gives error error file could not read tasks filename filename is variable which is set to tasks test yml>>>bug_report
fix rm call in hacking env setup since it is sourced from user shell rm can have an alias to rm which will make sourcing hang when is enabled >>>bugfix_pull_request easyfix needs_revision p2
draft bsd intro and bootstrapping needs more data about openbsd netbsd and newer freebsd package management >>>docs_pull_request
support exiting ansible playbook with custom exit code when automating execution of ansible playbook as part of continuous build process it useful for the automation framework to understand how playbook failed this feature request is to support some way for playbook to indicate what the process exit code should be when ansible playbook exits for example this could be an argument to the fail module example workarounds are to capture the output of ansible playbook and scan it or to have the playbook write some file that the automation reads afterward both are pretty hacky >>>feature_idea
cloudstack refactor get result commen dict of keys has been defined which we look in results returned from the api self returns dict can be use in subclass to extend this dict optionally the key name can be replaced with new key name often used to make the return keys identical to the arguments passed use new style class>>>bugfix_pull_request
prevent local logging of module args under vv when no log specified module args were getting logged with vv even when no log was set this caused sensitive data to be logged eg under tower verbose setting >>>bugfix_pull_request
vars files does not give error messages in issue type bug report ansible version devel branch ansible configuration nothing changed environment summary in if file included in vars files had an error it would error out now it silently drops the file steps to reproduce add file to load in vars files and inclue bad line in that vars files used the following line expected results in we get the following error message actual results the file is silently not loaded and the run continues >>>bug_report p2
relative pathing not working properly for unarchive issue type bug report ansible version ansible devel 8e30e3791e last updated 2015 08 12 09 31 46 gmt 500 lib ansible modules core detached head dea5f5d15e last updated 2015 08 12 09 31 49 gmt 500 lib ansible modules extras detached head 210ee3febc last updated 2015 08 12 09 31 51 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 12 09 31 55 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 12 09 31 58 gmt 500 config file configured module search path none environment centos vagrant summary relative path not working for unarchive using roles it not finding the archive in role files directory to deploy in devel it works as expected in steps to reproduce roles testme tasks main yml test yml expected results archive deployed on remote host actual results >>>bug_report p2
role named test doesn run properly in the devel version issue type bug report ansible version ansible devel 8e30e3791e last updated 2015 08 12 09 31 46 gmt 500 lib ansible modules core detached head dea5f5d15e last updated 2015 08 12 09 31 49 gmt 500 lib ansible modules extras detached head 210ee3febc last updated 2015 08 12 09 31 51 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 08 12 09 31 55 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 08 12 09 31 58 gmt 500 config file configured module search path none what have you changed about your ansible installation what configuration settings have you changed added removed compare your etc ansible ansible cfg against clean version from github and let us know what different bug is in devel branch works fine with environment centos vagrant role named test doesn run properly in the devel branch it works as expected in steps to reproduce test yml roles test roles test tasks roles test tasks main yml cp rp test test2 main yml test yml expected results run the role in this case with trivial example tasks list actual results works as expected with both roles devel runs setup task but it doesn run through the tasks with role test runs as expected with role named test2 >>>bug_report needs_info
bugfix missing path for lvm facts issue type bugfix pull request ansible version ansible fix lvm facts 1ea1b9fb13 last updated 2015 08 12 16 35 31 gmt 200 lib ansible modules core detached head 072c4f38ea last updated 2015 08 12 15 55 49 gmt 200 lib ansible modules extras detached head dcd2f441b5 last updated 2015 08 12 15 55 54 gmt 200 v1 ansible modules core not found use git submodule update init v1 ansible modules core v1 ansible modules extras not found use git submodule update init v1 ansible modules extras summary pr https github com ansible ansible pull 11762 works fine on my sles system but on centos vgs can be found this pr adds the binary path please review and give feedback>>>bugfix_pull_request
win file module does not work with state touch under version hello together my ansible playbook contains the task win file path foo conf state touch the file is created under the version but not under the version no exception is thrown under both versions my win rm modules are the same in both versions can anyone please check if the the command win file path foo conf state touch runs in lower version than strange thing win file path foo conf state directory works in both versions >>>bug_report needs_info windows
configurable location of ansible async accessing tplink routers running openwrt with root user in the given configuration the root filesystem is mounted read only still like to run some async job there which is not possible as ansible tries to place the job cache in root ansible async have not found any way to change this via configuration so at the moment there is no async jobs for me it would be good to have it configurable just like the ansible tmp dir>>>feature_idea
document any errors fatal and max fail percentage currently `any errors fatal` and `max fail percentage` are undocumented both are useful options so mention them in error handling they should really also be listed in the playbook options list to be added later >>>docs_pull_request
allow more colors into slack plugin from slack documentation color 36a64f can either be one of good warning danger or any hex color code ansible only supports normal good warning danger please update the dict with more colors eg color dict type str default normal choices normal good warning danger 9344bb 9344bb eed5b7 fef1b5 990000 fcac3a dc5757 452945 412d61 008b8b dae5e8 f6ba00 ff34b3 808000 838b00 008000 0038ff 46ff65 ffe69a fff19a ffc89a e30472 18f008 d3ffce afbec5 f9105e a63ffd 07a86d 3cff00 ffa7b6 397fdb cdc5ff 27ae60 ce0f0f faf9f9 ffd700 ffd700 faf9f9 ce0f0f 3a3553 afbec5 000000 >>>feature_idea
ansible doesn give an error when using non existent group in playbook issue type bug report ansible version ansible steps to reproduce use hosts group1 group2 group3 group4` in any playbook and as long as one group exists and matches one host the play will run with no error expected results ansible playbook error doesn exist actual results playbooks are run anyway >>>bug_report
fix docsite ad placement on safari the previous fix needed some attributes added to safari as well as one max width attribute added for firefox to display ads correctly in all browsers>>>docs_pull_request
improper pathing for jinja2 includes issue type bug report ansible version ansible configuration `no config file found using defaults` environment running on mac os summary an `include` in jinja2 template should accept path relative to the directory where the template file resides this doesn work but full path or path relative to the playbook directory both do steps to reproduce `main yml` `test j2` expected results expanded template at tmp foo` actual results however if change the `src setting `test yml` new result and then tmp foo` has the expected contents full absolute path also works >>>bug_report p2
display skipped hosts unexpectedly suppresses runner on skip callback issue type bug report ansible version ansible configuration environment summary the `display skipped hosts` flag unexpectedly suppresses `runner on skip` callback this is surprising behavior as one would expect it would only suppresses the default logging of skipped hosts see callbacks py l561 https github com ansible ansible blob stable lib ansible callbacks py l561 for the error steps to reproduce set `display skipped hosts false` in ansible cfg make callback plugin implement `def runner on skipped self host item none run with skipped hosts say `when` clause expected results callback should always fire actual results callback does not fire >>>bug_report
update docsite ads this updates the padding of the square ad in the nav bar to be full width as well as includes the new tower ads >>>docs_pull_request
if in template breaks ansible hi using here the following code breaks well something actually im not sure whats broken here https gist github com mschirmacher 034c2c95d0f59e43e14e the result on my machine is task debug var somevar ok localhost var somevar broken bar map if foo map if task debug msg somevar to json fatal localhost duplicate parameter was found in the argument string fatal all hosts have already failed aborting funnily it works if you remove the blank between if and in the template>>>bug_report needs_info
tree does not save output ansible created rpm and installed on server command ansible setup out all command ansible setup tree out all expected result output file with facts saved for each host in inventory actual result no files are saved >>>bug_report
cloudstack add get result in utils to return common results>>>feature_pull_request
9433 rebase cache the results for the rackspace dynamic inventory this is trivial rebase handled automatically by git way merge of pr 9433 by intellitronica to target ``contrib inventory rax py`` >>>cloud feature_pull_request
update playbooks tags rst this important point gets lost in the fixed width word wrap of the docs site separating it out to it own line stops it being lost in the noise of the previous sentence >>>docs_pull_request
randomly disappearing ohai variables having weird intermittent problem with ansible on my os machine this was present in and still is in ve installed ohai onto several servers administering with ansible one of the tasks is as follows name check python version set fact python is old ohai languages python version version compare in the course of doing several ansible playbook runs for various groups they all start ok but then some or all of them may subsequently randomly run into fatal error with this task task common check python version fatal some server one or more undefined variables ohai languages is undefined fatal all hosts have already failed aborting sometimes but not always `rm retry` will help sometimes but not always starting new terminal session and re running the command will help sometimes neither will and end up commenting out the task running the playbook and then uncommenting it later on full run with the task included may again work normally running `ansible setup some server` after an error will show that none of the ohai variables are populated but when ssh into the server the `ohai` command works just fine later runs of the same fact printing command may or may not again show the ohai stuff right now as writing this did the following procedure run the playbook fails on ohai languages run `ansible setup some server` ohai not present cmd close the terminal tab cmd start another one run `ansible setup some server` all ohai variables are back run the playbook fails on ohai languages again but might as well work this time depending on karma or something mystified >>>bug_report needs_info
cli galaxy py scm archive role is not defined error it seems that scm archive role is not defined in lib ansible cli galaxy py https github com ansible ansible blob devel lib ansible cli galaxy py l369 this causes the an error with ansible when you run ansible galaxy requirements yml and you have git repository as source such as the exception get is the same command with the same requirements yml file works with ansible might be related to bcoca changes some weeks ago https github com ansible ansible commit 96bcf50a943e31e1fb254ec2811d96c7f2e6a955 diff 0fb1ac8e85c5f8b604a2bcbbe16a50c8 because not using github com but github enterprise instead >>>bug_report
boto profile not being used by ec2 vpc issue type bug report ansible version boto version 38 ansible configuration nothing special environment ox 10 10 summary ec2 module is running fine with the usage of profile and region ec2 vpc however gives an authentication error with the same values specified for profile and region if manually set the variables and re run the playbook it runs fine steps to reproduce playbook expected results yeah know get an error as well but you get the point my full playbook using ec2 vpc is working fine if the environment variables are set this is more or less copy from the documentation http docs ansible com ansible ec2 vpc module html actual results >>>cloud feature_pull_request
httplib httpsconnection used even when has ssl false issue type bug report ansible version jed jed ansible version ansible configured module search path none ansible configuration stock environment any host os managed os coreos on gce summary when google vendors coreos for their platform they include python interpreter for daemons owned by them since we do not ship one in the os conveniently for me can then use this interpreter to manage ansible and this works fine for pretty significant deployment at present the one roadblock is that this subclass https github com ansible ansible blob devel lib ansible module utils urls py l314 blindly uses `httplib httpsconnection` even though `import ssl` was guarded further up google hasn included openssl in its build of python so `import ssl` fails which sets `has ssl` to `false` which then implies that `httplib httpsconnection` is nonexistent there are obviously couple solutions here including google recompiling python with openssl but it seems like since work was put in to do the `has ssl` guard it should apply to the whole file trying to `get url` cleartext url so don need the extra tls centric functionality began writing patch to guard this extra functionality under `has ssl` but quickly lost the plot and broke ansible inexplicably so just filing an issue instead steps to reproduce launch coreos on google compute engine attempt to manage it with `ansible python interpreter usr share oem python bin python2 7` use `get url` play expected results successful file download actual results task kubelet install kubelet failed core1 coreos systems failed true parsed false become success xugzhlvqovsgnxebwkpyiptibpqnkrhn openssh 2p2 osslshim 8r dec 2011 debug1 reading configuration data users jed ssh config debug1 users jed ssh config line applying options for coreos systems debug1 reading configuration data etc ssh config debug1 etc ssh config line 20 applying options for debug1 auto mux trying existing master debug1 mux client request session master session id traceback most recent call last file line 2201 in attributeerror module object has no attribute httpsconnection >>>bug_report
add listall true param to listpublicipaddresses `listall true` is required in order to see all the ip addresses you are authorised to access not just the ones you own cc resmo sorry ve mentioned you few times today https cloudstack apache org api apidocs domain admin listpublicipaddresses html>>>cloud feature_pull_request
fix syntax error introduced in d35b9569006be8b6>>>bugfix_pull_request
adding documentation for ask vault pass usage in ansible cfg this should close 11914>>>docs_pull_request
no documentation for ask vault pass usage in ansible cfg the `ask vault pass` is allowed to be present in the configuration file https github com ansible ansible blob devel lib ansible constants py l131 and currently it works as expected it is not documented however >>>docs_report
ansible ssh pass with symbol causes trouble if got line like this in `hosts` and try to run playbook against that host im getting this failure when removed the hash from the password it all went away>>>bug_report
task entry environment is not auto templated v2 using the role bennojoy mysql role https github com bennojoy mysql noticed the environment keyword is not being autotemplated as is the case pre and as documented updating the role with this patch fixes it but the original behaviour should be patched in ansible of course verified using ansible devel e32d887609 last updated 2015 08 10 17 56 12 gmt 200 >>>bugfix_pull_request
colon in password causes strange issues with ssh port variable traceback most recent call last file usr local cellar ansible libexec bin ansible playbook line 324 in sys exit main sys argv file usr local cellar ansible libexec bin ansible playbook line 157 in main inventory ansible inventory inventory options inventory vault password vault pass file usr local cellar ansible libexec lib python2 site packages ansible inventory init py line 100 in init self parser inventorydirectory filename host list file usr local cellar ansible libexec lib python2 site packages ansible inventory dir py line 54 in init parser inventorydirectory filename fullpath file usr local cellar ansible libexec lib python2 site packages ansible inventory dir py line 54 in init parser inventorydirectory filename fullpath file usr local cellar ansible libexec lib python2 site packages ansible inventory dir py line 58 in init parser inventoryparser filename fullpath file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 43 in init self parse file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 47 in parse self parse base groups file usr local cellar ansible libexec lib python2 site packages ansible inventory ini py line 140 in parse base groups host host name hn port port file usr local cellar ansible libexec lib python2 site packages ansible inventory host py line 32 in init self set variable ansible ssh port int port valueerror invalid literal for int with base 10 kyx0vx gpwqygyt >>>bug_report
synchronize conditional support of zz instead of compress in rsync in private email giles orr reports using it to set up openwrt in attempting to use the synchronize module got the following error failed owrt 127 cmd rsync delay updates compress archive rsh ssh none stricthostkeychecking no out format tmp owrt git repo root owrt root bin failed true rc 12 msg rsync this rsync lacks old style compress due to its external zlib try zz rsync error syntax or usage error code at main 1554 server rsync connection unexpectedly closed bytes received so far sender rsync error error in rsync protocol data stream code 12 at io 226 sender so searched synchronize py and replaced the only occurrence of compress with zz and it worked note that on github ansible modules core files synchronize py still includes compress this message was passed along to abadger who says so just looked at the man page and it looks like zz wasn implemented until there some room for interpretation of whether the option might be accepted earlier but not do anything we have to check if we want to go further into this since rhel6 is on version of rsync don think we can just replace it maybe we can detect the error and try the alternation cli argument workaround turn off the compress feature in the synchronize module with `compress no` and pass zz` using the `rsync opts` >>>feature_idea
jinja2 lookup template hangs issue type bug report ansible version ansible configuration stock `ansible cfg` environment but running on mac os summary when template contains `lookup template playbook execution hangs steps to reproduce `roles test tasks main yml` `roles test templates test j2` `roles test templates test2 j2` expected results complete playbook execution with fact set like this run against tag `v1 1` actual results >>>bug_report
add ansible ssh extra args inventory variable this pr does two things adds an ``ansible ssh extra args`` inventory variable and makes it possible to override on the command line when it set the specified arguments are added to the ssh command for host group everyone this is applied in addition to any ``ssh args`` configured in ``ansible cfg`` so there no need to repeat the default ``controlpath`` settings note that ``ssh args`` cannot be set as an inventory variable so it all hosts or nothing the primary use of this feature is to specify per host or per group ``proxycommand`` in the inventory to use jump host of course it may have other uses as well depending on the complexity of the ssh configuration this is an oft requested feature and it the minimum common feature to both prs 9122 by sivel and 9477 by nitzmahone which seek to make it easier to use by assembling the proxy command from simpler settings both of those prs are currently outdated not being worked on actively and complex enough that they seem unlikely to make it to v2 in contrast this pr is very low impact and ve tested that it sufficient to set jump host it also will not conflict with the more user friendly change attempted in the prs referenced above should they be resurrected in future consulted bcoca on the implementation via irc and he seemed to agree that this was the least intrusive way to implement the desired feature >>>feature_pull_request
inventory option in config ignored just updated my ansible clone from the master branch the `inventory` option http docs ansible com ansible intro configuration html inventory in the `ansible cfg` now is ignored defaults inventory inventory default error unable to find an inventory file etc ansible ansible hosts specify one with this used to work in all previous versions since inventory was introduced as config option >>>bug_report
add ec2 spot request validity ansible ec2 module doesn have the possibility to create an ec2 spot request with validity valid from and valid to this is necessary when we need spot request to be valid for while hour for example >>>feature_idea
ansible converts strings into booleans without bool filter applied issue type bug report ansible version ansible devel https github com ansible ansible commit e32d88760906da5ed473570218b5831292e0bfa8 ansible configuration standard `ansible cfg` environment debian ubuntu summary ansible converts strings yes and no into booleans `true` and `false` when it is not asked to this can interfere when user wants to have literal strings `yes` or `no` passed through variable steps to reproduce expected results actual results >>>bug_report
update hashing algorithms hello was playing with ansible and in the hashing py file found in the utils folder found that sha and md5 are being used as such suggest updating the file can do it with pull req to either sha 256 or more and as fallback sha regards>>>feature_idea
mongodb users module not creating users have the following task name setup db users mongodb user database item database name item user password item password state item state ssl item ssl roles item roles default omit with items mongo users when mongo users is defined with the following list mongo users database gummy user bearuser password 123456admin1234567 state present ssl false when running the playbook the task is set as changed every time going into mongo shell the db is created but when doing `show users` for the given db it does not show the user have tried disabling selinux to no avail ansible version os centos mongodb 10 >>>bug_report needs_info
script module no longer honors sudo sudo user become user recently updated the version of ansible running from ebc8d48d34296fe010096f044e2b7591df37a622 to 29809bb83d6f3bf1f9ed3eb6655eadf9f380a0f3 noticed that tasks such as the following are effectively ignoring the `become user` declaration also true if go with the deprecated `sudo yes` `sudo user git` declarations can see this in the output of run with vvvvv` as you can see the `ssh` command is just running the uploaded script without `sudo` believe this may be regression or is it intended behavior my workaround in the meantime is to put the relevant `sudo` commands inside the script itself so this isn huge issue but nevetheless thought it was worth bringing to your attention >>>bug_report
tiny typo fix environment>>>docs_pull_request
shell module arguments are interpreted incorrectly issue type bug report ansible version ansible devel https github com ansible ansible commit dbab7032658b6e70da229966251ad0d1292a6419 ansible configuration standard `ansible cfg` environment ubuntu debian summary `shell` module arguments are incorrectly interpreted quoting doesn help steps to reproduce task can be found in production role https github com debops ansible nginx blob master tasks main yml l58 l61 it also copied here original version quoted version expected results both versions of above playbooks should return list of available nameservers actual results unquoted first playbook returns an error quoted second playbook doesn parse the task list correctly >>>bug_report p1
grouping by aws scheduled maintenance events occasionally aws will shut down an instance if there something wrong with the underlying hardware this pull request allows you to group by instances scheduled for maintenance and their maintenance type >>>cloud feature_pull_request
add new size computation on mountpoint used space block used this pull request replace this one https github com ansible ansible modules extras pull 563 during fact gathering the module compute new values including used space percent block information inode information percent >>>feature_pull_request
improper pathing of included files issue type bug report ansible version ansible configuration stock `ansible cfg` environment running on mac os summary believe `include`s should be relative to the file where the `include` appears not relative to the top level playbook steps to reproduce `roles test tasks main yml` `roles test2 tasks yml` `roles test2 tasks yml` expected results execution of plays in `b yml` actual results >>>bug_report
adding variables section to playbook lookups doc also cleaned up few white spaces in the readme and aligned the indentation in the playbook lookups section that contributing to >>>docs_pull_request needs_rebase
variables not set on successive runs when using vars syntax instead of inline the following works main yml otherfile yml otherfile2 yml results on 8f106c9a58 if change otherfile yml to the following the results change to >>>bug_report
doing registered var and conditional based on that registered var in the same task does not error out issue type bug report ansible version ansible configured module search path none note this is not bug in v2 ansible configuration default environment osx to localhost and osx to rhel summary if you have task that registers var then has conditional like `when` that references that registered var via `is defined` the task does not error out the task is evaluated to false every time steps to reproduce do expected results `error while evaluating conditional temp stat exists` or an undefined var error actual results >>>bug_report
regex replace requires backslashes to escape for key value argument issue type bug report ansible version ansible configuration environment summary upgraded ansible from to recently and the `regex replace` backreference escaping stopped working it now requires backslashes to escape for `key value` argument instead of which is different from what described in the documentation below if regex replace filter is used with variables inside yaml arguments as opposed to simpler key value arguments then you need to escape backreferences with backslashes instead of steps to reproduce expected results expected the output message to be test for the second case which would be consistent with v1 actual results for ansible v2 for ansible v1 >>>bug_report p2
fix powershell splatting leaving executionpolicy unrestricted intact changed powershell py to fix powershell splatting to make sure the exectutionpolicy stays working added executionpolicy unrestricted to common args this restores support for myscript ps1 key value another value >>>bugfix_pull_request windows
attributeerror tuple object has no attribute iteritems issue type bug report ansible version ansible version ansible config file configured module search path none fully patched mac osx 10 10 on maxed out late 2013 mbp retina summary expected results successful setting of ver actual results >>>bug_report needs_info
patch runner action plugin in ansible is broken with remote source patch file there are problems contrary to the documentation and the patch module intent the runner uses remote src to true by default the runner don copy correctly the source patch file from the master to the remote host so the module execution fails this pull request fixes this problems btw from what see this is not an issue in the devel branch the runner code has been completely redone however propose this simple fix for the people running the stable branch >>>bugfix_pull_request
add missing not sure how this was lost but ``env setup`` is broken without it source hacking env setup hacking env setup 28 number expected >>>bugfix_pull_request easyfix
template module creates backups as owner root have task that runs template with sudo yes and backup yes the owner and group is set to an account `gb` with lower privilege than root the templated file that is uploaded has the owner set to `gb` but the backups are owned by` root` would like the ability to configure the template module to changed the owner group of the backup files to be the same as uid gid specified name copy foo config template src foo config dest data5 foo config owner gb group gb mode 0644 backup yes ignore errors true sudo yes >>>bug_report
lookup json template unexpected type error summary when attempting to use `lookup template something json j2 getting an `unexpected type error` if change the contents of `something json j2` to invalid json the lookup works successfully attempted adding jinja2 comments to the file as workaround to no avail issue type bug report ansible version ansible commit e16b24c ansible configuration tasks main yml templates works json j2 templates breaks json j2 environment python debian running within docker steps to reproduce create role with the above config add it to playbook run the play expected results run errors actual results >>>bug_report
gce module create instance scopes are hardcoded and are out of date the scopes are checked against predefined set believe the map is defined in apache cloud library right now there are quite few new scopes but since check is made against predefined map these new scopes are rejected ideally scopes should not be checked against pre defined map >>>bug_report cloud needs_to_be_moved
81 column wide output suppose am old fashioned for using 80 column terminals in many places still but noticed this change in ansible recently was it intentional on e16b24c01e on tag `v1 1` the output used to be 79c wide but now it 81c wide realize this may seem like trivial aesthetic issue hoping it was minor unintentional change >>>bug_report
streamlined include syntax no longer works at http docs ansible com ansible playbooks roles html task include files and encouraging reuse find if you are running ansible and later include syntax is streamlined to match roles and also allows passing list and dictionary parameters tasks include wordpress yml wp user timmy ssh keys keys one txt keys two txt ve been using this syntax but find that it doesn work anymore after updating to recent `devel` revision main yml otherfile yml results with e16b24c01e results with tag `v1 1` >>>bug_report
variable overding during nested includes issue it seems variables are not overridden when using nested includes this works ok in v1 this might be related to 11353 to reproduce the issue you can follow the steps from 11353 in build yml have variable docker tags what is overriden in tasks docker base build yml instead of printing the overridden value it prints the value from build yml see debug statements after running ansible playbook build admin ui yml inventories local hosts extra vars admin ui version 1234 >>>bug_report needs_info
made squashable with plugin list configurable partially deals with 11383>>>feature_pull_request
variables not set for includes testing on e16b24c01e unable to set variables via includes main yml otherfile yml results with e16b24c01e results with tag `v1 1` >>>bug_report
fix for issue 11863 hello ve created pull request to potentially fix issue 11863 don expect this patch to be merged in so much as help the developer working on this issue to see where the problem is when using `serial` in playbook role dependency execution is skipped for hosts other than those in the first batch it looks to me that this is because restriction is placed on the inventory causing the boolean expression in the batch to result in `true` too early this value should only result in `true` if all the batches in the serial execution are finished hope this helps and thanks for making ansible >>>bugfix_pull_request
hostvars is not json serializable for debugging ve been using vars to nice json in template to give dump of what variables have been defined in play or role ve also discovered similar issue when using vars to yaml with ansible as of commit e16b24c this fails with an error my code >>>bug_report
cannot set run once via vars try to set run once via vars but tasks still run on all hosts play1 yml name check run once via var set hosts ndb01 ndb02 tasks include play2 yml vars run once true play2 yml name check run once debug msg run once run once name run once debug msg running once run once run once ansible playbook myhosts play1 yml play check run once via var set gathering facts ok ndb01 ok ndb02 task check run once ok ndb01 msg run once true ok ndb02 msg run once true task run once ok ndb01 msg running once ok ndb02 msg running once play recap ndb01 ok changed unreachable failed ndb02 ok changed unreachable failed >>>bug_report
add lookup plugin with each found expect list of file names and filter out existing ones derived from the lookup plugin with first found this plugin implements the feature of iterating over list of file names returning only actual resolvable files vars` templates` files` while silently omitting missing ones this is especially useful when loading var files while maintaining an order of precedence if you want to read vars in the way that most specific ones overriding broader scoped ones while not knowing which files may be requested you can utilize this lookup this is currently just draft for review limited to ansible version in order to check whether further effort makes sense in your eyes please comment if you find it worthy to hack on am going to write code for version and may add further integration tests if required common use case is when you want to dynamically load vars based on host distribution facts while providing common defaults via `ansible family os` and preserving the possibility to override those common defaults by more specific var files see example below name load os based default variables include vars item ignore errors yes with each found default yml ansible os family yml ansible distribution yml ansible distribution ansible distribution release yml find this pretty common scenario where you prepare your role for future support of even more linux distributions >>>feature_pull_request
amazon sns module doesnt show up in cloud modules list this link http docs ansible com ansible sns module html does not appear on the cloud modules page http docs ansible com ansible list of cloud modules html>>>docs_report
loop on too many items with include with items issue type bug report ansible version ansible devel 151010920d last updated 2015 08 06 13 20 04 gmt 200 ansible configuration environment fedora 21 summary when use playbook using ansible v2 capabilities of include with items it fails with unexpected exception results it seems the loop on items iterate too much steps to reproduce create playbook like this one hosts localhost tasks include debug yml letter item with items letters vars letters debug yml file debug var letter then run ansible playbook inventory localhost test yml vvv expected results each letter is printed the script exits without error actual results task include letter item included debug yml for localhost item included debug yml for localhost item included debug yml for localhost item included debug yml for localhost unexpected exception results the full traceback was traceback most recent call last file home tcottier src ansible bin ansible playbook line 80 in sys exit cli run file home tcottier src ansible lib ansible cli playbook py line 142 in run results pbex run file home tcottier src ansible lib ansible executor playbook executor py line 141 in run result self tqm run play play file home tcottier src ansible lib ansible executor task queue manager py line 192 in run return strategy run iterator play context file home tcottier src ansible lib ansible plugins strategies linear py line 242 in run included files includedfile process include results host results self tqm iterator iterator loader self loader variable manager self variable manager file home tcottier src ansible lib ansible playbook included file py line 54 in process include results include results res result results keyerror results >>>bug_report
added check mk omd external inventory script this inventory script is using mklivestatus socket to connect to nagios check mk icinga server to get list of hosts from your monitoring the script name omd is inspired with the project name omd the open monitoring distribution which comes with 16 awesome tool for monitoring http omdistro org example >>>feature_pull_request
handle urls in meta main yml dependencies use `rolerequirement` rather than `roledefinition` for handling role inclusions handle of comma separated specified versions allow old style string role specifications no need for role rolespecification when `rolespecification` will suffice this is for backward compatibility with style rolesfiles and meta main yml files>>>feature_pull_request
path of group vars and host vars were getting the basedir added twice fix inventory so this won happen and fix dataloader so that it will test relative paths relative to self basedir fixes 11789>>>bugfix_pull_request
add win basename and win dirname filters like to add these two filters which users who are targetting windows hosts might find useful >>>feature_pull_request windows
role dependencies only run once even with serial enabled issue type bug report ansible version `ansible devel 9aa4214417 last updated 2015 07 31 08 03 38 gmt 700 ansible configuration environment os 10 summary have role with dependency on role role is normally executed implicitly by role `meta folder specifying role as dependency role gets executed against each host before role then set role to be `serial` with value of have three hosts in the inventory now when run the playbook role only executes against the first host in the inventory and is skipped on subsequent hosts steps to reproduce make playbook with two roles make role depend on role set the inventory size to anything greater than make role serial with value of run the playbbook expected results role executes against every host in the inventory when role has `serial` set to actual results role only executes against the first host in the inventory >>>bug_report p2
module for writing to etcd issue type feature idea ansible version ansible configuration environment summary module that writes to etcd and reports when changes were made would come in very handy steps to reproduce reasonable implementation seems to be available and licensed under the gpl https github com modcloth labs ansible module etcd the repository an example in the readme and pr that seems to address an etc2 issue haven used ansible long enough to know what an idiomatic api would look like but the example seems reasonable thank you for reading and considering this >>>feature_idea
chroot plugin importerror no module named callbacks my setup build deb package from the source devel branch using make deb getting the following error when run simple shell task within the chroot plugin environment in examining the source code in github line 30 does show that it is trying to import callbacks in my git checkout there doesn appear to be any file corresponding to this nothing in the v2 directory also searched the github repository online and didn find anything corresponding to v2 should there be v2 ansible callbacks py or should the offending line be removed >>>bug_report p2
extra vars don override variable in delegate to issue type bug report ansible version ansible detached head f974ff6972 last updated 2015 08 05 17 42 07 gmt 300 ansible configuration default environment mac os ubuntu summary when using variable in `delegate to` the variable isn overridden when passing e` only the instance of the variable in `delegate to` isn overridden steps to reproduce playbook command expected results actual results >>>bug_report
directive become sudo not working unless using ansible keep remote files oracle linux issue type bug report ansible version ansible version ansible config file etc ansible ansible cfg configured module search path usr share ansible ansible configuration sanitized `diff` follows ansible examples ansible cfg 2015 07 03 18 24 28 138641679 0100 my ansible cfg 2015 05 14 21 14 03 000000000 0100 inventory etc ansible hosts library usr share my modules hostfile etc ansible hosts library usr share ansible transport smart transport ssh fact caching memory gathering implicit gathering smart deprecation warnings true deprecation warnings true fact caching memory http user agent ansible agent pty false pty false ssh args controlmaster auto controlpersist 60s ssh args controlmaster auto control path directory ansible ssh control path directory ansible ssh pipelining false pipelining false scp if ssh true scp if ssh true environment oracle linux summary this issue seems to be similar to 11611 https github com ansible ansible issues 11611 but that one was reported as fixed by the op this is happening on an ansible installation built from the git repo running `ansible` with become` does not work unless `ansible keep remote files 1` is used steps to reproduce install `ansible` from the git repository try to run an ad hoc task that requires becoming different user expected results `ansible` does not require the `ansible keep remote files 1` environmental variable set ansible vvv host example com uptime become user someuser ask become pass using etc ansible ansible cfg as config file sudo password establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com mkdir tmp ansible tmp 1438770811 21 268931387794476 chmod rx tmp ansible tmp 1438770811 21 268931387794476 echo tmp ansible tmp 1438770811 21 268931387794476 establish ssh connection for user sysadm put tmp tmpwyspwi to tmp ansible tmp 1438770811 21 268931387794476 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com chmod tmp ansible tmp 1438770811 21 268931387794476 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com bin sh sudo sudo sudo via ansible key durhytuchutihmjtwzxoafmfwshdrdyn password someuser bin sh echo become success durhytuchutihmjtwzxoafmfwshdrdyn lang lc messages lc ctype usr bin python tmp ansible tmp 1438770811 21 268931387794476 command host example com success rc 10 33 32 up 109 days 20 12 users load average 01 01 00 actual results two runs with vvv` with and without the environmental variable set ansible vvv host example com uptime become user someuser ask become pass using etc ansible ansible cfg as config file sudo password establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com mkdir tmp ansible tmp 1438770797 51 185748965806726 chmod rx tmp ansible tmp 1438770797 51 185748965806726 echo tmp ansible tmp 1438770797 51 185748965806726 establish ssh connection for user sysadm put tmp tmp vryjd to tmp ansible tmp 1438770797 51 185748965806726 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com chmod tmp ansible tmp 1438770797 51 185748965806726 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com bin sh sudo sudo sudo via ansible key adxaihuxqpizkhqbveobukxvznmrytwo password someuser bin sh echo become success adxaihuxqpizkhqbveobukxvznmrytwo lang lc messages lc ctype usr bin python tmp ansible tmp 1438770797 51 185748965806726 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com rm rf tmp ansible tmp 1438770797 51 185748965806726 dev null host example com failed rc error connection closed waiting for privilege escalation password prompt ansible keep remote files ansible vvv host example com uptime become user someuser ask become pass using etc ansible ansible cfg as config file sudo password establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com mkdir tmp ansible tmp 1438770811 21 268931387794476 chmod rx tmp ansible tmp 1438770811 21 268931387794476 echo tmp ansible tmp 1438770811 21 268931387794476 establish ssh connection for user sysadm put tmp tmpwyspwi to tmp ansible tmp 1438770811 21 268931387794476 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com chmod tmp ansible tmp 1438770811 21 268931387794476 command establish ssh connection for user sysadm exec ssh tt controlmaster auto port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 host example com bin sh sudo sudo sudo via ansible key durhytuchutihmjtwzxoafmfwshdrdyn password someuser bin sh echo become success durhytuchutihmjtwzxoafmfwshdrdyn lang lc messages lc ctype usr bin python tmp ansible tmp 1438770811 21 268931387794476 command host example com success rc 10 33 32 up 109 days 20 12 users load average 01 01 00>>>bug_report needs_info
loop on lookup plugin from role rejected issue type bug report ansible version ansible devel faf4c3bb6c last updated 2015 08 05 11 31 42 gmt 200 ansible configuration default environment debian jessie summary playbook cannot directly use loop base on lookup plugin provided by role steps to reproduce consider role providing lookup plugin playbook that attempts to use `with myitems` loop in task is then rejected it seems to me that while loading play roles need to be loaded before we can preprocess tasks or alternatively the setup of plugin directories should be part of prerpocessing roles not loading them expected results success display of the two debug messages item foo and item bar actual results >>>bug_report p2
minor comment fix>>>docs_pull_request
feature request temp file directory creation currently in the process of learning sufficient python to write this plugin myself however if faster more experienced hands are able to do this quickly would like way to create temporary directory or file using system safe and system independent manner using python mkstemp would assume and be able to have that registered as variable for later use in other plays can do this with multiple tasks checking for os and the command module however something more robust would be better >>>feature_idea
can open file setup after installing sudo flags hi in ansible cfg playbooks periodically fall in error failed host example com failed true parsed false become success crllipfjilsndpnrqbnftwvajxozmned usr bin python can open file setup errno no such file or directory openssh 3p1 openssl 1e fips 11 feb 2013 debug1 reading configuration data var lib rundeck ssh config debug1 reading configuration data etc ssh ssh config debug1 applying options for debug1 auto mux trying existing master debug1 mux client request session master session id debug1 mux client request session master session id shared connection to host example com closed ansible 1>>>needs_info
playbooks blocks rst add syntax highlighting see https github com msabramo ansible blob patch docsite rst playbooks blocks rst>>>docs_pull_request
when not working from include using the latest ansible from the master branch to ensure my playbooks are combatible with when it arrives the when attribute of include does not seem to work anymore this is the error getting here is test showing the issue test run by running ansible playbook foo yml foo yml bar yml this same test works with 2>>>bug_report
shell module not always return correct error code issue type bug report ansible version ansible version ansible version ansible rpm ansible ansible git 7d8afad fc24 noarch ansible configuration irrelevant environment fedora 22 summary please summarize your request in this space you will earn bonus points for being succinct but please add enough detail so we can understand the request thanks steps to reproduce playbook expected results all variant should fail with non return code actual results only first which is commented failed as expected>>>bug_report needs_info pending_closure
env var set in raw module incorrect issue type bug report ansible version ansible version ansible version ansible rpm ansible ansible git 7d8afad fc24 noarch ansible configuration irrelevant environment fedora 22 summary when you using raw module you can set variables as it possible in bash and sh steps to reproduce playbook result expected results both variants raw var qwerty echo var and raw var qwerty echo var run normally and on stdout return string qwerty actual results stdout in one case and fail to run in another >>>bug_report needs_info
add option to avoid empty prompt like password >>>feature_pull_request needs_rebase needs_revision
ansible2 hangs with sudo yes ansible playbook hosts base yml vv ask sudo pass sudo password play task setup ok logs task test ok logs task test2 fatal logs failed failed true msg error connection closed waiting for privilege escalation password prompt home ynnt ansible tmp ansible tmp 1438685213 34 47645153366124 ansible devel c3ce140dd2 last updated 2015 08 04 13 36 30 gmt 300 cat base yml hosts logs sudo yes roles role prometheus master tags prometheus >>>bug_report pending_closure
allow passing other tags when using untagged tags untagged tag1 tag2 tag1 and tag2 should also run os ubuntu 15 04 ansible version not sure this is bug or intentional but in my oppinion in case parameter tags untagged tag1 tag2 is passed to ansible playbook tag1 and tag2 should be used and both tasks with no tags and tasks with listed tags should be used but ansible is running only untagged tasks in such situation the corresponding code part is the tasks to run in play function in playbook init py original code proposed fix download demo playbook https www dropbox com t2bd7ib5da07fqd bug tar gz dl try the followings to reproduce the issue >>>feature_idea
win iis website ignores required name parameter am querying an iis server with two web sites no matter what name parameter pass get back both web sites both app pools for the two web sites etc don have to pass valid name or can pass valid name for either site always get back both am running iis7 on windows 2008r2 with powershell seem to be hitting this defect http stackoverflow com questions 4170530 powershell get website name parameter is ignored that link lists some workarounds these seem to work for me in powershell >>>bug_report windows
add get available hash algorithms as described in ansible ansible modules core 141 it would be handy to have the get available hash algorithms that was developed there to be included in module utils this pr adds the method get available hash algorithms additionally it does some refactoring to ease the use of digest from file you just need to call digest from file with the name of the algorithm instead of the function itself digest from file also does self fail json when the requested algorithm is not available tested the changes as good as could but sure that missed some corner cases so feel free to critize >>>feature_pull_request
free strategy doesn execute more than one play in playbook version ansible version ansible devel a586c74967 last updated 2015 07 23 02 37 33 gmt 700 lib ansible modules core detached head 222927256d last updated 2015 07 23 00 37 20 gmt 700 lib ansible modules extras detached head 167cad99fa last updated 2015 07 23 00 37 55 gmt 700 v1 ansible modules core detached head f8d8af17cd last updated 2015 07 23 00 38 37 gmt 700 v1 ansible modules extras detached head 495ad450e5 last updated 2015 07 23 00 39 11 gmt 700 config file configured module search path none how to reproduce results in note there is no message expected behaviour similar to the following which gives >>>bug_report p1
proposal lineinfile custom location for the backup file lineinfile has the ability to create backup of the original file could use feature where the backup copy of the original file would be placed at user specified location in marathon creating the backup file in etc marathon conf will cause marathon to fail to start as the backup file is not recognized marathon setting there are other apps that use the convention of using the filename to represent configurable setting >>>feature_idea
synchronize module doesn read host vars locahost the problem started with this error on my system https gist github com tahvok a04a5344b919b33e7ada after some debugging with abadger we came to the conclusion that need to set `ansible python interpreter` to python2 as have python3 on my local machine as the default but this problem came up synchronize module doesn read host vars locahost as in this example cat sync test yml cat host vars localhost error working example with symlinked usr bin python usr bin python2 https gist github com tahvok 2717ff16009f80d835f0 >>>bug_report p2
usermod user user is currently used by processid am having issues with the following task name create nginx webroot user user name nginx webroot owner shell sbin nologin home usr share nginx html system yes output task nginx create nginx webroot user establish connection for user janitor remote module user name nginx www shell sbin nologin home usr share nginx html system yes exec ssh controlmaster auto controlpersist 60s controlpath root ansible cp ansible ssh port 3050 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user janitor connecttimeout 10 site by bin sh sudo sudo sudo via ansible key cdwbtfcgptpgbhwkbejovoksmrztrhrw password root bin sh echo become success cdwbtfcgptpgbhwkbejovoksmrztrhrw lang lc ctype usr bin python failed site by failed true name nginx www rc msg usermod user nginx www is currently used by process 4630 ansible version this role is pretty old and has worked for few versions of ansible except stopping nginx and php fpm the daemons using the nginx www user and then re running the playbook does work properly there appears to have been another issue created for this problem https github com ansible ansible issues 11324>>>bug_report needs_info
disallow forks without at least one worker process things break traceback most recent call last file home ams extern ansible ansible lib ansible executor process result py line 103 in run result self read worker result file home ams extern ansible ansible lib ansible executor process result py line 69 in read worker result worker prc main rslt self workers self cur worker indexerror list index out of range>>>bugfix_pull_request
digitalocean dynamic inventory support private ip when using private networking the api reports ip address 10 132 156 108 and the ansible inventory gets the private ip instead of the public one which is useless we actually need to look for the public ip inside the networks list networks v4 gateway 10 132 ip address 10 132 156 108 netmask 255 255 type private gateway 45 55 64 ip address 45 55 85 125 netmask 255 255 224 type public we detect the feature here features private networking virtio >>>bug_report
show better message when ansible cfg is not found earlier we would say using as config file if we didn find one >>>docs_pull_request
remove todo the play already overrides options>>>bug_report easyfix
another small batch of trivial fixme removals the first two just needed to be removed as the required changes have been made already the third one involves small change suggested by bcoca to make the raw module set in data because ``ssh py`` can access the ``module name`` any more >>>bugfix_pull_request
get url does not set mode if file already exists name fetch url get url url https example com file txt dest file txt mode 0755>>>bug_report
ansiblemodule class argument spec parsing broken issue type bug report ansible version pre ansible configuration vanilla git clone environment reproducible on centos summary in the most recent version of ansible have found that evaluation of module parameters is broken with test module ansiblemodule will always return an emtpy module params name for example steps to reproduce test module module py name test state present with version v1 rc1 this does work expected results being able to use module arguments in test module actual results returns that name is empty but is required which is it but is being set >>>bug_report needs_info
cloud amazon ecs modules this pull request includes the integration tests for ansible modules extras pr 794 the modules can be tested individually with `ec2 ini path ansible home contrib inventory ec2 ini aws region us west ansible library ansible modules core j1g ansible modules extras ansible test inventory ini vvv ecs cluster facts localhost details true or using the playbook `ec2 ini path ansible home contrib inventory ec2 ini aws region us west ansible library ansible modules core ansible modules extras ansible playbook test inventory ini vvv users mchance projects 47lining customers ansible ansible test integration amazon ecs yml`>>>feature_pull_request
change ec2 util to create only requested objects in anticipation of upcoming ecs modules have the following issue with ec2 py as it exists run this command `ec2 ini path ansible home contrib inventory ec2 ini aws region us west ansible library ansible modules core j1g ansible modules extras ansible test inventory ini vvv ecs cluster facts localhost details true` the ecs cluster facts uses this code to connect to boto3 `self ecs boto3 conn module conn type client resource ecs region region endpoint ec2 url aws connect kwargs but gets errors `file users mchance projects 47lining customers ansible ansible lib ansible module utils ec2 py line 89 in get aws connection info if aws url in os environ nameerror global name os is not defined` similarly for boto3 but more problematic `file users mchance projects 47lining customers ansible ansible lib ansible module utils ec2 py line 41 in boto3 conn resource boto3 session session resource resource region name region endpoint url endpoint params file opt local library frameworks python framework versions lib python2 site packages boto3 session py line 257 in resource service name resources file opt local library frameworks python framework versions lib python2 site packages botocore loaders py line 119 in wrapper data func self args kwargs file opt local library frameworks python framework versions lib python2 site packages botocore loaders py line 280 in determine latest version return max self list api versions service name type name file opt local library frameworks python framework versions lib python2 site packages botocore loaders py line 119 in wrapper data func self args kwargs file opt local library frameworks python framework versions lib python2 site packages botocore loaders py line 309 in list api versions raise datanotfounderror data path service name botocore exceptions datanotfounderror unable to load data for ecs` because botocore doesn in fact have resources json file `ls opt local library frameworks python framework versions lib python2 site packages botocore data ecs 2014 11 13 paginators json service json waiters json` >>>feature_pull_request
module utils cwd double change it looks like the ansiblemodule `run command` method tries to change the cwd twice through an `os chdir` https github com ansible ansible blob stable lib ansible module utils basic py l1519 1524 prior to running `subprocess` through the `subprocess` call https github com ansible ansible blob stable lib ansible module utils basic py l1527 itself via setting `cwd` in the `kwargs` https github com ansible ansible blob stable lib ansible module utils basic py l1513 1514 this would not be evident if the specified dir is an absolute path but does happen if it is relative path perhaps ansible only expects absolute paths and missed that bit of documentation >>>bug_report
fix ssh connections to ipv6 addresses we can unconditionally wrap remote addr in square brackets for scp and sftp both of which require them for ipv6 addresses but not wrap them at all for ssh which doesn accept them this way we don have to detect ipv6 addresses and treat them specially this works for hostnames ipv4 addresses and ipv6 addresses based on review of pr 11677 by juiceboxsingularity>>>bugfix_pull_request
lookup plugins appearing alongside playbook not found according to the documentation plugins can be shipped in subdirectory relative to top level playbook and this used to work in v1 with v2 however this does not work at least for lookup plugins unless the lookup plugins subdirectory is explicitly mentioned in ansible cfg >>>bug_report
yum module can add extra repo entry to etc yum repos issue type bug report ansible version running from source cloned from github ansible configuration just the original configuration nothing changed environment control host ubuntu 14 04 kernel 16 30 generic target host centos kernel 10 123 e17 x86 64 summary extra repo entry erlang solutions repo will be added to yum repo folder etc yum repos when install erlang solutions noarch rpm directly on the host using the following commands but after installed erlang solutions noarch rpm through ansible yum module there no extra repo entry erlang solutions repo appeared in yum repo folder etc yum repos steps to reproduce expected results there extra repo entry erlang solutions repo added in yum repo folder etc yum repos actual results the package erlang solutions was installed successfully but the repo entry erlang solutions repo was not added >>>bug_report
fix build failure use compatible exception syntax this is intended to address the build failure at https travis ci org ansible ansible jobs 73507390 py26 runtests commands python2 compileall fq module utils a10 rax openstack ec2 gce py lib ansible module utils compiling lib ansible module utils vmware py file lib ansible module utils vmware py line 125 except vim fault invalidlogin as invalid login syntaxerror invalid syntax error invocationerror usr bin python2 compileall fq module utils a10 rax openstack ec2 gce py lib ansible module utils >>>bugfix_pull_request
fixme in host range parsing make the ``step`` argument work for alphabetic sequences `` `` means this was the ``fixme`` improved error messages for host range parsing errors we say host range must something now mention ``x y`` ranges in ``intro patterns rst`` >>>bugfix_pull_request
allow multiple interpreters to be specified it may be inconvenient to set specific ansible interpreter explicitly for each host in inventory instead allow the specification of comma separated list of interpreters which are tried in turn until one is found and cache the value for future use interpreters can be specified either with full path or with just base name in which case they are located in path >>>feature_pull_request
delegate to and changed when never returns changed task issue type can you help us out in labelling this by telling us what kind of ticket this this you can say bug report ansible version winrm v2 fixes b07f8e7a7e currently in pr shouldn matter ansible configuration environment control node ubuntu 14 04 target node windows 2012r2 summary have role with delegate to 127 which loops but should never report changed although changed when never is set it reports changed on v2 the v1 branch stays silent as it should steps to reproduce use the role trondhindenes win reboot with the following vars winreboot simulate yes note that this will reboot the target node expected results none of the task in the role should report change actual results the task looping while waiting for winrm reports changed >>>bug_report p2
failed failed true msg error connection closed waiting for privilege escalation password prompt home ansible ansible tmp ansible tmp 1438288298 05 93146604594652 issue type bug report ansible version ansible version ansible devel 222f04e387 last updated 2015 07 30 14 22 39 gmt 500 lib ansible modules core detached head 79f21c6ec9 last updated 2015 07 30 14 22 39 gmt 500 lib ansible modules extras detached head 50f4b2c3de last updated 2015 07 30 14 22 39 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 config file volumes warrior1tb users tanner projects ansible git playbooks ansible cfg configured module search path none ansible configuration source hacking env setup my ansible cfg as follows environment os yosemite 10 10 python python summary might be related to 11796 migrating to become and plays that worked with ask sudo pass now fail with steps to reproduce here is the play that is throwing the error got the role using ansible galaxy but this is git repo for the role bennojoy network interface https github com bennojoy network interface the relevant vagrant yml expected results assume the plays would run to completion like it does when using on the command line actual results failed failed true msg error connection closed waiting for privilege escalation password prompt home ansible ansible tmp ansible tmp 1438288298 05 93146604594652 >>>bug_report
overriding variables include vars with vars files doesn work bug report in ansible test playbook yml roles rolea task main yml roles rolea vars defaults yml roles roleb task main yml vars override yml expected result actual result ansible version >>>bug_report
series of trivial fixmes for devel ll keep pushing commits to this pr for any ``fixme`` comments in devel that can be trivially removed ll note here when done so that this can be merged ``inventory init py`` all marked sites use combine vars already ``template vars py`` hostvars is imported and used below>>>docs_pull_request
uncomment encrypt handling for vars prompt this makes the following work again vars prompt name varname prompt password encrypt sha512 crypt it said ``fixme`` but didn really have to do much to ``fixit`` >>>bugfix_pull_request
default filter not possible for ansible ssh port the following fails because ansible doesn seem to settle the ansible ssh port by default so tried the following which fails fatal host one or more undefined variables ansible ssh port is undefined ansible playbook version ansible playbook in my opinion one of these probably both should succeed >>>bug_report
pause with prompt in loop not prompting issue type bug report ansible version environment rhel6 summary what wanted to do was compare the property files in the local source directory against the destination and if there was difference by md5 comparison prompt the user that they should manually verify and confirm the reason for this is that different environments lower test environments production environments may have had optimizations that don want to overwrite blindly or skip and miss change that should be deployed even gathering the host and file info and then logging it at the end of the run would work from my perspective steps to reproduce for my test the remote file on server1 10 246 34 158 is the same as the local file the remote file on server2 10 246 34 159 is different the following runs against list of hosts currently hosts webservice vars local path tmp webservice latest tomcat dest path opt tomcat webapps shared classes path opt tomcat shared classes webservice files sample name wrapper properties sample name wrapper properties src local path conf dest shared classes path tasks name get local stat of all webapp files become no local action stat path item src item sample name with items webservice files register local name get remote stat of all the webapp files action stat path item dest item name with items webservice files register remote name debug file stat for both local and remote true debug msg stat should be true item stat path item stat md5 item stat path item stat md5 when item stat exists true and item stat md5 item stat md5 default with together webservice files local results remote results if the property files do exist then we need to tell the user and let them sort it out name compare md5 of webservice files that do exist prompt if different pause prompt files are different manually review enter to continue when item stat exists true and item stat md5 item stat md5 default with together webservice files local results remote results expected results get prompted for each file and each host where there is difference actual results can see the debug line skipped for server2 and displayed for server1 which is correct the issue is that only see the action skipped for server2 for server1 don get prompt or notification that it was skipped it just silently skips it task debug file stat for both local and remote true skipping 10 246 34 158 item ok 10 246 34 159 item item snip msg stat should be true tmp webservice latest conf wrapper properties sample 67b3c6d486e5ee5a431e5a5f5df75045 opt tomcat shared classes wrapper properties 7bfe4004786dac7006355fe9b810032c task compare md5 of webservice files that do exist prompt if different skipping 10 246 34 158 item >>>bug_report
document best practice with regard to using variable and vault files issue type docs pull request ansible version ansible summary after digging through multiple resources solved my problem by creating group vars groupname vars and group vars groupname vault setup which defines all variables in the vars file with pointers to the real sensitive variables in vault after discussing this on freenode was told that this is basically the best practice so took the time to write it up it might not be fully up to par yet but that can be iterated upon >>>docs_pull_request
add documentation about any errors fatal there is setting in code named any errors fatal so found it there but it isn described on docsite only in few topics in the internet here is my proposal to add few doclines to docsite >>>docs_pull_request
failed failed true msg error connection error waiting for privilege escalation password prompt issue type bug report ansible version ansible version ansible devel 769b0d92ee last updated 2015 07 29 21 36 56 gmt 500 lib ansible modules core detached head a46b3a4dc4 last updated 2015 07 28 16 17 43 gmt 500 lib ansible modules extras detached head e30d8b84fe last updated 2015 07 28 16 17 44 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 config file volumes warrior1tb users tanner projects ansible git playbooks ansible cfg configured module search path none ansible configuration source hacking env setup testing become since ask sudo pass is deprecated edited my ansible cfg as follows setting default for privilege escalation environment os yosemite 10 10 python python pip freeze ansible coverage coveralls docopt ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos linecache2 markupsafe 23 mock nose paramiko 15 passlib pycallgraph pycrypto pywinrm pyyaml 11 requests six traceback2 unittest2 xmltodict summary setting become variables results in fatal testing failed failed true msg error connection error waiting for privilege escalation password prompt steps to reproduce expected results assume the plays would run to completion like it does when using on the command line actual results fatal testing failed failed true msg error connection error waiting for privilege escalation password prompt >>>bug_report
update dependencies for pywinrm adding the python dev and libkrb5 dev libraries avoids the error message error command x86 64 linux gnu gcc failed with exit status when running pip install kerberos >>>docs_pull_request windows
v2 fixed delegation when using host that is not in the inventory issue type bugfix pull request ansible version ansible configuration nothing has changed and worked fine before the v2 update environment local mac os 10 10 summary currently when using host with the `delegate to` option that is not in the inventory the host is skipped over this is due to an earlier commit of mine 7f45c9edf that jumps over the hosts instead of setting the defaults this commit fixes this so that if set of variables don exist for the specified `delegate to` host then defaults used steps to reproduce test yml expected results notice here that the hostname for each system is the same and different from the host it being run for these results are actually delegated actual results in the actual results the actual hosts hostname is shown in both the ssh output as well as the output of the `hostname` command sent to the hosts >>>bugfix_pull_request
integration tests for windows implementation of lineinfile coverage compatible integration tests for win lineinfile including coverage for added encoding preservation and newline control features and hook into test winrm yml depends on pull request 1839 for ansible implementation of the win lineinfile module running integration tests in v2 environment requires pull request 11719 be merged to fix ability to run windows modules in current devel these tests were verified locally by falling back to v1 env setup >>>windows
ansible incorrectly constructing paths when running playbook in subdirectory issue type bug report ansible version ansible configuration added an additional roles path ansible roles` environment os 10 11 summary running `ansible playbook ansible playbook yml` via vagrant provisioner fails to locate the `provisioning group vars all` in pre the `ansible group vars all` was found and used correctly also it would be nice to be able to use `ansible ansible cfg` instead of ansible cfg` just to consolidate my files in this case `project` is my top level project directory steps to reproduce notice the doubling of the directory `ansible ansible group vars` instead of the correct single `ansible group vars` relevant bit of vagrantfile >>>needs_info
su hangs indefinitely in while it is working fine in 10 bug description simple ansible playbook indefinitely hangs when using su this can be repeated indefinitely version affected ansible ansible version not affected using the same script ansible 10 environment tested on linux redhat centos python version other details the playbook is working fine if su is not used root credential is correct using the ping module with su works fine the password prompt is password without the quotes run details playbook main file name install app on my servers hosts my hosts gather facts no remote user my user su yes roles app install app install role under tasks main yml name query whoami shell whoami log project myotheruser myprodserver ansible playbook hosts ask su pass my playbook yml vvvv ssh password su password defaults to ssh password play install app on my servers task app install query whoami establish connection for user my user on port 22 to my server mydomain com remote module command whoami use shell exec bin sh mkdir tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 chmod rx tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 echo tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 put tmp tmp6ugefe to tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 command exec bin sh su root bin sh echo become success xzmbgooensxgrlbezhnlngbagojwbczg lang en us utf lc ctype en us utf usr bin python tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 command rm rf tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 dev null extra tests have run the command below on the remote server it is presenting the password prompt and execute correctly the command bin sh su root bin sh echo become success xzmbgooensxgrlbezhnlngbagojwbczg lang en us utf lc ctype en us utf usr bin python tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 command rm rf tmp ansible my user tmp ansible tmp 1438014075 95 221459817104733 dev null happy to do any other test if needed>>>bug_report p2
moving vmware utilites module moved `vmware py` from v1 to `lib ansible module utils vmware py` no other changes has been made since these two prs https github com ansible ansible pull 10812 https github com ansible ansible pull 10760>>>bugfix_pull_request
10489 rebase add dict support to set theory filters this is an updated series of commits with some documentation added it supersedes pr 10489 >>>feature_pull_request
tests check that handlers are able to use include following https github com ansible ansible pull 11520 issuecomment 124164941>>>feature_pull_request
synchronize doesn work with more than one with items bug report in ansible ve just encountered this weird synchronize issue which seems to be different to the others but might be relevant basically only one with items value works subsequent ones fail with permission issues the message is but because this goes away when split into separate tasks that probably some weird connection usage underneath this includes solutions to the other synchronize issues and in particular the `delegate to` without which the whole task hangs as reported by others the simple version is as follows this does not work but rewritten as below all is well this should obviously not be required >>>bug_report p2
absent in mount module should not remove the nfs share folders in docs if mounted or unmounted the device will be actively mounted or unmounted as needed and appropriately configured in fstab absent and present only deal with fstab but will not affect current mounting if specifying mounted and the mount point is not present the mount point will be created similarly specifying absent will remove the mount point directory this is misleading putting absent in the statement will not unmount the share but actually issue an rm rf on the mountpoint >>>feature_pull_request needs_to_be_moved
support yaml inheritance over variable files using yaml implicit inheritance in one variable file works fine and saves lot of configuration lines also ansible has its own concept of inheritance which is quite verbose what does not work is combining both would like to define parent element in `group vars all yml` and override parts of it in `host vars test yml` to make this happen ansible would need to merge yaml files before handing them to the yaml parser >>>feature_idea
setting list of vars on block results in weird error issue type bug report ansible version devel ansible configuration na environment na summary the following works as expected hosts localhost vars 42 31 tasks debug msg but if set the vars like this on block it breaks with weird error message as shown below hosts localhost tasks block debug msg vars 42 31 if use the following syntax it works in both cases vars 42 31 steps to reproduce run ``ansible playbook dev null second playbook above yml`` expected behaviour task debug msg ok localhost changed false msg 73 this is with vars set on the play actual behaviour play unexpected exception dictionary update sequence element has length is required the full traceback was traceback most recent call last file home ams extern ansible ansible bin ansible playbook line 79 in sys exit cli run file home ams extern ansible ansible lib ansible cli playbook py line 148 in run results pbex run file home ams extern ansible ansible lib ansible executor playbook executor py line 139 in run result self tqm run play play file home ams extern ansible ansible lib ansible executor task queue manager py line 192 in run return strategy run iterator play context file home ams extern ansible ansible lib ansible plugins strategies linear py line 201 in run task vars self variable manager get vars loader self loader play iterator play host host task task file home ams extern ansible ansible lib ansible vars init py line 236 in get vars all vars self combine vars all vars task get vars file home ams extern ansible ansible lib ansible playbook task py line 198 in get vars all vars update self block get vars file home ams extern ansible ansible lib ansible playbook block py line 65 in get vars all vars update self vars valueerror dictionary update sequence element has length is required this is with vars set on the block >>>bug_report
add credstash lookup plugin credstash is small utility for managing secrets using aws kms and dynamodb https github com luminaloss credstash example usage all credstash options region table etc are also configurable have some small questions about contributing this lookup plugin has dependency on the `credstash` module is there way for me to add this as dependency for the plugin is there also good way for me to add documentation >>>feature_pull_request
inconsistent hosts when using group by core module hi there so my task is quite simple run play against group of hosts then in the next play report which hosts completed the task successfully and which don am using the group by keyword for that in more detail am running deploy playbook against large group of hosts called bid in one play where also group each host by boolean variable in the next play same playbook am trying to write to screen all hosts from each group this is how it is laid out play1 play2 when run this task against hosts and serial is or more than this succeeds but when run it with serial which is lower than the number of hosts then the output only contains the first hosts in that group so it looks like the newly created group when accessed from the group succes host is only aware of the first hosts that were set in it however when ran the second play against the newly created group such as hosts succees hosts then all hosts were actually running it meaning that the group actually contains all hosts but not when accessed from the groups success host note the failed host did not fail from ansible point of view use ignore errors and store this in variable so can control for it please let me know if this makes sense or need more info thanks offer>>>bug_report
sequence py skips tasks when count bcoca as bbasata pointed out in made sequence more flexible 10565 just want to make sure this doesn get lost in closed ticket >>>bug_report
inventory hostname not passed to windows node when using delegate to in this example the expected result is to have inventory hostname be the target node name however when delegating to windows node the value is empty running the latest commit v1 branch name test win some module host name inventory hostname delegate to some windows node >>>bug_report
ansible doc list fails get url documentaion defect environment ubuntu 14 04 ansible branch devel d78c2fc212840a0d128244893e6a4a88f3feef48 sven folder ansible doc list traceback most recent call last file usr lib pymodules python2 ansible utils module docs py line 62 in get docstring doc yaml safe load child value file usr lib python2 dist packages yaml init py line 93 in safe load return load stream safeloader file usr lib python2 dist packages yaml init py line 71 in load return loader get single data file usr lib python2 dist packages yaml constructor py line 37 in get single data node self get single node file usr lib python2 dist packages yaml composer py line 36 in get single node document self compose document file usr lib python2 dist packages yaml composer py line 55 in compose document node self compose node none none file usr lib python2 dist packages yaml composer py line 84 in compose node node self compose mapping node anchor file usr lib python2 dist packages yaml composer py line 133 in compose mapping node item value self compose node node item key file usr lib python2 dist packages yaml composer py line 84 in compose node node self compose mapping node anchor file usr lib python2 dist packages yaml composer py line 133 in compose mapping node item value self compose node node item key file usr lib python2 dist packages yaml composer py line 84 in compose node node self compose mapping node anchor file usr lib python2 dist packages yaml composer py line 127 in compose mapping node while not self check event mappingendevent file usr lib python2 dist packages yaml parser py line 98 in check event self current event self state file usr lib python2 dist packages yaml parser py line 439 in parse block mapping key expected but found token id token start mark parsererror while parsing block mapping in line 75 column description expected but found in line 77 column required false error module get url has documentation error formatting or is missing documentation >>>bug_report docs_report
add ansible connection variable hi like to have an ansible connection variable that specifies the connection method used smart local etc added in our infrastructure we have machines that run ansible playbooks locally for deploying new versions of our applications however some playbooks have tasks that are delegated to other machines and fail when run locally it would be nice to include when clause so that those tasks were skipped if run locally for example name create backup destination delegate to backup example com when ansible connection local file path srv backup owner root group root state directory mode 0777 thanks >>>bug_report
rackspace rax cbs py minimum size has changed please change the minimum size of an ansible created rackspace cloud block storage in module `rax cbs py` the default minimum size has been lowered to 75gb and is not 100gb anymore when playbook is run with `size 75` this error occurs the rackspace webgui says 75 1024 gb can be resized later so please change the value of 100 into 75 >>>bug_report needs_to_be_moved
in with loop the command module doesn fail when script exit status always returns changed issue type bug report ansible version ansible devel aa5bd8c2b5 last updated 2015 07 28 14 27 18 gmt 200 lib ansible modules core detached head 291fef3b34 last updated 2015 07 20 16 27 51 gmt 200 lib ansible modules extras detached head ff2386faf4 last updated 2015 07 20 16 27 51 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 07 01 10 23 05 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 07 01 10 23 08 gmt 200 config file etc ansible ansible cfg configured module search path usr share ansible ansible configuration no change in default configuration environment ubuntu 15 04 summary the command module doesn fail when script exit status steps to reproduce it seems to work fine in but not in ansible devel aa5bd8c2b5 the easiest example to reproduce is running the following script bin bash exit with the following play name doesnt fail in ansible command testscript sh >>>bug_report p2
using core module user is not working with check mode lang name playbook for domain tld hosts host user root vars sshkey hostname sub domain tld copysshkey to user jenkins ssh keylength 4096 home path var lib jenkins tmp path tmp tasks name copying authorized keys copy src data ssh authorized keys dest home path ssh owner jenkins group nogroup mode 0644 tags sshkeys name generate new ssh key for sub domain tld user name copysshkey to user generate ssh key yes ssh key bits ssh keylength ssh key file ssh id rsa sshkey hostname lang ansible playbook domain tld yml inventory check verbose>>>bug_report
add option to ansible vault to read new password from file for rekey the new vault password file option works the same as vault password file but applies only to rekeying when vault password file sets the old password also update the manpage to document these options more fully >>>feature_pull_request
on notify does not checked handler exist issue type bug report ansible version master 7d8afad28c46ec04e6a32d5aff65bde2d5ab54c5 ansible configuration irrelevant environment fedora 22 summary you may notify handler which does not present at all steps to reproduce simple playbook expected results error what test handler not found actual results playbook run and just silent skip notify >>>bug_report
use pbkdf2hmac from cryptography for vault keys when stretching the key for vault files use pbkdf2hmac from the cryptography package instead of pycrypto this will speed up the opening of vault files by 10x the problem is here in lib ansible utils vault py hash function sha256 make two keys and one iv pbkdf2 prf lambda hmac new hash function digest derivedkey pbkdf2 password salt dklen keylength ivlength count 10000 prf pbkdf2 prf `pbkdf2 calls python callback function `pbkdf2 pr 10000 times if one has several vault files this will cause excessive start times with `ansible` or `ansible playbook` we experience 15 second startup times testing the original implementation in with vault file in timeit decrypt encrypted data loops best of 265 ms per loop having recent openssl version and using the vault py changes in this commit in timeit decrypt encrypted data 10 loops best of 23 ms per loop>>>feature_pull_request p2
fixes remote code execution for su sudo with strict remote umasks this is pull request for v2 in analogy to 9902 >>>bugfix_pull_request
unarchive module fails if archive contains files with non ascii file names ubuntu 14 04 ansible create archive zip or tar containing file with non ascii name run the following command result unicodeencodeerror ascii codec can encode characters in position ordinal not in range 128 >>>bug_report
add lvm facts to setup module this commit adds linuxhardware get device facts and calls that from populate lvm facts are only gathered if the setup module is running as root and the lvm utilities are available tested by searching for vgs if the conditions are met facts are set for each volume group and logical volume rebase of 9795 >>>feature_pull_request
add pciid to linuxnetwork interface fact this commit adds pciid to the linuxnetwork fact object pciid is gathered if the symlink sys class net device exists rebased version of 9843>>>feature_pull_request
changelog fix typos>>>docs_pull_request
can set vars prompt default using variable hi folks just started playing with ansible great project noticed can put variable in the `default field of prompted variable maybe it bug was expecting >>>feature_idea
vault password ensure other users can read vault password take on 11754 this time on live code and after testing locally >>>feature_pull_request needs_revision
aws profile with s3 module causes runtime error hello am using s3 this task works file need to use aws profile when add this ansible with boto 38 fails on python using ubuntu 14 04 lts if add striaghforward import import boto ec2 in ansible module utils ec2 py fixes the error jk>>>bug_report cloud plugin
install fail on amazon nat gateway ami cat proc version linux version 14 20 20 44 amzn1 x86 64 mockbuild gobi build 60001 gcc version 20140120 red hat 16 gcc smp mon oct 22 52 46 utc 2014 did git clone and switched to stable ve installed all possible requirements ansible make rpm mkdir root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share ansible usr lib rpm check buildroot usr lib rpm brp compress usr lib rpm brp strip usr bin strip usr lib rpm brp strip static archive usr bin strip usr lib rpm brp strip comment note usr bin strip usr bin objdump processing files ansible git201507251537 amzn1 noarch error file not found by glob root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr lib python2 dist packages ansible executing doc bin sh var tmp rpm tmp 1cjkxp umask 022 cd root ansible rpm build cd ansible docdir root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share doc ansible export docdir bin mkdir root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share doc ansible cp pr readme md root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share doc ansible cp pr pkg info root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share doc ansible cp pr copying root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr share doc ansible exit rpm build errors file not found by glob root ansible rpm build buildroot ansible git201507251537 amzn1 x86 64 usr lib python2 dist packages ansible make rpm error any idea what am missing >>>bug_report
add integration tests for group by precedence test that when group is created with group by variables from the corresponding group vars file are correctly pulled in and override variables specified in group vars all see ansible ansible 8664 this is rebase of pr ansible ansible 8702 which having been ignored for almost 12 months no longer applies cleanly please note that have not verified that the new test passes in this rebase it was passing in the original pr but couldn get the tests to run at all in current devel figure it is currently in flux and broken >>>feature_pull_request
better error message for ansible playbook yml this is very conservative change we add the hint only if we re definitely going to die already we could do better suppress the empty host list error and make this raise an ansibleerror rather than an ansibleoptionserror so that the error isn obscured at the end of the usage message which ve never personally found to be useful behaviour anyway but this is the smallest most self contained change that could come up with in the interests of making it easier to merge >>>feature_pull_request
make copy content add newline if there isn one fun fact according to posix file should end with newline http pubs opengroup org onlinepubs 9699919799 basedefs v1 chap03 html tag 03 206 rebase of 9468>>>feature_pull_request
ansible pull later than throws error vault password must be specified to decrypt encrypted file issue type bug report ansible version currently experiencing this on but the issue appears to be present in every version tested since ansible configuration environment issue is present in ubuntu 12 04 and 14 04 have not tested any other platforms summary ansible pull throws an error suggesting no vault password is provided to decrypt vault encrypted files however provide the vault password file flag as part of the command steps to reproduce run ansible pull as follows have also tried specifying the vault password in the following ways specifying ansible vault pass setting vault password file in my ansible cfg then setting ansible config prior to running ansible pull both environment variables yield the same error below expected results ansible pull should run to completion or report other issues with the playbook actual results this command works as expected with ansible but in every later version that have tested get this have also tried running ansible playbook in local connection mode similar to what ansible pull should be doing the above command with ansible playbook works fine >>>bug_report
fix parsing bug that prevents ipv6 addresses from being used with add host rebased version of 8682>>>bugfix_pull_request needs_revision
v2 relative path with with fileglob resolves the path relative roles files issue type bug report ansible version ansible version ansible devel c56a304ad9 last updated 2015 07 26 16 43 12 gmt 500 lib ansible modules core detached head 2bfddb015d last updated 2015 07 26 16 43 13 gmt 500 lib ansible modules extras detached head 14fffa5b53 last updated 2015 07 24 12 24 44 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 config file configured module search path none ansible configuration source hacking env setup environment os yosemite 10 10 python python pip freeze ansible coverage coveralls docopt ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos linecache2 markupsafe 23 mock nose paramiko 15 passlib pycallgraph pycrypto pywinrm pyyaml 11 requests six traceback2 unittest2 xmltodict summary loops http docs ansible com ansible playbooks loops html says with fileglob when using relative path with with fileglob in role ansible resolves the path relative to the roles files directory but debugging shows this not to be true steps to reproduce play from main yml from the nagios servers role that lives in volumes warrior1tb users tanner projects ansible git playbooks roles nagios servers tasks changing the play to look like this then things work as expected expected results assume using the relative path with fileglob would put me into volumes warrior1tb users tanner projects ansible git playbooks roles nagios servers files might be documentation out of date issue as believe loops http docs ansible com ansible playbooks loops html still references the pre v2 code base but if v2 changed behavior many of my with fileglob plays break and users should be warned of the breakage actual results the relative path with with fileglob is being set to volumes warrior1tb users tanner projects ansible git playbooks >>>bug_report easyfix p2
make ec2 py inventory script importable trying to build off the work in ec2 py one is tempted to try and have new script import the stock one and then derive from ec2inventory ve actually been using this technique but had to make slight modification to the ec2 py script ve created pr for this issue 11744 for your kind consideration note this issue is clone of the original issue 8700 created on this while back which was closed due to ansible modules repositories branching out >>>feature_idea
made ec2 py dynamic inventory module more modular and importable trying to build off the work in ec2 py one is tempted to try and have new script import the stock one and then derive from ec2inventory ve actually been using this but had to make couple slight modifications to the ec2 py script to support this this pr is clone of the original one created while back 8712 that was created after the various ansible modules repositories were branched out >>>feature_pull_request
regex escape filter new pr version for year old unmerged pr 8468 >>>feature_pull_request
encrypt the vault file after editing only if the contents changed rebased to target ``lib ansible parsing vault init py`` instead of ``bin ansible vault`` closes 8602>>>bugfix_pull_request
add limit` option to ansible pull closes 7917>>>feature_pull_request
v2 breakage list tasks doesn list tasks inside roles issue type bug report ansible version devel 5be384ba ansible configuration na environment na summary while investigating 6216 found that `` list tasks`` in devel doesn list tasks inside roles steps to reproduce run ansible playbook yml list tasks on playbook that includes some roles expected results tasks inside roles are listed actual results tasks inside roles aren listed only pre tasks post tasks are >>>bug_report
add more explicit documentation on ansible nodename and ansible hostname fix 9971 based on text from paul czarkowski>>>docs_pull_request
document and test is undefined rather than is not defined according to https github com ansible ansible issues 10273 this syntax should work better for nested dicts >>>docs_pull_request feature_pull_request
removed deletion of salt by password lookup 10871 rebase otherwise two tasks that lookup the same password one with the encrypt parameter and one without it always considers the latter changed rebased version of 10872 >>>bugfix_pull_request
v2 breakage lookupfile should lookup the given file xxx without this patch if you do lookup csvfile xxx file foo csv you get an error like msg error csvfile errno no such file or directory home ams xxx file foo csv this was because we used the pre split ``term`` for the ``self loader path dwim relative`` call >>>bugfix_pull_request easyfix
have paramiko use etc ssh known hosts 7730 rebase fixes an issue with confusing error paramiko the authenticity of host host can be established when ssh on the command line doesn complain closes pr 7730>>>bugfix_pull_request
exclude paramiko module from ansible build hi was wondering if there could be any potential problems of excluding paramiko from ansible according to http www ansible com blog 2014 01 15 ssh connection upgrades coming in ansible you used it in the past for controlpersist which is feature available in openssh released maybe year ago and as such appears redundant you also list some rationales for having it in how do get ansible to reuse connections enable kerberized ssh or have ansible pay attention to my local ssh config file https docs ansible com ansible faq html which seems to me to be legacy issue only furthermore these explanations paramiko is great for starting out but the openssh type offers many advanced options this line doesn make any sense great for starting what out you will want to run ansible from machine new enough to support controlpersist if you are using this connection type machine or openssh version you can still manage older clients if you are using rhel centos sles 10 or sles 11 the version of openssh is still bit old so consider managing from fedora or opensuse client even though you are managing older nodes or just use paramiko how about you avoid all this confusing nonsense and just recommend using the latest openssh caveat emptor don know anything about https github com paramiko paramiko but it has not been updated since april stable and it has large number of bug and pull requests that seems like lot of work for one guy to be working part time let alone full time basically want to make sure can exclude this from my ansible builds because adding unnecessary code to my environment adds unnecessary risk if this is the case then you should also remove it from the list of required modules on https docs ansible com ansible intro installation html and list it as optional thanks >>>feature_idea
allow vars file includes from vars files to allow for hierarchical structuring specifically this matters most for the defaults directory where employing `include vars` from the playbook itself would have the undesirable effect of increasing the precedence of the variables within the file suppose this could also be resolved by simply associating different files with different priorities and adding an option to `include vars` which specifies the the variables defined therein are defaults to be overridden mainly though hierarchical structuring is what hoping for the current alternative is flat defaults main yml which contains every possible var which would need default this rapidly becomes unreadably lengthy >>>feature_idea
docs bug on host key checking http docs ansible com ansible intro getting started html host key checking gives an error not sure if this is an older version of ansible bug or not using ansible on f20 >>>needs_info
error debug is not legal parameter in an ansible task or handler am trying to install edx fullstack on single ubuntu machine but get this error >>>needs_info
support for gradual list construction why you should care security concerns modularity concerns this might seem like nitpicky clean coding issue but for project of any kind of size role management rapidly becomes unwieldy and unmanageable it impossible for collection of roles to construct variables in aggregate which artificially creates dependencies and makes role reuse across projects extremely difficult and it isn just ferm as in the example below it also important for any application which involves whitelisting which matters because whitelisting is fundamental to security policy so generating whitelists for installed packages running processes daemon services config files users groups etc the problem sometimes role would benefit from variables the content of which are aggregated from number of roles some of the roles it needs information from are dependencies sometimes they are dependents as such it would be useful for roles to be able to statically add elements to globally visible list variable for example if deploying webserver need to deploy my firewall ruleset first for security reasons which are hopefully obvious but that firewall ruleset needs to know about which ports are publicly visible this should just be single list variable `public services` so that the firewall role is modular enough that it can be plugged into project with completely different set of roles and still work fine and it should be dry don need to manually add an additional line to the config file for every single possible service at the moment it possible to create such variable that not the issue the issue is that all the roles which create public services can simply add their service to the `public services` set well list but that can be fixed via filter need to centrally define the list somewhere so that if added or removed role other than ferm would still need to modify variable associated with ferm group role breaking the ferm group role portability and making it that much more difficult for maintainer to ensure only the ports they want open are open they must manually edit `vars` file rather than simply removing role from the play >>>feature_idea
fixes for winrm powershell support in v2 appreciate feedback from bcoca jimi and abadger on any better ways to implement these changes add support for inserting module args into powershell modules fixes 11661 support windows paths containing spaces applies changes from 10727 to v2 fixes 9999 should also fix ansible ansible modules core 944 and ansible ansible modules core 1007 change how execution policy is set for running remote scripts applies changes from 11092 to v2 also fixes ansible ansible modules core 1776 use codepage 65001 utf for winrm connection instead of default cp437 convert command to utf and results from utf replaces changes from 10024 fixes 11198 close winrm connection when task completes use win stat win file and win copy modules instead of stat file and copy when called from within other action plugins only when using winrm powershell unquote windows path arguments before passing to win stat win file win copy and slurp modules only when using winrm powershell check for win ping module to determine if core modules are missing only when using winrm powershell add stdout lines to result from running low level commands so stdout lines is available when using raw script update copy action plugin to use shell functions for joining paths and checking for trailing slash update fetch action plugin to unquote source path when using windows paths add win copy and win template action plugins that inherit from copy and template support running bat and cmd scripts using default system encoding instead of utf always send powershell commands as base64 encoded blobs to allow for running simple powershell commands via raw support running modules on windows with interpreters other than powershell update integration tests to support above changes and test unicode fixes add test for win user error from ansible ansible modules core 1241 fixed by ansible ansible modules core 1774 add test for additional win stat output values implemented by ansible ansible modules core 1473 add test for os architecture and name from setup ps1 implemented by ansible ansible modules core 1100 all winrm integration tests pass for me with these changes >>>bugfix_pull_request p2 windows
complex task arguments args ignored issue type bug report ansible version ansible configuration none environment summary complex task arguments specified with `args are ignored steps to reproduce create this `playbook yml` expected results as per ansible actual results >>>bug_report p1
rhel centos and docker py hello the following task throwed the following error on centos fixed this my using an older docker py would repect that this dependancy would be automaticly resovled >>>needs_info
ansible start at task and serial bug hello have playbook with two roles first role contains one task second role contains four tasks and inventory with three host in playbook add option serial when launch my playbook with option start at task test2 the first two hosts start at task test2 but the third starts at the beginning example play test gathering facts ok host1 ok host2 ok host3 task test2 test3 ok host1 msg hello world ok host2 msg hello world task test2 test4 ok host1 msg hello world ok host2 msg hello world task test ls tache de test pour le playbook de test changed host3 task test2 test2 ok host3 msg hello world task test2 test3 ok host3 msg hello world task test2 test4 ok host3 msg hello world play recap host1 ok changed unreachable failed host2 ok changed unreachable failed host3 ok changed unreachable failed hello >>>bug_report
template module doesn work under local connection and with sudo password ansible devel 88e1ef8c9b last updated 2015 07 24 13 50 34 gmt 1000 lib ansible modules core devel 5f2b365faa last updated 2015 07 24 09 25 21 gmt 1000 lib ansible modules extras detached head 3c6707ada1 last updated 2015 07 23 14 15 44 gmt 1000 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 15 15 23 40 gmt 1000 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 15 15 23 47 gmt 1000 config file configured module search path none hosts localhost sudo true connection local vars files vfile tasks command whoami template src pool password j2 dest tmp pool password wthames wthames ansible ansible playbook playbook yml inventory dir vvv using as config file sudo password plays in playbook yml play task setup establish local connection for user wthames localhost exec mkdir home ansible tmp ansible tmp 1437710167 69 256968404394034 chmod rx home ansible tmp ansible tmp 1437710167 69 256968404394034 echo home ansible tmp ansible tmp 1437710167 69 256968404394034 localhost put tmp tmpn4qpnd to home wthames ansible tmp ansible tmp 1437710167 69 256968404394034 setup localhost exec bin sh sudo sudo sudo via ansible key obvtoytedkbllvzcrwffonobutfllhsc password root bin sh echo become success obvtoytedkbllvzcrwffonobutfllhsc lang en us utf lc messages en us utf lc ctype en us utf usr bin python home wthames ansible tmp ansible tmp 1437710167 69 256968404394034 setup rm rf home wthames ansible tmp ansible tmp 1437710167 69 256968404394034 dev null ok localhost task command establish local connection for user wthames localhost exec mkdir home ansible tmp ansible tmp 1437710170 19 235314567409766 chmod rx home ansible tmp ansible tmp 1437710170 19 235314567409766 echo home ansible tmp ansible tmp 1437710170 19 235314567409766 localhost put tmp tmpklap8o to home wthames ansible tmp ansible tmp 1437710170 19 235314567409766 command localhost exec bin sh sudo sudo sudo via ansible key datepdecfhjlqcixxrpvozfkbrxesulr password root bin sh echo become success datepdecfhjlqcixxrpvozfkbrxesulr lang en us utf lc messages en us utf lc ctype en us utf usr bin python home wthames ansible tmp ansible tmp 1437710170 19 235314567409766 command rm rf home wthames ansible tmp ansible tmp 1437710170 19 235314567409766 dev null changed localhost changed true cmd whoami delta 00 00 001972 end 2015 07 24 13 56 11 167214 rc start 2015 07 24 13 56 11 165242 stderr stdout root stdout lines root warnings task template dest tmp pool password src pool password j2 establish local connection for user wthames localhost exec mkdir home ansible tmp ansible tmp 1437710171 29 170105846201682 chmod rx home ansible tmp ansible tmp 1437710171 29 170105846201682 echo home ansible tmp ansible tmp 1437710171 29 170105846201682 localhost exec bin sh sudo sudo sudo via ansible key ngcpaxmjtthajgivxkbhwzvgdxthwxge password root bin sh echo become success ngcpaxmjtthajgivxkbhwzvgdxthwxge rc flag tmp pool password rc tmp pool password rc tmp pool password rc python dev null rc rc xflag echo rc tmp pool password exit python import hashlib blocksize 65536 hasher hashlib sha1 afile open tmp pool password rb buf afile read blocksize while len buf 	hasher update buf 	buf afile read blocksize afile close print hasher hexdigest dev null python import sha blocksize 65536 hasher sha sha afile open tmp pool password rb buf afile read blocksize while len buf 	hasher update buf 	buf afile read blocksize afile close print hasher hexdigest dev null echo tmp pool password localhost exec mkdir home ansible tmp ansible tmp 1437710172 25 232667232137450 chmod rx home ansible tmp ansible tmp 1437710172 25 232667232137450 echo home ansible tmp ansible tmp 1437710172 25 232667232137450 fatal localhost failed failed true msg error privilege output closed while waiting for password prompt home wthames ansible tmp ansible tmp 1437710172 25 232667232137450 play recap localhost ok changed unreachable failed >>>bug_report p1
ansible hangs when strategy free playbook hosts all sudo yes strategy free tasks name fetch dump fetch src tmp dump rdb dest tmp inventory hostname command `ansible playbook hosts test str yml ask sudo pass vvv` output sudo password plays in test str yml play task setup establish ssh connection for user arseniy exec ssh tt controlmaster auto controlpersist 60s controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user arseniy connecttimeout 10 example com mkdir home ansible tmp ansible tmp 1437677728 34 220898981465849 chmod rx home ansible tmp ansible tmp 1437677728 34 220898981465849 echo home ansible tmp ansible tmp 1437677728 34 220898981465849 establish ssh connection for user arseniy put var folders m3 m5hb5gbx3g57d60cj9nb30x40000gp tmpt5hifp to home arseniy ansible tmp ansible tmp 1437677728 34 220898981465849 setup establish ssh connection for user arseniy exec ssh tt controlmaster auto controlpersist 60s controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user arseniy connecttimeout example com bin sh sudo sudo sudo via ansible key rzxwzgrdjhibssyapvbxjaryppftqjlz password root bin sh echo become success rzxwzgrdjhibssyapvbxjaryppftqjlz lang en us utf lc messages en us utf lc ctype en us utf usr bin python home arseniy ansible tmp ansible tmp 1437677728 34 220898981465849 setup rm rf home arseniy ansible tmp ansible tmp 1437677728 34 220898981465849 dev null ok node11 play recap node11 ok changed unreachable failed after this line `ok node11 ansible hung and nothing occured until canceled task >>>bug_report p2
ansible iam module documentation gives wrong information http docs ansible com ansible iam module html it says iam manage iam users groups roles and keys as title but iam type key only accepts user group role it does not manage keys at all tried to get the server key but it does not work the documentation needs to be updated it will confuse lot of people >>>docs_report
cobbler py dynamic inventory support for meta to improve performance adjustable group criteria these commits enable caching of cobbler meta data and will return all servers when run which improves performance in addition it can group by owner so that you can run ansible playbooks against servers owned by specific user adjustable groupby key is stored in variable however this could be moved out to the cobbler ini file>>>feature_pull_request
adding display to plugins and start moving debug to display>>>feature_pull_request
lookup plugins not found bug issue type bug report ansible version ansible version ansible configured module search path none if run the playbook on an earlier version of ansible my plugin gets found and executes correctly have lookup plugins defined in my ansible cfg as lookup plugins lookup plugins ls lookup plugins os private fip py lookup plugins os private fip py when run play which does the following add host name lookup os private fip dbd mysql split join groups project prefix mysql get error error lookup plugin os private fip not found >>>bug_report p2
strange behaviour when delegating to host defined in variable issue type bug report ansible version ansible configuration ssh connections are routed through vm via proxycommand environment control machine os osx 10 10 managed os centos summary when using variable in delegate to the connection hangs steps to reproduce this doesn work it eventually times out this works using hardcoded delegate host this also works putting the variable into with items loop and referencing it in delegate to expected results would expect all examples to work the same way actual results the first example fails >>>bug_report
preserve oldpwd in hacking env setup issue type bugfix pull request ansible version ansible configuration none environment summary preserve `oldpwd` when sourcing hacking env setup clobbering `oldpwd` is particularly annoying when cd into the ansible source tree before sourcing force of habit steps to reproduce expected results actual results >>>feature_pull_request
update man1 updated man1 ansible ansible playbook and ansible pull to match command line help >>>docs_pull_request
get memoryerror when fetching large file always get the following error message when trying to fetch about 2gb file fatal failed to parse sudo success cfbftfjqyemugnxnudmbnfkjbidswsqm traceback most recent call last file home xxx ansible tmp ansible tmp 1437624645 89 38788504027242 slurp line 1167 in main file home xxx ansible tmp ansible tmp 1437624645 89 38788504027242 slurp line 67 in main data base64 b64encode file source read file usr lib python2 base64 py line 53 in b64encode encoded binascii b2a base64 memoryerror >>>bug_report
ansible yum and dnf modules does not fire notifications issue type bug report ansible version ansible version ansible master 7124504ccfd837d6a8e4124d619fb605ae92e0b0 ansible configuration hope irrelevant environment fedora 22 summary notify from yum and dnf does not fire events steps to reproduce test playbook expected results as of ansible actual results >>>bug_report p1
include of handlers does nothing even silence if file does not exists issue type bug report ansible version ansible version ansible master 7124504 ansible configuration hope irrelevant environment fedora 22 summary in version it lead to error in if included path does not esistt ansible do not thrown any error nor on include parsing stage nor on fire handlers by non existence name steps to reproduce testhandlerinclude yml playbook expected results fail with error if included path can be included fail with error if requested handler can be notified better provide possibility make it optional as by https github com ansible ansible issues 10839 actual results this playbook fail on ansible with error but seams just fully ignore include in ansible >>>bug_report p2
typeerror nonetype object is not iterable issue type bug report ansible version ansible version ansible devel ae54792a35 last updated 2015 07 21 22 43 44 gmt 500 lib ansible modules core detached head 55bc9e8fb1 last updated 2015 07 21 15 39 28 gmt 500 lib ansible modules extras detached head 26c1bd76c3 last updated 2015 07 21 15 39 28 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 configured module search path none ansible configuration source hacking env setup environment os yosemite 10 10 python python pip freeze ansible coverage coveralls docopt ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos linecache2 markupsafe 23 mock nose paramiko 15 passlib pycallgraph pycrypto pywinrm pyyaml 11 requests six traceback2 unittest2 xmltodict summary when host is unreachable ansible playbook eventually throws an error unexpected exception nonetype object is not iterable steps to reproduce using the same setup and configuration https github com basictheprogram issue11320 used in 11320 with debug enabled and fork remove the unreachable host from the inventory file expected results assume the plays would run to completion even if multiple hosts are unreachable >>>bug_report p2
don disable gssapiauthentication or pubkeyauthentication when using ask pass closes 6846 earlier pr >>>feature_pull_request
add note about running in virtualenv based on dec 2013 pr by sivel but rephrased by me closes 5335>>>docs_pull_request
8935 rebase add outputfile and oexec options to hacking test module rebase of 8935 which merged only with bit of fuzz with couple of trivial edits >>>feature_pull_request
remove mention of apache example removed explicit mention of apache not all of the file modules that use this doc fragment have an apache example some give visudo example instead rather than changing the examples the simplest thing seems to be to remove the explicit mention of apache and just refer to generic example below for more details see https github com ansible ansible modules core pull 1455>>>docs_pull_request
fix add missing import locale this file appears to be missing an import locale fwiw this fixed real issue encountered while using rpi cross >>>bugfix_pull_request easyfix
role level lookup plugins was making an ansible galaxy role today and when placing the lookup folder plugin at the same level as the rest of the folders and then using it it returns that it can find the plugin do we have anyway to use lookup plugins at role level without forcing uses to manually add it to there playbook here is the repo in question master is how got it to work for testing that the lookup plugins folder only works when at the same level as the playbook https github com nowait tools ansible rabbitmq the branch galaxy test is the one that fails >>>bug_report docs_report
fix formatting of groups of groups the example in the groups of groups section was being rendered as quote switching to the notation causes it to render as preformatted text instead this could have also been done with code block but chose to be consistent with other sections in the document >>>docs_pull_request
6238 rebase add ssh specific args config option this is trivial rebase of 6238 from jeremyherbert with an added doc patch note that don particularly like the name ``ssh specific args`` and ve not done anything about the linked from 8637 request to make sftp vars configurable but figured it would be easier to pick up discussion after nearly year if there were documented rebased pr available tested that setting the variable does actually add the arguments to ssh >>>bugfix_pull_request feature_pull_request
debugging module invocations in playbooks issue type feature idea ansible version na ansible configuration na environment na summary find myself often building up complex module invocations for the ``ec2`` module create ec2 instances using the vpc subnets and security groups and access key we configured above name set up ec2 instances ec2 exact count count tag cluster tags image item image region item region group id item group id instance type item type vpc subnet id item subnets id instance tags cluster tags merge item tags key name ec2 key name assign public ip yes volumes item volumes wait yes with together instances vpcs results security groups results register ec2 instances and then when something goes wrong adding bunch of ``debug `` tasks above this to see what actually getting passed in it would be enormously and outrageously useful to be able to just add ``debug `` to the beginning of this task and have it dump the arguments if it hard to deal with ``debug ec2 `` for some reason would be equally happy with ``debug no ec2 but original args `` related to this is that ``debug`` ignores arguments it doesn understand and just prints here we are steps to reproduce na expected results na actual results na>>>feature_idea
expand become after variable merging the become variable still cannot take variables as its value this has been fixed long time ago for become user pr 3217 this commit applies variable expansion to become the same way it is already applied to become user addresses 10667 2526>>>feature_pull_request
feature pull request vagrant inventory bugfixing and refactoring feature pull request ansible version and above summary inventory script is not working for multiple vms steps to reproduce here is simple vagrantfile with db and web virtual machines https gist github com hostmaster 92dd34ed9f8830e9f1d0 expected results somethink like actual results fixed version produces the output below bugfix added support for multiple vms refactored paramiko module is used to parse ssh config added meta` https docs ansible com ansible developing inventory html tuning the external inventory script element markmandel it would be nice if you could have look >>>feature_pull_request needs_revision
fix ipv6 for ssh connection fixes ipv6 when using ssh>>>bugfix_pull_request
replace module typeerror unhashable type dict issue type bug report ansible version master 7124504ccfd837d6a8e4124d619fb605ae92e0b0 ansible configuration hope nothing related to settings environment fedora 22 summary steps to reproduce task expected results in file http pkgs fedoraproject org cgit httpd git tree 00 mpm conf commented all loadmodule directives except mod mpm prefork so actual results fail in module>>>bug_report
hashicorp vault lookup plugin this is lookup plugin to be able to read secrets from hashicorp vault endpoint requires `pip install hvac` usage is like `lookup hashi vault secret secret hello token c975b780 d1be 8016 866b 01d0f9b688a5 url http myvault 8200 where url is optional and defaults to localhost and can also read in from the vault addr environment variable this first iteration doesn support other authentication mechanisms other than token and also presumes the vault is unsealed prior to executing the lookup >>>feature_pull_request needs_revision new_plugin
regression in replace module with ansible v2 when using the replace module the replace argument need to be double escaped to work properly on ansible v2 for example with this playbook this is the output of cat with ansible detached head a09ce4bd87 last updated 2015 07 21 15 10 03 gmt 200 the same playbook is working with ansible >>>bug_report p2
file lookups inappropriately search for files outside cwd issue type bug report ansible version devel 7124504c ansible configuration environment linux summary file lookups break out from the cwd as shown below thanks to the following code in ``plugins lookup file py`` 48 fixme the original file stuff still needs to be worked out but the 49 playbook dir stuff should be able to be removed as it should 50 be covered by the fact that the loader contains that info 51 if playbook dir in variables 52 playbook path self loader path dwim relative variables playbook dir files term note that ``variables playbook dir `` in this case is correctly set to `` home ams y`` and ``term`` is ``foo pub`` steps to reproduce in `` home ams`` do ``mkdir y`` and then create ``x foo yml`` with the following contents hosts localhost tasks debug msg lookup file foo pub then do ``cd x`` and run ansible playbook dev null foo yml expected results the lookup should look for foo pub under the cwd in home ams which it doesn or home ams which it does actual results strace fetrace file ansible playbook dev null vvvv foo yml grep foo pub pid 330 stat home ams files foo pub 0x7fff12b2d1b0 enoent no such file or directory pid 330 stat home ams files foo pub 0x7fff12b2d1b0 enoent no such file or directory pid 330 stat home ams foo pub 0x7fff12b2d1b0 enoent no such file or directory pid 330 stat home ams foo pub 0x7fff12b2cf10 enoent no such file or directory note the lookup of home ams files foo pub outside my cwd `` home ams x`` and yes it does look for `` home files foo pub`` if do all this one level up checked >>>bug_report
fix intro inventory documented params update for the new become system replaces and updates 9588 >>>docs_pull_request
lookup gives poor error message for missing file issue type bug report ansible version ansible configuration none environment summary requesting `lookup` against non existent file no longer offers an error message that clearly indicates that the file does not exist steps to reproduce create this `playbook yml` run it as follows expected results as per ansible actual results >>>bug_report p2
ansible playbook ignores step issue type bug report ansible version ansible configuration none environment summary the step` flag to `ansible playbook` is ignored steps to reproduce create this `playbook yml` run it as follows expected results as in `ansible playbook` should prompt before executing each task actual results the playbook is run as if step` was not specified >>>bug_report p1
ignore errors with missings source files in synchronize module issue type bug report ansible version ansible configuration clean setup environment starting ansible playbook from rhel targeting rhel and rhel summary missing source files in copy or synchronize module can be caught with ignore errors yes steps to reproduce http grokbase com gg ansible project 148w7rvbbe how to sync over directories that exist locally name setup user home directories synchronize src homes item username dest home item username owner item username group item username with items ssh users ignore errors yes so basically want it to copy home directory for users that have one not everyone will have one because not everyone really needs say their own customized vimrc etc in those cases like ansible to just skip it expected results missing source files should be skipped actual results task users setup user home directories fatal default input file not found at roles users files homes or roles users homes fatal all hosts have already failed aborting >>>needs_info
mount module not working with centos the same way it did with centos the mount module is not working anymore for me works in centos but the same playbook in centos7 gives me that please enter password with the systemd tty ask password agent tool am mounting cifs share note that am passing the user credentials in the options filed >>>needs_info
only set ansible ssh host if not already set issue type bugfix pull request ansible version ansible devel 5b5ba35111 last updated 2015 07 20 20 08 15 gmt 400 ansible configuration defaults inventory hosts py test script for this bug report environment os summary when using dynamic inventory that sets ansible ssh host as hostvar ansible will set ansible ssh host to ipv4 address which earlier gets defaulted to name so ansible will connect to name instead of ansible ssh host steps to reproduce set ansible cfg to dynamic hosts file made super basic inventory script for testing ve tested with both meta vars and hostvars supplied with host here is sample script used for testing >>>bugfix_pull_request p1
fix for configs getting ignored if environment variable is supplied this should resolve 11599 which is caused by python on linux returning empty string when the environment variable is not present the new test passed on both os and ubuntu verified the fix also works on centos6 >>>bugfix_pull_request
on the devel parameters are not propagated to windows module commands on the remote windows host issue type bug report ansible version ansible devel 6bff315ed8 last updated 2015 07 20 11 54 35 gmt 400 ansible configuration no changes stock ansible configuration environment results of uname darwin brian lloyds macbook pro local 14 darwin kernel version 14 thu feb 26 19 26 47 pst 2015 root xnu 2782 10 73 release x86 64 x86 64 summary on the devel github source parameters are not propagated to windows module commands on the remote windows host steps to reproduce given the following playbook hosts windows tasks name test copy win copy src ansible testing test txt dest test test txt the result is an error exec powershell noprofile noninteractive executionpolicy unrestricted file users administrator appdata local temp ansible tmp 1437429216 04 162277422500825 win copy ps1 winrm exec powershell noprofile noninteractive encodedcommand uabvahcazqbyafmaaablagwabaagac0atgbvafaacgbvagyaaqbsaguaiaatae4abwbuaekabgb0aguacgbhagmadabpahyazqagac0arqb4aguaywb1ahqaaqbvag4auabvagwaaqbjahkaiabvag4acgblahmadabyagkaywb0aguazaagac0argbpagwazqagaciaqwa6afwavqbzaguacgbzafwaqqbkag0aaqbuagkacwb0ahiayqb0ag8acgbcaeeacabwaeqayqb0ageaxabmag8aywbhagwaxabuaguabqbwafwayqbuahmaaqbiagwazqatahqabqbwac0amqa0admanwa0adiaoqayadeangauadaanaatadeangayadianwa3adqamgayaduamaawadgamga1afwaxab3agkabgbfagmabwbwahkalgbwahmamqaiaa winrm result fatal 52 11 216 failed changed false failed true msg missing required argument src play recap 52 11 216 ok changed unreachable failed this appears to be because in devel the arguments file is not being copied to the remote host and the path the arguments file is not being added as an argument to the remote command so that the parse args function can handle it expected results ansible should put the arguments file to the remote windows host and pass the path to that temp file as an argument to any module that takes params actual results as noted above no parameters file is created for any windows module tested few win copy is simple example thus all windows modules that require params fail when checking for the existence of their first parameter have worked around this for now by sourcing the v1 version of hacking env setup doing this results in the appropriate parameters file being created on the remote host and its path being appropriately passed in the encoded powershell command sent to the remote host >>>bug_report p2 windows
ec2 iam py user already exists issue type bug report ansible version ansible configuration didnt modify the ansible cfg at all environment ubuntu 14 04 lts 13 48 generic 80 ubuntu smp thu mar 12 11 16 15 utc 2015 x86 64 x86 64 x86 64 gnu linux summary false alarm when creating an ec2 user stating that the user already exists steps to reproduce just install ansible from the devel git and test is against an ec2 env by creating iam user here is the code used expected results the expected result should be that the user will be created that is happening already without errors actual results user is created but get false alarm that its already there see below >>>needs_info
ansible is overzealous with respect to ssh key issue type bug report ansible version used version nb meanwhile it turns out that the official ppa distributed deb for `trusty` that self reports as `2 preppa trusty` on 2015 06 25 in fact the version seems to be off of the line ansible configuration can find the vanilla version on github your template should contain link to that environment ubuntu 14 04 x86 64 summary despite having `connection local` in my playbook the following error causes the whole playbook to fail steps to reproduce the problem is created when using the `acl` module to add an `user oliver x` to the directory with the key and another `user oliver to the `id rsa` file this results in the unix file permission `r` being added for the group and therefore to the above error because of the overzealous check despite running locally the next step of removing the `r` bit fails catch 22 expected results ansible should not care about my private ssh key for `connection local` actual results it errors out see above if more information is needed let me know please oliver>>>backport bug_report
integrate eui64 slaac into ipaddr jinja2 filter usage 2db8 64 ipaddr l2addr enforce rfc 4862 and ignore networks with prefixlen other than 64 does not require separate keyword acts as if l2addr was an index in the subnet does not work with bare hwaddr such as 001122334455 to keep templates like 2db8 32 ipaddr 32 working better force hwaddr format as in 2db8 64 ipaddr l2addr hwaddr eui48 when unsure >>>bugfix_pull_request
add sshpass support for `synchronize` add sshpass support for rsync work together with https github com ansible ansible modules core pull 1755>>>feature_pull_request
update intro configuration rst removed some grammar redundancy >>>docs_pull_request
add test checks that handlers work with loops following 11606 >>>feature_pull_request
issue when python json is installed centos5 hello would report issue en centos5 vhen python json is also installed we have installed on the same server python json el5 python simplejson el5 and when we try to use ansible we have this error without python json all works fine is it issue already knew >>>bug_report
update intro inventory rst change the groups of groups example to use same block formatting as the rest of the docs >>>docs_pull_request
galaxy suggestion add number of reviews issue type feature idea summary the ratings are somewhat useful but vital component to them are missing and that number of reviews seeing and on the search page doesn mean much if there is only one review for the former and 10 for the latter expected results it would be great to have something like amazon showing the number of reviews as well as average often looking for the most often used package anyway and this would be big help in finding them >>>feature_idea
ansible vault should prompt for password when it needs to as in v1 issue type bug report ansible version devel a8ba9cac3 ansible configuration na environment na summary in ansible running ansible vault interactively prompts for the password with devel it breaks unless you explicitly specify ask vault pass which is pretty tedious note this is about running ansible vault directly not specifying ask vault pass to ansible playbook was going to work up pr to fix this but thought note it here for the record but if someone else wants to fix it please feel free it should be simple fix steps to reproduce ansible vault view encrypted file expected results prompt for vault password as ansible does actual results error password is required to use ansible vault>>>bug_report easyfix p2
allow ansible to connect to docker containers without using ssh this connection plugin allows ansible to connect to docker containers through using `docker exec` to allow ansible to configure docker containers without first copying ansible and your playbooks to the container as long as there python you re good to go just like with regular servers it was largely based on the work done by lorin hochstein on his https github com lorin ansible docker connection project some remarks about the implementation it does not use docker py but calls the docker cli through subprocess ve found that from experience with other projects that use docker py it very much moving target at the moment and that tends to break integration as it did quite recently in ansible as well believe if people insist on using docker py instead can rewrite the code accordingly to copy files over to the container it `cat`s the file and writes them to the stdin of the container this is because `docker cp` does not actually support copying from the host to the container only the other way around this trick hack seems to work well enough for now and we can gradually get rid of it once https github com docker docker pull 13171 has been integrated into docker >>>cloud feature_pull_request new_plugin
ansible breaks synchronize functionality and completely changed the behavior issue type bug report ansible version devel environment unrelated but host mac 10 10 target ubuntu 10 the first issue is in when want to sync two folders on the remote server do now it keeps giving me permission denied error the second issue is it looks like now it defaults to sync two folder on the remote server even if don specify delegate to in without delegate to src will be my local and dest will be my remote thanks>>>bug_report p1
explain uniqueness requrement for handler task names addresses comments in 4943 >>>docs_pull_request p2
behaviour of parsing string value some val should be documented issue type bug report ansible version devel 7a9b5b6f ansible configuration ansible environment summary took the example of using the quote filter from rst playbooks filters rst put it in playbook and then ran it with string value set to as shown below it didn seem to be quoting properly although when the variable is defined in the playbook vars section it does work as expected steps to reproduce create playbook containing the following hosts localhost tasks shell echo string value quote then run ansible playbook dev null foo yml string value also other values such as etc expected results expected to see on stdout stdout lines actual results with string value the output was only changed localhost changed true cmd echo delta 00 00 002520 end 2015 07 19 11 12 59 176126 rc start 2015 07 19 11 12 59 173606 stderr stdout stdout lines warnings with string value or string value the output was error unexpected exception error while splitting arguments either an unbalanced jinja2 block or quotes>>>docs_report feature_idea
timeout causes fact cache corruption issue type bug report ansible version ansible as distributed by debian dfsg ansible configuration any playbook containing conditionals involving facts environment debian linux jessie summary after timeout during play on slow host plays involving conditionals fail on that host steps to reproduce copied from downstream ticket https bugs debian org cgi bin bugreport cgi bug 792793 faced timeout on slow host since this playing playbooks failed on that host when conditionals where used after some digging it appeared the fact cache for this host using jsonfile only contained the following line module setup true so ansible must not write in cache if any error occurred during fact collection expected results fact cache is either deleted upon failure to refresh on next run or left intact with old data actual results fact cache contains only module setup indication >>>bug_report p2
add homebrew to package managers list homebrew is typically installed in fixed path we can detect it with ease >>>feature_pull_request
meta inventory and fixes added meta refresh inventory cleaned up ansibleerror to match general style now dir and single file share same logic on dealing with files if executable fails we try ini aftewards and only then really fail inventory ignored files are now configurable added note to plugins inventory that it is not currently used code fixes 8830 10068 10369 and some cases of 9526>>>feature_pull_request
modifications to ignored files in inventory directories v2 replacement for the old pull request 8830 this adds readme to the list of file patterns ignored in inventory directories and adds an ignored inventory files configuration option which can be used to override the list the environment variable ansible ignored inventory files can also be used ve tested this by hand but didn know if there good place to test this yet in the new v2 test system all the best quentin >>>docs_pull_request
template module breaks json issue type bug report ansible version devel exhibits this behaviour from commit 301019059272ab0a1b288a20c9772107b592dccd onward ansible configuration none environment ubuntu 15 04 x86 64 python jinja2 simplejson summary json files rendered by the template module are invalid whitespace is compressed undesirable and double quotes are converted to single quotes show stopper steps to reproduce create this template called `array json j2` feed the template to the template module with this `playbook yml` apply the playbook and observe the generated `array json` expected results the generated `array json` should match what ansible produces actual results the generated output is invalid double quotes converted to single quotes and less readable whitespace compressed >>>bug_report needs_info
update list of prerequisites for make tests had to install these additional modules to get make tests to run without complaint patch funcsigs and coverage>>>bugfix_pull_request
allow vars main to be folder issue type feature idea ansible version ansible configured module search path none ansible configuration stock environment summary allow `vars main` to be directory and automatically load all variable files within similar to inventory directories steps to reproduce am using dependencies and relying on `vars main yml` to set variables which will be used by the dependency roles my current situation is having mysql role which needs username and password would like to set this in my top level role for re usability however would also like to use ansible vault on the sensitive variables while keeping other variables in the clear ve tried using an `include vars` in the top level role `tasks main yml` but it seems that these are not passed to dependency roles like they are from `vars main yml` expected results if it were possible to keep separate files for sensitive and non sensitive variables could put them both in `vars main and protect just the one need to and all variables would still be passed along to dependencies maybe there another way to do what trying to accomplish but ve spent long time searching and trying things and haven found any great options >>>feature_idea
capture error when smoeone puts list or some other complex type in note that this is fix for stable fixes reported traceback produces >>>bugfix_pull_request p2
moar docs added docs for new v2 features restructures modules bar and core extras info into their own pages changed templates to refer to the new pages >>>docs_pull_request
add an option to stack filters in ec2 inventory script added an option to stack filters in ec2 inventory script >>>feature_pull_request p2
update docs styling this pr updates ansible documentation by adding one of the official ansible fonts open sans removing the grey block due to the google remarketing code adding navigation bar that goes to the new docs landing page updating the color and style of the index header in the navigation drawer you ll need to run `make staticmin` to instantiate the css changes to the minified file >>>docs_pull_request
connection closed waiting for privilege escalation password prompt pulled recent devel from git experienced issue and isolated to commit point have tried with sudo and ask sudo pass as well as with become and ask become pass preceding tasks of file for creating directory work sles 11 sp3 task copy works at commit point dc63bbf0b9686db297de8d0bb801cba0418f88f2 june 17 2015 does not work at commit point 194b85338f0cae2d986f371508b37a2961d98dfb june 17 2015 error connection closed waiting for privilege escalation password prompt name create consul template config copy src 01 consul template conf dest consul template config dir 01 consul template conf verbose output is equivalent between the two up to this point establish ssh connection for user tg8855 exec ssh tt vvv controlmaster auto controlpersist 60s controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 msp0lnand001 etdbw com bin sh sudo sudo sudo via ansible key kwinvgdxmqggrhhvnvpjkhgnwocpufrw password root bin sh echo become success kwinvgdxmqggrhhvnvpjkhgnwocpufrw rc flag etc consul template conf 01 consul template conf rc etc consul template conf 01 consul template conf rc etc consul template conf 01 consul template conf rc python dev null rc rc xflag echo rc etc consul template conf 01 consul template conf exit python import hashlib blocksize 65536 hasher hashlib sha1 afile open etc consul template conf 01 consul template conf rb buf afile read blocksize while len buf hasher update buf buf afile read blocksize afile close print hasher hexdigest dev null python import sha blocksize 65536 hasher sha sha afile open etc consul template conf 01 consul template conf rb buf afile read blocksize while len buf hasher update buf buf afile read blocksize afile close print hasher hexdigest dev null echo etc consul template conf 01 consul template conf establish ssh connection for user tg8855 exec ssh tt vvv controlmaster auto controlpersist 60s controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 msp0lnand001 etdbw com mkdir home ansible tmp ansible tmp 1437167920 48 182501296239349 chmod rx home ansible tmp ansible tmp 1437167920 48 182501296239349 echo home ansible tmp ansible tmp 1437167920 48 182501296239349 the one that succeeds has the additional output where the other one stops establish ssh connection for user tg8855 put tmp tmphhgjpz to home tg8855 ansible tmp ansible tmp 1437167920 48 182501296239349 file establish ssh connection for user tg8855 exec ssh tt vvv controlmaster auto controlpersist 60s controlpath tmp ansible ssh kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 msp0lnand001 etdbw com bin sh sudo sudo sudo via ansible key gptcrbwurujzncotdqfurvildirzxbqv password root bin sh echo become success gptcrbwurujzncotdqfurvildirzxbqv lang lc messages lc ctype usr bin python home tg8855 ansible tmp ansible tmp 1437167920 48 182501296239349 file rm rf home tg8855 ansible tmp ansible tmp 1437167920 48 182501296239349 dev null >>>bug_report p1
gce inventory doesn provide disk names when attach some extra disks to vm they are named gce inventory doesn provide name of extra disks hack the inventory to fix this point libcloud doesn expose disk name but libcloud provides simple api to talk directly with gce rest api the patch is light https github com bearstech ansible commit d34a4d759a9ebf832dc3569a286fd1b632607feb but don know how to normalize the output >>>feature_idea
gce tag prefix for creating ansible group when you migrate your old hosting to gce you want to keep your beloved groups it can be done with simple name convention gce tag beginning with group like group toto becomes group named toto >>>feature_pull_request
fix ansibleerror object name in subelements plugin fixes 11624>>>bugfix_pull_request p2
devel bug profile tasks py requires callback constants or the display param is not passed relates to 11625 and commit a09f623 >>>bug_report
profile tasks py requires callback constants or the v2 code doesn pass the display param and it gives an error relates to 11625 and commit a09f6236a5f9ace208e7b17893e67c386abaa802 fixes 11627 before change after change >>>bugfix_pull_request p2
add plugin that profiles playbook tasks resubmission of https github com ansible ansible pull 11270 to correct ansible v2 file location description and console output demonstration https github com aioue ansible plugin profile blob mast er readme md features provides per task timing ongoing playbook elapsed time and ordered list of top 20 longest running tasks at end >>>feature_pull_request new_plugin
errors is undefined in subelements py issue type bug report ansible configuration defaults command warnings false forks 64 gathering smart nocows pattern remote tmp home ansible tmp transport smart inventory inventory hash behaviour merge ansible version ansible devel ba7243c5f9 last updated 2015 07 16 15 01 11 gmt 100 lib ansible modules core detached head 291fef3b34 last updated 2015 07 16 15 01 36 gmt 100 lib ansible modules extras detached head ff2386faf4 last updated 2015 07 16 15 01 40 gmt 100 v1 ansible modules core detached head f8d8af17cd last updated 2015 07 16 15 01 45 gmt 100 v1 ansible modules extras detached head 495ad450e5 last updated 2015 07 16 15 01 49 gmt 100 configured module search path none environment centos summary python stack trace received when running an incorrectly configured playbook expected to see the human readable error message steps to reproduce trying to iterate over dictionary using with subelements rather than list with subelements my dict subfield also dict expected results actual results believe the issue is the from ansible errors import statement in subelements py which can be replaced with from ansible import errors >>>bug_report p2
hacking test module updated to use new loader associated with 11619 successfully runs through with more complex module and args either directly or from file >>>bugfix_pull_request
devel breaks gathering explicit setting in ansible cfg issue type bugfix pull request ansible version devel d70c88bf ansible configuration gathering explicit environment summary setting gathering explicit in ansible cfg has no effect plays without gather facts true still gathered facts there was confusion between the valid values for defaults gathering explicit implicit smart and play gather facts setting boolean which resulted in gathering explicit being ignored steps to reproduce set gathering explicit run play that doesn set gather facts true expected results doesn gather facts actual results does gather facts >>>bugfix_pull_request
key error dependencies from ansible galaxy install requirements yml in role dependencies role data dependencies issue type bug report ansible version fdavis haifisch ansible version ansible configured module search path none ansible configuration uncommented the following retry files save path ansible retry environment server archlinux fdavis haifisch uname linux haifisch arch smp preempt wed jul 15 08 30 32 utc 2015 x86 64 gnu linux client ubuntu 14 04 from the vagrantbox ubuntu trusty64 vagrant vagrant ubuntu trusty 64 uname linux vagrant ubuntu trusty 64 13 44 generic 73 ubuntu smp tue dec 16 00 22 43 utc 2014 x86 64 x86 64 x86 64 gnu linux summary better error handling when dependencies is not in role data during ansible galaxy install file usr bin ansible galaxy line 845 in execute install role dependencies role data dependencies keyerror dependencies steps to reproduce run ansible galaxy requirements yml roles against expected results role should install without errors actual results key errors during install >>>needs_info
add option to apt to allow unauthenticated packages if try to install deb package which was not signed authenticated the apt module fails additionally there is no way to pass allow unauthenticated to apt get with this module have few home grown packages which are stored in secure locations there no need to sign them need to pass the allow unauthenticated to apt get for these packages thanks >>>feature_idea
hacking test module needs updating for devel following 11618 started trying different modules is lib ansible utils init py supposed to pull in all other files in the folder the above error happens unless the following import is added import ansible utils vars as vars with the above import added it then errors with grep ing shows that parse yaml and parse yaml from file only exist in the v1 code base that as far as got >>>bug_report p2
hacking test module updated to new location and non classness of module common before change after change >>>bugfix_pull_request
fixes 11607 override ansible ssh port in group host vars tested with ansible myhost ping vvvv it correctly picks up ansible ssh port in the following order host vars group vars remote port default in ansible cfg full testing can be seen in https gist github com halberom 2195fe0d6dfa996d9439 only thing not sure about is whether it should be assigned to class variable also took look at the unit tests and although could see there port test in executor connection info ve no idea how to validate or expand on it any tips appreciated >>>bugfix_pull_request
vmware py fix to handle user directory correctly ansible tmp >>>bugfix_pull_request
template module only processes templates that contain have file in which like to include inline comments but need those comments to be removed in the final version of the file so ve been using jinja2 comments like these however ve observed that the template module will copy the file literally ignoring comments unless the file contains the string this feels like reasonable optimization but we should probably check for the other triggers too and perhaps if ansible has jinja2 line statements enabled thanks happy thursday >>>needs_info
fetch action stalls on local problems issue type bug report ansible version ansible configuration nothing important changed from the upstream example only the defaults inventory and defaults remote user settings environment debian jessie on amd64 summary when fetching file from the remote host which can not be written locally the write fails silently steps to reproduce below just execute the same fetch command multiple times the first call fetches the file and has the status changed the second call doesn change anything everything is well now reproduce the problem change the file locally and make it unwritable ansible notices that the file doesn have the correct output tries to change it but does not recognise that updating the file fails because of this subsequent calls of the same action still return changed status allthough nothing happened expected results on errors fail actual results ignores error silently one could argue that using the validate checksum flag makes ansible fail this action instead of silently skipping it in my opinion the validate checksum flag should be used to ensure that the source file didn change in the meantime and that full consistent file was fetched but should not guard against programming errors in ansible itself quick and dirty patch the following patch makes ansible fail this action instead of silently skipping the problem the status message could be improved >>>bug_report
directive become sudo not working unless using ansible keep remote files centos issue type bug report ansible version ansible configuration changed transport for paramiko if do get environment control machine ubuntu 14 04 made with managed node centos made with note both machines have set up private networks omitted for brevity summary connecting as root `become` is not working get `error ssh connection closed waiting for password prompt` but it works if set the variable `ansible keep remote files 1` note my intention is to connect as root become user postgres and create user and db to use the modules `postgresql db` etc need to be the postgres user but that user by default doesn have password so need to connect as root and become postgres the problem also applies for other users so made the issue as general as possible becoming user vagrant steps to reproduce playbook file main yml to get the error to make it work expected results running should work and do not give errors and return the same results as giving the variable `ansible keep remote files 1` as understand the variable `ansible keep remote files 1` should be used for debug only and shouldn be needed to make `become` work the outputs of those commands are below omit them here for brevity actual results when run get but when run get >>>bug_report p1
error invalid ini entry first time configurating ansible use ansible playbook ubuntu 14 10 am configured playbook and task created inventory file started ansible follow command ansible playbook etc ansible inventory etc ansible roles preconf tasks test new yml list hosts list tasks and receipt error error invalid ini entry this need more than value to unpack in what my error what do wrong >>>needs_info
ansible ssh port ignored in group vars and group vars issue type bug report ansible version ansible configuration environment summary since f17bdc4d ansible ssh port in inventory group vars and group vars is ignored steps to reproduce define inventory in `hosts` create this `playbook yml` execute the playbook expected results expect the output get from ansible which correctly prints `3022` as the value of `ansible ssh port` appreciate that setting `ansible ssh host` at group level makes no sense only included it to delineate the scope of the problem actual results get an empty `ansible ssh port` again the fact that `ansible ssh host` is wrong only delineates the scope of the problem and is not use case care about >>>bug_report p2
using loops notify didn work when the notify value is single string and not list task post validate https github com pilou ansible blob notify with items lib ansible playbook base py l242 was called for each included task https github com pilou ansible blob notify with items lib ansible executor task executor py l238 but wasn https github com pilou ansible blob notify with items lib ansible executor task executor py l164 for the include task post validate needs to be called because this method modifies https github com pilou ansible blob notify with items lib ansible playbook base py l290 the task for example the notify attribute becomes list if it string without this patch using an handler named test notified handlers` https github com pilou ansible blob notify with items lib ansible plugins strategies init py l403 looks like test testhost testhost testhost when it should be test testhost >>>bugfix_pull_request
variables from other roles substitute into task names as variable name not the usual case of failed substitution you expect with this output expect this output if `source variable` didn exist or was from `group vars` and thus couldn be substituted 3103 which if as expected is still wart or couldn be templated for some other reason 10347 but that not quite the case variable is substituting properly in the task itself at least for `debug` `command` and `shell` substituting as the name of the variable it came from in the task name if it could be substituted into the name expect `task role2 value if it couldn be substituted into the name expect `task role2 variable instead the task name incorporates the name of the source variable `task role2 source variable demo `variable from other role substitutes as its own name yaml` `roles role1 defaults main yaml` `roles role2 tasks main yaml` kick it off with >>>bug_report
fixed first available found for template refactored into common function added deprecation warning fixed display deprecated to make version optional code already assumed this turned warning deprecated in plugin loader into actual call to deprecated >>>bugfix_pull_request
have openssl autonegotiate tls protocol on python this allows usage of tls and tls if the underlying openssl library supports it unfortunately it also allows sslv2 and sslv3 if the server is only configured to support those in this day and age that probably something that the server administrator should fix anyhow >>>bugfix_pull_request
add an apt upgrade apt upgrade option that runs `apt get upgrade` not aptitude issue type feature idea ansible version ansible ansible configuration environment ubuntu 14 04 summary add an apt upgrade apt upgrade option that runs `apt get upgrade` not aptitude steps to reproduce would like to be able to run task like name apt upgrade apt update cache yes upgrade apt upgrade that is equivalent to running in the shell apt get upgrade at present there is no option that includes this functionality the current ones are yes or safe `aptitude safe upgrade` full `aptitude full upgrade` dist `apt get dist upgrade` the reason this is desirable is because all of the above options will upgrade the kernel if new one is available whereas `apt get upgrade` holds these back by default in many cases one might want to upgrade the package using the more conservative `apt get upgrade` so it would be great if it exposed as an upgrade option >>>feature_idea needs_to_be_moved
synchronize module doesn respecting ssh config issue type bug report ansible version ansible ansible configuration all ssh related by default environment fedora 22 summary when using the synchronize module rsync is attempting to use direct connection to the host without configured parameters like port user proxy similar issue was reported https github com ansible ansible issues 6590 but then requalified only to user setting and closed steps to reproduce playbook tasks run against host egais app balance that defined in inventory in ssh config please note port different from 22 and proxycommand defined because there no direct access expected results run playbook works because host accessible directly with that configuration actual results fails with no access by port 22 >>>bug_report
support wait in ec2 elb lb issue type feature idea ansible version ansible configuration none environment summary please support `wait true` on the `ec2 elb lb` module so that in the `state absent` case it waits for the elb to have been successfully removed before completing steps to reproduce given an elb called `myelb` in security group called `mysecuritygroup` try to apply the following `playbook yml` expected results the playbook should complete successfully the first time it is run the elb and security group should not exist once the playbook completes actual results the playbook fails in the `ec2 group` action the first time it is run the elb and security group exist once the playbook completes after some time rerunning the playbook produces the expected results the `ec2 group` failure is >>>cloud feature_idea
do not fail when skip tag matches nothing hi it often happens in my case that ansible throws telling me that tag willing to skip doesn exist through totally understand that it made in order to prevent typos in the tags it quite frustrating since skipping it could we just ignore the invalid tag usually it only invalid because commented out some roles in order to speed up the provisioning during development regards warren >>>feature_idea
ssh port not working as the if clause is wrong the ssh port always results in port 22 as the if clause is never executed this means that hosts on non standard ssh port cannot be accessed>>>bugfix_pull_request
file lookup fails in template when reading binary data like an image file hello given variable like this file path sample bmp and given jinja2 template file with some content like this lookup file file path when playbook that uses that template is run failure like the following occurs fatal my remote host msg ansibleerror unexpected error in during lookup utf8 codec can decode byte 0xff in position 57 invalid start byte failed true fatal my remote host msg one or more items failed failed true changed false results skipped true changed false msg ansibleerror unexpected error in during lookup utf8 codec can decode byte 0xff in position 57 invalid start byte failed true fatal all hosts have already failed aborting play recap to retry use limit home osg main retry my remote host ok changed unreachable failed to reproduce it you can try it with any binary file you have available like jpeg png or bmp image tried with some text file and it worked fine so it seems it related to the internal content of binary files the environment used is ansible ubuntu 14 04 64 bits gnu linux kernel 19 22 generic please review it when you have time available and thanks lot >>>feature_idea
apt module ignoring some packages for installation in my playbook have long list of packages needed for installation about half of them are not installed when the playbook is run and have to be manually installed after the playbook finishes what could possibly cause this >>>needs_info
playbook role variables overwritten by include vars call issue type bug report ansible version ansible configuration default installation config done with pip install ansible upgrade if bug is taken in consideration yet can be replicated ll provide the entire config file environment ubuntu 14 04 summary when using include vars within role than calling the role from playbook and giving it different values for variables declared in include vars yml when debugging in tasks main yml variables values ar the ones from playbook when debugging in included file within tasks main yml variable values are the ones from include vars file steps to reproduce please see https github com dragoscirjan ansible issue 11592 expected results when running the playbook given playbook variables should be given throughout the entire role files actual results when running test sh the output looks like this >>>needs_info
connection function for boto3 this is adding simple connection function for boto3 inside of module code it would be used like there are two noticeable pieces that make it functionally different than the current connection functions `conn type` refers to the type of session you want whether high level resource session or low level client session or both the boto3 docs regarding sessions are here resources clients `resource` this is the aws resource you want to communicate such as ec2 s3 autoscaling etc full list is here res list this should allow everyone to start using boto3 for module development enhancement right away resources clients http boto3 readthedocs org en latest reference core session html res list http boto3 readthedocs org en latest reference services index html>>>feature_pull_request p2
fixing bug 1655 this should fix https github com ansible ansible modules core issues 1655 it works in my local branch >>>needs_info
add support for sni and tls and tls to the fetch url helper fixes 1716 fixes 1695>>>bugfix_pull_request p2
upcloud inventory script dynamic inventory script for www upcloud com iaas provider supports python tested with uses https github com upcloudltd upcloud python api quite lot upcloud offers free trial for testing if someone wants to help testing this and the module in near future you may email me at elias nygren at upcloud dot com for more credits if you run out of the free trial am also writing module but opening this pr for the inventory first feel free to comment give advice point out errors or improvements etc >>>cloud
variable resolution wrong if using hostvars issue type bug report ansible version ansible ansible configuration nothing environment darwin redacted 14 darwin kernel version 14 thu may 28 11 35 04 pdt 2015 root xnu 2782 30 release x86 64 x86 64 summary when resolving variable from `another host` via `hostvars` if that variable is built up from other variables those are resolved in the content of the `current host` instead of `another host` steps to reproduce please see https github com dwt ansible reproduction variable resolution for reduction calling that playbook will demonstrate the problem in the output expected results using `hostvars` should not change the way variables are evaluated as that means you can really get the variables from another host as he would see them which makes this feature rather dangerous instead it should allow to access variables as if another host would access them actual results if variable is composition of other variables accessing it through `hostvars` will resolve those other variables in the context of the current host thus giving unexpected and sometimes dangerous results >>>bug_report
ansible vault rekey fails there bug in ansible vault py that causes it to fail on rekey error the error is caused by this line https github com ansible ansible blob 032690a8439012833ca4206acd3ce3fe4d725e6c lib ansible cli vault py l61 which should be `elif self action rekey `>>>bug_report p1
including empty task files no longer allowed issue type bug report ansible version ansible configuration none environment summary in ansible it is no longer legal to include an empty task file this was allowed with ansible and there are galaxy playbooks that depend on this from the looks of it they include boilerplate task files that could just be deleted but this is breaking change nonetheless steps to reproduce it easy to repeat with this `playbook yml` we just provide empty yaml in `included yml` expected results the playbook should complete without error actual results although this example begs the question but why would you do that this problem exists in roles too where we might have includes for each supported distro but where not all distros need anything special done reporting the issue because ran into galaxy playbook is affected >>>bug_report
powershell ps1 is not equal across v2 and v1 ping jhawkesworth shouldn these two files have the same contents >>>bug_report
use yaml filename extensions for vars files the v2 codebase didn use this previously introduced constant yet yaml filename extensions>>>bugfix_pull_request
do not combine group vars with an empty file this addresses specific case with multiple vars files in group vars groupname directory where one of those files is empty which returns none instead of an empty dict this then triggers an error in the combine vars utility function >>>bugfix_pull_request p2
groups and append always shows changed see https github com ansible ansible issues 3062 this appears to remain an issue or has resurfaced at least on amazon linux like centos if run this user name foo state present group wheel groups wheel shared append yes password 45122387 7q8mu6uffyjyqk 6ve7trupuudrtjszwzgzx7ymuep1vhg nnt8wkq mrs3via6t2itpqaqoh 6extvnq88wi it shows as changed every time >>>bug_report needs_info needs_to_be_moved p2
handlers are not running in proper order when using tags issue type bug report ansible version ansible configuration environment ubuntu 12 04 summary according to the ansible documentation handlers are automatically processed between pre tasks roles tasks and post tasks sections however when running ansible playbook with tags this is not the case instead the handlers are all run at the end of the play this issue was observed when running ansible tower on ubuntu 12 04 when installed with either pip or apt get the issue was not present on osx yosemite steps to reproduce roles handler test tasks main yml roles handler test handlers main yml handlers test yml expected results actual results >>>bug_report
ansible oneline seems not to be as usefull any more since devel v2 up to we get which changed in v2 to >>>bug_report p2
feature request change success failed on plays summary if play has name the play should have `state` which can be used in other plays general work if any task in play has changed `play changed` is true if any task in play has failed `play failed` is true if no tasks in play have failed `play success` is true if all tasks have been skipped `play skipped` is true note play can have failed and changed at the same time pre conditions play must have name examples example changed name play1 tasks shell bin true creates bin true shell date name play2 tasks shell echo play has changed because tasks has changed when play1 changed example failed name play1 tasks shell bin true shell bin false name play2 tasks shell echo play has failed because tasks has failed when play1 failed shell echo play changed because tasks has changed when play1 changed example success and skipped play all tasks are skipped name play1 tasks shell bin true creates bin true shell bin false creates bin false name play2 tasks shell echo play has only skipped tasks when play1 success and play1 skipped example success and not only skipped but changed play all tasks are skipped name play1 tasks shell bin true shell bin false creates bin false name play2 tasks shell echo play has not only skipped tasks when play1 success and not play1 skipped shell echo play has also changed tasks when play1 changed >>>feature_idea
fixed github links to plugin sources ve fixed the links to the github sources in the documentation for developing plugins >>>docs_pull_request
too few tags none from ec2 py inventory script for rds instances in fact it was cloned from here https github com ansible ansible modules extras issues 668 when using ec2 py https github com ansible ansible blob devel contrib inventory ec2 py inventory script it returns no tags for rds instances saying when it is regular ec2 node we have this 172 29 134 ec2 in monitoring element false ec2 ami launch index ec2 architecture x86 64 ec2 client token ec2 dns name ec2 ebs optimized false ec2 eventsset ec2 group name ec2 hypervisor xen ec2 id 3ace31c4 ec2 image id ami d85e75b0 ec2 instance profile ec2 instance type m3 medium ec2 ip address ec2 item ec2 kernel aki 919dcaf8 ec2 key name devkey ec2 launch time 2015 07 01t00 44 19 000z ec2 monitored false ec2 monitoring ec2 monitoring state disabled ec2 persistent false ec2 placement us east 1b ec2 platform ec2 previous state ec2 previous state code ec2 private dns name ip 172 29 134 ec2 internal ec2 private ip address 172 29 134 ec2 public dns name ec2 ramdisk ec2 reason ec2 region us east ec2 requester id ec2 root device name dev sda1 ec2 root device type ebs ec2 security group ids sg dd42aeba ec2 security group names public ec2 sourcedestcheck true ec2 spot instance request id ec2 state running ec2 state code 16 ec2 state reason ec2 subnet id subnet 09f38250 ec2 tag name arenaci ec2 tag deployment ansible ec2 tag environment arenaci2 ec2 tag role all ec2 virtualization type paravirtual ec2 vpc id vpc 19e3ef7c but rds instance has only usersdb shard1 devshared c2i4io1knn7g us east rds amazonaws com ec2 dbinstance ec2 dbname devshared ec2 optiongroupmembership ec2 optiongroupmemberships ec2 optiongroupname default mysql ec2 publiclyaccessible false ec2 status in sync ec2 address usersdb shard1 devshared c2i4io1knn7g us east rds amazonaws com ec2 in endpoint false ec2 port 3306 ec2 allocated storage 20 ec2 auto minor version upgrade true ec2 availability zone us east 1d ec2 backup retention period ec2 character set name ec2 create time 2015 06 29t23 34 15 674z ec2 engine mysql ec2 engine version 22 ec2 id usersdb shard1 devshared ec2 instance class db m1 small ec2 iops ec2 latest restorable time 2015 07 01t01 00 01z ec2 license model general public license ec2 master username idle ec2 multi az false ec2 preferred backup window 03 00 03 30 ec2 preferred maintenance window wed 04 00 wed 04 30 ec2 status available ec2 status infos expect to have more `ec2 tag keys for it seems like boto rds2 supports `list tags for resource call to do this >>>bug_report cloud
add check and diff mode support to assemble in current devel assemble just skips when in check mode it should be able to test if there is difference and changed true false the same with diff it should work as template modules does >>>feature_idea
add shelvefile lookup plugin add lookup plugin to read string values of keys from shelve https docs python org library shelve html module shelve file usage example >>>feature_pull_request
copy and include module don search in roles path for referenced files issue type bug report ansible version ansible configuration https github com tahajahangir ansible bug copy roles path blob master ansible cfg environment ubuntu 14 04 summary from https docs ansible com playbooks roles html roles any copy tasks can reference files in roles files without having to path them relatively or absolutely in ansible and later you can configure roles path to search for roles but actually `roles path` is not searched in copy include and probably other modules steps to reproduce this is complete playbook demonstrating this bug https github com tahajahangir ansible bug copy roles path expected results two files should be copied to tmp test1` and tmp test2` one from current roles directory and one from role in `roles path` actual results copying from current roles directory succeed but copying from roles path fails >>>bug_report p2
sshpass fails to handle custom freebsd ssh prompt causing hangs issue type bug report ansible version ansible configuration defaults hostfile inventory roles path roles environment controller parabola gnu linux x64 target freebsd 10 x64 summary long standing bug in sshpass http sourceforge net sshpass bugs 12 dependency causes ansible commands using ssh username password authentication to fail running the same command via ssh key authentication works fine steps to reproduce setup new freebsd 10x target attempt to run the following command against the new target expected results command completes and returns raw module output in this case uname actual results command hangs indefinitely >>>bug_report p2
ansible connection not working on local actions and connection to vms via localhost issue type bug report ansible version ansible ansible configuration standard environment running virtualenv on arch managing ubuntu based systems summary when using the following inventory ve got the following error when trying to run the playbook fatal no hosts matched or all hosts have already failed aborting running arch linux and ansible is within virtualenv so without this line ve got the following error when something goes wrong when use hostname configured in my hosts file toto local 127 and modify my inventory accordingly everything goes smoothly there must be something messing up with localhost and 127 when connecting via ssh trying to configure interpreter for local actions regards steps to reproduce use the following inventory expected results any playbook running smoothly actual results fatal all hosts have already failed aborting >>>bug_report
ec2 region not work when use roles structure site yml test yml when run site yml get an error when run test yml all works fine workaround is using region lookup env ec2 region this works in both scenarios but some annoying >>>bug_report needs_info
unarchive fails to pick up http source unarchive src http download jboss org wildfly final wildfly final zip dest tmp copy no this fails with msg source http download jboss org wildfly final wildfly final zip does not exist although you can verify with your browser that the link works >>>bug_report needs_info
ability to specify any combination of ec2 instance states to return this addition to the ec2 py inventory script allows for specifying any valid combination of ec2 instance states to return rather than just all or running this introduces new optional configuration option in ec2 ini called `instance states` the default state is still running and if `all instances` is true `instance states` will be ignored making this backward compatible as an example we have run into scenarios where we like to retrieve inventory information about hosts in either running stopped or shutting down states but not pending or terminated >>>cloud feature_pull_request
misspell in mail py callback looks like little misspell >>>bugfix_pull_request
ansible galaxy won install geerlingguy ansible role from galaxy issue type bug report ansible version ansible configuration defaults environment mac os 10 10 summary ansible galaxy will not download my `geerlingguy ansible` role from requirements file but instead returns the error requirements file in question this was reported to me by erimar77 taken from this example playbook https github com geerlingguy ansible for devops tree master jenkins the role exists in galaxy here https galaxy ansible com list roles 1007 though the title is missing and is on github here https github com geerlingguy ansible role ansible steps to reproduce attempt to install `geerlingguy ansible` role from ansible galaxy via requirements file expected results `geerlingguy ansible` role is downloaded and installed correctly actual results ansible galaxy returns an error saying that the role cannot be found >>>bug_report p2
update tests for win get url module to test force parameter tests for changes from https github com ansible ansible modules core pull 1485 and https github com ansible ansible modules core pull 1712 also adds tests for handling of invalid urls paths >>>feature_pull_request windows
extra vars ansible ssh user user and delegate to do not work together https github com eparis anisble ssh user bug for reproducer it seems as though user works >>>bug_report p2
no log ignored for file module have playbook still see syslog messages on the remote server about ansible file invoked with directory mode when running this playbook role1 etc have `file` tasks in them am using 1>>>needs_info
minor spelling changes>>>docs_pull_request
suggestion ansible retry and timeout at hosts level the structure of my playbook is the failures are always most of the time operational and they require just restart of the playbook it would be very convenient to have two keys yml hosts zookeeper retries timeout 600 roles zookeeper>>>feature_idea
ansible galaxy doens override requirements yml path issue type bug report ansible version ansible configuration nothing of note http pastebin com 1uz0nueq environment summary p` command line option does not override ansible galaxy role installation from file with `path` variable specified steps to reproduce `requirements yml` `ansible galaxy install requirements yml tmp force` expected results for `role required vars role to be installed in tmp required vars` actual results `role required vars is installed in who cares required vars` >>>bug_report needs_info
add solaris platform to ansible galaxy bin ansible galaxy below are all platforms currently available just uncomment the ones that apply to your role if you don see your platform on this list let us know and we ll get it added so here am don see solaris in this list which should include versions 10 and 11 this is probably enough detail although solaris does have sub releases solaris 10 calls them updates eg 10u3 11 calls them srus written eg 11 can think of scenario where need to differentiate on sub release version and collecting minor versions obviously increases maintenance overhead see red hat versions only extend as far as the major version number too so there is precedent >>>feature_idea needs_to_be_moved
vault overrides file permissions and ownership have several files with 400 permission after encrypting decrypting them they change to 644 that not desired expected it seems the same happens for the file owner if have multiple files belonging to several users they all become owned by the current user >>>bug_report
variables values containing tildes or accents cause failure hi given directory with the following tree like content for playbook dummy playbook main yml mypeople yml and given directory with the following tree like content for role roles dummy role tasks main yml people provisioning yml templates templaterole j2 and here the content for each of those files dummy playbook main yml ansible dummy playbook hosts my dummy host vars files mypeople yml roles dummy role dummy playbook mypeople yml people internalcode abc123 fullname juan prez pea roles dummy role tasks main yml dummy role main tasks include people provisioning yml when people roles dummy role tasks people provisioning yml dummy role provisioning tasks name generate people file template src templaterole j2 dest tmp people txt with items people roles dummy role templates templaterole j2 ansible managed item internalcode item fullname when run the playbook with the following command ansible playbook vvv playbooks dummy playbook main yml get this error task dummy role generate people file fatal my dummy host failed to template if fullname juan else false endif template error while templating string expected token got string fatal all hosts have already failed aborting play recap to retry use limit home osg main retry my dummy host ok changed unreachable failed did the following changed the double quotes around the value juan prez pea to single quotes or to no quotes at all but it failed too changed the value juan prez pea to something like juan perez and it worked fine rewrote the playbook to simpler version with no roles and no when conditions and it worked fine reviewed the codification of the file dummy playbook mypeople yml and there no difference in the failed output between utf and iso 8859 15 removed the condition when people in the file roles dummy role tasks main yml and it worked fine then it seems to me there some kind of bug in the implementation of the when condition could someone please review this case thanks in advance >>>bug_report
change the output of ansible list hosts to be separated by spaces change the output of ansible list hosts to be separated by spaces instead of newlines this way it can be readily used in clusterssh config` external cluster command path to ansible bin ansible list hosts>>>feature_pull_request
assert password or ssh key provided on new image creation grab azure credentials from env by default in example credential template remove environmental variables that define azure credentials when performing undefined credentials test add test for no password or ssh key early fail >>>cloud feature_pull_request
advise updating controlpath settings when ssh throws unix domain socket too long error when trying to use the ec2 plugin ssh fails with this error `ssh error unix listener users luke ansible cp ansible ssh ec2 255 255 255 255 compute amazonaws com 22 ubuntu cervovre5u0urcgm too long for unix domain socket` here the full example ve changed some of the sensitive info in here like the ip etc >>>feature_idea
stdout lines is returning uoutput instead of only output hi all don know if it is bug but don know how to solve it also have asked about it on the ansible group https groups google com forum topic ansible project x2mcn2qc4gu have the two following actions this is an output example from the the first action the problem is that the second action is not working due to the command expects to received just one argument per time mean need to execute and right now it is not working because it is executing onevm delete 674 675 which it does not work because the command does not admit to pass more than one argument followed ansible documentation https www google com url https 3a 2f 2fdocs ansible com 2fplaybooks loops html 23iterating over the results of program execution sa sntz usg afqjcnhsnuqa9qhfurh5ugry868zicz8va so tried but got the following issue then have tried the following things but got the following issue in all the previous cases so it seems it is splitting the lines according to stdout lines 685 686 and stdout 685 n686 stdout lines 685 686 the problem is that it is taking the characteres as and don know how to remove that any idea is welcome and my apoligize if this is not bug thanks in advance esteban >>>bug_report
cb and contrib bunch of changes to callbacks moved inventory scripts to contrib dir and made setup py know about em >>>bugfix_pull_request feature_pull_request
ansible doesn like empty top level vars declarations more silly bugs but this is fine in v1 but causes an error in v2 >>>bug_report p2
document `jsonfile` fact cache>>>docs_pull_request
with dict default filter behavior is slightly different in v2 this works in v1 while in v2 it produces the following error guarding it with when conditional doesn help either although think `when` has always evaluated after `with this has to do with the filter somehow because this works just fine >>>bug_report p2
unable to mount multiple swap files issue type bug report ansible version ansible configuration environment running ansible from osx 10 10 os being managed is amazon linux 2015 03 summary when using the mount module to create mount two separate swap files only the latter swap file gets written to etc fstab steps to reproduce run task file with the following note that root swapfile1 and root swapfile2 should already be configured to be used as swap with dd and mkswap expected results the following lines in etc fstab actual results >>>bug_report
added powerpc support to facts added support to get the vendor and model information for powerpc processor architecture >>>feature_pull_request
added tests for `taggable` module>>>feature_pull_request
yum module in ansible fails when package already installed issue type bug report ansible version ansible version ansible configured module search path none ansible configuration ansible host key checking no ansible inventory users anandb repos ripe ansible hosts ansible gathering smart ansible remote temp tmp ansible ssh control path users anandb ssh mux ansible hash behaviour merge ansible timeout 75 ansible retry files enabled no ansible ssh pipelining yes environment managing centos from osx 10 10 summary an ansible task to install packages using yum that works under ansible fails under steps to reproduce on newly installed centos system which already has exim installed by kickstart run the following task yum name item with items epel release exim python virtualenv nb exim and python virtualenv are only available in the epel repository that why my task first installed the epel release package which makes available the epel yum repo files the next installation steps will be able to find exim and python virtualenv in the epel repo and install update skip them as needed expected results ansible should first install epel release then skip installing exim which is already installed and finally install python virtualenv actual results failed ns1 nl ams as112 ripe net item epel release exim python virtualenv changed false failed true item epel release exim python virtualenv rc results exim 72 el6 x86 64 providing exim is already installed msg no package matching python virtualenv found available installed or updated>>>bug_report needs_to_be_moved
ansible cannot find hosts defined in ssh config after recent update when try to run my playbook immediately get the `skipping no hosts matched` response can reproduce it with following command the output of it is `no hosts matched` `myhost` is defined in my local ssh config ssh` has the same effect when downgrade to `1 2` it works fine ansible locates `myhost` etc ansible ansible cfg` has defaults in ssh connection section my system is ubuntu 15 04 ssh version is `openssh 7p1 ubuntu 5ubuntu1 openssl 1f jan 2014` current ansible version is `1 2` >>>bug_report needs_info
git module fails to interpret bool parameter assumes unicode v1 opening this as more general case of 11506 and after doing more extensive troubleshooting have been testing with ansible on ubuntu 14 04 ll try to explain how to reproduce this first the ansible jinja yaml code varprefix git update true varprefix deploy repo dir repo extract to rrrrr git url varprefix git repo update varprefix git update default false bool debug msg varprefix deploy repo extract name deploy via git git repo item git url dest tmp path to repo clone yes update true update item git update update item git update default true update item git update default true bool with items varprefix deploy repo extract note the lines marked with for later 1st execution with hardwired value for update line breaks added for readability task moduleprefix somemodule debug ok local vm msg git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr task moduleprefix somemodule somemodule git clone remote module git version master depth repo ssh bitbucket org uuuuu ggggggggggggggggggggg git accept hostkey true dest var www site rrrrr website repo rrrrr recursive false force false failed local vm item to rrrrr git url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master update true failed true item git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr msg local modifications exist in repository force no fatal all hosts have already failed aborting nevermind the error at the end it means git is working as intended in this case updating repo with changes the force paramenter the interesting stuff is that the variable appears correct in the debug and also on the 2nd part of the debug message but appears as version master update true when reported in item but in this case all would be ok now 2nd time with update item git update task moduleprefix somemodule debug ok local vm msg git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr remote module git version master depth repo ssh bitbucket org uuuuu ggggggggggggggggggggg git update accept hostkey true dest var www site rrrrr website repo rrrrr recursive false force false failed local vm item to rrrrr git url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master update true failed true item git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr msg boolean not in either boolean list fatal all hosts have already failed aborting at this point it seems that expansion of the boolean value causes some kind of problem 3rd attempt with update item git update default true bool task moduleprefix somemodule debug ok local vm msg git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr task moduleprefix somemodule somemodule git clone remote module git version master depth repo ssh bitbucket org uuuuu ggggggggggggggggggggg git update false accept hostkey true dest var www site rrrrr website repo rrrrr recursive false force false ok local vm item to rrrrr git url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master update true after 1d9b80fd6a5aa4b61d150b10f3923668e61709e1 before 1d9b80fd6a5aa4b61d150b10f3923668e61709e1 changed false item git update true url ssh git bitbucket org uuuuu ggggggggggggggggggggg git version master to rrrrr here it incorrectly finishes since it skips updating the repository even though update is set to true this behaviour also happens in other modules the fact that it fails silently is insidious because it doesn give you any clue on what is happening any help is appreciated thanks>>>bug_report
add complex args to logging callback data following on from 11512 callback plugins don get given any complex module arguments on task completion this fixes that >>>easyfix
handle include tasks in handlers `include` tasks in handlers must be handled they were allowed in >>>bugfix_pull_request p2
new human readable filter to transform bits and bytes into cake not really it just allows for nice readable sizes>>>feature_pull_request
test add base path role test hit an issue in v1 and tested it in v2 which works as expected however didn find test for it so added one v1 output make test role files path ansible playbook test role files path yml inventory play localhost task test role files path copy file from task in subdir fatal localhost input file not found at home resmo projects ansible test integration roles test role files path tasks files test role files path file or home resmo projects ansible test integration test role files path file fatal all hosts have already failed aborting play recap to retry use limit home resmo test role files path retry localhost ok changed unreachable failed beside that wanted to add `ignore errors yes` on the copy task to just ignore errors if src file was not found and fail in the assert task didn find way to skip the error in the copy task if src file was not found seems like another issue >>>feature_pull_request
inventory parser should show line numbers when error is encountered it would be helpful if the inventor ini parser would include the line number when reporting errors in parsing the inventory file currently it just shows the variable name and filename >>>feature_idea
don wrap text for ansibleparsererror this allows not messing up the wonderful error reporting that is carefully created instead of ansible playbook foo yml error error foo is not valid attribute for task the error appears to have been in users marca dev git repos ansible foo yml line column but may be elsewhere in the file depending on the exact syntax problem the offending line appears to be tasks name do something here we get ansible playbook foo yml error foo is not valid attribute for task the error appears to have been in users marca dev git repos ansible foo yml line column but may be elsewhere in the file depending on the exact syntax problem the offending line appears to be tasks name do something here which is much nicer >>>feature_pull_request
roles being ignored when executed against different hosts in different plays have playbook with two plays in it each addresses different host group ve omitted the `vars` section which contain different values for each play expect the `nginx` and `php fpm` roles to be executed against the `host2` group but right now they re being ignored the `magento` role is run on the second host though which leads me to think that it does so because there different val passed in for `is admin` how do get the second set of roles to run >>>bug_report p1
update intro inventory rst minor fix for consistency and more engaging language >>>docs_pull_request
syslog json call plugin improvements fix nameerror global name handler is not defined update log message format >>>feature_pull_request
update index rst fix typo>>>docs_pull_request
ansible architecture is missing for windows targets issue type bug report ansible version ansible configuration clean check out from git environment ansible control machine fedora 19 ansible target windows 2008 r2 sp1 summary can see ansible architecture in windows facts any other way to determine os architecture steps to reproduce ansible windows target setup expected results ansible architecture should exists actual results ansible architecture is missing >>>bug_report windows
with items seems to introduce unicode strings in objects defined inplace am having several cases of unicode strings appearing in the output as somestring being passed to mysql db command and causing problems it seem that this occurs whenever with items or with indexed items or others iterates over list of variables defined in place the output is as follows after searching found this fix in jinja2 that might help here https github com ntrrgc jinja2 commit b815d68462392a51c2280a25ff3b484885f9c9f2 diff split am running ansible on ubuntu 14 04 any ideas or workarounds >>>bug_report needs_info
vmware inventory script has incorrect cache age checking issue type bug report ansible version ansible configuration not relevent environment ubuntu summary plugins inventory vmware py line 118 if cache stat st mtime cache max age time time comparision should be or steps to reproduce not sure expected results cache gets used properly actual results cache is never used>>>bug_report
populate hostvars with the host vars variables of every node hey there more like feature request than an issue here it could be nice to have the variables located in the host vars directory copied in the `hostvars` variable as well so that single node could access other nodes specific variables for instance when deploying service cluster with playbook you might need the cluster frontend to be able to generate its config files with other node specific information that is not retrieved by the ansible setup cluster technology specific information but located in the host vars acutally writing playbook to deploy postgresql cluster with pgpool as the frontend in that fashion in hostvars there is already an host based layout for each node involved in the playbook call we can access the facts retrieved during setup like to be able to access group vars and host vars in the same way but can only access those of the currently running node know could just write all the information in the group vars in very static way but didn find it scalable nor elegant maybe there is something to do that already but didn find it thanks lot for your help >>>feature_idea
add no syslog option in order to prevent ansible syslog its actions on the remote host add no syslog option in order to prevent ansible syslog its actions on the remote host syslog on remote hosts can be turned off by no syslog option inside ansible cfg no syslog command line options ansible and ansible playbook >>>feature_pull_request
integration tests for notify with variable list make test notify test integration it checks notifications with scalar and dict variables it tests the notification resolution use the correct priority on resolution of the variables >>>feature_pull_request
ansible sudo pass doesn work any more issue type bug report ansible version ansible version ansible devel 2c9d1257ba last updated 2015 07 06 16 34 30 gmt 550 lib ansible modules core detached head ff69ce7912 last updated 2015 07 03 09 43 55 gmt 550 lib ansible modules extras detached head 4e48ef9eca last updated 2015 07 03 09 43 55 gmt 550 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 09 18 30 45 gmt 550 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 09 18 32 50 gmt 550 ansible configuration empty configuration file environment debian wheezy summary ansible sudo pass doesn work any more if set it in the inventory either directly in the hosts file or in host vars hostname yml or group vars all yml it is as if haven specified it at all if change it to ansible become pass instead it works as expected note that the magic variable mapping in lib ansible executor connection py mentions only ansible sudo password and ansible su password although the documentation mentions only ansible sudo pass and ansible su pass in contrast both ansible become password and ansible become pass are mentioned here but adding ansible sudo pass as an alias does not fix the problem or this would be pull request nor does setting ansible sudo password in the inventory steps to reproduce hosts raven ansible ssh host ansible sudo pass xxx playbook yml hosts raven tasks name count lines in etc passwd command wc etc shadow sudo true invocation ansible playbook hosts playbook yml expected results the sudo task succeeds changed raven changed true end 2015 07 06 13 15 18 470655 stdout 52 etc shadow cmd wc etc shadow start 2015 07 06 13 15 18 468512 delta 00 00 002143 stderr rc invocation module name command module args raw params wc etc shadow stdout lines 52 etc shadow warnings the above was obtained with ansible become pass set instead actual results the sudo task does not succeed fatal raven failed msg error missing sudo password failed true >>>bug_report p1
add changelog entry for version right now the changelog https github com ansible ansible blob 2c9d1257ba59e01c093a901cf53a7323c56f4f85 changelog md contains info for version and future version but not for the most recent version >>>docs_report
add support for yum options related to security yum these days comes with the ability to perform the following security related actions as person who administers fleets of servers often want to perform fixes that are security driven and the above operations come in handy ansible however has no support for these as of now here page explaining these features https access redhat com solutions 10021>>>feature_idea
typos>>>docs_pull_request
docsite rst intro configuration rst reword title make configuration the first word so that it is in line with other documents and that system administrators devops people don lose the tab when having many browser tabs open discussed wording with bcoca on irc >>>docs_pull_request
add facts for datetime 8601 basic and basic short this pr adds facts for the date time in the official basic format of iso8601 and short version without fractions of second basic notation yyyymmddthhmmssffffff example 20150705t160037761485 basic short notation yyyymmddthhmmss example 20150705t160037 this is useful for datetime stamping file aws ami name etc without all of the separators and without having to chain number of calls ansible date time year ansible date time month ansible date time day ansible date time hour ansible date time minute ansible date time second intentionally not using utc with offset for brevity and as it can be appended by adding the existing tz tz offset facts >>>feature_pull_request
support systemd reenable have this task this works ok the first time but if edit the service file particularly the install section ansible says ok but it actually does not enable the current new service it ignores it and keeps the old one this leads to confusion and inconsistency right now run systemctl reenable timeagent manually to actually enable the service after editing it it would be great if ansible service module supported this if not used it by default >>>feature_idea needs_to_be_moved
changes introduced by 9404 not documented issue type documentation report ansible version ansible configuration environment summary pull request 9404 by mmoya merged on 31 jan 2015 introduces `retry files enabled` and `retry files save path` configuration settings but these are not described in the current documentation for such settings http docs ansible com intro configuration html general defaults steps to reproduce google `ansible retry files enabled https google com ansible 22retry files enabled 22 expected results official ansible documentation describing the `retry files enabled` and `retry files save path` configuration settings and how to use them actual results single official ansible example configuration file https github com ansible ansible blob devel examples ansible cfg with this description for the two settings >>>docs_report easyfix p2
if task is delegated ansible facts will be applied to delegated host once delegate to actually gets templated this will work for every case right now it only works for hard coded delegate to should fix 10608>>>feature_pull_request
be more specific describing groups of groups fixes 11397>>>docs_pull_request needs_revision
make test galaxy fails lot of code that was at the heart of ansible galaxy has been ripped out and not replaced this means that make test galaxy trivially fails we need something to replace ansible utils role yaml parse and ansible utils role spec parse and make test galaxy should pass its tests those tests exist for reason >>>bug_report p2
make ansible galaxy work with galaxy ansible com issue type bugfix pull request ansible version ansible configuration nothing relevant environment summary update v2 ansible galaxy to work with galaxy ansible com steps to reproduce run ansible galaxy install galaxy role fails expected results should work with rolesfile containing roles using galaxy ansible com actual results >>>bugfix_pull_request p2
fix typo in developing modules rst fix typo in developing modules rst>>>docs_pull_request
implement jinja2 header overrides complete 4098e8283e8cf7c13ced8c04796d838caf304c81 the code comes from v1 https github com ansible ansible blob de98dc2968f312b5c565631a56f4bf153ccd9bec v1 ansible utils template py l252 >>>bugfix_pull_request
facts add aliases to ansible all ipv4 addresses on openbsd edited only lib ansible module utils facts py v1 ansible module utils facts py still unchanged is it ok related issue https github com ansible ansible modules core issues 1627 1627 >>>bugfix_pull_request
custom filter failing no filter named when used with with items issue type bug report ansible version devel 139138c604 ansible devel 139138c604 last updated 2015 07 03 12 38 26 gmt 200 lib ansible modules core detached head ff69ce7912 last updated 2015 07 03 12 38 49 gmt 200 lib ansible modules extras detached head 4e48ef9eca last updated 2015 07 03 12 38 49 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 11 22 17 01 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 11 22 17 04 gmt 200 configured module search path opt ansible library ansible configuration not sure it has any relevance but just to be sure installed via git to opt ansible didn change anything in the config can find ansible cfg the above path though the issue guide lines asks me to compare that with the most recent version on git environment local ubuntu 15 04 the issues reproduces on local connection and on ubuntu 14 04 vagrant vm box summary custom filter which seems to work just fine in other contexts fails with the error message error template error while templating string no filter named name of the filter when used in with items loop steps to reproduce put the files below in the same folder and run ansible playbook testplay yml 127 inlucde the trailing comma for convenience have created gist with the files https gist github com andersbc 1b89dc80a7b33dcdab48 testplay yml core py ansible cfg expected results task test msg foo bar first verbose always true item foo bar first msg foo bar second verbose always true item foo bar second ok 127 actual results task test fatal 127 failed msg error template error while templating string no filter named byattr failed true note the extra postfixed to byattr in the error message correction read the message wrong there is no extra >>>bug_report
where have the special template variables gone running ansible develop version straight from github and since couple of weeks have problem cannot explain think it since the switch to v2 as the default tree but not completely sure of that have lot of templates almost all of them that start of with but since the problem started get errors about the `template path` variable not being found looking further it seems that none of the six special template variables can be found `ansible managed` etc when look into the code see the comments in lib ansible modules core files template py` but there is no code has this code been moved or accidentally removed >>>bug_report p2
add groups to serf inventory plugin>>>feature_pull_request
add landscape inventory plugin dynamic inventory script which lets you use nodes discovered by canonical landscape http www ubuntu com management landscape features requires `landscape api` python module see https landscape canonical com static doc api api client package html https landscape canonical com static doc api python api html environment variables `landscape api uri` `landscape api key` `landscape api secret` `landscape api ssl ca file` optional cc sudarkoff aconrad>>>feature_pull_request
use cfacter instead of facter if possible cfacter is the facter replacement written in it is available from the puppetlabs repo >>>feature_pull_request
v1 firewalld with state enabled errors when port is already enabled ansible task output >>>bug_report
commandline option ask become pass hi from ansible there is new privilege escalation method and thus new command line options to use ansible with sudo and password it should be used like ansible playbook become ask become pass here think ask become pass implicitly means that user wants to use become and thus ansible playbook ask become pass should work same as ansible playbook become ask become pass >>>feature_idea
copy module in v2 does not honour dest argument using ansible changeset 08ad05c83bcd7b3dfc63a732f24e87bc41fb2f7d with the copy module for directory have observed that the dest argument is not honoured but the files are copied to the root of the remote filesystem steps which used to verify the problem ansible droplets frontend copy src demowebapp frontend public html dest srv www metrika ls demowebapp frontend public html css index html js ansible droplets frontend copy src demowebapp frontend public html dest srv www metrika ssh root frontend01 ls srv www metrika registry json ssh root frontend01 ls bin boot css dev etc home index html js lib lib64 lost found media mnt opt proc root run sbin srv sys tmp usr var the js css and index html entries can be seen in their unexpected locations >>>bug_report p2
fix pyflakes error use msg variable error was local variable msg is assigned to but never used avoid to display play play when name of the playbook is undefined >>>bugfix_pull_request needs_info
fix pause module when ansible output is piped fixes traceback when pause module is used and ansible output is piped into another process no sys stdout encoding is set >>>bug_report p2
file module error when use file module in playbook in the doc page http docs ansible com file module html the file module options said path to the file being managed aliases dest name to me it shows the path and the dest is the same but in my playbook when need file module to create one soft link via path ansible will show one error like refuse by directory or link if use dest everything is ok could you fix this >>>bug_report
stat command etc module error when using name in tasks using devel version of ansible steps to reproduce create task as expected result information on directory whether or not the directory actually exists populated to the variable jc installed actual result playbook refuses to run with the following message >>>bug_report
ansible accelerate mode can not working issue type bug report ansible version `ansible 1` environment `centos 6` and all machines has installed `python keyczar` package summary ansible accelerate mode can not working in playbook steps to reproduce site yaml hosts all accelerate true tasks name test shell hostname expected results root vm10 160 112 18 ansible playbook site yaml 172 17 10 vvvv play all gathering facts thursday 02 july 2015 15 31 18 0800 00 00 015 00 00 015 attempting connection to 172 17 10 via the accelerated port 5099 172 17 10 sending request for validate user 172 17 10 waiting for validate user response 172 17 10 in recv data waiting for the header 172 17 10 got the header unpacking 172 17 10 data received so far expecting 121 172 17 10 received 121 bytes 172 17 10 received all of the data returning 172 17 10 received the validate user response msg unhandled error in the handle function failed true rc remote module setup exec command mkdir home ansible tmp ansible tmp 1435822278 43 61461131657903 echo home ansible tmp ansible tmp 1435822278 43 61461131657903 172 17 10 in recv data waiting for the header 172 17 10 received nothing bailing out fatal 172 17 10 failed to get response from 172 17 10 task test thursday 02 july 2015 15 31 18 0800 00 00 032 00 00 048 fatal no hosts matched or all hosts have already failed aborting play recap thursday 02 july 2015 15 31 18 0800 00 00 004 00 00 053 test 01s to retry use limit root site yaml retry 172 17 10 ok changed unreachable failed >>>bug_report
winrm with v2 connection variables are not picked up correctly several users are having issues with ansible not picking up all connection variables when these are placed in separate blocks such as using windows vars https github com ansible ansible issues 11278 issuecomment 117780566 https github com ansible ansible modules extras pull 398 issuecomment 117756012 this leads to ansible attempting to perform winrm connection on port 22 for example if anyone is able to shed more light on when it fails please be my guest >>>bug_report p2 windows
fix attributeerror actionmodule object has no attribute shell shell was removed with commit 2a5fbd85700b719df9c2af22f0ccc61633ee4ac6>>>bugfix_pull_request p1
fixes 11448 yum with with items fixes issue where the with items fails when used wiht yum apt etc >>>bugfix_pull_request
git module fails with slash in the branch name hello have stumbled across the bug in git module it fails when branch name contains ansible version please take look thanks >>>bug_report
file mkdir nonatomic checks we caught this due to broken playbook nonetheless it bears fixing the behaviour was caught due to delegate to localhost file dest tmp foo state directory this ran once per host in the target group basically ansible raced itself it checked that the directory was not present multiple times then attempted to create it some of those creations failed with an oserror 17 eexist the file module should probably simply attempt mkdir which ll happen atomically and then catch and deal with the resulting errors determining for instance that directory already existed there appreciate that this is corner case you might want to wontfix this there no atomic test and set on posix filesystem >>>bug_report
with pipe doesn grok line breaks hosts localhost vars dir tmp bar tasks file dest dir state absent file dest dir item state directory with items debug var item with pipe find dir maxdepth mindepth type d>>>bug_report p2
patch module is not python compatible issue type bug report ansible version environment centos python summary patch module is incompatible with python it uses ternary operator which was introduced in python only steps to reproduce just use patch module when remote host is running python expected results patch module works successfully actual results >>>bug_report
fix type error >>>bugfix_pull_request easyfix p2
bug report ansible cfg remote port has no effect in issue type bug report ansible version ansible devel 47be5b4166 last updated 2015 06 02 11 58 32 gmt 400 lib ansible modules core detached head 600fc15b42 last updated 2015 02 05 14 09 13 gmt 400 lib ansible modules extras detached head 77485f6c6a last updated 2015 02 05 14 09 19 gmt 400 v1 ansible modules core not found use git submodule update init v1 ansible modules core v1 ansible modules extras not found use git submodule update init v1 ansible modules extras configured module search path none ansible configuration no change environment centos release final summary in stable `remote port` in `ansible cfg` specifies an alternate ssh port when switch to the `devel` branch changing nothing else about my configuration `remote port` has no effect here is my `ansible cfg` defaults remote port 2200 log path tmp ansible log ask sudo pass true steps to reproduce see summary expected results see summary actual results see summary >>>bug_report
make test module work in v2 wasn working because some utility functions have moved around `jsonify` moved from `ansible utils` to `ansible parsing utils jsonify` don see `ansible utils parse json` anymore so used `json loads` >>>bugfix_pull_request needs_revision
yum with items is not working this code works fine in tasks name install tools yum name item state latest with items curl devel expat devel however in the head version get an error like this task install tools an exception occurred during task execution the full traceback is traceback most recent call last file users jgrigonis github ansible lib ansible executor process worker py line 118 in run executor result taskexecutor host task job vars new connection info self new stdin self loader shared loader obj run file users jgrigonis github ansible lib ansible executor task executor py line 83 in run item results self run loop items file users jgrigonis github ansible lib ansible executor task executor py line 151 in run loop items self squash items items task vars file users jgrigonis github ansible lib ansible executor task executor py line 189 in squash items if templar contains vars name file users jgrigonis github ansible lib ansible template init py line 204 in contains vars return self environment block start string in data or self environment variable start string in data typeerror argument of type nonetype is not iterable fatal computer failed failed true stdout >>>bug_report p2
openstack inventory updates from tower includes changes from https github com ansible ansible pull 10491 and https github com ansible ansible pull 10776 and allows specifying config file via environment variable >>>easyfix feature_pull_request p2
updates to windows azure inventory from tower includes earlier changes from https github com ansible ansible pull 8403 along with configurable cache path support for host hostname` command line syntax include meta hostvars key in list` response set `ansible ssh host` and `ansible ssh port` in host variables set host variable for instance status and private id return all instances in deployment to fix issue described in https github com ansible ansible issues 9615 >>>cloud windows
fix tiny typo>>>docs_pull_request
let fileglob glob more than files we could do with dirglob plugin that gives us list of directories for use in with dirglob with dirglob my dir alternatively or additionally it be nice to expose isdir and isfile and perhaps other os path tests as j2 filters and provide non limited lookupmodule which let us write with glob my dir when item isdir >>>feature_idea
assertraises should be given an exception type fixes 11441 this pr addresses an issue where `assertraises` was not given an exception type to look for this gets unit tests passing again >>>bugfix_pull_request
error invalid selinux context with ramfs in etcd and copy module issue type bug report ansible version ansible configuration clean install environment centos using the `centos 7` vagrant image summary unable to use copy module to copy to ramfs mounted directory inside etc steps to reproduce expected results copied file actual results >>>bug_report
python unit test failure the test appears to be passing in python but failing in the offending line is https github com ansible ansible blob devel test units parsing yaml test loader py l126 >>>bug_report
check for name or pkg when templating squashed items since the logic for module argument aliases is handled in `ansiblemodule` the args that we have to inspect inside the executor are unaliased we need to check for `name` or `pkg` when attempting to template to avoid an exception as documented in 11430 >>>bugfix_pull_request p1
fix yaml formatting issue for rax integration tests the `yaml csafeloader` is more strict on parsing and as such causes some poorly formatted yaml in the rax integration tests to parse unexpectedly this pr fixes the parsing issues by wrapping the full line in quotes to prevent the yaml parser from thinking that in the line separates key value pair >>>bugfix_pull_request cloud
feature run once per ansible machine id there have been mutliple suggestions for running task once per group however think the following would give nice benefit over existing idea love to see syntax such as `run once per variable examples `run once per ansible ssh host` `run once per database name` this would give admins the option to limit certain tasks such as db upgrades don find the hack of `when inventory hostname webservers sufficient because some sites may only run at `webservers for example some sites may share the same database others use different one multiple beta production sites in single playbook internally ansible could keep set of have seen variable before and skip the task if that the case if have more time be happy to contribute this feature but for now figured it would be better to at least report it and see if there is feedback on this idea >>>feature_idea
using set fact with ansible ssh host no longer works in devel created very simple playbook http paste openstack org show 326119 to highlight the issues am seeing the most relevant part is in my playbook create ensure an openstack instance exists and change the ip address in the inventory so that can actually talk to it then try to run few commands this works in but not in devel it looks like in the branch the code is explicitly looking for ansible ssh host https github com ansible ansible blob stable lib ansible runner init py l877 but can find the equivalent code in devel >>>bug_report needs_info p2
treat generators like lists and tuples fix for 11434 jinja2 filters use generators extensively so anyone doing something like is liable to get in trouble otherwise >>>bugfix_pull_request
ipwrap filter doesn work with generators example `string` being filter plugin http jinja pocoo org docs dev templates string that confusingly does what `unicode does in python it returns generator would expect the output to be the same but actually this is true in and in devel >>>bug_report
add splitext filter this filter exposed `os path splitext` have noticed many times in the ansible irc channel that someone wanted the root of file with the extension stripped often give them the following but that can be ugly and not self explanatory the `splitext` filter would make that look like >>>easyfix feature_pull_request
adhoc allow hosts not in inventory to be targeted sometimes want to do something quick against brand new host that haven yet added to the inventory this is essentially more flexible version of the comma trick `somehost` is not in the ansible inventory ansible somehost ping allow hosts not in inventory user host success invocation module name ping module args changed false ping pong note that this also makes the experience easier for new users and means that the getting started docs http docs ansible com intro getting started html your first commands don need to cover inventory right away which makes for more shallow learning curve replaces https github com ansible ansible pull 11426>>>feature_pull_request
backtrace with simple task not sure how useful this will be but this reliably backtraces for me with devel from today >>>bug_report p1
use list for tags but with the assistance of sets to remove duplicates fixes 11424 this pr addresses 11424 by reverting little of 0eb1c88 and using using `set` to remove duplicates casting back to list and using `set` as needed in the last mile to check for intersections overall this may not be the right course of action maybe it would be better to handle the unhashable errors by casting to list where needed and not from the start >>>bugfix_pull_request p1
display config file read when provided because sometimes get confused because don know which config file is being picked up >>>feature_pull_request
make the wait timeout for rax tests configurable default ve started trying to run the integration tests for the rax modules on regular basis while the default values for `wait timeout` in each module are sane values am seeing some timeouts in my integration tests on an infrequent basis this pr sets default of 600 seconds which can be overridden to allow for the tests to successfully complete >>>cloud feature_pull_request
0eb1c88 causes traceback when specifying tags via git bisect have found that recent traceback when specifying tags on the command line was introduced in 0eb1c88 to resolve 9380 that commit references use itertools instead of set for tags cc jimi >>>bug_report p1
playbook host group vars are not loaded inventory ones do work issue type bug report ansible version ansible configuration environment but running ubuntu 14 04 summary `host vars` and `group vars` are not loaded from the path adjacent to playbooks they are only loaded from where the inventory file is this breaks things like vagrant ansible since it creates dynamic inventory file usually in vagrant provisioners ansible inventory vagrant ansible inventory that is not next to my main ansible structure steps to reproduce play yml inventory test inventory host vars testhost invoke ansible as follows `ansible playbook inventory test inventory play yml` expected results actual results if move my inventory file to be in the same directory as `host vars` and `play yml` then ansible runs correctly >>>bug_report p2
with sequence skips if count ansible osx and ubuntu results in >>>bug_report
group module fails when trying to add update group which already exist in the attached ad hi the group module seems to not work right am using centos the expected result is that it wouldn fail since the group is properly present the group was added by yum install docker task sample >>>bug_report
refactor the argspec type checking and add path as type>>>feature_pull_request
vagrant synchronize don work 5240 is happening to me patched like this to make it work >>>bug_report
galaxy filtering roles from the remote source galaxy requires specific git project per role src git ssh gitserver company com 20000 my ansible roles git name dw marathon path roles if there are roles under the same project to create multiple repos its not always and option will be nice if the installation from the temporal file filter the project that has been download example src git ssh gitserver company com 20000 my ansible roles git name apache path roles remote path ansible roles apache regards >>>feature_idea
old style output in ansible tried to find any info about changes in output format in v2 but failed basically what want is to get the same output for both playbooks and simple commands as it was in v1 plaint stdout without json wrapper around it with such fields as changed end stdout cmd start delta rc invocation etc didn see any verbose flags turned on and in the same time no flags to make it more compact is it just changed added in v2 or miss something >>>bug_report easyfix
add ability to adhoc apply roles to hosts have often wanted the ability to adhoc apply role to hosts yes can write playbook to do this but feel like then would accumulate big list of playbooks that are of questionable usefulness and would clutter the repository this would also make it easier for people to demo and test and code review roles from galaxy as the user does not need to create playbook just to try out the role ve seen people ask for this before https groups google com forum topic ansible project sglupdrrs ansible vagrant role name docker sudo vvvv timeout 30 usr bin env ansible playbook hosts vagrant roles docker executing ansible playbook sudo vvvv timeout 30 var folders gw w0clrs515zx9x 55zgtpv4mm0000gp tmpw0f6zx yml plays in var folders gw w0clrs515zx9x 55zgtpv4mm0000gp tmpw0f6zx yml play applying role ad hoc seems to me to be quite similar to ad hoc applying module in that you want to do these for the same reasons ability to quickly try things out ability to do one off operations avoid accumulation of tons of trivial little playbooks make ansible easier to demo and easier to learn ansible currently allows ad hoc execution of modules but roles require playbook but see them as quite similar hence this pr cc georges sontek djeebus>>>feature_pull_request
remove unnecessary imports>>>bugfix_pull_request
fix small typo for wantlist>>>docs_pull_request
eoferror exception is not catched hi when doing d` without entering anything in the `sudo password` prompt an `eoferror` is thrown by `getpass` but not catched think it could be catched and pretty error message could be displayed instead traceback is >>>bug_report p2
v2 callback plugin issues there seem to be number of callback methods not called anywhere in the code specifically in v1 `playbook on start` was called in v2 neither `playbook on start` nor `v2 playbook on start` seem to be called from anywhere also noted `v2 playbook on setup` method which doesn appear to be called from anywhere also in v1 the `playbook` instance was made available to the callback currently do not see that the callback plugin has access to the playbook instance have several callback plugins which perform deeper inspection into the playbook run and use data from loaded variables host vars playbook play inventory provided tags provided limit connection information without deeper insight into the playbook run we lose lot of information that we previously had access to >>>bug_report p2
playbook relative callback plugins not loaded in testing playbook relative `callback plugins` it looks like `push basedir` is not called early enough `taskqueuemanager load callbacks` is called before `playbook load playbook data` this prevents playbook relative `callback plugins` directory from functioning properly >>>bug_report p2
grammar update to vault docs grammar nazi rearrangements >>>docs_pull_request
change stage to staging as it much more common term for pre production environment and there are already many references to staging appearing in the ansible code and docs so let be consistent>>>docs_pull_request
fix typo in module development comment by but>>>docs_pull_request
ansible mercurial clone hangs on deploy runs fine on subsequent runs have an anisble playbook that does the following launches an ec2 instance switches to that instance in second play within the playbook and configures the instance for our specific purpose one of the things that the second play does is clone some local hg repos to specific directory the problem having is that the hg clone hangs when run from the master playbook run however when run hg clone manually on the existing instance it works fine and when run only the clone step of the playbook using tags do hg clone to specify that task that too runs fine am using vvvv to debug the connection but there isn any output it just hangs at the point of the clone ve even logged on to the running instance and run strace on the hg clone process but it is just sitting there hung note that there are actually two repos being cloned thought it might be timeout issue but the first repo is very small and clones manually in less than seconds ve done the following made sure the ssh pubkey is in known hosts the task runs fine when run outside the main playbook so know it is not an ssh problem or problem with hg itself or general network connectivity problem from the ec2 instance to the repo server looking for any sort of suggestion for example is there way to improve logging on the running instance not sure if ansible is logging anything while it is running on the instance ansible debug task doesn really help as it just prints out the contents of variables unless missing something am using the following pieces ansible mercurial aws ec2 instance running centos don think these versions are relevant to the issue including them for completeness >>>bug_report needs_to_be_moved
feature request ability to only use one group in group vars even if host is in multiple groups if host is in multiple groups by design ansible behavior is that variables will come from all of the groups they are member of this is great most of the time but there are certain instances where it is desirable to turn this feature off for some provisioning cloud modules it actually detriment for example if want to run the route53 module to manage domain records very likely to run it on localhost as there is not specific server managing however if try to use group vars to define each separate route53 domain in its own group ansible will only use the first set of vars it finds since the host for each group localhost is the same if could somehow tell ansible hey only use the group that matches your hosts line it would be neat thing know can use include vars or vars files instead but it seems little less elegant when running at the playbook level also there isn good standard place to put vars that aren host or group vars at the playbook level referencing http docs ansible com playbooks best practices html besides creating vars directory at the playbook level seems excessive when group vars is such good fit otherwise anyway thanks for your time and consideration >>>feature_idea
remove install requires dependency on setuptools ansible does not `install require` setuptools setuptools is build setup time requirement one that if it wasn present would make the `setup py` not even importable putting setuptools in install requires means that because pip has only full upgrade mode where all dependencies are upgraded if someone tries to `pip install ansible` and is not on the latest setuptools pip will try to upgrade it which isn desirable unless it specifically intended not to mention that there are means of installing ansible that do not require setuptools to be installed at all >>>feature_pull_request needs_revision
regression between and prevents dynamic cascaded vars regression functionality regressed between version and which prevents var defined in the first `vars files` to be used in the lookup of last `vars files` in my example below the tier variable is defined in customers vars id yml` and is used to include additional variables in tier vars files should only run on web nodes in vpc like webstg01 name my web app vars prompt id please enter the customer id vars files customers vars id yml customers vars tier tier yml sudo yes hosts id id web roles role nginx role rails app role my web app work arounds prompt or pass the tier var in addition to id this is not ideal because the tier is sort of constant and shouldn be changed once its defined include additional vars dynamically using `pre tasks` and `include vars` in each play should only run on web nodes in vpc like webstg01 name my web app vars prompt id please enter the customer id sudo yes hosts id id web vars files customers vars id yml pre tasks include vars customers vars tier tier yml roles role nginx role rails app role my web app >>>bug_report
self aliases is nonetype object attributeerror no attribute get issue type bug report maybe ansible version ansible installed via pip via virtualenv ansible configuration nothing special environment mac os 10 10 steps to reproduce `ansible playbook hosts redacted yml extra vars emr cluster id redacted cluster name redacted vvvv ask vault pass` task expected results not an error expected the playbook to continue using the registered variable in subsequent tasks actual results summary findings thus far inspecting users micperez ansible tmp ansible tmp 1435328568 23 84034094653667 command shows that the `commandmodule` class overwrites its inherited method handle aliases` to just `pass` when its then used in the constructor of the parent class `ansiblemodule` the result `none` is assigned to `self aliases` thus when its used in log invocation` there is no attribute `get` >>>bug_report p2
keyword environment not working in v2 works in latest but not latest v2 error message is error the field has an invalid value and could not be converted to an dict >>>bug_report p2
feature request include playbooks from python packages currently its only possible to include playbooks from filenames for better reuse in different projects and wanting to avoid the trouble around propose extending the include mechanism to also resolve for python packages >>>feature_idea
cloudstack fixes and updates>>>bugfix_pull_request
documentation is unclear on how to create groups of groups issue type documentation report this documentation http docs ansible com intro inventory html groups of groups and group variables is what am referring to it is unclear that you need to add children to the parent group name in order for ansible to know you are dealing with group of groups it took me several experiments and almost giving it up as buggy for me to figure out what was needed could you state explicitly that group of groups needs the children suffix thanks >>>docs_report p2
feature request provide capability to combine tags using logic and or or conditions issue type feature idea ansible version ansible ansible configuration not relevant environment linux 77 generic 112 ubuntu smp x86 64 x86 64 x86 64 gnu linux darwin 14 darwin kernel version 14 release x86 64 x86 64 summary as an ansible user can use tags to selectively execute tasks if specify several tags in the same command then ansible will execute all tasks which have at least one tag from the list specified by command it performs logical disjunction on tags set however we ran across multiple scenarios when we need ability to perform logical conjunction on list of tags to determine list of tasks to execute for example we defined set of tags representing type operation install restart and another set of tags representing application type server agent broker now when want to perform limit my activity by performing only restart restart for server and agent would run my playbook with syntax like that ansible playbook my playbook yml tags server agent restart steps to reproduce expected results actual results a>>>feature_idea
documentation for the known hosts module incorrectly refers to the path argument as name issue type documentation report ansible version ansible configuration environment summary noticed that parameter called `name` is mentioned in the options table in the following document http docs ansible com known hosts module html based on the examples and some experimentation it appears that this should be `host` steps to reproduce navigate to http docs ansible com known hosts module html take note of the `name` parameter mentioned in the options table and the `host` parameter used in the examples expected results the options table should mention the `host` parameter actual results the options table mentions the `name` parameter which is invalid for use with the known hosts module >>>docs_report
ipv6 slaac address computation filter jinja2 filter to compute slaac address usage 2db8 64 slaac ansible eth0 macaddress >>>feature_pull_request
store ec2 instance ids in tags and hostvars have several ec2 instances that want to start and stop on schedule to save money after some googling came across these two conversations https github com ansible ansible pull 6349 https groups google com forum topic ansible project ogkbqkb9sqa michael dehaan suggested the ec2 inventory script would be the best place to implement this change well modified the ec2 inventory script to store the ec2 instance id of every instance such that it can be referenced in playbook like this the itag is all the ec2 tags storing the ec2 instance ids instead of the destination also store the host info by instance id in the hostvars so you can reference the ec2 instance by id >>>feature_pull_request
update link to github in developing plugins docs>>>docs_pull_request
bad var in included playbook produces misleading error found this post from 2014 http grokbase com gg ansible project 1473nhq6te include error message misleading when encountered the same problem `file could not read path to playbook` error that makes it look like the playbook doesn exist when in fact it does but there is problem with an undefined variable within in the responses it was suggested that github issue should be created but can find one so here is github issue >>>bug_report needs_info
pause module doesn allow continuation with v2 control is being trapped differently in v2 ansible which doesn allow ansible pause module to continue early hitting control at the pause prompt will cause ansible playbook to exit in this is displayed instead >>>bug_report
template module doesn set correct permissions on tmp file issue type bug report ansible version ansible v2 also has this issue environment running on ubuntu 15 04 managing centos summary if you set `mode` with the template module that mode is not set on the tmp file but only on the destination file the problem with this is if you use `validate visudo csf which with s` checks file permissions as well this fails because the tmp file doesn have 440 permissions but the default ones steps to reproduce here is an example playbook which fails on centos run on centos host and you get this error expected results this command shouldn fail since the tmp file should have the correct permission set with the parameters >>>bug_report p2
v2 add support for squash actions to ansiblemodule in v1 and now see from the code in v2 as well for ansible to squash `with items into single item and pass it to the module at once you needed to modify the core to add the module into list of modules which support this currently you need to edit `lib ansible executor task executor py` also this doesn pass list of those items to the module but joins those items with `join would it be possible that v2 adds support in the `ansiblemodule` class so you can pass an argument `squash actions true` which will automatically pass all the `with items as list of items to the module this should make the execution of lot modules if they add support lot faster but it will also make it easier to add this support to future and old modules since you don have to make separate pull request to the core to enable this for module >>>feature_idea
playbook doesn load vars files correctly with variable in path name according to the documentation variable precedence has extra variables at the top however in lib ansible vars init py the function get vars line 127 145 has the order inverted with extra variables as the lowest priority this prevents me from dynamically loading vars files based on what specify in the extra variable use this so that can load the staging and production var files based upon what variable set >>>bug_report p1
setting dynamic become doesn work have some systems that need to run some tasks with an escalated privileges and on some of the systems not so did the following an example run it with extra vars app become yes it will fail with this error failed hostname failed true parsed false traceback most recent call last file root ansible tmp ansible tmp 1435221345 83 73209898619316 file line 2000 in main file root ansible tmp ansible tmp 1435221345 83 73209898619316 file line 279 in main os mkdir curpath oserror errno 13 permission denied path test openssh 8p1 openssl 2c 12 jun 2015 debug1 reading configuration data home albert ssh config debug1 home albert ssh config line 232 applying options for hostname debug1 reading configuration data etc ssh ssh config debug1 auto mux trying existing master debug2 fd setting nonblock debug2 mux client hello exchange master version debug3 mux client forwards request forwardings local remote debug3 mux client request session entering debug3 mux client request alive entering debug3 mux client request alive done pid 5042 debug3 mux client request session session request sent debug1 mux client request session master session id debug3 mux client read packet read header failed broken pipe debug2 received exit status from master shared connection to closed fatal all hosts have already failed aborting however if explicitly set become like so it will run successfuly>>>bug_report p2
group vars all clobbering group vars tag environment demo variable precedence use group vars and want is to define defaults in inventory group vars all and override them for different environments which differentiate using aws tags inventory group vars all contents inventory group vars tag environment demo contents playbook provision server yaml am using ec2 dynamic inventory http docs ansible com intro dynamic inventory html my playbook looks like this test case when run my playbook with `ansible playbook provision server environment demo` expected result `database user is demouser other value is other` observed result `database user is alluser other value is other` it seems that `inventory group vars tag environment demo` is definitely getting used because other value is set `inventory group vars all` clobbers `inventory group vars tag environment demo` because it uses alluser not otheruser tearing my hair out can anybody help me notes >>>bug_report p2
change in conditional result between and issue type bug report ansible version ansible configuration no changes environment centos summary conditional that was working as expected in started resolving to true unexpectedly when upgrading to it can be resolved by making the expression more explicit but thought let you know just in case you didn intend this effect steps to reproduce when running this playbook in with say hello false other var false would not print hello but in it executes it seems to be evaluating it like this `say hello is defined and other var is defined` it can be fixed by being more explicit `say hello true and other var is defined` or `say hello and other var is defined expected results should not print hello actual results prints hello>>>bug_report
v2 templated vars files no longer work issue type bug report ansible version ansible configuration this was working until pulled the latest environment mac os 10 10 summary switching between vars files imports using extra vars with the `ansible playbook` command no longer works ve tracked the break down to this commit steps to reproduce test yml group vars test expected results actual results >>>bug_report p1
updated fetch url to actually use the parameters being passed in was trying to use the dnsmadeeasy module but the changes were not be reflected in dns made easy and noticed was getting back some obscure error message tracked the issue down to the parameters being passed into the fetch url method were not being used particularly the headers parameter >>>bugfix_pull_request needs_info p2 pending_closure
relative path broken in v2 the relative path are not good in v2 working in v1 main yml ntp update yml execution the src path should be system instead of products src users jeff deploiement playbooks infra system system files ntp conf >>>bug_report p2
get aws access and secret keys from boto config noticed when was trying to manage my aws servers using the ec2 module was getting the following error this is caused when the credentials are not configured properly however have valid home boto with the credentials section correctly configured the ec2 dynamic inventory script and connecting with plain boto work fine googled the problem and found this issue https github com ansible ansible issues 9984 was having similar problem fixed the problem by adding boto config lookup to the ec2 module utils >>>bugfix_pull_request cloud
authorized keys fails on glusterfs ansible on centos fully patched as of 24 2015 user home directory is hosted on glusterfs file system when using the authorized keys module to install their key receive the following error would guess this is similar to 5632 in root cause worked around the issue by using copy module command instead but would prefer authorized keys be fixed so things are more self documenting in the playbook >>>bug_report needs_info
added six to install from source docs v2 needs six installed updated install from source docs to reflect that >>>docs_pull_request
when inventory hostname in groups group does not work with dynamic inventory created https github com eparis ansible inventory bug to show exactly what mean with clean reproducer which anyone can run locally it has both dynamic inventory and static inventory for dynamic it really is just catting in some json but it shows the problem clearly with static inventory file `when inventory hostname in groups group works just fine but with dynamic inventory it fails with what looks like some python localization string handling mess >>>bug_report
added role path to magic var section discovered that it possible to use role path today it not mentioned in the docs so here brief comment >>>docs_pull_request
set fact skipping the following code works under ansible but fails on the latest devel checkout it runs the same rules but skips the set fact command this assigns unique id to each zookeeper instance dynamically >>>bug_report
gathering facts error on openvz container have couple of openvz containers which fail when attempt to gather facts on them this is shame because it seems that if any of the key value pairs are missing the whole gather facts step fails in this case it appears that there is no swapcached value failed machine failed true parsed false traceback most recent call last file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 4278 in main file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 137 in main data run setup module file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 81 in run setup facts ansible facts module file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 4217 in ansible facts facts update hardware populate file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 2339 in populate self get memory facts file root ansible tmp ansible tmp 1435154235 24 256016898287708 setup line 2361 in get memory facts self facts memory mb keyerror swapcached is there workaround or solution >>>bug_report easyfix p2
second play of role doesn evaluate dependencies trying to deploy the same role to different sets of machines spun up in ec2 playbook contains different plays to apply this role to different machines the first play works and the role is applied along with its dependencies the next play fails however as ansible attempts to apply the role without dependencies example playbook is below >>>bug_report p2
template error while templating string encountered unknown tag this strange bug bit me when tried ansible latest released version ve reduced it to playbook an template file and the inventory file the content in the template file doesn matter it is enough with completely empty file hostname doesn matter either localhost or other names triggers the bug ve tried 127 and other variants of hostnames with or without domain also tried deleting my environment completely using env ash trying minimal shell that has few veriables these are the current files hosts host list localhost site yaml hosts host list tasks action template dest tmp app keys txt src mupp j2 mupp j2 empty file byte the error shows when run ansible like this ansible playbook hosts site yaml play host list gathering facts ok localhost task template dest tmp mupp txt src mupp j2 fatal localhost template error while templating string encountered unknown tag fatal all hosts have already failed aborting play recap to retry use limit home jh site yaml retry localhost ok changed unreachable failed now the interesting thing happens when change action to local action everything works get zero byte sized file in tmp as expected once again content doesn matter using local doesn help either ansible playbook hosts site yaml play host list gathering facts ok localhost task template dest tmp mupp txt src mupp j2 ok localhost 127 play recap localhost ok changed unreachable failed >>>bug_report p2
docs added missing filters several filters were undocumented relpath from yaml from json quote tidied up code indentation and standardized since version comments >>>docs_pull_request needs_revision
fix with with dict no log and check not hide variables when use no log true using with dict not with items check still show sensitive information confirmed at rc2 10388 has some fix but not success to `with items` how to reproduce and run `ansible playbook localhost no log yml check` then shows this pr fixes this problem with almost same change as 10388 thank you >>>bugfix_pull_request
add quote to variable following colon value after colon such as an ansible variable has to be quoted otherwise yaml will interpret it as dictionary >>>docs_pull_request
update playbooks tags rst clarify how tagging with roles and includes works >>>docs_pull_request needs_revision
clarify that setting ssh args trumps control path>>>docs_pull_request
extraneous syslog output from ansible file when do fairly standard ansible playbook run the remote server ends up getting syslog output with lot of ansible modules expected however it also produces output like this interspersed with the ansible commands believe it ansible file that causing this but it not clear why it ending up in syslog >>>bug_report needs_info pending_closure
git module documentation report issue type documentation report for the git module there is no mention that git binaries are required other core modules with requirements report these at the top of the file for example http docs ansible com s3 module html ansible version `ansible 1` ansible configuration no changes environment summary the git module has dependency requirement on git binaries being installed however this is not stated in the documentation http docs ansible com git module html steps to reproduce expected results actual results used the module to download git repo it failed solution was incredibly simple and the other reason this is being reported is for completeness of documentation and maybe to save someone else few seconds in the future >>>docs_report
fix broken links on the developing plugins page>>>docs_pull_request needs_revision
retry ssh exec command applied to v1 in pr https github com ansible ansible pull 9927 the ability to retry failed ssh commend execution was added it was only added to the v1 code branch subsequently in https github com ansible ansible commit 2e07567c16bdd339f2305ee67e23ede60ba9a3ce `v1` will eventually be removed and we will only be left with the configuration constant in `constants py` the code from v1 should be ported over to the v2 connection plugin at `lib ansible plugins connections ssh py` cc hughsaunders >>>bug_report p2
include paths do not work the same in v2 as in v1 have couple of task files that include each other and are not at the same level as the playbook it seems that in v2 codebase the include path needs to be specified relative to the palybook directory specifying the path relative of the task file directory does not work any more ansible version ansible devel 952166f48e last updated 2015 06 23 11 45 41 gmt 300 lib ansible modules core detached head cf273bbaeb last updated 2015 06 23 11 45 45 gmt 300 lib ansible modules extras detached head dd6e8f354a last updated 2015 06 23 11 45 49 gmt 300 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 23 11 45 53 gmt 300 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 23 11 45 56 gmt 300 configured module search path none sebi>>>bug_report needs_info p2
group host and command line vars not loaded registered for the last couple of weeks using v2 it seems variables loaded from either group vars host vars or the command line do not seem to be loaded if using group vars host vars combined with debug var hostvars inventory hostname it appears to return an empty dict however variables seem to work if specified in playbook reverting to the stable branch or sourcing v1 seem to resolve the issue additionally the condensed output option o` does not seem to be working in v2 as well see examples below version example sourcing v2 not working example sourcing v1 working >>>bug_report p2
enable do until with async tasks when task is marked as async there is no way to loop until condition is met with poll and async status you can poll for async task to complete but you cannot repeat the original async task itself until condition is met >>>feature_idea
add example callback plugin no hosts matched fail this example callback plugin makes `ansible playbook` return non zero exit code if the playbook matches no hosts stab at solution to https groups google com forum topic ansible project 9qluer83za0 cc sudarkoff sontek djeebus>>>feature_pull_request
feature request current role name current play name variables it would be helpful to be able to access the current role name and current play name as variables from within task ansible playname ansible rolename an example use case is when having multiple plays creating configs in shared config folder for logstash forwarding each play that creates file can be named after the play making it clear >>>feature_idea
bug in unarchive module hi have found problem with the unarchive module when the file to uncompress contains weird characters with this playbook the problem can be reproduced and this is the output when executing it the file can be uncompressed without issues using tar directly in the command line or using the ansible shell module to call tar this is the file name which triggers the error have found this issue with ansible >>>bug_report p2
authorized key exclusive yes with multiple key files if `exclusive yes` is set it is not possible to add multiple keys by looping through list of files they has to be in one file like mentioned in the docs otherwise the last keys wins and every update would trigger change something like this would be nice if possible >>>docs_report
feature request cleanup in event of fatal error believe feature similar to finally in try catch block would be great feature to add tasks that would run in the event of fatal error this would be useful in cleanup resources created before the failure such as an ec2 instance that is created >>>feature_idea
cant pass in email address syntax to script or command cant esacpe char im having an issue where by script myscript py username xxxx company com argument2 results in myscript py username srgument2 the value for the username arguemnt is blank as soon as place an ampersand even if have this as var var1 username company com and use var1 no amount of single or double quoting allowing the value to be passed onto the remote command or script im sure that its my mistake however cannot find any fix for this and any yaml parsers seem to be able to parse the data and leave the intact even adding unicode doesnt seem to work >>>bug_report needs_info
groups is undefined getting strange error when trying to apply role apparently groups the builtin variable is undefined ve tested on play in the same playbook and the variable works any ideas ve tried this with different roles but it still fails using the latest pull from the git repo >>>bug_report p2
add default omit functionality for sub keys issue type feature idea ansible version ansible configuration environment os 10 10 summary `default omit is very useful but only works for top level keys arguments of the module and not sub keys https groups google com forum topic ansible project gz1wyxpqiy0 failed workarounds `default passes an empty string `default fails to parse `default passes the tilde steps to reproduce run this ec2 module task without the build number variable expected results build tag is not assigned to the instance actual results the ec2 machine is created with build tag of omit place holder 6248a11ef81332080f31b81d2894e811f905b723` >>>feature_idea
start at task not working in version basic info works correctly at ansible role roles aws tasks main yml command play enigma lamp task setup ok enigma14 task base base core server packages ansible devel ff251a0dcc last updated 2015 06 22 10 38 58 gmt 200 lib ansible modules core detached head d6ed6113a7 last updated 2015 06 22 09 38 14 gmt 200 lib ansible modules extras detached head 57813a2e74 last updated 2015 06 22 09 38 14 gmt 200 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 22 09 38 14 gmt 200 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 22 09 38 14 gmt 200 configured module search path none >>>bug_report
update vault rekey in vault py to validate files passed before input pting for password update rekey in vault py to validate files passed exist before prompting for password why enter password when the files passed don exist in the first place >>>feature_pull_request
update playbooks tags rst when specifying multiple tags from the command line one must use space and not comma between tags >>>bugfix_pull_request needs_info needs_revision
quotes removed from become method just experimented that with quotes it does not work ansible >>>bug_report
bug ansible can deal with home directory that contains spaces hey there guys loving ansible moved my home directory to volumes fotsies home fots` on my mac and noticed that ansible was not correctly quoting scripts and so my run was failing and creating the scripts in my current directory under `home` after renaming the volume to data volumes data fots` everything is working well again may be worth touching up when there time smile cheers fotis>>>bug_report p2
encryption with vault crashes ansible vault encrypt file yml debian ansible 2>>>bug_report p2
roles path regression in v2 issue type bug report ansible version ansible configuration haven changed or added any configuration settings to ansible environment osx 10 10 python 10 summary there is regression on `v2` regarding how `roles path` is constructed with subdirectories ansible cfg` subfolder playbook yml` subfolder child roles steps to reproduce set up an example repository to illustrate this bug https github com arturhoo ansible bug expected results actual results notes the expected result is the one we get on `1 1` workaround on `v2` maybe the wanted way all along is to use only the role name in the playbook >>>bug_report p2
handlers not ran when first skipped but then notified issue type bug report ansible version ansible configuration haven changed or added any configuration settings to ansible environment osx 10 10 python 10 summary handler that is firstly not notified due to skipped and depended upon task but later notified through the same task directly invoked does not run at the of the play steps to reproduce set up an example repository to illustrate this bug https github com arturhoo ansible bug expected results actual results >>>bug_report
group vars all yml no longer loaded in v2 issue type bug ansible version ansible version ansible devel fc82bccf6c last updated 2015 06 19 11 15 17 gmt 400 lib ansible modules core detached head cf273bbaeb last updated 2015 06 19 11 16 15 gmt 400 lib ansible modules extras detached head 1604382538 last updated 2015 06 19 11 16 30 gmt 400 v1 ansible modules core detached head cf273bbaeb last updated 2015 06 19 11 16 31 gmt 400 v1 ansible modules extras detached head 1604382538 last updated 2015 06 19 11 16 33 gmt 400 configured module search path none ansible configuration environment summary without manually including all yml my roles fail because my high level vars aren available steps to reproduce do anything that requires group vars all yml to be loaded https gist github com shawnferry 8a0a0c2f144753f2ebde expected results all yml variables will be available actual results all yml variables appears to be ignored >>>bug_report p2
add new on exception callback method there are two separate commits one adds the feature to ansible v2 and the other to v1 this can be used to catch and log keyboardinterrupt when user cancels playbook run we use callback plugins to log the start and stop of our playbook runs to another system fedmsg http fedmsg com for fedora infrastructure https fedoraproject org wiki infrastructure sat down to try and build dashboard showing what admins were running what playbooks at any given time we have logs indicating when playbooks start and stop but not when they are interrupted by control or some other internal exception adding this callback would let us expose that kind of information >>>feature_pull_request
broken notification with msg notification running v1 but it appears to be broken with the latest pull error notified perl announce hipchat failed server1 127 failed true msg unable to sent msg global name urllib is not defined system with error ansible version ansible stable 65fc0161a8 last updated 2015 06 19 09 56 06 gmt 400 on system that works am running ansible version ansible stable b70caac618 last updated 2015 06 04 20 52 04 gmt 000 >>>bug_report
added sts support for ec2 py for handling multiple accounts following is the process to scan multiple accounts via sts step create role in the destination account from which we would like to scan the instances from and authorize the user and the account from the source account to assumerole aws iam put role policy policy name cross access policy role name cross access role policy document statement sid action ec2 describeinstances ec2 describetags route53 get route53 list rds describe elasticloadbalancing describe effect allow resource step3 export aws access key id xxxx export aws secret access key xxxxxx for the user present in the master account who has access to perform the cross account access >>>cloud feature_pull_request
v2 playbook with tags are not working same playbook works fine in v1 issue type bug report ansible version ansible version ansible devel 98fee172ee last updated 2015 06 18 13 05 15 gmt 500 lib ansible modules core detached head 9acc7c402f last updated 2015 06 10 17 06 47 gmt 500 lib ansible modules extras detached head 2f967a949f last updated 2015 06 10 17 06 47 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 configured module search path none ansible configuration was aka using v1 code base source v1 hacking env setup now using v2 code base source hacking env setup environment os yosemite 10 10 python python pip freeze ansible ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos markupsafe 23 nose paramiko 15 passlib pycrypto pywinrm pyyaml 11 six xmltodict summary playbooks in v2 using tags do not run the plays steps to reproduce vmware virtual host running linux snapshot to save the unpatched state roll back virtual machine to unpatch state know for sure there plays so ok isn right also know there are multiple patches to this virtual machine so changed is not right the virtual machine is debian expected results assume the plays would run to completion like then do in v1 actual results >>>bug_report needs_info p2
add tests for rax scaling group this pr adds integration tests for `rax scaling group`>>>feature_pull_request
facts caching not working just did clean clone and facts caching with redis stopped working details install ansible cfg version before the clone was using the following version with working fatcs in redis cli prior the most recent clone was noticing the following using the monitor cmd using the current clone the following transactions from redis no setex or zadd >>>bug_report p2
ansible managed from ansible cfg not available as template var issue type bug report ansible version `ansible devel 4d5a98d8d9 last updated 2015 06 18 10 55 47 gmt 400 lib ansible modules core detached head 9acc7c402f last updated 2015 06 17 14 22 00 gmt 400 lib ansible modules extras detached head 2f967a949f last updated 2015 06 17 14 22 01 gmt 400 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 17 14 22 26 gmt 400 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 17 14 22 49 gmt 400 configured module search path none` ansible configuration etc ansible ansible cfg is the default one environment ubuntu 14 04 lts summary the sole action in playbook is to instantiate template on the server the template contains only ansible managed instead of placing the template file as expected ansible errors out complaining that ansible managed is undefined steps to reproduce ensure that you have ansible managed set in your etc ansible ansible cfg and then simply try to parse template file that contains the string ansible managed expected results template file is parsed and ansible managed is replaced appropriately actual results `fatal my server com failed msg undefinederror ansible managed is undefined failed true changed false `>>>bug_report p2
adding lookup plugin for postgresql database lookup plugin for querying postgresql>>>feature_pull_request
host vars file doesn parsed when run playbook with hi here my test case using ansible on centos6 ansible on centos7 arch linux >>>bug_report
vars prompt fails to pass along values in don even know how to describe this but this works in and does not in when using vars prompt and value does not appear to be getting passed along somewhere playbook template when innodb buffer pool size is called in template zero is populated where in real number that accurate is populated >>>bug_report
roles handler uses previous value ansible version ansible am using ansible redis https github com davidwittman ansible redis role for installing two redis server one by one though playbook as but in running handler `restart redis` though second time role run it has previous value of `redis port` variable 9921 which is unexpected am sharing you the run logs of notification of both role run below first run with redis port 9921 second run with redis port 6379 in above it uses `9921` value of variable `redis port` only for handlers not for the task please help me on this due to this lost some redis data on the production it can be major issue >>>bug_report p2
add installroot option to yum module issue type feature idea ansible version ansible configuration nothing changed environment rhel centos summary trying to keep some software installed into non standard directory currently using the yum module can specify an alternative installroot path expected results would like to be able to add installroot option like can do this with yum in linux >>>feature_idea
top level playbook tags broken see the attachment with ansible this works as expected ansible playbook version ansible playbook ansible playbook hosts localhost yml tags play localhost gathering facts ok localhost task debug msg ok localhost msg play recap localhost ok changed unreachable failed with it broken ansible playbook version ansible playbook ansible playbook hosts localhost yml tags error tag not found in playbook possible values >>>bug_report
sudo fails on check password prompt this worked fine up to days ago this commit still works 5ed2e440260e2d06d234634305f4d61e82413f6c now every ssh gets this error fatal 10 22 26 38 failed failed true exception traceback most recent call last file usr local lib python2 dist packages ansible py2 egg ansible executor process worker py line 118 in run executor result taskexecutor host task job vars new connection info self new stdin self loader shared loader obj run file usr local lib python2 dist packages ansible py2 egg ansible executor task executor py line 111 in run res self execute file usr local lib python2 dist packages ansible py2 egg ansible executor task executor py line 266 in execute result self handler run task vars variables file usr local lib python2 dist packages ansible py2 egg ansible plugins action normal py line 27 in run return self execute module tmp task vars task vars file usr local lib python2 dist packages ansible py2 egg ansible plugins action init py line 355 in execute module self transfer data remote module path module data file usr local lib python2 dist packages ansible py2 egg ansible plugins action init py line 221 in transfer data self connection put file afile remote path file usr local lib python2 dist packages ansible py2 egg ansible plugins connections ssh py line 418 in put file returncode stdout stderr self communicate stdin indata file usr local lib python2 dist packages ansible py2 egg ansible plugins connections ssh py line 181 in communicate elif self check password prompt stdout file usr local lib python2 dist packages ansible py2 egg ansible plugins connections init py line 136 in check password prompt return self prompt output ntypeerror nonetype object is not callable stdout >>>bug_report p2
change syslog priority level from log notice to log info if you look at the meaning of the different syslog levels notice means that the event is unusual and may need someone to look at it whereas info is pure informational and expected since module invocations are in fact requested deliberate actions they shouldn need any additional post processing and therefore should not be logged as notice this may seem like hairsplitting but correctly categorizing system events helps weeding through the noise downhill we don do any specific post processing of debug or info events according to wikipedia https en wikipedia org wiki syslog 	notice 		notice 	events that are unusual but not error conditions 	informational 	info 		normal operational messages no action required example an application has started paused or ended successfully >>>bugfix_pull_request
fix docs typo>>>docs_pull_request
allow multiple vcenter esxi servers in single inventory allow multiple vcenter esxi servers to be scanned from single inventory ini combo removing the need to have multiple sets of vmware inventory files when managing large deployment >>>feature_pull_request needs_rebase
easier use of built in dynamic inventory scripts not sure this is the best way consider it one possible solution to problem and jumping off point for discussion problem want to make it easier to have ansible consult the dynamic inventory plugins that come with ansible `ssh config` `nova` `serf` etc could only think of few ways of doing this now and don love any of them tell people to pass path to ansible plugins inventory ssh config py` to `ansible` `ansible playbook` etc bleh add path to ansible plugins inventory ssh config py` to an `ansible cfg` not that know where people have installed ansible they may all have it installed in different places bleh copy the contents of the scripts need into directory in my project that lives alongside the `ansible cfg` static inventory files playbooks etc `hosts nonprod dynamic ssh config py` this is the best solution but not great because copying code not getting the latest changes in ansible etc so here stab at solving this allows passing the name of built in inventory script with i` on the command line or in `ansible cfg` without specifying the full path if ansible cannot resolve the given path it will attempt to find resolve it relative to the `ansible plugins inventory` directory this makes it easier to use these scripts without having to copy them into your project ansible gabriel ping ssh config py gabriel success invocation module name ping module args changed false ping pong the py` suffix can be omitted as well and instead of using i` on the command line you could use the same syntax in an `ansible cfg` file and then you can simply do cc sudarkoff sontek>>>feature_idea
add inventory file to unable to find error msg ansible gabriel ping ssh config py error unable to find an inventory file ssh config py specify one with >>>bugfix_pull_request
add simple prefix filtering to vmware inventory significantly speeds up inventory collection on systems with many excluded machines >>>feature_pull_request
support instances with no public ip default to private ip if the instance doesn have public ip assigned causes list index out of range error otherwise >>>feature_pull_request
fixes 11296 where the groups does not have all the groups fixes 11296 where the groups variable does not have all the groups>>>bugfix_pull_request p2
simplify serf inventory plugin using newly added `environmentconfig` class in `serfclient` see https github com kushalp serfclient py pull 17>>>feature_pull_request
looping of hosts in group in jinja2 template does not work in v2 hi have the following step 10 hosts step 10 haproxy yml template invoking the following works in v1 >>>bug_report p2
cron module validate cron file parameter issue type feature idea ansible version managed environment ubuntu 12 04 summary we can use invalid file names like blabla example com conf for cron files but based on documentation http manpages ubuntu com manpages maverick en man8 cron html files must conform to the same naming convention as used by run parts they must consist solely of upper and lower case letters digits underscores and hyphens maybe need to add validation and throw error show hint for invalid names steps to reproduce expected results throw error or show hint about invalid file name actual results cron ignores this job>>>feature_idea
plugins inventory serf py use serf rpc env vars this makes the serf inventory plugin use the `serf rpc addr` and `serf rpc auth` environment variables that the `serf` command line tool already uses see https www serfdom io docs commands members html rpc addr these can be used to get serf data from remote node instead of requiring the ansible control host to be running serf agent and to be member of the serf cluster cc bcoca kushalp sudarkoff>>>feature_pull_request
for tags with empty value do not append separator>>>bugfix_pull_request
unchanged when issue type feature request ansible version ansible configured module search path none no configuration changes environment ubuntu 14 04 02 summary please add new task parameter unchanged when or similar to allow the unchanged status to be recorded for task this would be similar to failed when and changed when at present the only way to implement this it either to ignore errors or to enumerate all other conditions neither of these is an adequate alternative to the requested tag sample script there probably needs to be be an extra test for the initial run >>>feature_idea
wishlist show ssh port if not standard in output would be helpful to show the ssh port if it is not standard in the output for example am running an ansible playbook against localhost and localhost 2022 which is boot2docker it would be helpful to differentiate between the two currently the port number is not displayed for example default port non standard port >>>feature_idea
refactored aixnetwork get interfaces info moved parse entstat and parse lsattr into their own methods and simplified them collect get bin path outputs once per call to get interfaces info instead of once per line of ifconfig output execute uname once per call to get interfaces info fixes 11289 >>>bugfix_pull_request needs_rebase
aix wpar handling is inefficient and possibly buggy the `lib ansible module utils facts py aixnetwork get interfaces info` method is structured like rc out err module run command ifconfig path for line in out split uname path module get bin path uname if uname path rc out err module run command uname path this has two big problems it uses `subprocess popen` to run `uname w` for each line in ifconfig this is performance issue because shelling out is expensive and this data isn going to change during run on single host it should be collected once and then reused note that `out` is overwritten inside the loop it won break the loop which is iterating over `out split and not `out` directly however that may cause breakage in further edits that expect `out` to keep the same information throughout the loop consider using unique variable names like `ifconfig out` `entstat out` etc to avoid weird hard to debug errors later cc bmanojlovic who contributed this code >>>bug_report
don panic if aix uname doesn support the current code expects uname on aix to always succeed the aix instance have doesn support the flag and facts gathering always crashes on it this skips some wpar handling code if uname doesn work >>>bugfix_pull_request
fixes for freebsd get memory facts swapinfo on freebsd maybe too doesn support the flag for fetching amounts in megabytes this patch fetches amounts in kilobytes and divides by 1024 and also returns the result as an int instead of string when no swap is configured swapinfo prints header line and nothing else the old version unexpectedly parsed that header line and emitted nonsense values like this version emits those items altogether when no swap is configured >>>bugfix_pull_request
handlers defined in role are not executed discovered issue type bug report ansible version using `source hacking env setup` ansible configuration environment ubuntu 14 04 managing ubuntu 14 04 summary handlers defined in role are not executed if the handler is moved into the play itself then it will execute normally see the commented out handler below if it is uncommented this testcase works correctly it seems to only be when the handler is defined in the role itself that it fails to execute also noticed that if the handler is not defined anywhere no error message is raised under v1 an error message is raised when the handler is to be notified everything works as expected if `source v1 hacking env setup` instead steps to reproduce create role with roles testrole tasks main yml roles testrole handlers main yml play yml then run `ansible playbook 127 local play yml` expected results expect the handler to run and the output to be this actual results the handler is never notified and if it is never defined then no error messages are raised >>>bug_report p2
nameerror global name success key is not defined issue type bug report ansible version ansible version ansible devel 30c1a2d861 last updated 2015 06 16 11 18 20 gmt 500 lib ansible modules core detached head 9acc7c402f last updated 2015 06 10 17 06 47 gmt 500 lib ansible modules extras detached head 2f967a949f last updated 2015 06 10 17 06 47 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 configured module search path none ansible configuration was aka using v1 code base source v1 hacking env setup now using v2 code base source hacking env setup environment os yosemite 10 10 python python pip freeze ansible ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos markupsafe 23 nose paramiko 15 passlib pycrypto pywinrm pyyaml 11 six xmltodict summary please summarize your request in this space you will earn bonus points for being succinct but please add enough detail so we can understand the request thanks steps to reproduce applied 98f5534 source hacking env setup ansible playbook ask pass ask sudo pass production servers linux servers yml vvvv ssh password sudo password defaults to ssh password expected results assume the plays would run to completion like then do in v1 actual results >>>bug_report p1
add serf inventory plugin add inventory plugin for serf https serfdom io requires `serfclient` python module https pypi python org pypi serfclient cc sudarkoff>>>feature_pull_request
unarchive sudo solaris broken am using ansible to run cis cat scripts and found that my script was running fine on my linux hosts but on solaris was getting this output fatal coeusdev acsu buffalo edu ssh connection closed waiting for privilege escalation password prompt when running this step tried manually copying the file over to simplify matters and ran this pared down script got the same results for some reason it seems unarchive doesn play nice with sudo through ansible with solaris 10 target machines >>>bug_report
bugfix win checksum win checksum had some errors causing it to output an array of strings instead of string this caused depending module such as win file and win copy to throw errors >>>bugfix_pull_request p2 windows
update syslog json py localhost is better than locahost small fix for better life >>>bugfix_pull_request
unable to clone ansible the file lib ansible executor task queue manager py contains the string in the filename which leaves me unable to clone or do anything to the ansible repo sure the filename is typo >>>bug_report p2
winrm fails in v2 mode on current devel branch v2 does not work in the current devel branch azureuser thansible ansible all win ping vvv thhighperf4 failed failed true exception traceback most recent call last file home azureuser ansible ansible lib ansible executor process worker py line 118 in run executor result taskexecutor host task job vars new connection info self new stdin self loader shared loader obj run file home azureuser ansible ansible lib ansible executor task executor py line 111 in run res self execute file home azureuser ansible ansible lib ansible executor task executor py line 218 in execute self handler self get action handler connection self connection templar templar file home azureuser ansible ansible lib ansible executor task executor py line 425 in get action handler shared loader obj self shared loader obj file home azureuser ansible ansible lib ansible plugins init py line 284 in get obj getattr self module cache path self class name args kwargs file home azureuser ansible ansible lib ansible plugins action init py line 64 in init self shell shell loader get shell type file home azureuser ansible ansible lib ansible plugins init py line 274 in get path self find plugin name file home azureuser ansible ansible lib ansible plugins init py line 246 in find plugin if not name startswith nattributeerror shellmodule object has no attribute startswith stdout sourcing the v1 env setup file and re running the command works >>>bug_report p1 windows
typeerror exec command got an unexpected keyword argument sudoable issue type bug report ansible version ansible version ansible devel 5ed2e44026 last updated 2015 06 16 00 54 15 gmt 500 lib ansible modules core detached head 9acc7c402f last updated 2015 06 10 17 06 47 gmt 500 lib ansible modules extras detached head 2f967a949f last updated 2015 06 10 17 06 47 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 configured module search path none ansible configuration was aka using v1 code base source v1 hacking env setup now using v2 code base source hacking env setup environment os yosemite 10 10 python python pip freeze ansible ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos markupsafe 23 nose paramiko 15 passlib pycrypto pywinrm pyyaml 11 six xmltodict summary all my playbooks and plays that work in v1 fail in v2 swear this was discovered when v2 dropped and there was pr for it but cannot find the pr the discussion or issue vaguely recall it was with ssh pass on os sorry steps to reproduce source hacking env setup ansible playbook ask pass ask sudo pass production servers linux servers yml vvv ssh password sudo password defaults to ssh password expected results assume the plays would run to completion like then do in v1 actual results plays in linux servers yml play task setup fatal host domain com failed failed true exception traceback most recent call last file users tanner projects ansible git ansible lib ansible executor process worker py line 118 in run executor result taskexecutor host task job vars new connection info self new stdin self loader shared loader obj run file users tanner projects ansible git ansible lib ansible executor task executor py line 111 in run res self execute file users tanner projects ansible git ansible lib ansible executor task executor py line 266 in execute result self handler run task vars variables file users tanner projects ansible git ansible lib ansible plugins action normal py line 27 in run return self execute module tmp task vars task vars file users tanner projects ansible git ansible lib ansible plugins action init py line 348 in execute module tmp self make tmp path file users tanner projects ansible git ansible lib ansible plugins action init py line 156 in make tmp path result self low level execute command cmd none sudoable false file users tanner projects ansible git ansible lib ansible plugins action init py line 449 in low level execute command rc stdin stdout stderr self connection exec command cmd tmp in data in data sudoable sudoable ntypeerror exec command got an unexpected keyword argument sudoable stdout no more hosts left play recap host domain com ok changed unreachable failed >>>bug_report p2
unarchive with copy no failing inexplicably have playbook to install python works great under worked for long time under fails today on devel threw in the stat code for testing but it doesn make it work name configure usr src python permissions file dest usr src python state directory owner ansible ssh user group ansible ssh user recurse yes sudo yes name get python get url url http www python org ftp python python version python python version tar xz dest usr src python stat path usr src python python python version tar xz register st name unarchive python unarchive src usr src python python python version tar xz dest usr src python copy no when st stat exists true the error get fatal aws ansible failed msg error file or module does not exist usr src python python 10 tar xz failed true >>>bug_report
to json does not escape newlines in dict when another key has bool or null value issue type bug report ansible version ansible configuration environment freebsd 10 summary when using the to json filter on dict variable when one key has boolean or null value and second key value has embedded newlines the second key value with the embedded newlines do not get escaped steps to reproduce failing playbook name testing playbook hosts all vars test data newlines one two three boolean true tasks copy content test data to json dest test json expected results test json should have boolean true newlines one ntwo nthree actual results test json contains boolean true newlines one two three same thing happens when the `boolean` key is `false` or `null` >>>bug_report
allow adhoccli to be more flexible for overriding in one of our applications we mimic the `adhoccli` functionality now that this class exists we are attempting to reuse more of it code without having to copy paste the following changes are part of this pr add play ds` method that can be easily overridden we already have dictionary for the args for module this allows us to overwrite building the play ds to pass in our already structured data make `taskqueuemanager` an instance attribute of `adhoccli` we also produce recap for adhoc commands to make it easier to see where things change and fail both of these changes make it easier for us to inherit from `adhoccli` and only override small pieces of code without having to copy paste into our project the only thing question is whether it would be beneficial for ad hoc commands to have recap in ansible itself >>>feature_pull_request
add plugin that profiles playbook tasks description and console output demonstration https github com aioue ansible plugin profile blob master readme md features provides per task timing ongoing playbook elapsed time and ordered list of top 20 longest running tasks at end >>>feature_pull_request
local and ssh connection plugin fixes this pr addresses few things on the `ssh` connection plugin use for printf formatting to replace s` make sure we accept kwarg `sudoable` for the `local` connection plugin and pass it when calling `exec command` via `super`>>>bugfix_pull_request
dynamic inventory instructions need update https github com ansible ansible blob 5d213cab23ced2664fdd0d77a9c1e1b11a3d489b docsite rst intro dynamic inventory rst example aws ec2 external inventory script this instruction did not work at this point of the documentation the `plugins inventory` dir is referenced for the first time and given the instructions immediately above it should not exist nor have `ec2 py` script in it had to follow this guide https djaodjin com blog deploying on ec2 with ansible blog to understand that ec2 py needs to be in the `plugins inventory` directory also it would appear that the env var `export ec2 ini path virtual env etc ansible ec2 ini` needs to be set >>>docs_report p2
make ansible galaxy install requirements yml idempotent issue type bug report feature idea ansible version ansible configuration environment summary running `ansible galaxy install requirements yml` should be idempotent it should behave like `pip install requirements txt` steps to reproduce create `requirements yml` file with the following contents yaml nodejs role src https github com nodesource ansible nodejs role version 592a239dca52e1c5ff79cfefd0072efe3831428e name nodejs run `ansible galaxy install requirements yml` re run `ansible galaxy install requirements yml` expected results on the second run `ansible galaxy` should detect that the `nodejs` role is already installed and make sure the installed version matches the version specified in `requirements yml` actual results additional info one can specify ignore errors` to ignore the failed roles however this is not the appropriate solution since this would also ignore errors where `ansible galaxy` failed to fetch role from remote server it should be possible to obtain the version of the installed role via `meta galaxy install info` file for example for the `nodejs` role installed before it has the following contents install date mon jun 15 11 56 40 2015 version 592a239dca52e1c5ff79cfefd0072efe3831428e >>>feature_idea
with dict doesn work after commit 47aeff1636cfc158d72a54370eb3135469264ca2 there is line 41 changed in lib ansible utils listify py in commit no aed429554dc86385408133988da5caba44dce891 and since then with dict keeps returning error failed msg error with dict expects dict failed true after replaced that line with one from 47aeff1636cfc158d72a54370eb3135469264ca2 it works again >>>bug_report p1
add permission changes to file diff mode it would be very nice if diff mode also showed permission changes in addition to file contents changes for now it only says that file changed without any further explanation is it possible to display summary of what changed owner group or mode with before and after values making mistake when changing permissions can be very dangerous so having more information would make applying changes less stressful >>>feature_idea
add diff option to synchronize module issue type bug report ansible version ansible ansible configuration nothing changed environment summary sync module doesn honor diff option steps to reproduce use sync in playbook add diff check options to running the playbook see no diff appear in the output expected results diff output should appear in the output actual results it does not>>>feature_idea
adds elasticache to ec2 dynamic inventory plugin adds support to aws elasticache services clusters nodes and replication groups to ec2 py dynamic inventory plugin the new functionality follows the architecture used for the previous services ec2 and rds supported by the script with some obvious differences due to lack of dedicated classes in boto the added code follows the pattern used until now regarding to grouping naming and keys although think it should be subject of refactoring in the future hope you appreciate the addition it ll be very useful to everybody out there using elasticache services if you have any doubts or suggestion entirely at your disposal live long and prosper ah by the way today is my birthday >>>feature_pull_request
get filechecksum doesn calculate hash for files missing update of the checksum value before returning the result hash is never updated in case file exists>>>bugfix_pull_request p2
include parameters not overriding values from vars files this is in references to https groups google com forum topic ansible project si sxvrxgao the short version is that in ansible parameters passed to includes are always overridden by values in vars files for ansible v2 devel the behavior varies for simple test cases the behaviors is the same as ansible hoever it more complex cases the behavior can apper to be correct the seems to be related to parameters being past to one include can end up bleeding over it seems most likely that this bleed over is related to variable references being used rather than copies but that is just an educated guess for more detailed breakdown of the varied behaviore in ansible v2 devel please see https github com therevmj ansible oddities blob master play yml >>>bug_report p2
authorized key fails in check mode if user doesn exist issue type bug report ansible version ansible configuration no changes from defaults environment both manager and managed host are ubuntu 14 04 summary have set of tasks that create local users and manage their authorized keys file using the `authorized key` module if run play containing these tasks in check mode against brand new managed host the user creation is skipped as expected but the `authorized key` module fails because the user doesn exist >>>bug_report
command warnings are no longer displayed in v2 the command warnings option still exists warn no works correctly the command module still returns warnings key value pair but nothing actually displays the warning it used to be in callbacks py on ok but doesn seem to have migrated to runner on ok in v2 >>>bug_report p2
update index rst adding some copy edits feel free to disregard >>>docs_pull_request
no log is ignored when using key value args was working on module and not entirely what is going on between the two forms of argument passing issue type bug report ansible version ansible configuration environment rhel summary when using inline arguments in module with `no log` applied to it output for `no log` entries are still output if you `register` the result from previous run switching to nested dictionary form doesn output anything as you would expect steps to reproduce as simple example the `copy` module sets `no log` on the `content` argument failing input case expected results with the output will be actual results using inline arguments >>>bug_report
display warning when using deprecated module this pr adds warning when using deprecated module currently user would never know the module was deprecated unless they looked at the docs this should help users identify that they are using deprecated module to enable us to eventually remove those modules example output the text there is largely taken from the text used on docs ansible com if desired we could also get the docs and display the specific module deprecation string >>>feature_pull_request
require passlib over crypt in password hash for mac os darwin fixes 11244 this pr conditionally imports passlib for the `password hash` filter and requires it for operation on mac os darwin >>>bugfix_pull_request
ec2 group should allow for blank egress rules within vpc there are use cases where you do not want any egress rules when creating security group within vpc this however forces people to create bogus 127 egress rule to get rid of the default allow all use case separate security group which contains egress rules you attach to your instances then you can have specific ingress only security groups https github com ansible ansible issues 7309 prevents this >>>cloud feature_idea
utf characters silently break jinja2 templates have simple jinja2 template that upload to remote server using ansible name generate configuration file template src test j2 dest test test conf the test j2 template contains private ip address private ip everything works fine if the template does not contain any utf characters the private ip variable is substituted for the correct value but when add word utf characters to the template file private ip address wrocaw private ip the template will be copied to the remote server unchanged ansible won complain about this even in verbose mode it will just happily upload the template without any changes like it was binary file using python on debian jessie 64 bit with default locale set to en us utf with fresh checkout of ansible straight from github reverted to ansible it doesn have this problem >>>bug_report
update guide gce rst make the docs more specific >>>docs_pull_request
gce py dynamic inventory fails followed the guide here http docs ansible com guide gce html gce dynamic inventory copied the `gce ini` and put it my `gce service account email address` `gce service account pem file path` and `gce project id` everything without or installed libcloud via pip when run `gce py` when also specify `gce ini path gce ini` have no real idea what is going wrong any ideas >>>docs_report
jinja filter password hash does not work correctly hi have tried to generate encrypted password hash with password hash filter but it gives me wrong results test playbook got result debug msg pass 6ftpwxl4wvg when encrypted string should be something like djcpqaxy eqkcqofe9ljcjruff2mc9adju 4hlvhx0 i4isgbsinuhmj f88l qyffcc73qcjohgkh4ucajqqivqbh jse have got same kind result with sha1 sha256 filters also my ansible version is on osx yosemite any help would be appreciate br sami niemi >>>bug_report
lookup file xxx not working at all in v2 echo test test cat playbook yml ansible playbook playbook yml vvv task test establish local connection for user jaseclamp fatal localhost failed failed true exception traceback most recent call last file library python site packages ansible py2 egg ansible executor process worker py line 118 in run executor result taskexecutor host task job vars new connection info self new stdin self loader shared loader obj run file library python site packages ansible py2 egg ansible executor task executor py line 107 in run res self execute file library python site packages ansible py2 egg ansible executor task executor py line 226 in execute self task post validate templar templar file library python site packages ansible py2 egg ansible playbook task py line 191 in post validate super task self post validate templar file library python site packages ansible py2 egg ansible playbook base py line 258 in post validate value templar template getattr self name file library python site packages ansible py2 egg ansible template init py line 176 in template self template convert bare convert bare file library python site packages ansible py2 egg ansible template init py line 158 in template result self do template variable preserve trailing newlines preserve trailing newlines file library python site packages ansible py2 egg ansible template init py line 268 in do template res j2 concat rf file line in root file library python site packages jinja2 runtime py line 193 in call return obj args kwargs file library python site packages ansible py2 egg ansible template init py line 220 in lookup ran instance run args variables self available variables kwargs file library python site packages ansible py2 egg ansible plugins lookup file py line 57 in run ret append contents rstrip nattributeerror tuple object has no attribute rstrip stdout ansible version any ideas was forced to upgrade to to use digital ocean api v2 but now this lookup file that was working is no longer working anywhere is there workaround >>>bug_report p1
copy play instead calls file module when dest is symlink with checksum matching the source issue type bug report ansible version ansible configuration the playbook being run is bit strange and can elaborate if necessary but boils down this am running copy via local action where the source is file and the destination is symlink environment freebsd 10 release p9 amd64 summary the situation have play that calls the copy module via local action if that is relevant the source file is regular file the destination path is symlink the target of which has checksum matching that of the source based on the docs and behavior when the checksums do not match expect that the symlink should be replaced with copy of the file however on the first run of the play the symlink is replaced with bogus symlink to the basename of the source file on the second execution of the play this is rectified this issue seems similar to 10190 not sure if they are related excuse any python ignorance that follows steps to reproduce this is the play in question name copy host specific nslcd conf when host nslcd config path is defined run once true local action copy src config root host nslcd config path dest pxe nfs root image name usr local etc nslcd conf backup yes owner root group wheel mode 0644 force yes as described above the source is regular file the destination is symlink that points at file the checksums match between the source and the file pointed at by the symlink the particular line in the source that appears to control this errant behavior is in usr local lib python2 site packages ansible runner action plugins copy py line 203 if the checksums match the file module is called instead which based on the provided parameters causes bad behavior if change this line to read if local checksum remote checksum or os path islink dest file the behavior is correct although have no idea what the unintended consequences of this change are for example before running the play source file ll common nslcd conf cluster rw rw tom tom 732 may 26 13 07 common nslcd conf cluster destination file ll usr local etc nslcd conf lrwxr xr root wheel 35 apr 14 16 44 nslcd conf common nslcd conf cluster running the play the first time causes the existing symlink to be re pointed at the basename of the source file destination file ll usr local etc nslcd conf lrw root wheel 18 jun 11 16 47 nslcd conf nslcd conf cluster running the play second time yields the correct behavior destination file ll usr local etc nslcd conf rw root wheel 732 jun 11 18 37 nslcd conf expected results expected to see the results of the second run shown above on the first run >>>bug_report
unable to pass in list of roles to playbook as json list via extra vars issue type bug report ansible version ansible configuration my installation is clean with no customizations and done through `pip` environment mac osx 10 10 summary am trying to dynamically set the included roles in playbook using the extra vars variable and the feature built in json support minimal playbook the command trying to run steps to reproduce copy my minimal playbook run the command listed above observe the stacktrace expected results my playbook should run and should be able to specify an arbitrary number of roles through the extra vars parameter actual results ansible chokes and spits out it seems there is problem when passing in collection of size the existing workaround is to add dummy entries to the list >>>bug_report
all async tasks now fail with typeerror in latest devel version issue type bug report ansible version ansible devel aed429554d last updated 2015 06 11 15 40 21 gmt 000 lib ansible modules core detached head 9acc7c402f last updated 2015 06 11 15 40 23 gmt 000 lib ansible modules extras detached head 2f967a949f last updated 2015 06 11 15 40 24 gmt 000 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 11 15 40 25 gmt 000 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 11 15 40 27 gmt 000 configured module search path none ansible configuration environment amazon linux 14 42 31 38 amzn1 x86 64 summary after upgrading to the latest devel version of ansible all of my async tasks now fail returning the following error typeerror low level execute command got an unexpected keyword argument task vars using git bisect was able to identify that this bug was introduced in the following commit ee5e166563ca01a556a921b177a632ea5c2f1a44 steps to reproduce ve created simple playbook that consistently demonstrates the failure expected results expect the playbook execution to pass actual results >>>bug_report p1
variable precedence vars prompt to load after vars post vars prompt currently var prompt runs before any variables are set feel global vars should be loaded before vars prompt is initiated this would allow you to quickly change the default of vars prompt used across many playbooks by setting it to global variable in my case have specific ami that want to us in var prompt as the default but want the ability to specify another when needed have this prompt in almost every playbook and since the default ami use is always changing as we upgrade and patch os it should be easy to set with one variable across all playbooks think better system would be as follows specify variables in global vars like and have this in each playbook have what would the reasons not to do this be >>>feature_idea
dynamic inventory static group vars not loading group vars related issues https github com ansible ansible issues 8605 https github com ansible ansible issues 6563 ansible like to load some variables for newly created aws ec2 instances from my static inventory would like to define ansible ssh user for dynamic group do create some ec2 instances with playbook as in basic example do have static group vars defined group vars tag name demo but when lunch ansible ping tag name demo vvv establish connection for user xxxxx so the files are not read thought that the inventories are not combined so did create directory combining static and dynamic inventory but no luck ansible ping tag name demo vvv inv establish connection for user xxxxx was sure that ansible would match group vars from static inventory and assign proper variables for groups in dynamic inventory any suggestions probably there is some step missing or based on provided issues top of the post this is some bug offtopic http grokbase com gg ansible project 149bqh8m05 setting host vars programmatically with dynamic inventory >>>bug_report p2
bug report ipv6 inventory im trying setting up ansible with ipv6 have groups setup in etc ansible hosts and passing the group as an argument to the script with extra vars hosts groups are defined like this group group vars some vars here group children group child1 group child2 group child1 xxxx xxxx xx xx xxxx xxxx xxxx group child2 more ipv6 addresses have tried to escape the ipv6 address with and when run playbook ansible can gather the facts but stops the playbook immediately after that with no hosts matched similar setup with ipv4 works fine passing extra vars hosts ipv6 address gives no hosts matched before the facts get gathered but if pass the group name instead of the address ansible gathers the facts succesfully but rest of tasks isnt run no hosts matched tested on ansible versions and 91 >>>bug_report
comment to ec2 ini inventory instances grouping warning about usage boto ec2 ini had problem that mine instances were not presented in ec2 py refresh cache it did appear that instances without key variable in my case instances in vps did not have ip address they only have private ip address won be presented on the list so be warned this comment should help to clarify the issue >>>docs_pull_request
changelog add cs network>>>feature_pull_request
v2 fixed logic when looking up become attribute issue type bugfix pull request ansible version ansible configuration nothing has changed in my configuration since this broke with the v2 code environment os 10 10 python summary currently when trying to change the `become` value from global `yes` to task level `no` does not work steps to reproduce the following playbook is able to reproduce this for me expected results actual results >>>bugfix_pull_request needs_revision
fixes 11216>>>needs_revision
v2 delegate to is no longer templated issue type bug report ansible version ansible configuration nothing has changed since this was working with the v1 stuff environment os 10 10 python default sep 2014 15 04 36 remote is amazon linux summary `delegate to` on the new v2 branch no longer allows you to use variables for what host should be used as the delegate need to template this because the hosts to delegate to change with the different environments use ansible against steps to reproduce expected results actual results with more debugging notice aboe that is showing up for the host being used as the delegate notes made temporary fix on my end but don think that it is correct long term fix for this issue placed template in the easiest place that could find the `delegate to` variable used here the diff anyways >>>bug_report p1 pending_closure
update playbooks vault rst as of at least you may specify password file in your ansible cfg and not have to extend your playbook calls with vault flags >>>docs_pull_request
zero length `notify` list causes typeerror and traceback noticed this after typo in my playbook running on os 10 10 looks like zero length `notify` list or yaml array causes type error and traceback because `nonetype` doesn have len assume you want this to trigger syntax warning or something rather than traceback can probably do pr if you re interested >>>bug_report
ansible ignoring private key option ansible temp inventory root private key keyfile rsa ping all works in ansible and see identityfile keyfile rsa in the vvvv output with ansible devel f2934eeb0a the same exact command fails and the vvvv output doesn contain the keyfile in any output >>>bug_report
cloudstack cleanup remove unused parts >>>bugfix_pull_request
update readme md there are over 1000 contributors now >>>docs_pull_request
win copy and win file documented but missing the win copy and win file modules are documented as existing but they are missing from the latest release of ansible http docs ansible com win copy module html http docs ansible com win file module html j>>>docs_report
ansible pull add option to verify gpg signature of commit add option verify commit to verify gpg signature of the checked out commit as noted in the git module documentantion this requires git version this needs the new git module option `verify commit` introduced in issue ansible ansible modules core issues 1491>>>feature_pull_request
fixes issue where hostvars are not loaded in the host object proposed fix for 11217 which actually happens because the hostvars are not loaded into the host object but loaded only into varialblemanagers host vars files the connection object uses host get vars method to set the connection variables and since the hostvars are not available there it uses the default values >>>bugfix_pull_request
winrm stops working in latest trunk revision issue type bug report ansible version ansible configuration clean check out from git environment ansible control machine fedora 19 ansible target windows 2008 r2 sp1 summary since update to latest trunk winrm stopped working not sure if it due to misconfiguration but things were working fine before update trunk etc ansible hosts contain machine under windows etc ansible group vars windows yml contains steps to reproduce expected results ansible should run winrm module and pong the ping actual results seems ansible is not using winrm attempt to force winrm for target machine >>>bug_report p2 windows
ansible distribution is na on arch linux ansible localhost setup filter ansible distribution 127 success ansible facts ansible distribution na changed false >>>bug_report
remove duplicated by default in docs>>>docs_pull_request
ansible pull not working on head issue type bug report ansible version on `head` currently 8e3213a ansible configuration running this on clean enviroment on virtual env environment summary unless missing something obvious since the move to v2 think ce3ef7f4c16e47d5a0b5600e1c56c177b7c93f0d and 0b836262f0720bf6b95761095bbaaf44046973c2 ansible pull is not working for example commit 0b83626 removes the sys import line while it used couple of lines later ce3ef7f4c16e4 seems to remove the `cmd functions py` file in v2 which ansible pull is depended upon there are numerous other issues preventing ansible pull from running this is just short list steps to reproduce expected results expected `ansible pull` to run actual results cc ing bcoca who has written one of the above commits >>>bug_report p1
cloudstack prevent getting the wrong project since we use domain and account data to filter the project listall is not needed and can return the wrong identical named project of another account if root admin permissions are used fixed projects names are not case insensitive >>>bugfix_pull_request
accelerated mode not working with vagrant and forwarded port hey there thanks for your awesome library discovered problem locally which is bit sad cause try lot locally before deploy something to live if use `accelerate true` in my playbook and have host to provision which is cascaded behind port forwarding from vagrant the ssh acceleration port is not openend stacktrace is that one here is the vagrant config section for that host in that machine checking for open ports when trying to run an accelerated run which displays to me there is no open port whereas when use the ip vms directly not 127 then there will be an open port on `0 5099` my inventory config section looks like this searched for an answer already but since discoverd the missing listening port in the vm suspect this is misbehaviour not misconfiguration if you want me to prepare complete example please let me know thanks in advance best andi>>>bug_report
ec2 asg documentation wrongly declares the launch config name atribute as not required when using ec2 asg get task ec2 asg failed localhost failed true msg missing required arguments for autoscaling group create update launch config name where is in the module man page http docs ansible com ec2 asg module html this attribute is listed as not required this is on ansible 1>>>docs_report
add an example of multiple plays in single playbook lot of people are surprised to find that playbook can contain multiple plays this adds an explicit section to the playbook intro describing the idea with an example >>>docs_pull_request
clarify reason for failure saying will not have been written is misleading as the file probably existed before the sync timeout value elapsed >>>docs_pull_request
anisble fails to alert when modules are missing is there changes in yml format in ansible dev latest have simplest playbook that works fine with ansible but fails with dev latest playbook file running against ansible running against dev latest >>>bug_report p2
`allow duplicates` does not allow role and its dependencies to be run multiple times issue type bug report ansible version ansible configuration environment mac osx 10 summary roles that are included multiple times cannot have their dependencies included multiple times the documentation states that `allow duplicates` accomplish something like this so long as the dependency is included multiple times from the same role but it does not seem to work for the aforementioned case steps to reproduce here simple set of playbooks roles that should illustrate the problem expected results running the first playbook `hypervisor yml` should give output that shows disk is set up for both `red` and `blue` as well as the installation of the vm for both actual results note the disk is only set up for `red` and is skipped for `blue` >>>bug_report
playbooks intro should link to best practices for playbook naming issue type documentation report ansible version ansible configuration environment summary the playbooks intro https github com ansible ansible blob devel docsite rst playbooks intro rst doesn discuss how playbooks should be named if such best practices doc exists it be great to mention it in the intro the use case here is that following along with the intro guide to spin up toy server managed with ansible and am totally overthinking what to call the files think that guidance on how to name playbooks could also contain useful advice on how to scope them and at what point to break large playbook into smaller ones which steps to reproduce read the docs without prior knowledge of playbook naming best practices expected results expected some guidance on what to call playbooks actual results had to go look it up and dig around in https github com ansible ansible examples only to find that most of the filenames were very generic >>>docs_report
unrelated env vars can break ansible templates this broke when we upgraded from to >>>bug_report needs_info
copy task fail ansible version ansible environment localhost osx yosemite summary have run playbook results on task copy php fpm conf have got weird message >>>bug_report needs_info p2
windows test yml fails on chinese windows issue type bug report ansible version root lsc102 ansible examples ansible version ansible devel 8cf4452d48 last updated 2015 05 04 15 01 24 gmt 800 lib ansible modules core detached head 9028e9d4be last updated 2015 05 04 15 01 44 gmt 800 lib ansible modules extras detached head dd80fa221c last updated 2015 05 04 15 02 00 gmt 800 v2 ansible modules core detached head 0341ddd35e last updated 2015 05 04 15 02 16 gmt 800 v2 ansible modules extras detached head dd80fa221c last updated 2015 05 04 15 02 37 gmt 800 configured module search path none ansible configuration clean yum install ansible on fedora 19 environment ansible host fedora 19 ansible target windows 2008 r2 sp1 chinese hong kong summary running ansible examples windows test yml fails believe it due to ipconfig displaying chinese characters target windows has default chcp 950 unicodedecodeerror ascii codec can decode byte 0xb0 in position 49 ordinal not in range 128 steps to reproduce change windows system locale to chinese hong kong requires reboot in command line run ipconfig and see that its output should be in chinese chcp 950 root lsc102 ansible examples ansible playbook windows test yml expected results expect the execution to pass actual results note the ipconfig task will success if change the system locale back to english united states >>>bug_report needs_info windows
included task file in role always report changed state issue type bug report ansible version ansible environment localhost debian jessie 16 amd64 summary included task file in role is shown as included during the run of the playbook but is always marked as changed steps to reproduce create dummy role dummy tasks main yml tasklist yml inside main yml include tasklist yml name include list of tasks include tasklist yml and inside tasklist yml name ensure myfile exists copy content this is my file dest tmp myfile put this role inside playbook and run it twice the first time there will be changed tasks one for the include task and one for the copy task and then the second time the include will be marked as changed you can try to include as much taskfile as you want it will increase the number of changed tasks expected results included task file are marked as included and should not report changed state since they will be included each time the playbook run play task setup ok localhost task dummy include list of tasks included tasklist yml for localhost task dummy ensure myfile exists ok localhost play recap localhost ok changed unreachable failed actual results play task setup ok localhost task dummy include list of tasks included tasklist yml for localhost task dummy ensure myfile exists ok localhost play recap localhost ok changed unreachable failed even if you add changed when false to the include task the result is the same >>>bug_report p2
hosts setting being ignored when using connection local issue type bug report ansible version ansible configuration defaults environment ubuntu 14 10 64 bit running on virtualbox 28 on windows 64 bit via vagrant summary am running ansible within ubuntu vm using connection local` for some reason the playbook will play everything even for ones that do not match the hostname of the machine steps to reproduce create inventory file create playbook files playbook yml mesos master yml mesos slave yml run the playbook `ansible playbook playbook yml inventory file inventory connection local` expected results assuming that the machine hostname is `mesos master 01` the `mesos master` playbook should be played and only tmp is master` should exist actual results both the `mesos master` and `mesos slave` playbooks are played both tmp is slave` and tmp is master` exists >>>bug_report
fix confusing wording about aliases new to ansible when reading through this section of the install docs was confused about what file the `jumper ansible ssh port 5555 ansible ssh host 192 168 50` line was supposed to be an example of because the aliases that don live in your host file wording made it sound like the aliases were supposed to live elsewhere tried putting an equivalent line in the hosts file of the toy project playing with and it worked so pretty sure it actually does go there please double check that the new wording is factually accurate all did was test that the code runs >>>docs_pull_request
don test for play become pass any longer in 11183 we removed the ability to set `become pass` at the play level this is now causing tests to fail this pr removes those tests note believe we still allow setting `become pass` at the task level that will need to be addressed in in separate effort >>>bugfix_pull_request
raise ansibleparsererror instead of assertionerror currently if there is parser error we raise an assertionerror in several functions instead of ansibleparsererror this causes traceback and doesn cause ansible to print useful message this pr converts the assertionerror to ansibleparsererror traceback helpful error >>>bugfix_pull_request p1
add missing import in vault py this pr adds missing import `read vault file` to fix the following error >>>bugfix_pull_request p1
to yaml and to nice yaml no longer output data faithfully in in the same is true for `to yaml` >>>bug_report p2
reverses delegate to host and remote host reverses the delegate to host and the managed host fixes 11067 patched against the devel branch >>>feature_pull_request
get tests passing the largest failure in the tests was due to selinux not being installed the tests don require it to be installed so mock the import this pr is likely to fail due to the fix needed in 11186 however in my earlier test here is the success https travis ci org sivel ansible jobs 65631561 additional fixes use the correct data type for failed hosts` and unreachable hosts` use the correct fixture data when comparing distributions>>>bugfix_pull_request p2
add feature to run only tasks that have all of the given tags https groups google com forum topic ansible project kzegm9ijvrm>>>feature_idea
package manager optimization results in unexpected behaviour with complex package names faced the problem when tried to install several packages with similar names using with items to generate package names here is the code example expected ansible to do the following but got the error message had been confused with this message some time spent in checking my syntax and trying different ways to give the variable vlue to with items with or not inside or not with or not tried to replace with items with with flattened but it has no effect placed debug before real task and saw that it can recognize the list given in varable became to search for help in google but it hard to explain to search engine what are you looking for when you have no idea so suddenly found conversation about bug with yum year 2013 version where one of ansible developers told that he switched off optimization for non string item values suggested that it can be another or the same optimization for apt module and started to learn and inspect code ve found that runner tries to join items using delimiter and it crashes my playbook it seems that should be done one of things or both of them which will be much better because this is not the first bug with this optimization and nobody knows when this code will shoot again optimization should be more smart and work only when the name field value does not contain anything except item documentation should have notes about this optimization package managers has unique behaviour here and it should be explicitly noted by documentation for package modules and in loops documentation section >>>feature_idea
don empty out become pass see 11169 this pr ensures that the `become pass` supplied via the cli prompt does not get emptied out become pass is not part of `options` so we don need to try to set it in `set options` and only set it from the play if it is actually set there is still more work to do to solve 11169 but this is start >>>bugfix_pull_request p1
update current released ansible to update current released ansible to and development version to in documentation to avoid confusion >>>docs_pull_request
ansible hacking env setup doesn work to use ansible hacking test module trying to follow the testing modules http docs ansible com developing modules html testing modules instructions fails at the ansible hacking test module timetest py stage but sourcing ansible v1 hacking env setup works >>>bug_report p2
ansible galaxy install throws an error when the role file option is used issue type bug report ansible version environment debian summary ansible galaxy install throws an error when the role file option is used steps to reproduce expected results great success actual results >>>bug_report p1
ec2 group failure when proto is either 50 or 51 hi am having the following issue when applying the variable set below `` it will work on the 1st run but on the second will have have tried specifying ports also nothing seems to work if say tcp or udp it works fine but when specify numeric port as above got the issue any possible workaround >>>bug_report cloud
hostvars lookup fallback logic not working as expected like to look up value in `hostvars` if it exists otherwise fallback to just returning the key using to do the lookup if the host doesn exist ansible yells and says `host not found whatever the key is` which makes sense to degree but would think using jinja pipe would catch that as failure and just use the default value example here how `mysql users expanded` looks note ve tried condensing this to just the problem encountering if you like more context check out the server fault question http serverfault com questions 696405 using ansible to provisioning users modify facts expand hostvars >>>bug_report
ansible cfg lookup paths for ansible playbook would ya ll be open to pr that adds new location for finding `ansible cfg` would like for `ansible playbook` to search sibling to the playbook being used think it should be possible to run `ansible playbook` from any directory without modifying global or per user configuration files and have customized `ansible cfg` settings respected proposing lookup precedence of ansible config an environment variable ansible cfg in the current directory ansible cfg sibling to the playbook when ansible playbook is used ansible cfg in the home directory etc ansible ansible cfg understand this wouldn make sense for the `ansible` command but hopeful that isn considered an issue >>>feature_idea
default omit filter doesn work with dictionary values given this playbook main yaml and this role roles python app tasks main yaml the playbook fails on the some other python app hosts with an error environment must be dictionary received omit place holder c474fb1160e3edc29166ca21a4eb7aa620a5e2b3>>>bug_report
use of failed when in v2 always results in fatal issue type bug report ansible version ansible devel f3f3fb7c49 last updated 2015 06 04 14 05 18 gmt 400 lib ansible modules core detached head b138411671 last updated 2015 06 04 13 35 34 gmt 400 lib ansible modules extras detached head 1276420a3a last updated 2015 05 31 18 53 16 gmt 400 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 02 18 10 20 gmt 400 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 02 18 10 33 gmt 400 configured module search path none summary any use of failed when in v2 results in failure including command exit with rc behavior in v1 is as expected steps to reproduce https gist github com shawnferry b1ffad1508927cc58047 expected results failed when false should never fail task actual results any use of failed when task execution >>>bug_report p2
source v1 hacking env setup python can open file setup py as discussed here https goo gl tsz4cm issue type bug report ansible version ansible version ansible devel f3f3fb7c49 last updated 2015 06 04 14 11 06 gmt 500 lib ansible modules core detached head b138411671 last updated 2015 06 03 00 37 46 gmt 500 lib ansible modules extras detached head 1276420a3a last updated 2015 06 03 00 37 50 gmt 500 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 03 00 37 54 gmt 500 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 03 00 37 58 gmt 500 configured module search path none ansible configuration git pull git submodule update init recursive environment os yosemite 10 10 python python pip freeze ansible ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos markupsafe 23 nose paramiko 15 passlib pycrypto pywinrm pyyaml 11 six xmltodict summary source v1 hacking env setup cannot find the setup py in the posting at https goo gl tsz4cm it says switch back to using the old v1 codebase from git checkout simply source the hacking script in the v1 directory instead steps to reproduce source v1 hacking env setup python can open file setup py errno no such file or directory setting up ansible to run out of checkout expected results be able to use the v1 ansible code base actual results python can open file setup py errno no such file or directory >>>bug_report p2
sudo password broken after v2 modules merge issue type bug report ansible version ansible configuration nothing has been changed the inventory file is simple file with single ip with no host group variables environment tested in ubuntu 15 04 and osx 10 10 but very likely affects all os summary ever since the v2 modules merge using sudo with password no longer works it simply hangs until sudo times out this is likely due to code that was commented out during the v1 v2 transition https github com ansible ansible blob f3f3fb7c491effe9e61ae5a429ac796558c2963a lib ansible plugins connections ssh py l313 steps to reproduce run any ansible command with sudo` expected results ansible uses sudo password and runs the command successfully actual results hangs until sudo times out for example >>>bug_report p1
resync the v1 directory with v1 last fixes 11162 this pr resyncs the v1 directory with the v1 last branch as it is the v1 directory does not contain working copy of ansible see 11162 maybe as an alternative we should just delete the v1 directory altogether and just go with recommending use of the v1 last branch >>>bugfix_pull_request p1
fetch url is missing imports calling fetch url from module utils urls py results in the error nameerror global name get distribution is not defined and if this is worked around results in the error nameerror global name sys is not defined didn test any further than this but it seems like this file is missing import statements >>>bug_report needs_info p2
fixed github examples directory url>>>docs_pull_request
revert replacement please have look to this comment https github com ansible ansible commit c7f33627950d352cdca46f71c93b0783981b8c89 for further discussion >>>bugfix_pull_request cloud needs_revision
ansible mount facts in addition to array of mounts this change adds enumerated ansible mount with one special case for as root it does not change the existing ansible mounts array based on the assumption that someone is already using the other facts as they are today this allows direct selection of mount by name instead of looping over the list of all mounted filesystems to find the desired mount ansible mount orahome device dev mapper vg lv orahome fstype ext4 mount orahome options rw size available 200443834368 size total 211378954240 uuid ansible mount root device dev mapper vg lv root fstype ext4 mount options rw size available 10591088640 size total 15919398912 uuid full example output before and after https gist github com shawnferry 0c0cb623495e1f6bc715 >>>feature_pull_request
re introduce ssh connection private key support this pr addresses fixme in the ssh connection plugin to pull the `private key file` from connection info >>>bugfix_pull_request p1
v1 out of sync in devel the v1 directory appears to be out of sync in the devel branch `module common py` is looking for `constants default selinux special fs` which doesn exist see that in `stable 9` those files are in sync >>>bug_report p1
ovirt dynamic inventory used gce py as template to create an ovirt dynamic inventory script>>>feature_pull_request
rds module needs encryption at rest parameter there no parameter for this in the documentation this can only be enabled at creation time so it important to have available assuming it available via the api >>>cloud feature_idea p2
failed handlers are run multiple times easy to reproduce issue where any handler that has error is retried thrice is this by design why is this behavior different from normal tasks >>>bug_report
memory leak in devel issue type bug report ansible version ansible 14356 7dd3ef7 ansible configuration external inventory 738 nodes total with meta information total size of json generated by the external inventory is 324 537 bytes 64 forks environment running ansible from archlinux managing ubuntu 12 04 centos and xenserver and summary the latest devel branch uses approx 469 mb of memory to complete the same task that the stable branch does with approx 245 mb of memory steps to reproduce using reasonably large inventory ping 100 nodes while watching memory usage ran `free m` at second intervals while running on `ansible 14356 7dd3ef7 1` this produced on `ansible 13570 b70caac 1` this produced it took quite bit longer on `ansible 13570 b70caac 1` which is why there are so many more entries but you can see the memory usage is much less drastic expected results memory usage should be relatively flat after initially loading ansible actual results memory usage increases dramatically during ansible execution >>>bug_report p2
got error for shell with grep highlighting not work shell with grep pipline shell find test path name requirements txt exec cat grep shell find test path name requirements txt exec cat grep shell find test path name requirements txt exec cat grep test shell find test path name requirements txt exec cat grep test shell find test path name requirements txt print0 xargs cat grep shell find test path name requirements txt print0 xargs cat grep shell find test path name requirements txt print0 xargs cat grep test shell find test path name requirements txt print0 xargs cat grep test with next message failed test instance changed true cmd find test path name requirements txt exec cat grep delta 00 00 003797 end 2015 06 03 21 40 57 502797 rc start 2015 06 03 21 40 57 499000 warnings fatal all hosts have already failed aborting when replace `grep something` for example to `tail` all work this commands also work fine on shell on instance for bash and sh also this work for python `subprocess popen` with shell true >>>bug_report needs_info
errors is undefined in hashing py my team encountered the following error today it looks like in tag `1 rc1` this isn fixed but it is fixed in `devel` not sure how the branching policy is interacting with the upcoming and releases so thought open bug just in case it be great to have this fixed in >>>bug_report p2
new lookup plugin merged dicts input list of dictionaries order is important output single dictionary with all the keys from the source dictionaries and values from the last dictionary in the input list which contained the given key>>>feature_pull_request
inventory file variables int vs str failed with error version info ansible devel d8c8ca11cf last updated 2015 06 03 12 29 49 gmt 400 lib ansible modules core detached head b138411671 last updated 2015 06 02 13 10 38 gmt 400 lib ansible modules extras detached head 1276420a3a last updated 2015 05 29 09 20 33 gmt 400 v1 ansible modules core detached head f8d8af17cd last updated 2015 06 02 13 11 12 gmt 400 v1 ansible modules extras detached head 495ad450e5 last updated 2015 06 02 13 11 44 gmt 400 configured module search path none inventory file playbook error output how to make it work changing the inventory file to zookeeper myid from to working output etc zookeeper conf myid >>>bug_report needs_to_be_moved
ssh error the output was am getting very strange error when running my ansible playbook on some newly created openstack vms it seems that ansible ssh is throwing an error while can still ssh using my private key and also by using the `nova ssh` command the error is very short and non descriptive so please let me know if you need to see some other files from me since am little new and not quite sure how to make this error more verbose here is the error here is some system info this is very fresh centos vm >>>bug_report p2
conditionals inconsistent order of evaluation in loops issue type bug report maybe depending on assessment ansible version ansible version ansible configured module search path none ansible configuration default configuration environment control machine ubuntu 14 04 target machines ubuntu 14 04 summary how collection variable is specified in loop direct vs templated seems to have an influence on the order of evaluation in the direct case an associated conditional is evaluated before the collection making it possible to test the collection existence in the templated case it the other way around steps to reproduce run the following playbook hosts 127 connection local gather facts false tasks this works task is skipped debug msg do stuff with item with items nonexistent list when nonexistent list is defined this fails instead of being skipped debug msg do stuff with item with items nonexistent list when nonexistent list is defined expected results for the second task in the playbook skipping 127 item nonexistent list actual results fatal 127 with items expects list or set >>>bug_report
local action fails with sudo issue type bug report ansible version ansible from macports ansible from epel ansible el6 noarch ansible configuration default environment management host rhel 6u5 mac os 10 10 yosemite target machines rhel centos summary `local action` for host fails when the inventory entry for that host uses sudo this used to work fine in ansible through but it started failing in it looks like ansible tries to apply the `ansible sudo` for host onto the localhost which is obviously incorrect `local action` should work on localhost with local connection just like it did before steps to reproduce create two vms with centos inventory file centos6vm1 ansible ssh host 192 168 239 129 ansible ssh user erik ansible sudo yes ansible sudo pass test1234 centos6vm2 ansible ssh host 192 168 239 132 vm centos6vm1 centos6vm2 example playbook hosts vm tasks name test shell local action shell touch ansible test inventory hostname creates ansible test inventory hostname expected results ansible playbook filetest yml limit centos6vm2 play vm gathering facts ok centos6vm2 task test shell changed centos6vm2 127 play recap centos6vm2 ok changed unreachable failed actual results ansible playbook filetest yml limit centos6vm1 play vm gathering facts ok centos6vm1 task test shell failed centos6vm1 127 failed true parsed false sorry try again sudo via ansible key lgxsqaofduqkpnkskndzomckmkrxfddh password sudo incorrect password attempt fatal all hosts have already failed aborting play recap to retry use limit users erik filetest retry centos6vm1 ok changed unreachable failed >>>bug_report p2
import missing mutablemapping class for module docs currently building the docs is failing right now due to missing import this pr addresses this by importing `mutablemapping` >>>bugfix_pull_request
don set default on the become fieldattribute this pr addresses 11136 ultimately it looks like because the become` `fieldattribute` was being defaulted to `false` it was overriding the specification of become` on the cli removing the default seems to work with `ansible` and `ansible playbook` both with setting `become` to `true` `false` in the playbook or via the command line value of `false` in the playbook overrides the cli >>>bugfix_pull_request p1
with items accepts single string which could be source of trouble issue type bug report maybe depending on assessment ansible version ansible version ansible configured module search path none ansible configuration default configuration environment control machine ubuntu 14 04 target machines ubuntu 14 04 summary we use `with items` extensively to loop over collection variables like this debug msg do stuff with item with items collection variable when `collection variable` is undefined we expect ansible to throw an error instead the name of the variable is taken literally and is passed as the only item of one element colletion to the task this way misspelled variable name could lead to all kinds of unwanted side effects steps to reproduce run the following playbook hosts 127 connection local gather facts false vars existing list foo bar baz tasks this does stuff to items foo bar baz debug msg do stuff with item with items existing list this should fail imo instead of doing stuff to an item called nonexistent list debug msg do stuff with item with items nonexistent list expected results an error in the vein of fatal 127 one or more undefined variables nonexistent list is undefined actual results ok 127 item nonexistent list item nonexistent list msg do stuff with nonexistent list >>>bug_report
add common fonctions for f5 modules fq name functions complete the common f5 functions>>>feature_pull_request
importerror no module named six moves issue type bug report ansible version ansible version traceback most recent call last file users tanner projects ansible git ansible bin ansible line 39 in from ansible utils display import display file users tanner projects ansible git ansible lib ansible utils display py line 28 in from ansible import constants as file users tanner projects ansible git ansible lib ansible constants py line 26 in from six moves import configparser importerror no module named six moves git show commit 3e2e81d896067170e72ca2999fe84c1ba81b9604 author brian coca ansible configuration did june 12 28am cdt git pull git submodule update init recursive environment os yosemite 10 10 python version python pip freeze ansible ecdsa 13 epdb 12 httplib2 isodate jinja2 kerberos markupsafe 23 nose paramiko 15 passlib pycrypto pywinrm pyyaml 11 xmltodict summary https github com influxdb influxdb python issues says dependency on six is removed in but after the pull cannot get ansible to run steps to reproduce git clone git github com ansible ansible git cd ansible git pull git submodule update init recursive source hacking env setup ansible version expected results ansible version actual results traceback most recent call last file users tanner projects ansible git ansible bin ansible line 39 in from ansible utils display import display file users tanner projects ansible git ansible lib ansible utils display py line 28 in from ansible import constants as file users tanner projects ansible git ansible lib ansible constants py line 26 in from six moves import configparser importerror no module named six moves>>>bug_report p2
fix for task executor on os get this exception during the setup task attributeerror connectioninformation object has no attribute remote pass believe it is supposed to be looking at the password attribute either that or we should create remote pass attribute in connectioninformation >>>bugfix_pull_request p2
handle when role dependencies is none for some roles role dependencies will be returned as none instead of an empty list coerce it to an empty list >>>bugfix_pull_request
new lookup plugin merged dicts input list of dictionaries order in the list is important output single dictionary containing all the unique keys from all the input dictionaries with values from the last dictionary found in the list note other than the merging function it acts just like with dict >>>feature_pull_request needs_revision
add missing import in ansible cli this pr adds missing import in `ansible cli` if `display` is `none` in the `cli` class display will need to be initialized with `display` which hasn been imported>>>bugfix_pull_request p2
validating roles supported platforms from meta main yml issue type feature idea ansible version ansible configuration environment summary validating roles supported platforms from `meta main yml` and start provisioning only if all applied roles support the current os without implementing this in any applied role to ensuring clean host provisioning state steps to reproduce expected results validating roles supported platforms from `meta main yml` and start provisioning only if all applied roles support the current os ansible should output something like this actual results playbook is executing without checking if the current os is supported and fails including an unclean host provisioning state actually you have to do that manually in your role like >>>feature_idea
ansible ssh user not being picked up updated the latest version and ansible is not picking up the ansible ssh user in my group vars if specify it on the command line it works fine development yml group vars allservers yml >>>bug_report p1
don override ansible ssh host with inventory hostname this pr addresses 11130 it seems that this line was added before connectioninformation was fully functional and does not appear to be needed any longer >>>bugfix_pull_request p1
ansible ssh host is overriden in `ansible inventory host` `ipv4 address` is set to the inventory hostname https github com ansible ansible blob d1b43712870f5331a58abe115911725619264ca5 lib ansible inventory host py l78 later in `ansible executor task executor get connection` `self connection info remote addr` is set to the `ipv4 address` https github com ansible ansible blob d1b43712870f5331a58abe115911725619264ca5 lib ansible executor task executor py l374 before that re assignment in get connection` `remote addr` is correct after that assignment it is now the inventory hostname am not sure what the correct fix is but removing the re assignment in get connection` seems to resolve the issue for me >>>bug_report p1
fix command building for scp if ssh currently with `scp if ssh` set to `true` you will get the following traceback this pr fixes this by error and additionally normalizes appending to the command >>>bugfix_pull_request p2
created makedirs safe function for use in cases of multiprocess should fix 11126 and most race conditions>>>bugfix_pull_request p2
race condition in fetch module in ansible lib ansible plugins action fetch py at lines 128 and 129 there is race condition 128 if not os path isdir os path dirname dest 129 os makedirs os path dirname dest if the destination directory does not exist this code attempts to create it however if multiple python threads are doing this simultaneously it is possible for one thread to create the directory in the interval between the test on line 128 and the create on line 129 when that happens the losing thread throws oserror errno 17 file exists several solutions are discussed here http stackoverflow com questions 12468022 python fileexists error when making directory >>>bug_report p2
ec2 eip documentation not correct in documentation there is no required options mentioned http docs ansible com ec2 eip module html but when you try to add eip with public ip and instance id it throws error ec2 url or region is required >>>docs_report
use decorator to perform just in time connection copy of 11002 now against the devel branch this pr adds new ensure connect decorator for connection plugins it function is to decorate method requiring connection to be open the replaces the explicit call to connect why calling connect explicitly as it is causes the connection plugin to connect to remote host sometimes needlessly such as when running an action plugin that does not need connection such as set fact this change will ensure that connection is not forcefully established when not needed but still establish it just in time for the operation the following connection plugins have been updated due to them being ready for v2 ssh paramiko winrm additional plugins will need to have this decorator applied to exec command put file and fetch file ve tested handful of scenarios and did not encounter any issues addresses 10997>>>feature_pull_request p1
v2 ansible playbook should print the help message if run without parameters issue type bug report ansible version ansible devel 620fad9f8d last updated 2015 06 02 12 21 42 gmt 200 ansible configuration environment ubuntu 15 04 summary when you run `ansible playbook` without parameters it prints an error message like this on older version it printed help help` but what is also important is that the `ansible` command even in v2 still prints help when run without any parameters so guess this is bug for `ansible playbook` >>>bug_report p1
v2 does not allow action variable hey guys does not work anymore with v2 kram>>>bug_report p1
moved raw module list to constants and made it quasi configurable did same for modules that require arguments adhoc >>>bugfix_pull_request p2
synchronize tries to use sudo on localhost when using ansible sudo true issue type bug report ansible version ansible version ansible configured module search path none rpm ansible ansible fc22 noarch ansible configuration etc ansible ansible cfg` is untouched and the version shipped by fedora seems to be exactly the same as in upstream repo environment ansible host fedora 22 managed host fedora 22 rhel summary with `ansible sudo true` in inventory the `synchronize` module tries to use sudo for spawning rsync on the ansible host not the managed host when `sudo true` is used in the playbook instead of the inventory variable the behavior is as expected steps to reproduce hosts playbook yml command line expected results this is the output get when uncomment `sudo true` in playbook yml and remove `ansible sudo true` from hosts in fact expect `127 f22` instead of `f22 127 1` but that is already reported 11067 actual results more verbose output can be found here http b42 srck net ansible synchronize sudo txt please note that the message is indeed from sudo on the ansible system tried replacing bin sudo` with shell script that prints aaaaaaargh and instead of the usual lecture got aaaaaaargh from ansible playbook >>>bug_report
changes to raw breaking playbooks running against devel branch it appears https github com ansible ansible commit b94e2a1f4ee1631d311f6943f6653c391d5022de landed in the devel branch last night and since then ve been unable to utilize the raw method getting which is rooted in the following yaml which makes total sense to me and seems reasonable as the target os lacks sftp and python is this an intended change am doing something unreasonable wrong >>>bug_report p2
rfe default localhost entry in etc ansible hosts to test the fix for ansible dnf compatibility in the absence of yum https bugzilla redhat com show bug cgi id 1225762 wanted way to quickly check the module so added localhost ansible connection local to my etc ansible hosts it occurred to me that if that connection was defined in etc ansible hosts by default then it would be possible to start experimenting with local ad host task execution without any configuration steps at all and you only need to learn how to configure the inventory when you went to start doing remote execution >>>docs_report
consider using hostname to match ansible pull hosts issue type bug report currently according to https github com ansible ansible blob fe6a2d644dc610d713f96e9cef663b81c9762687 bin ansible pull l165 ansible pull tries to match hostnames against localhost 127 and the machine fqdn there is two problems with this approach many machines don have an fqdn properly configured not all people want to use fqdns in inventory lists if there is no possible breakage think simple fix would be to include the simple hostname in that matching list >>>feature_idea
part fix for https github com ansible ansible modules core issues 1404 replaces 11086 replacement for previous attempt at this https github com ansible ansible pull 11086 which accidentally included some unwanted changes get filechecksum always returns string now and the test win copy integration tests that depend on the checksum have been updated in this change too also requires https github com ansible ansible modules core pull 1438>>>bugfix_pull_request p2 windows
fixes osx fact gathering for the bridge interface fixes 11104>>>bugfix_pull_request
apply 10563 to stable uh the corrected pull request properly targeting stable as stated apply fix 10563 via cherry pick of 104b203 to make sourcing of hacking env work >>>bugfix_pull_request
new hash lookup plugin created new lookup plugin to lookup hash digest from file the plugin uses python hashlib https docs python org library hashlib html to create the hash by default md5 will be used but it can be overwritten by adding the parameter algorithm to the filename term the try except attributeerror block around getattr could be enhanced by checking hashlib algorithms but the algorithms attribute is only available in python and wanted to keep backwards compatibility hope that ok >>>feature_pull_request
fix keyerror which occurs when not existing entry is tried to be removed fixes 11109>>>bugfix_pull_request p2
bug report keyerror when trying to remove not existing entry when running our playbook that perfectly works with ansible in ansible we run into this issue it looks like that line 194 https github com ansible ansible blob f4172fb9daf27baaedd63d1f67ad072b2263d9e7 lib ansible playbook task py l194 should be moved up to the if block >>>bug_report p2
add distribution information for novell open enterprise server issue type feature idea ansible version ansible configuration environment os running ansible os managing novell open enterprise server 11 x86 64 with sles 11 summary novell oes comes with sles 11 on top of the basic oes setup actually all oes hosts are managed as sles hosts by ansible regarding information from etc suse release` allready fixed here https github com ansible ansible pull 10128 but for sufficient distribution and os specific orchestration include var names it is necessary to know the oes distribution information which lives in etc novell release` too this extra distribution information should be standard env var without adding own facts or something example for etc novell release` file in addition an example for the allready works etc suse release` parsing steps to reproduce `ansible setup server grep distribution` expected results information needed it is necessary to discuss the var names here information is allready fine actual results >>>feature_idea
no current variable in ansible like in perl sometimes we need to register variable in order to check file or when launching command but in fact this kind of variable are not very usefull here an example of this the variable is registered but will never be used anymore in perl we commonly use for this kind of purpose after looking little bit in ansible found way to reproduce this behaviour by applying the following patch using this patch test on existing file can be written like this what do you think about >>>feature_idea
minor tweaks to winrm integration tests allow prepare win tests role to run multiple times fail play when any host fails >>>feature_pull_request windows
fix os facts for media interface fixes 11104>>>bugfix_pull_request
osx media type facts for bridge interface is wrong issue type bug report ansible version ansible version ansible configured module search path usr share ansible ansible configuration none environment management server centos managed server osx summary using setup module against an osx computer the media type fact for the ansible bridge0 interface shows as ype steps to reproduce from management server run the ansible command using the setup module ansible mac setup view the ansible bridge0 fact in the output expected results based on the output of ifconfig on the osx machine media so the fact should be set to media type unknown type actual results ansible bridge0 device bridge0 flags up broadcast smart running simplex multicast ipv4 ipv6 macaddress xx xx xx xx xx xx media unknown media select unknown media type ype mtu 1500 options performnud status inactive type unknown >>>bug_report
fix fact gathering on os fixes 11046>>>bugfix_pull_request
pip module hangs when installing from git repos attempting to install from requirements pip file works for all packages registered with pypi but if there is git packege `git http github com supervisor supervisor git 20e47d8b09c0a7700078c99054ad47ca7fd74ae0` ansible will hang indefinitely >>>bug_report needs_to_be_moved p2
`copy` for localhost seems to call `template` and fails hello all issue type bug report ansible version environment osx yosemite summary only uses `file` but `template` although ve got an wierd error that comes from opt local library frameworks python framework versions lib python2 site packages ansible utils template py` guess it will be raised only for `localhost` when use ssh with other machine all things are well done note that ansible seems hang slightly when outputs `gathering facts files hosts empty but also tried dummy file that doesn contain `localhost` hoge yml roles hoge tasks main yml roles hoge files hogehoge empty command and resulting error >>>bug_report
pass group var dict to role in playbook throws exception when hash behaviour merge when variable is defined inside the playbook it gets passed to the role correctly however when it defined in `group vars all yml` ansilbe won find it undefined and exits with an error `fatal vagrant failed to combine variables expected dicts but got dict and unicode the unicode parameter is actually undefined this only happens if hash behaviour merge site yml vars var in playbook bar roles this works role test my role var var in playbook this doesn role test my role var var in group vars is there any workaround to this issue >>>bug_report needs_info
cloudstack updates and v1 sync>>>feature_pull_request
with first found search everywhere hey there decided to add some further information about `with first found` because faced some problems with it during some experiments of mine and noticed that other people are having issues using `with first found` and the way it looks for file it has been said that `with first found` and lookup in general looks into files truth is that for what noticed it looks in every single subdirectory of role folder even when used with `include vars` hope this help to shed some light on the matter >>>docs_report
only run win feature tests when the host has the servermanager module skips remaining win feature tests on unsupported os versions windows server 2008 non r2 >>>bugfix_pull_request windows
don hide errors in files listed in vars files previously files listed in vars files could have parse errors or even not exist at all and ansible would not raise any error until it found that the expected variables were not defined based on the placeholder comment opted to continue to ignore errors by default but explicitly raise them when called from the playbook executor the test suite passes even if the function raises the errors in all cases so maybe that not necessary >>>bugfix_pull_request needs_rebase
change how executionpolicy is set for running remote scripts so arguments passed via splatting work again fixes this integration test that was failing https github com ansible ansible blob devel test integration roles test win script tasks main yml l49>>>bugfix_pull_request needs_rebase windows
unicode issues with ansible and up im running some ansible playbooks on ec2 instances created by opsworks part of the automation reads the ec2 tags from the instance here is the code for that using that information then do group by using one of the tags the main reason to do this is to leverage group vars and do automation that configures settings differently for environments in this case the tag name is environment code below all this worked perfectly in ansible but after the playbook fails with the following error is intersting to note that the automation works fine with instances that are not spun up by opsworks opsworks does add some special tags to the instance my suspicion is that some of those tags have special characters that are causing some sort of unicode issue group by key alltags tags environment group by key alltags tags environment >>>bug_report
add compress to convertto json calls in common powershell code as discussed here https groups google com forum topic ansible devel 0b29wdft3ig >>>feature_pull_request windows
the file module won delete directories with recursive yes ansible version tested with ansible configured module search path none ansible devel ac14ad1419 last updated 2015 05 29 10 14 02 gmt 200 lib ansible modules core detached head 74e69d1fd1 last updated 2015 04 14 22 57 06 gmt 200 lib ansible modules extras detached head 4048de9c1e last updated 2015 04 14 22 57 16 gmt 200 v2 ansible modules core detached head 34784b7a61 last updated 2015 04 14 22 57 33 gmt 200 v2 ansible modules extras detached head 21fce8ac73 last updated 2015 04 14 22 58 02 gmt 200 configured module search path none ansible configuration default ansible configuration from https github com ansible ansible blob devel examples ansible cfg environment host running ansible ubuntu 15 04 destinations ubuntu 12 04 lts ubuntu 14 04 lts summary when trying to delete directory with the file module ansible fails if recursive yes is set steps to reproduce name delete directory hosts all remote user root tasks stat path var tmp deleteme register somepath debug var somepath file path var tmp deleteme recurse yes state absent when somepath stat isdir is defined and somepath stat isdir true expected results the file module should recursively delete directories actual results failed 192 168 10 10 failed true gid group root mode 0700 owner root path var tmp deleteme playbook test yml role null size state directory task file path var tmp deleteme recurse yes state absent uid msg recurse option requires state to be directory the module complains that it can only recursively delete if the state of the path is directory even though in the output it says state directory >>>bug_report p2
part fix for https github com ansible ansible modules core issues 1404 checksum function now allways returns string also had to amend some integration tests as the checksum is no longer being returned in an array >>>bugfix_pull_request windows
path arguments are not being templated correctly have the following playbook play sync repos task debug var ansible ssh user ok httpd var ubuntu ubuntu ok db var ubuntu ubuntu ok api var ubuntu ubuntu ok kibana var ubuntu ubuntu ok es var ubuntu ubuntu ok logstash var ubuntu ubuntu ok ldap var ubuntu ubuntu task synchronize times yes compress no archive no delete yes dest home local user hgdata sfdc ops1 recursive yes src home ansible ssh user hgdata sfdc ops failed ldap 127 cmd rsync delay updates delete after recursive times rsh ssh files keys sv test pem none stricthostkeychecking no out format home seb hgdata sfdc ops ubuntu test com home seb hgdata sfdc ops1 failed true rc 11 msg rsync mkdir home seb hgdata sfdc ops1 failed no such file or directory rsync error error in file io code 11 at main 674 receiver failed api 127 cmd rsync delay updates delete after recursive times rsh ssh files keys sv test pem none stricthostkeychecking no out format home seb hgdata sfdc ops ubuntu test com home seb hgdata sfdc ops1 failed true rc 11 msg rsync mkdir home seb hgdata sfdc ops1 failed no such file or directory rsync error error in file io code 11 at main 674 receiver failed httpd 127 cmd rsync delay updates delete after recursive times rsh ssh files keys sv test pem none stricthostkeychecking no out format home seb hgdata sfdc ops ubuntu test com home seb hgdata sfdc ops1 failed true rc 11 msg rsync mkdir home seb hgdata sfdc ops1 failed no such file or directory rsync error error in file io code 11 at main 674 receiver failed es 127 cmd rsync delay updates delete after recursive times rsh ssh files keys sv test pem none stricthostkeychecking no out format home seb hgdata sfdc ops ubuntu test com home seb hgdata sfdc ops1 failed true rc 11 msg rsync mkdir home seb hgdata sfdc ops1 failed no such file or directory rsync error error in file io code 11 at main 674 receiver failed kibana 127 cmd rsync delay updates delete after recursive times rsh ssh files keys sv test pem none stricthostkeychecking no out format home seb hgdata sfdc ops ubuntu test com home seb hgdata sfdc ops1 failed true rc 11 msg rsync mkdir home seb hgdata sfdc ops1 failed no such file or directory rsync error error in file io code 11 at main 674 receiver c32 error interrupted>>>bug_report
more complex example of using test module>>>docs_pull_request
safe item filter plugin to safely get from deep dicts it currently very hard to use values from possibly nested dicts where each component can be undefined example expression `ansible local my fact file my fact` using `default` or `is defined` will still fail if `ansible local` or `my fact file` are undefined my filter allows one to do this `ansible local safe item my fact file my fact and not throw an error if any of these values are undefined or isn dictionary custom default value can be passed `ansible local safe item my fact file my fact default and the string expression can be expressed more safely as list `ansible local safe item my fact file my fact default >>>feature_pull_request
pip package doesn contain proper extra modules an example is the `consul` module checked the package downloading the source and the modules are not updated issue type bug report ansible version pip summary pip package doesn contain proper extra modules steps to reproduce download the latest release package http releases ansible com ansible ansible latest tar gz and check the extra modules dir expected results consul module installed on as official documentation says actual results `error consul is not legal parameter in an ansible task or handler`>>>docs_report
avoid too broad except in inventory capture only ioerror when reading shebang from inventory file to avoid ignoring other possible exceptions like timeouts from task we are using celery to manage different tasks and if eventually task times out at this part of the code it will not rollback as expected and will keep on executing the rest of the code leading it to hard timeout>>>bugfix_pull_request
new lookup plugin ini can handle ini file and java properties file can also read list of value in section using regexp here simple example this pull request refer to 11019 csvfile lookup plugin can now handle properties file here the result of the test playbook bundle in the pull request >>>feature_pull_request needs_revision
module utils basic set lc all in command run instead of passing the env into the command run it should be defaulted to lc all closes https github com ansible ansible modules extras pull 529>>>bugfix_pull_request needs_info
corrected the playbook name from rolling upgrade yml to rolling updat yml as per example playbook>>>docs_pull_request
include more info when task fails adds playbook role and task fields to the output when task fails this makes it easier to pinpoint where the problem is especially when you have lot of roles and playbooks failed vagrant playbook users marca dev ansible vagrant yml role pythonapp task pip install opt src sm app role requirements txt cc sontek sudarkoff>>>feature_pull_request
added windows module checklist cc jhawkesworth>>>docs_pull_request windows
ansible playbook limit doesnt filter correctly when playbooks has the same host ip issue type bug report ansible version ansible configuration default environment debian 64bit summary if have two different plays configured on the same remote host ansible playbook limit doesnt filter correctly it wants to run both plays on the host steps to reproduce hosts yml deploy yml expected results it should only run the playbook that matches crontab not both playbooks which is on the common ip actual results even if say with limit to only play the hosts tagged crontab it wants to run my other playbook which is also configured for the same ip >>>bug_report
feature request ignore instances option in ec2 asg need to run asg rolling update from within an ec2 instance of the autoscaling group that is updated so need to inform to ec2 asg module to ignore the instance which is calling ec2 asg because that instance will be replaced by new one and the ssh connection will be dropped causing fatal error to ansible playbook execution so propose new parameter called ignore instances it will instructs ec2 asg module to replace all instances except the ignored instances >>>feature_idea
route53 add support to create and delete dns zones currently it seems the the module route53 can only manage zone records but not the zone it self >>>feature_idea
synchronize swaps the source and target in the output issue type bug report ansible version ansible configured module search path none ansible configuration environment running at mac os 10 10 managing debian summary synchronize works but swaps the source and target in the output result steps to reproduce file inventory file office servers yml file roles firehol tasks main yml expected results play office servers task firehol sync common files changed server1 127 play recap server1 ok changed unreachable failed >>>bug_report
synchronize always say changed issue type bug report ansible version ansible configured module search path none ansible configuration defaults inventory inventory environment running at mac os 10 10 managing debian summary synchronize works but always set state changed as result steps to reproduce file inventory file office servers yml file roles firehol tasks main yml expected results actual results >>>bug_report
about function execute module code wrong look code lib ansible runner init py 1280 basefile ansible tmp time time random randint 48 lib ansible runner init py 535 if tmp in tmp and not default keep remote files and not persist files and delete remote tmp the tmp in tmp` expression is always true >>>bug_report
feature request support host key checking as host group variable currently host key checking is global option that can be toggled via ansible cfg or the ansible host key checking environment variable it would be really handy if this could be set on host by host or group by group basis have group of development vms that are blown away and recreated on routine basis it would be nice to disable host key checking for these development vms while leaving it enabled for other hosts >>>feature_idea
remove duplicate retry files constants>>>bugfix_pull_request
factor primitives for f5 modules factor the standard elements for all f5 big ip modules f5 standard arguments f5 login method >>>feature_pull_request
fix typo in ask sudo pass reference within playbook intro doc>>>docs_pull_request
add json example to set fact documentation it would be really helpful if we added json example to the set fact documentation can do this in pull request if you can point me to the documentation here is one >>>docs_report
limit extensions for files in group host vars dir inventory vars make loading from directory obey the same rules as when checking the base paths looking at the file name extensions as defined in constants yaml filename extensions fixes 11017>>>bugfix_pull_request
fix ec2 ami find documentation and add additional examples noticed couple of errors on the http docs ansible com ec2 ami find module html documentation that be happy to fix however can find this file in github when searching under the repository do you want to fix these issues or can you tell me where this file is located and can submit pull request the region parameter is required but all examples do not include the region each example should include region parameter the first example is invalid since it is using the tags parameter the parameter is called ami tags clean up synopsis text currently returns list of matching amis with ami id along with other useful information can search amis with different owners can search by matching tag by ami name and or other criteria results can be sorted and sliced whatever makes sense here maybe something like returns list of amis for given search criteria of owners tags or ami name that can be sorted and sliced the last example uses ami search which is the wrong registered variable this should be ami find instead the last example assumes the results length is greater than to showcase ansible conditionals and help the end user you could add condition such as when ami find results length it would be great to include an additional example on how to delete an ami here is one >>>docs_report
apt module is not idempotent when locale is not english issue type bug report ansible version environment what os are you running ansible from debian gnu linux testing stretch what os are you managing debian gnu linux wheezy summary the `apt` module fails to detect idempotency when locale is not set to english steps to reproduce playbook `test yml` when locale is set to english tested with both `c` and `en us utf 8` the idempotency is well detected ie the status is ok however when locale is not english confirmed with `fr fr utf 8` the idempotency fails and the status is always changed note that it the same when using `ansible` ie not through playbook isn the parsing done in english only if so then shouldn the locale be forced inside ansible >>>bug_report needs_to_be_moved
ubuntu ppa ansible does not even run wow ansible does not even run xxx xxx code devops ansible traceback most recent call last file usr bin ansible line 36 in from ansible runner import runner importerror no module named ansible runner >>>bug_report p1
regression in template interpolation post with hash merging enabled minimum test play with hash merging on and this in the group vars resulting error message git bisected this back to 9a0f8f0 fix for 9497 it works with hash merging off >>>bug_report p2
extraneous files in release tarball issue type bug report ansible version ansible ansible configuration environment summary the release tarball for version includes git repositories for the extras and modules repo these should be removed in the release tarball >>>bug_report
add validate recipes to the docs issue type documentation report summary to this day several modules have validate command `template` http docs ansible com template module html `lineinfile` http docs ansible com lineinfile module html `copy` http docs ansible com copy module html `replace` http docs ansible com replace module html did forget any as reminder it works like this validation to run before copying into place use in the command to indicate the current file to validate the command is passed securely so shell features like expansion and pipes won work find this to be extremely powerful yet not often used on roles you can find online experience and readings showed me that it because it not trivial often find myself browsing the examples in the doc to find that nice command it would be nice to have list of recipes to test services after their configuration in the doc what do you admins think of that until it gets accepted or if you don see the value of it propose to list those know or already found in the examples in the next section of this issue please comment with more and ll add to the list steps to reproduce known recipes apache `apache2ctl t` or usr sbin apache2ctl t` configuration files in javascript syntax `esvalidate s` using the esprima https www npmjs com package esprima npm package configuration files in json syntax `jsonlint s` using the jsonlint https www npmjs com package jsonlint npm package nginx main configuration file only `nginx s` openssh server `sshd s` sudoers file `visudo cf s` syslog ng `syslog ng s` or sbin syslog ng s` expected results unknown or desired recipes apt apticron bashrc file exim4 with update exim4 conf conf something like `nginx bv s` fail2ban gunicorn `gunicorn check config app module` but needs to be run from the project directory can we do that with `validate` etc hosts file http www trilug org pipermail trilug week of mon 20131021 069966 html lynis mpd nginx `server` config sort of virtualhosts rkhunter `rkhunter configfile s` does not work for local` files samba supervisor >>>docs_report
evaluate other host vars in the context of that other host issue type feature idea ansible version ansible configuration na environment na summary when accessing another host variables through `hostvars hostname variable name` if the value of `variable name` is templated the template is evaluated using the current host available variables instead of the variable host of origin it requires putting more variables in more generic groups such as `all` making them noisier steps to reproduce host vars origin expected results actual results >>>feature_idea
fact gathering gets slightly unhelpful media type value on os ending in issue type bug report ansible version charles mba ansible charles ansible version ansible configured module search path none ansible configuration no changes to the standard configuration environment running from os against os summary when facts are obtained from an os system the variable ansible en0 media type and possibly other interfaces is returned with trailing character steps to reproduce on os system ansible setup hosts localhost less find ansible en0 in the displayed output expected results the media type field should be full duplex not full duplex it looks like the output from networksetup getmedia en0 isn being truncated to report the trailing flags separator for example osx builduk networksetup getmedia en0 current 1000baset active 1000baset actual results ansible en0 device en0 flags up broadcast smart running simplex multicast ipv4 address xxx broadcast xxx netmask xxx network xxx ipv6 address xxx en0 prefix 64 scope 0x4 macaddress xxx media unknown media select 1000baset media type full duplex mtu 1500 options performnud status active type unknown private informatin hidden with xxx >>>bug_report
feature request tags that are excluded by default as requested in these stackexchange questions http serverfault com questions 623634 ansible excecute task only when tag is specified http stackoverflow com questions 28789912 ansible default explicit tags 28932124 28932124 like the ability to specify tag in task that will cause it to be skipped by default and only run if the tag is explicity specified in the command line this way we can put dangerous tasks or tasks that should follow manual checks right in there with the rest of them and avoid running them by accident know the same can be achieved with prompts and variables which using right now but it isn as convenient >>>feature_idea
template within template problem hello trying to parse bash stdout in order to get just ip port value inside an ansible variable however as try to use the variable afterwards to create jenkins job using curl get weird error here are the tasks you can see that escaped the template use to parse the stdout with raw tags however get the following error on the create jenkins job http www fpaste org 224121 19996214 think that when try to get the variable value ansible tries to rerun the previous task without the raw tags so get template error while templating string cannot even debug it as get the same error whenever try to use the variable inside the playbook don think this is the expected behaviour >>>bug_report needs_info
add default value support to `consul kv` lookup issue type feature idea ansible version ansible configuration not applicable environment not applicable summary supporting default value for the `consul kv` lookup would be useful in the case that the server cannot be reached or the key does not exist >>>feature_idea
ssh connection errors are unclear issue type bug report ansible version ansible devel ede94dd7f8 last updated 2015 03 29 14 04 17 gmt 400 lib ansible modules core detached head de4c7f8ba6 last updated 2015 05 19 12 48 28 gmt 400 lib ansible modules extras detached head cb848fcd9e last updated 2015 04 03 15 14 36 gmt 400 v2 ansible modules core detached head 34784b7a61 last updated 2015 02 26 12 26 47 gmt 400 v2 ansible modules extras detached head 46e316a20a last updated 2015 04 03 15 14 36 gmt 400 configured module search path none ansible configuration nothing of note environment na summary hosts without name resolution result in failures with unclear ssh connection errors steps to reproduce attempt to connect to host in inventory which does not have name resolution expected results ansible with ssh errors more clearly indicates the reason for failure ansible paramiko fatal hosta msg failed errno nodename nor servname provided or not known failed true command line ssh ssh hosta ssh could not resolve hostname hosta nodename nor servname provided or not known actual results ansible with ssh errors are unclear ansible ssh fatal hosta ssh error data could not be sent to the remote host make sure this host can be reached over ssh example if have hundreds or thousands of hosts some of which need to be bootstrapped in specific way can tell from the ssh errors if they need to be bootstrapped or if there is some other error which needs to be addressed separately in the simple case this forces me to fall back to paramiko and bootstrap them all again which is slow >>>bug_report
doc we need gplv3 license headers gplv2 only headers are incompatible with gplv3>>>docs_pull_request needs_revision p2
feature request report time each task took to complete it would be great to see how much time task takes on each host especially if you leave ansible working and find it done or failed in tens of minutes or even hours >>>feature_idea
winrm not working with delegate to trying to configure windows host through linux based machine linux based machine has public ip windows host has private ip output from ansible play public ip gathering facts establish connection for user biohazard remote module setup exec ssh tt vvv controlpersist 15m ssh config controlpath kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 public ip bin sh mkdir home ansible tmp ansible tmp 1432110715 98 246670613366576 chmod rx home ansible tmp ansible tmp 1432110715 98 246670613366576 echo home ansible tmp ansible tmp 1432110715 98 246670613366576 put tmp tmpeutn2w to home admin ansible tmp ansible tmp 1432110715 98 246670613366576 setup exec ssh tt vvv controlpersist 15m ssh config controlpath kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 public ip bin sh sudo sudo sudo via ansible key ldujpazipujftlnmshxzlhflfhtvvvxu password root bin sh echo become success ldujpazipujftlnmshxzlhflfhtvvvxu lang en us utf lc ctype en us utf usr bin python home admin ansible tmp ansible tmp 1432110715 98 246670613366576 setup rm rf home admin ansible tmp ansible tmp 1432110715 98 246670613366576 dev null ok public ip task winrm establish winrm connection for user administrator on port 5985 to private ip winrm connect transport plaintext endpoint http private ip 5985 wsman winrm connection error 500 winrmtransport errno 113 no route to host winrm connect transport plaintext endpoint https private ip 5985 wsman winrm connection error 500 winrmtransport errno 113 no route to host fatal public ip private ip 500 winrmtransport errno 113 no route to host fatal all hosts have already failed aborting play recap to retry use limit home biohazard configure retry public ip ok changed unreachable failed as far as see the connection is established locally to private address on machine where playbook was played is it normal what doing wrong >>>needs_info windows
minor fix for broken link>>>docs_pull_request windows
add support for group roles to postgresql user issue type feature idea ansible version ansible configuration nothing unusual environment summary the postgresql user module doesn have any provision to manage role membership within other roles groups this makes it impossible to manage complex role structures using postgresql user this is typically handled with grant or create alter role syntax grant role name to role name or create role name with option snip in role role name relevant documentation links http www postgresql org docs static sql createrole html http www postgresql org docs static sql grant html steps to reproduce here is the expected playbook with in roles parameter added to the last play hosts dev database vars prompt name pg user prompt postgresql username private no name pg pass prompt postgresql password private yes vars myuserprivs login noreplication pggroups name mygroup pgusers name myuser pass apassword privs myuserprivs name create postgres group roles with items pggroups postgresql user login user pg user login password pg pass name item name db postgres name create postgres pgusers with items pgusers postgresql user login user pg user login password pg pass name item name db postgres password item pass role attr flags item privs in roles mygroup expected results would expect that ansible generate sql equivalent to the following create role mygroup create role myuser with login noreplication password apassword in role mygroup actual results >>>feature_idea
pass same host value for runner on file diff as runner on ok issue type bugfix pull request ansible version ansible configuration environment ubuntu 14 04 summary `runner on file diff` uses different value for `host` than `runner on ok` or `runner on failed` `runner on file diff` uses `conn host` all others simply use `host` what this means is that my callback plugin has to do more work to correlate the diff with the correct host see the code diff for the very simple fix steps to reproduce inventory playbook yml test j2 callback plugins bugreport py run ansible expected results expect the print value to show the same hostname for each callback also expect that value to be the one from the inventory file not the one used for the `ansible ssh host` variable for the given setup above expect to see `some name here` for both actual results instead what end up seeing is `localhost` for the `runner on file diff` callback and `some name here` for the `runner on ok` callback this pull request makes the very small change from `conn host` to `host` which then makes the callback act as expected >>>bugfix_pull_request easyfix
basic fix valueerror if value of type int is not an int with this fix we get friendly error message failed localhost failed true msg value of argument start port is not of type int>>>bugfix_pull_request
add source option to dependencies in the meta main yml issue type feature idea ansible version ansible detached head d76f8deed5 last updated 2015 04 27 14 58 48 gmt 200 environment summary the `ansible galaxy` command can install roles from requirement file so it is possible to install roles from an intern corporate git server instead of the official ansible galaxy the problem is that if the role has dependencies it tries to fetch these roles from the official ansible galaxy the solution would be to define the source of the dependencies in the main meta yml file of the first role steps to reproduce create role with dependencies which are not hosted on ansible galaxy for example bitbucket expected results the `ansible galaxy` command installs my role which has dependencies and installs the dependencies from there source actual results the `ansible galaxy` command installs my role which has dependencies and fails to install the dependencies because they are not hosted on ansible galaxy >>>feature_idea
cloudstack add tests for cs portforward depends on https github com ansible ansible modules extras pull 511 play localhost task test cs portforward setup ok localhost changed false task test cs portforward verify setup ok localhost msg all assertions passed task test cs portforward test fail if missing params failed localhost failed true msg missing required arguments private port ip address public port ignoring task test cs portforward verify results of fail if missing params ok localhost msg all assertions passed task test cs portforward test present port forwarding changed localhost changed true id 9bb712cb 0a35 410b a0cf 0e97be82261b ip address 10 100 212 private end port 8080 private port 8080 protocol tcp public end port 80 public port 80 tags vm display name test vm guest ip 10 101 68 201 vm name test task test cs portforward verify results of present port forwarding ok localhost msg all assertions passed task test cs portforward test present port forwarding idempotence ok localhost changed false id 9bb712cb 0a35 410b a0cf 0e97be82261b ip address 10 100 212 private end port 8080 private port 8080 protocol tcp public end port 80 public port 80 tags vm display name test vm guest ip 10 101 68 201 vm name test task test cs portforward verify results of present port forwarding idempotence ok localhost msg all assertions passed task test cs portforward test change port forwarding changed localhost changed true id 81ac52cf 63e1 4477 8381 1194ca3f8137 ip address 10 100 212 private end port 8888 private port 8888 protocol tcp public end port 80 public port 80 tags vm display name test vm guest ip 10 101 68 201 vm name test task test cs portforward verify results of change port forwarding ok localhost msg all assertions passed task test cs portforward test absent port forwarding changed localhost changed true id 81ac52cf 63e1 4477 8381 1194ca3f8137 ip address 10 100 212 private end port 8888 private port 8888 protocol tcp public end port 80 public port 80 tags vm display name test vm guest ip 10 101 68 201 vm name test task test cs portforward verify results of absent port forwarding ok localhost msg all assertions passed task test cs portforward test absent port forwarding idempotence ok localhost changed false task test cs portforward verify results of absent port forwarding idempotence ok localhost msg all assertions passed play recap localhost ok 14 changed unreachable failed >>>feature_pull_request
cloudstack add tests for cs firewall depends on https github com ansible ansible modules extras pull 510 play localhost task test cs firewall setup 80 ok localhost changed false task test cs firewall verify setup ok localhost msg all assertions passed task test cs firewall setup 5300 ok localhost changed false task test cs firewall verify setup ok localhost msg all assertions passed task test cs firewall setup all changed localhost changed true cidr network test protocol all type egress task test cs firewall verify setup ok localhost msg all assertions passed task test cs firewall test fail if missing params failed localhost failed true msg missing required argument for protocol tcp start port or end port ignoring task test cs firewall verify results of fail if missing params ok localhost msg all assertions passed task test cs firewall test fail if missing params ip address ingress failed localhost failed true msg ip address param ip address is required ignoring task test cs firewall verify results of fail if missing params ip address ok localhost msg all assertions passed task test cs firewall test fail if missing params network egress failed localhost failed true msg missing required argument for protocol tcp start port or end port ignoring task test cs firewall verify results of fail if missing params ip address ok localhost msg all assertions passed task test cs firewall test present firewall rule ingress 80 changed localhost changed true cidr end port 80 ip address 10 100 212 protocol tcp start port 80 type ingress task test cs firewall verify results of present firewall rule ingress 80 ok localhost msg all assertions passed task test cs firewall test present firewall rule ingress 80 idempotence ok localhost changed false cidr end port 80 ip address 10 100 212 protocol tcp start port 80 type ingress task test cs firewall verify results of present firewall rule ingress 80 idempotence ok localhost msg all assertions passed task test cs firewall test present firewall rule ingress 5300 changed localhost changed true cidr 24 end port 5333 ip address 10 100 212 protocol udp start port 5300 type ingress task test cs firewall verify results of present firewall rule ingress 5300 ok localhost msg all assertions passed task test cs firewall test present firewall rule ingress 5300 idempotence ok localhost changed false cidr 24 end port 5333 ip address 10 100 212 protocol udp start port 5300 type ingress task test cs firewall verify results of present firewall rule ingress 5300 idempotence ok localhost msg all assertions passed task test cs firewall test present firewall rule egress all changed localhost changed true cidr network test protocol all type egress task test cs firewall verify results of present firewall rule egress all ok localhost msg all assertions passed task test cs firewall test present firewall rule egress all idempotence ok localhost changed false cidr network test protocol all type egress task test cs firewall verify results of present firewall rule egress all idempotence ok localhost msg all assertions passed task test cs firewall test absent firewall rule ingress 80 changed localhost changed true cidr end port 80 ip address 10 100 212 protocol tcp start port 80 type ingress task test cs firewall verify results of absent firewall rule ingress 80 ok localhost msg all assertions passed task test cs firewall test absent firewall rule ingress 80 idempotence ok localhost changed false task test cs firewall verify results of absent firewall rule ingress 80 idempotence ok localhost msg all assertions passed task test cs firewall test absent firewall rule ingress 5300 changed localhost changed true cidr 24 end port 5333 ip address 10 100 212 protocol udp start port 5300 type ingress task test cs firewall verify results of absent firewall rule ingress 5300 ok localhost msg all assertions passed task test cs firewall test absent firewall rule ingress 5300 idempotence ok localhost changed false task test cs firewall verify results of absent firewall rule ingress 5300 idempotence ok localhost msg all assertions passed task test cs firewall test absent firewall rule egress all changed localhost changed true cidr network test protocol all type egress task test cs firewall verify results of absent firewall rule egress all ok localhost msg all assertions passed task test cs firewall test absent firewall rule egress all idempotence ok localhost changed false task test cs firewall verify results of absent firewall rule egress all idempotence ok localhost msg all assertions passed play recap localhost ok 36 changed unreachable failed >>>feature_pull_request
added hmc py and hmc ini in plugins inventory this inventory plugin pulls data from an ibm hardware management console hmc about the physical frames attached to that hmc and the logical partitions individual servers on that frame it provides picture of what is accessible via that hmc this version of the plugin uses ssh based commands to pull the data which allows it to work on older hmcs future rewrite of the code will use the restful api but will remove the backward compatibility that using ssh provides the frames run aix ibmi and power linux logical partitions need this information regularly at work but couldn find anything currently in ansible to provide the data this is my first pr and ve tried to rebase it against the devel branch so if ve done that wrong please let me know and ll fix it >>>feature_pull_request
added module checklist docs>>>docs_pull_request
ec2 vol msg found more than one volume in zone if specified with name none ansible when creating volume with name create volume test local action module ec2 vol aws access key aws access key aws secret key aws secret key region region zone availability zone volume size the volume gets created but the module fails with msg found more than one volume in zone if specified with name none reverting back to and get no error >>>bug_report needs_to_be_moved
flush handlers not working as expected issue type bug report ansible version ansible configuration environment osx yosemite summary handlers are not being forced to run when call flush handlers steps to reproduce in `site yml` in `roles webserver meta main yml` in `roles webserver nginx tasks main yaml` run the playbook with tags nginx` expected results actual results >>>bug_report
more flexible users groups management hi user module has only groups and append parameters regarding groups this is very limited model propose adding the following parameters remgroups groups listed in this parameter will be subtracted from groups if append true then user will also be removed from these groups ignore missing groups do not fail if group listed in groups does not exist on the system >>>feature_idea
breaks ec2 module compatibility with eucalyptus ec2 modules compatibility with eucalyptus has been compromised at some point following example shows it forcing the use of aws regions result without region in playbook >>>bug_report cloud needs_to_be_moved p2
csvfile lookup plugin can now handle properties file this change allow to lookup into java properties file using the csvfile lookup plugin for more information take lookup at the playbook test integration test lookup properties yml which show how to use this new capability >>>feature_pull_request
facts add ed25519 ssh pubkey add missing ed25519 ssh pubkey to facts and refactor code to reduce code duplication >>>feature_pull_request
text backups xxx yml in host vars override variables issue type bug report ansible version ansible from ppa ansible ansible ansible configuration default environment ubuntu 15 04 summary text backup files ending on tilde as created by joe or gedit in `host vars override the actual variable data steps to reproduce write samle data into `host vars test yml` edit `host vars test yml` using gedit gedit will create `host vars test yml ensure `test yml` and `test yml differ now ansible will override variable defined in `test yml` using the data from `test yml expected results only yml` files are recognized by ansible in `host vars` actual results yml files are recognized by ansible in `host vars` >>>bug_report
bower module thrown an error if bower components dir already exists run next task in my playbook and if `bower components` dir not exists in path to project` it download all dependencies and works fine but if run this task again get next error it looks like bug run playbook with vvvv` key remote machine is ubuntu 12 04 bower is installed and work correctly if run it manually with `bower install` or `bower update` my workaround is to remove manually `bower components` folder first if exists and then execute `install bower vendor dependencies` task >>>bug_report
fix error in the column name in the doc this is quite visible on http docs ansible com stat module html>>>docs_pull_request
uri integration tests originally by darkk provided in this pull request https github com ansible ansible pull 8027 planning on fixing the uri module with this pr https github com ansible ansible modules core pull 1331 which is slightly different from darkk fix so the tests needed to be updated little>>>bugfix_pull_request
ssh config dynamic inventory fails when config item uses identityfile paramiko sshconfig returns list for identifyfile instead of string this breaks ansible inventory variable handling flatten the list items when assigning values >>>bugfix_pull_request needs_info needs_revision
copy content from variable to file hello all need to put vaulted file in file inside my server as this is not yet supported by ansible have looked many solutions for these like using lookups https github com ansible ansible pull 8110 it didn work using template files http stackoverflow com questions 22773294 how to upload encrypted file using ansible vault generate new lines in the file and with copy module as described in previous link with the copy module using the long sintax link above was the way found to pass vaulted variable but need my destination to use path provided by another variable like this declared in vars app path opt infortunately was not able to use app path with destination with the long sintax tried the following and none of those worked does someone knows why is that am running ansible 2>>>needs_info pending_closure
attempt to fix selinux context on fuse filesystems hopefully fixes 10931>>>bugfix_pull_request
add judgment to to fix path0 if ansible config is set to dir made mistake when set ansible config to dir contains ansible cfg and hosts after digging into the source found this variable should direct to ansible cfg file itself but think maybe not the only one who made such mistake so pulled this request >>>feature_pull_request
explain source of ec2 inventory error addresses part of https github com ansible ansible issues 10840 edrozenberg ran into this while creating more limited iam role for some users before rds `error inventory script ec2 py had an execution error forbidden` ec2 `error inventory script ec2 py had an execution error error connecting to aws backend you are not authorized to perform this operation elasticache `error inventory script ec2 py had an execution error forbidden` after rds `error inventory script ec2 py had an execution error error forbidden while getting rds instances` ec2 `error inventory script ec2 py had an execution error error error connecting to aws backend you are not authorized to perform this operation while getting ec2 instances` elasticache `error inventory script ec2 py had an execution error error forbidden while getting elasticache clusters` thanks>>>bugfix_pull_request
autofs automounts become mounted by fact gathering issue type feature request ansible version all ansible configuration nothing environment ubuntu vivid vervet summary my dev workstation has 20 autofs automounts setup many over pokey remote links and often to unavailable resources when ansible goes to gather facts it goes into each of these automounts and pulls the normal facts on each of them this can be slow if the network resources are unavailable box is offline ansible will stall http serverfault com 691847 203776 as for possible solutions would greatly appreciate way to prevent certain fs type links from being recursed and probed here that type is `autofs` that will drastically decrease my gather fact time and prevent bunch of painful network traffic from occurring some discussion on autofs the way autofs works is it mounts to your mount point say mnt foo and when you access it it mounts the real fs while keeping the autofs mount there so the detection logic would need to see hey mnt foo only has an autofs mount don read it hey mnt bar has autofs and cifs mount so do gather facts on it because there not just autofs mount there also an actual fs mounted cifs steps to reproduce use autofs or include systemd automount as an option in an etc fstab entry to make it an automount and don mount it expected results automounts do not mount actual results automounts all mount then facts are gathered on these mounts which can be painfully slow for some network file systems on slow links if the resource is not available ansible will stall >>>feature_idea
permit logging of all commands executed shelled this may be the wrong way to go about this but have not been able to find solution with callbacks as they just don seem to have the information am looking for way to log all commands shelled out by ansible here an example of these logs from simple ansible playbook that does gather facts and installs apache >>>feature_pull_request
use decorator to perform just in time connection this pr adds new `ensure connect` decorator for connection plugins it function is to decorate method requiring connection to be open the replaces the explicit call to connect` why calling connect` explicitly as it is causes the connection plugin to connect to remote host sometimes needlessly such as when running an action plugin that does not need connection such as `set fact` this change will ensure that connection is not forcefully established when not needed but still establish it just in time for the operation the following connection plugins have been updated due to them being ready for v2 ssh paramiko winrm additional plugins will need to have this decorator applied to `exec command` `put file` and `fetch file` ve tested handful of scenarios and did not encounter any issues addresses 10997>>>bugfix_pull_request windows
allow adding paths to module path issue type feature idea ansible version or any other newer version probably ansible configuration environment fedora 21 summary would like to extend the default module path to add an extra module to ansible but this is not possble in cross distro compatible way since it is only possible to overwrite the module path not to append or prepend dirs to it steps to reproduce export ansible library pwd library expected results this should prepend pwd library` to the library path actual results the library path become pwd library` the default modules are not found anymore >>>feature_idea
subjectname variable unused clean up having used this script several times today came to notice the subjectname variable being passed in via the cli is essentially ignored when generating the ssl certificates rendering it useless believe it good idea to have it in place so ve updated the script to reflect this also cleaned up some random new lines throughout the file and expanded on comment it might be worth going step further and commenting the file fully as most people reviewing this file won be familiar with powershell like wasn until few days ago it could be helpful >>>feature_pull_request windows
paramiko establishes ssh connection for action plugins issue type bug report ansible version `ansible detached head b47d1d7e69 last updated 2015 05 12 16 27 04 gmt 500 ansible configuration environment control mac os managed summary when using paramiko as the connection type ansible will attempt to establish an ssh connection for an action plugin even when not necessary such as in the example of using `set fact` steps to reproduce expected results actual results there is also traceback but the cause is due to ssh connection failure there is no such exception in `v2 final` however paramiko still attempts to establish an ssh connection >>>bug_report p2
add integration test to verify 10073 in issue 10073 misbehaviour in literal handling for inline lookup arguments that can cause unexpected behaviur was reported this integration testcase reproduce the problem after applying pull request 10991 the issue is fixed and the test passes signed off by jan losinski >>>bugfix_pull_request
evaluate lookup terms only in with contexts as mentioned in issue 10073 there is problem when evaluation lookup terms in inline lookup statements the problem is that the template engine dies not know that the term was literal even if it was quoted because the outer tempalte engine have already stripped the quotes when the templating in listify lookup plugin terms see the term the term will then be evaluated as template variables and if part of the term evaluates to the parent variable of the current scope it will cause an endless recursion this patch fixes the issue by introducing new inject property that tells in whick context we are currently so listify lookup plugin terms can skip term evaluation if we are not within with context >>>bugfix_pull_request p2
conditional imports does nt work issue type bug report ansible version ansible ansible configuration environment using debian stretch on my laptop debian and centos on my servers summary conditional imports http docs ansible com playbooks conditionals html conditional imports doesn work as expected steps to reproduce have this playbook vars redhat yml contains vars default os yml contains expected results this is what get when only put vars ansible os family yml in `vars files` actual results this is what get with vars ansible os family yml vars default os yml thanks >>>bug_report needs_info
error no such file or directory during provision with docker image when do `vagrant provision` using `ansbile` as provisioner get next error my ansible playbook file is the vagrant dir is mount with vagrant as `nfs` on vm `dockerfile` exists by vagrant docker nginx dockerfile` path is this bug or do something wrong with `docker image path` config >>>bug_report needs_info p2
correct unbound error in ec2 py rds code path fixes 10910>>>bugfix_pull_request
added alternative syntax for tag usage ingydotcom different syntax for more compressed multiple tag entries >>>docs_pull_request
changelog add cs account>>>docs_pull_request
remove unnecessary from in playbook intro docs to make this sentence make sense fixes 10970 >>>docs_pull_request
update become rst visually separate commands and values from description text for clarity add value detail for become user and become method to match become >>>docs_pull_request
host facts treated as undefined by default filter when passed to parameterized roles issue type bug report ansible version tested with devel ded6e9be67 ansible configuration defaults environment issue seen on mac os 10 10 as well as ubuntu linux 14 04 don think it is os related summary when discovered host fact or variable set using the `set fact` module gets passed to parameterized role from playbook and `default` filter is used on it in the playbook the default filter gets triggered as if the variable was undefined steps to reproduce create role that uses variable see example below invoke the role in playbook as parameterized role setting the value of that varaiable to defined host fact with default filter observe the value for that variable within the role example playbook and role to demonstrate bug showing some examples of where it does and does not occur `roles test role tasks main yml` file content name display variable as received by role debug msg message var in role playbook to demonstrate behavior with `test role` name demonstrate parameterized role host fact default filter bug hosts localhost gather facts yes vars set my var as variable for the play my var apple pre tasks set my var as host fact in pre tasks set fact my var banana roles in none of these cases should the default value be used role test role message value of my var set in play vars passed to role without default filter var in role my var role test role message value of my var set in play vars passed to role with default filter var in role my var default default value role test role message value of my var set as host fact in pre tasks without default filter var in role my var role test role message value of my var set as host fact in pre tasks with default filter var in role my var default default value role test role message value of ansible hostname discovered automatically without default filter var in role ansible hostname role test role message value of ansible hostname discovered automatically with default filter var in role ansible hostname default default value expected results if the variables are defined the role should always receive the value in the variables not the default values in the example role and playbook we should never see default value printed actual results for certain facts discovered facts or fact set with the set fact module the default value in the variable gets erroneously applied as if the variable had been undefined the role gets passed default value instead of the correct value of the variable >>>bug_report
cloudstack add test for cs account play localhost task test cs account setup ok localhost changed false task test cs account verify setup ok localhost msg all assertions passed task test cs account test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs account verify results of fail if missing params ok localhost msg all assertions passed task test cs account test fail if missing params if state present failed localhost failed true msg missing required arguments email username password first name last name ignoring task test cs account verify results of fail if missing params if state present ok localhost msg all assertions passed task test cs account test create user account changed localhost account state enabled account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of create account ok localhost msg all assertions passed task test cs account test create user account idempotence ok localhost account state enabled account type user changed false domain root name cloudstack user network domain cloudstack local task test cs account verify results of create account idempotence ok localhost msg all assertions passed task test cs account test lock user account changed localhost account state locked account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of lock user account ok localhost msg all assertions passed task test cs account test lock user account idempotence ok localhost account state locked account type user changed false domain root name cloudstack user network domain cloudstack local task test cs account verify results of lock user account idempotence ok localhost msg all assertions passed task test cs account test disable user account changed localhost account state disabled account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of disable user account ok localhost msg all assertions passed task test cs account test disable user account idempotence ok localhost account state disabled account type user changed false domain root name cloudstack user network domain cloudstack local task test cs account verify results of disable user account idempotence ok localhost msg all assertions passed task test cs account test lock disabled user account changed localhost account state locked account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of lock disabled user account ok localhost msg all assertions passed task test cs account test lock disabled user account idempotence ok localhost account state locked account type user changed false domain root name cloudstack user network domain cloudstack local task test cs account verify results of lock disabled user account idempotence ok localhost msg all assertions passed task test cs account test enable user account changed localhost account state enabled account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of enable user account ok localhost msg all assertions passed task test cs account test enable user account idempotence ok localhost account state enabled account type user changed false domain root name cloudstack user network domain cloudstack local task test cs account verify results of enable user account idempotence ok localhost msg all assertions passed task test cs account test remove user account changed localhost account state enabled account type user changed true domain root name cloudstack user network domain cloudstack local task test cs account verify results of remove user account ok localhost msg all assertions passed task test cs account test remove user account idempotence ok localhost changed false task test cs account verify results of remove user account idempotence ok localhost msg all assertions passed play recap localhost ok 30 changed unreachable failed >>>cloud feature_pull_request
fix envvars support in openstack modules we were being too strict in the openstack module kwargs utility function requiring either cloud or auth to be defined however user can also reasonably decide that they want to use openstack environment variables instead remove the restriction so that passthrough values work properly also while we re in here add link to where documentation can be found and add few defaults to the docs >>>bugfix_pull_request easyfix p2
ssh connection got stuck when ip and host have different keys in known hosts in following situatation like to have some kind of error report but now the connection just got stuck reinstalled one machine and tried to use same ip and host after installation the initial ansible connection reported nicely fatal node2 jenkins slave dev sysart fi using ssh password instead of key is not possible because host key checking is enabled and sshpass does not support this please add this host fingerprint to your known hosts file to manage this host after adding doing this and trying to connect the connection got stuck ansible hosts node2 jenkins slave dev sysart fi ping root vvvv ssh password establish connection for user root remote module ping exec sshpass d6 ssh tt vvv controlmaster auto controlpersist 60s controlpath home jyrki ansible cp ansible ssh gssapiauthentication no pubkeyauthentication no user root connecttimeout 10 node2 jenkins slave dev sysart fi bin sh mkdir home ansible tmp ansible tmp 1431337315 21 244074993784678 echo home ansible tmp ansible tmp 1431337315 21 244074993784678 think that the reason for this had something to do with the warning got with ssh ssh node2 jenkins slave dev sysart fi warning the ecdsa host key for node2 jenkins slave dev sysart fi differs from the key for the ip address 192 168 179 43 offending key for ip in home jyrki ssh known hosts 107 matching host key in home jyrki ssh known hosts 133 after removing both keys and adding the host to known hosts everything worked >>>bug_report
workaround for gce py erroring on vms with no public ips gce py previously assumed that all vms have public ip assigned the script was erroring when attempting to return inst public ips from an empty list this workaround returns null if the list is empty >>>bugfix_pull_request needs_rebase
remove trailing newline from default meta template `ansible galaxy init` does not add trailing newlines to any of the other files it generates correcting the meta template to behave >>>bugfix_pull_request
add missed broadcast address to linux network facts add missed broadcast address to linux network facts fixes 10917 >>>bugfix_pull_request
unclear sentence in playbook introduction documentation the documentation that gives an introduction to playbooks https github com ansible ansible blob ded6e9be671e63829659ff52d656e2a0eefd4d49 docsite rst playbooks intro rst hosts and users says support for running things from as another user is also available this doesn make sense to me not sure what it supposed to say or send pull request >>>docs_report
add filters getgrnam and getpwnam thought these might be useful and the docs encouraged submissions of useful filters in my particular use case need to create pure ftpd passwd file but need the uids of the users admittedly didn check if the user action returned the uid as result >>>feature_pull_request new_plugin
fix ansible ansible 10937 as see python dist find correct distribution name but next code rewrite it to redhat think we can add centos to exception like fedora >>>bugfix_pull_request
changelog add cs instancegroup module has been merged in extras>>>docs_pull_request
add ability to control host order issue type bug report ansible version `ansible devel 374ea10e6f last updated 2015 05 06 16 00 33 gmt 700 environment osx 10 10 to ubuntu 14 04 summary when using `serial 1` ansible runs on hosts in seemingly random order when there are numbers at the end of the group name sometimes steps to reproduce expected result 52 196 227 then 52 65 189 then 52 245 103 actual result with no numbers with different numbers with am crazy previous fix https github com ansible ansible commit ca6db40cb4f7da7d5a57b951bf99b5782e7a675d>>>feature_idea
ssh user parameter is not explicitly set when requested defined while matching the invoking user issue type bug report ansible version ansible version ansible devel ede94dd7f8 last updated 2015 03 29 14 04 17 gmt 400 lib ansible modules core devel 791a28d6a8 last updated 2015 04 06 17 57 40 gmt 400 lib ansible modules extras detached head cb848fcd9e last updated 2015 04 03 15 14 36 gmt 400 v2 ansible modules core detached head 34784b7a61 last updated 2015 02 26 12 26 47 gmt 400 v2 ansible modules extras detached head 46e316a20a last updated 2015 04 03 15 14 36 gmt 400 configured module search path none ansible configuration pipelining true environment it an invocation error but os summary if happen to have ssh config that defines user for swath of hosts it is used instead of the explicitly defined user on the command line or inventory the result is unexpected failure as expected using on the command line overrides the value of ansible ssh user and ansible ssh user is applied if it differed from the invoking user however if have explicitly provided user and that user matches my user name the ssh invocation remains implicit steps to reproduce ansible lab ping vvv modified as below bob ansible ssh user sue connecttimeout 10 user bob controlpersist 60s ansible ssh user sue connecttimeout 10 user sue controlpersist 60s sferry ansible ssh user sue connecttimeout 10 no user parameter controlpersist 60s ansible ssh user sferry connecttimeout 10 no user parameter controlpersist 60s expected results if request specific user with or ansible ssh user it should be explicitly provided to ssh actual results when logged in user matches requested or defined user no user parameter is passed to ssh >>>bug_report
unicodedecodeerror when using ec2 py swallows real error from remote hosts issue type bug report ansible version ansible configuration this is vanilla ansible installed from the `ansible ansible` ppa and haven changed any configuration files environment ubuntu 14 04 if it helps using ami `ami cc3b3ea4` in us east the locale appears to be correctly configure both on the machine running ansible and the client hosts summary when using the `ec2 py` dynamic inventory errors from remote hosts get swallowed and `unicodedecodeerror` is reported in their place apparently because the error message contains unicode characters steps to reproduce provision some machines in ec2 that you can reference with the dynamic inventory break ansible by making the user ansible connects as unable to write to the default ansible tmp directory home ansible tmp run the `ping` module against those machines expected results expect to see the same errors as when running ansible with static hosts file namely the errors above are not the errors reporting they are expected due to the configuration of the remote hosts actual results the error relating to permissions is swallowed and replaced with `unicodedecodeerror` >>>bug_report needs_info p2
fixed docs on the meaning of sudo arg fixes 7418>>>docs_pull_request
cloudstack fix typo in variable fixes get domain thanks in advance for merging it asap >>>bugfix_pull_request cloud
don convert nulls to strings this change is similar to https github com ansible ansible pull 10465 it extends the logic there to also support none types right now if you have null in yaml and that var gets passed around it will get converted to string eg defaults main yml if you output `config` to json or yaml the feature flag would get represented in the output as string instead of as null but secrets would get represented as dictionary this is mis match in behaviour where some types are retained and others are not this change should fix the issue also updated the template test to test for this and made the changes to v2 added changelog entry abadger type we missed when we made the change for numbers and booleans >>>bugfix_pull_request
change arguments to missing arguments `if arguments raise expcetion missing arguments is way too confusing >>>feature_pull_request
patch unhelpful stack trace if inventory fails tl dr add no exceptions true to the utils parse json call here https github com ansible ansible blob devel lib ansible inventory script py l61 if one uses an inventory script and its output fails to parse as json for whatever reason the user is presented with unhelpful trace such as the following it looks like inventory script py parse is already prepared to produce much nicer error message including the stderr of the script but fails to invoke parse json in way that would allow it to detect errors >>>bug_report
shell autocompletion request as ansible has some long keys without shortcuts like vault password file or force handlers it really misses autocompletion ve found script https github com dysosmus ansible completion that seem to work fine but had just quick look on it it would be really nice to ship one with ansible distribution >>>feature_idea
delimiter param must be string tried to use ansible fqdn in the params string but string concat with this ansible variable casts the params string to unicode this results in the following exception ansibleerror csvfile delimiter must be string not unicode this exception is triggered here https github com ansible ansible blob 89fcf078bea08792b9b3da38cc8d359dce634742 lib ansible runner lookup plugins csvfile py l32 csv reader expects the delimiter param to be single char string according to this documentation https docs python org library csv html csv dialect delimiter the lookup call to reproduce lookup csvfile file tmp test csv delimiter col ansible fqdn this patch casts the delimiter param to string >>>bugfix_pull_request
have available modules in variable currently available modules is not available in variable for use in conditional >>>feature_idea
make compression support for ssh scp sftp connection configurable notice that compression used only for command execution via ssh but not for scp or sftp file transfers patch will set compression yes by default for ssh scp and sftp user can switch off compression via cfg file >>>feature_pull_request needs_rebase
add compress support for paramiko hi all just propose patch for compression support for paramiko transport connection think this change will save some network traffic and reduce module execution time because lower data size will be transfered via network >>>feature_pull_request
update issue template to ask for config details could be useful >>>docs_pull_request
ansible script module does not send boolean argument to powershell script in the powershell script we have defined boolean parameter like so param bool boolvariable and run the script module against it like so script rax configureappfabric ps1 true however it seems like the script module always treats this argument as string so the powershell script fails anyway to get around this bug maybe >>>bug_report windows
update digitalocean dynamic inventory to api v2 update to api version in api to get inventory is done in one request so there is no need to cache any more >>>feature_pull_request
v2 bug vars prompt has an invalid value and could not be converted to an dict ansible playbook test yml error the field vars prompt has an invalid value prompt name this instance name name and could not be converted to an dict error was hosts web vars prompt name important var >>>bug_report p1
add support for https proxies using ansible https proxies are not supported this is an issue for simple things such as downloading file with the `get url` module name download elasticsearch get url url https download elastic co elasticsearch elasticsearch elasticsearch tar gz dest tmp elasticsearch tar gz this generates the following error task elasticsearch download elasticsearch failed 127 failed true msg unsupported proxy scheme https currently ansible only supports http proxies fatal all hosts have already failed aborting looks like the issue lies in https github com ansible ansible blob 0951a74ea0f12b7426817ab5a915e2853502bc01 lib ansible module utils urls py l297>>>feature_idea
update playbooks tags rst minor clarity edit highlight the command part of the sentence to clarify use of all tag >>>docs_pull_request
failed to create temporary content file ascii codec can encode character in uri py fileit always report error msg when run ansible playbook to download file from internet the error message is failed to create temporary content file ascii codec can encode character x89 in position ordinal not in range 128 it seems that the code cant catch unicodeencodeerror as change the code unicode content decode raw unicode escape to str content encoding utf errors ignore in uri py the error disappeared and can be catched >>>bug_report
ansible distribution is wrongly reported as redhat under centos 1>>>bug_report p2
fix for openbsd it not solution but it workaround for us who are trying to use ansible on openbsd nothing was being done about this issue https github com ansible ansible modules core issues 278 so this workaround helped me at least >>>bugfix_pull_request
traceback in unarchive module issue type bug report ansible version environment mac os 10 10 yosemite xcode summary traceback in unarchive module steps to reproduce expected results tarball should be extracted to remote machine there is no file called certs dodca 25 cer in my tarball just verified no idea what ansible is doing here that could be problem on my end or it could be another bug actual results >>>bug_report p2
traceback in file module issue type bug report ansible version environment mac os 10 10 yosemite summary yaml traceback with file module steps to reproduce expected results file should be created as expected think this is due to my escaped space bug report is over traceback output as opposed to functionality actual results >>>bug_report p2
update ec2 inventory script to support elb grouping >>>feature_pull_request
error invalid selinux context in template module when using vxfs veritas cluster filesystem issue type bug report ansible version ansible environment running from rhel selinux is running in permissive mode logging only summary template modules fail to generate template file when the destination is on an vxfs filesystem msg invalid selinux context fatal all hosts have already failed aborting steps to reproduce from the playbook name ensure config file for deployment exists template src deploy cfg dest path on vxfs filesystem deploy cfg the playbook was executed as user root setting se settings does not help expected results file will be generated with template engine actual results myhost put tmp tmpkrhpkn to root ansible tmp ansible tmp 1430919691 46 42912766588713 source put tmp tmp8p atr to root ansible tmp ansible tmp 1430919691 46 42912766588713 copy exec bin sh lang lc ctype usr bin python root ansible tmp ansible tmp 1430919691 46 42912766588713 copy rm rf root ansible tmp ansible tmp 1430919691 46 42912766588713 dev null failed myhost cur context unconfined object vxfs s0 failed true gid group root input was system object default s0 mode 0644 new context system object default s0 owner root path path on vxfs filesystem ansible tmpswb01kdeploy cfg secontext unconfined object vxfs s0 size 31559 state file uid msg invalid selinux context fatal all hosts have already failed aborting there are also some bugs that this happend in the past on nfs and zfs filesystems also https github com ansible ansible issues 5632 https github com ansible ansible issues 7009 maybe someone can use this code https github com jimi ansible commit ed0fcb96390e18711521ecff7714253935f0a239 to fix this issue maybe setting selinux context is not necessary when selinux is in permissive mode another solution may be using copy instead of move but am not sure if this has to be atomic >>>bug_report
selinux overlayfs copy module failed with invalid selinux context hi there it seems very related to 7009 but this time with an overlayfs mountpoint the support for selinux context within overlayfs seems on the way but this issue might happen again with others fs anyway could we have parameter in the copy module to manually prevent the setting of these context steps to reproduce using updated fedora 21 sudo mkdir var lib overlayfs upper lower work mountpoint sudo mount workdir var lib overlayfs work upperdir var lib overlayfs upper lowerdir var lib overlayfs lower overlay overlayfs var lib overlayfs mountpoint sudo ansible localhost copy src etc fstab dest var lib overlayfs mountpoint fstab localhost failed msg invalid selinux context >>>bug_report
lookup failing to find file issue type bug report ansible version ansible and ansible environment mac osx 10 10 ubuntu 15 04 summary error error steps to reproduce run vagrant provision with ansible provisioner with plays below expected results simply work actual results error above >>>bug_report
use same interpreter for test module and module it runs default python interpreter to the same interpreter the test module script is executed with this is so that the interpreter doesn have to be specified twice in the command when using non default python `` path to python hacking test module python path to python `` >>>bugfix_pull_request
documentation update add advice about using unpatched windows management framework hopefully this should reduce bug reports like 10878 and 10825>>>docs_pull_request p2 windows
replace python2 style octal numbers the source code has several instances of number literals in the form `0700` python3 raises `syntaxerror` for these for forward compatibility we will need to change `0700` to `0o700` see the what new in python3 https docs python org whatsnew html integers document for reference >>>feature_idea
get url https with explicit port fails to validate certificate the get url module fails to validate the ssl certificate when the url contains https scheme with an explicit port in it example `https host 4443 path to something` to reproduce run the error is the bug is in `urls py 379` the port variable is actually left as string when the port is parsed out of the url as opposed to being an integer when the port is implicitly set to 443 simple `port int port would do think the patch below works for me >>>bug_report p2
v2 bug can pickle it hangs before the ansible detached head f310d13280 on ubuntu 12 04 lts ve confirmed that 0b83626 doesn give this error site degenerate yml inventory >>>bug_report
host variables do not override role vars values issue type bug report ansible version environment ubuntu 14 04 lts summary variables in host vars file yml should take precedence over variables in roles rolename vars main yml in my tests the role variables appear to take precedence steps to reproduce add the same variable to host vars hostname yml and roles rolename vars main yml create playbook for that host and role add debug task to the playbook that outputs the test variable expected results debug should output the value stored in host vars hostname yml actual results debug ouputs the value stored in roles rolename vars main yml comments the ansible docs say avoid defining the variable in 47 places and then ask the question which gets used why because thats not ansibles zen philosophy of doing things there is only one empire state building one mona lisa etc figure out where to define variable and dont make it complicated as nice as it would be to only define variable in one place it just not feasible end up with playbook per host or role per host or some other unmanageable mess in order to keep sane have to be able to define general defaults for everything then be able to override them on group or host based level when needed the best way ve found to do that is common role that can share between ansible projects sadly group vars all won work unless start copying the same values in to multiple locations which kinda defeats the whole point of configuration management unfortunately that causes issues between the common role defaults main yml values and rolename defaults main yml values both are at the same level so it impossible to tell which will get applied thus need to put my common values in common vars which when need to override that value on specific host causes the above issue anyway that why need host vars host to take precedence over rolename var blah >>>bug_report
bug report trying to resolve dictionary key from an empty list issue type bug report ansible version ansible configured module search path none environment running from mac os 10 10 managing ubuntu 14 04 lts summary using `with items` and an empty list the task fails if the list is expected to contain dictionaries which you try to lookup by key steps to reproduce consider this task when the `elasticsearch plugins` variable is not defined or is defined as an empty list would expect the entire task to be skipped however it looks like maybe ansible is still trying to lookup the `name` key from `item` which won exist if the list is empty and this results in the following failure `fatal ubuntu trusty one or more undefined variables unicode object has no attribute name when `elasticsearch plugins` is defined as follows this task works normally expected results when the `elasticsearch plugins` variable is an empty list this task should be skipped without attempting to lookup `item name` or `item installs to` actual results the task fails with the following error `fatal ubuntu trusty one or more undefined variables unicode object has no attribute name `>>>bug_report
ansible does not expand variables from other var files issue type bug report ansible version ansible version ansible devel c488ea019f last updated 2015 05 05 13 59 20 gmt 200 lib ansible modules core detached head c4f6e63117 last updated 2015 05 05 16 22 56 gmt 200 lib ansible modules extras detached head 28b0f3ce13 last updated 2015 05 05 16 22 56 gmt 200 v2 ansible modules core detached head 85c8a892c8 last updated 2015 05 05 16 22 57 gmt 200 v2 ansible modules extras detached head 70ea058563 last updated 2015 05 05 16 22 57 gmt 200 configured module search path none environment summary ansible does not expand variables from var files in var files directives anymore it looks like bug related to issue 9621 steps to reproduce expected results actual results >>>bug_report
ansible inventory support for ansible hosts is broken due to commit c73254543a9fc66bf2a22f978c6e979ae361221c therefore do not mention it in the man pages >>>docs_pull_request p2
missing broadcast address in facts try to template the etc network interfaces in debian need broadcast address unfortunetly there is no broadcast address in ansible facts part of setup result ansible debian jessie see that previously this was working https github com ansible ansible issues 8519 can we have it back found even similar question http grokbase com gg ansible project 14c2jdv7qn ipv4 broadcast address but without answers >>>bug_report
add azure integration tests succeeds with azure pr https github com ansible ansible modules core pull 1187>>>cloud feature_pull_request
hack to prevent tempalte copy errors on vagrant synced folders these report incorrectly errno 26 on copying file and prevent atomic move from working correctly fixes 9526 this should really warn when this happens letting the user know that the update was not atomic and that running applications might get corrupted view of the file >>>bugfix_pull_request
now properly inherit data from ansible cfg for sudo su ask pass fixes 10891>>>bugfix_pull_request p2
docs do not seem to match allow duplicates behavior the docs http docs ansible com playbooks roles html role dependencies say by default roles can also only be added as dependency once if another role also lists it as dependency it will not be run again this behavior can be overridden by adding allow duplicates yes to the meta main yml file we are then shown an example of several related roles `car` which calls `wheel` four times as dependency which in turn depends on `brake` and `tire` the example says that if you set `allow duplicates yes` in `wheel meta main yml` it will run `wheel` `brake` and `tire` each four times after noticing some behavior that didn seem to match this re created this example using ansible v1 on ubuntu 14 giving each role simple debug task if set `allow duplicates yes` on `wheel` actually see this behavior in fact see this regardless of how `allow duplicates` is set however if set `allow duplicates` for `brake` see the expected behavior for it applying `allow duplicates` to specific roles instead of recursively to all of role dependencies and honoring explicit dependency calls to role `car` calling `wheel` regardless of that setting makes more sense to me than what is described in the docs anyway so hope that this is just simple matter of correcting the docs or me if misunderstanding something >>>docs_report
stable branch ec2 py has an unbound error variable this occurs in the stack trace below specifically consistently get it because user have does not have access to rds describedbinstances which is separate bug might raise up ansible plugins inventory ec2 py traceback most recent call last file home jmhodges ansible plugins inventory ec2 py line 802 in ec2inventory file home jmhodges ansible plugins inventory ec2 py line 156 in init self do api calls update cache file home jmhodges ansible plugins inventory ec2 py line 332 in do api calls update cache self get rds instances by region region file home jmhodges ansible plugins inventory ec2 py line 389 in get rds instances by region self fail with error error unboundlocalerror local variable error referenced before assignment >>>bug_report cloud p2
add the dependency markupsafe this dependency seems to be missing>>>bugfix_pull_request needs_info
cloudstack integration tests yaml play localhost task test cs sshkeypair setup cleanup ok localhost changed false task test cs sshkeypair test fail on missing name failed localhost failed true msg missing required arguments name ignoring task test cs sshkeypair verify results of fail on missing name ok localhost msg all assertions passed task test cs sshkeypair test ssh key creation changed localhost changed true fingerprint 10 19 c9 91 27 41 f1 5b 08 0d bf 4f 61 cc 7d f2 name cloudstack sshkey private key begin rsa private key nmiicwwibaakbgqcdsbyxm0gdj2owtnkx spsesfcuvquolb 4xgaqigfr2mdzy0o ure qan3thm2pabezltdca4ds rsc9edjzcsupglyeawtczxdgcq 9rj5gr1qd n7 3xnupcgzxqqdtolzmvbdlc8zde09vgaurkomnmn6op jbiifwzqidaqab naogambjrfqm2kgnq0hc5stssvufe0v6exwdhs0csezuqzhi7io5 qao9it3qbzha nt8rbjjitqebkpn6btcutj3sntsvsl iyaphynd7pjoc voljyidzlkaf3exknce nlpjshslsckjrjptgwh8wie6xjwtcfs m6r8e0ylyfrgfzgecqqdrc8smsi7hhbbj ntlyi4uo4pvddmai8ilj5krnxehclxl8uehdiyyrdbmn pvvwk1o3efjuertb ved nlljqewahakeawjvgtajajty4e9khlpiovqlr1ezrzx06o pfpabrfsihdtd5kiqr numezvsjyyoqlcy qu5wjlw4l8hefcqkllqjat8dq7evhxpp91wmomxz5ktwge3r namc01cbdymgj4gozuqpdjpm4n noj uwbqvrxahzfaaitajndop q2yqjam ye nsmce khpigpvu3bv6gkffp ft0qcvmnatsifdpv3fesyhbjcyu68guz6aktq i0a nwpkfw sdos1fxpfztqjavkdyed1j9jtcwdjoc6tbcekpuy9agkxlokzqcxymw bo nre0vgr 0npjovbhepxiiiepjnl5ice9pvav14f4z end rsa private key task test cs sshkeypair verify results of ssh key creation ok localhost msg all assertions passed task test cs sshkeypair test ssh key creation idempotence ok localhost changed false fingerprint 10 19 c9 91 27 41 f1 5b 08 0d bf 4f 61 cc 7d f2 name cloudstack sshkey task test cs sshkeypair verify results of ssh key creation idempotence ok localhost msg all assertions passed task test cs sshkeypair test replace ssh public key changed localhost changed true fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name cloudstack sshkey task test cs sshkeypair verify results of replace ssh public key ok localhost msg all assertions passed task test cs sshkeypair test replace ssh public key idempotence ok localhost changed false fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name cloudstack sshkey task test cs sshkeypair verify results of ssh public key idempotence ok localhost msg all assertions passed task test cs sshkeypair test ssh key absent changed localhost changed true fingerprint d9 82 e9 77 f5 d1 06 6a d7 e2 67 e8 ed a2 b8 10 name cloudstack sshkey task test cs sshkeypair verify result of key absent ok localhost msg all assertions passed task test cs sshkeypair test ssh key absent idempotence ok localhost changed false task test cs sshkeypair verify result of ssh key absent idempotence ok localhost msg all assertions passed task test cs affinitygroup setup ok localhost changed false task test cs affinitygroup verify setup ok localhost msg all assertions passed task test cs affinitygroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs affinitygroup verify results of fail if missing name ok localhost msg all assertions passed task test cs affinitygroup test present affinity group changed localhost affinity type host anti affinity changed true name cloudstack ag task test cs affinitygroup verify results of create affinity group ok localhost msg all assertions passed task test cs affinitygroup test present affinity group is idempotence ok localhost affinity type host anti affinity changed false name cloudstack ag task test cs affinitygroup verify results present affinity group is idempotence ok localhost msg all assertions passed task test cs affinitygroup test absent affinity group changed localhost affinity type host anti affinity changed true name cloudstack ag task test cs affinitygroup verify results of absent affinity group ok localhost msg all assertions passed task test cs affinitygroup test absent affinity group is idempotence ok localhost changed false task test cs affinitygroup verify results of absent affinity group is idempotence ok localhost msg all assertions passed task test cs securitygroup setup changed localhost changed true name cloudstack sg task test cs securitygroup verify setup ok localhost msg all assertions passed task test cs securitygroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs securitygroup verify results of fail if missing name ok localhost msg all assertions passed task test cs securitygroup test present security group changed localhost changed true name cloudstack sg task test cs securitygroup verify results of create security group ok localhost msg all assertions passed task test cs securitygroup test present security group is idempotence ok localhost changed false name cloudstack sg task test cs securitygroup verify results present security group is idempotence ok localhost msg all assertions passed task test cs securitygroup test absent security group changed localhost changed true name cloudstack sg task test cs securitygroup verify results of absent security group ok localhost msg all assertions passed task test cs securitygroup test absent security group is idempotence ok localhost changed false task test cs securitygroup verify results of absent security group is idempotence ok localhost msg all assertions passed task test cs securitygroup rule setup custom security group changed localhost changed true name cloudstack sg task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs securitygroup rule setup default security group ok localhost changed false description default security group name default task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs securitygroup rule setup remove icmp rule ok localhost changed false security group default type ingress task test cs securitygroup rule verify remove icmp rule ok localhost msg all assertions passed task test cs securitygroup rule setup remove http range rule ok localhost changed false security group default type ingress task test cs securitygroup rule verify remove http range rule ok localhost msg all assertions passed task test cs securitygroup rule setup remove single port udp rule ok localhost changed false security group default type egress task test cs securitygroup rule verify remove single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test create http range rule changed localhost changed true cidr 32 end port 8888 protocol tcp security group default start port 8000 type ingress task test cs securitygroup rule verify create http range rule ok localhost msg all assertions passed task test cs securitygroup rule test create http range rule idempotence ok localhost changed false cidr 32 end port 8888 protocol tcp security group default start port 8000 type ingress task test cs securitygroup rule verify create http range rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test create single port udp rule changed localhost changed true end port 5353 protocol udp security group default start port 5353 type egress user security group cloudstack sg task test cs securitygroup rule verify create single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test single port udp rule idempotence ok localhost changed false end port 5353 protocol udp security group default start port 5353 type egress user security group cloudstack sg task test cs securitygroup rule verify single port udp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test icmp rule changed localhost changed true cidr icmp code icmp type protocol icmp security group default type ingress task test cs securitygroup rule verify icmp rule ok localhost msg all assertions passed task test cs securitygroup rule test icmp rule idempotence ok localhost changed false cidr icmp code icmp type protocol icmp security group default type ingress task test cs securitygroup rule verify icmp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove http range rule changed localhost changed true cidr 32 end port 8888 protocol tcp security group default start port 8000 type ingress task test cs securitygroup rule verify create http range rule ok localhost msg all assertions passed task test cs securitygroup rule test remove http range rule idempotence ok localhost changed false security group default type ingress task test cs securitygroup rule verify create http range rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove single port udp rule changed localhost changed true end port 5353 protocol udp security group default start port 5353 type egress user security group cloudstack sg task test cs securitygroup rule verify remove single port udp rule ok localhost msg all assertions passed task test cs securitygroup rule test remove single port udp rule idempotence ok localhost changed false security group default type egress task test cs securitygroup rule verify remove single port udp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule test remove icmp rule changed localhost changed true cidr icmp code icmp type protocol icmp security group default type ingress task test cs securitygroup rule verify icmp rule ok localhost msg all assertions passed task test cs securitygroup rule test remove icmp rule idempotence ok localhost changed false security group default type ingress task test cs securitygroup rule verify icmp rule idempotence ok localhost msg all assertions passed task test cs securitygroup rule cleanup custom security group changed localhost changed true name cloudstack sg task test cs securitygroup rule verify setup ok localhost msg all assertions passed task test cs instance setup ssh key changed localhost changed true fingerprint 55 c5 19 16 7a 58 d5 db 81 06 21 ed 9f e5 22 db name cloudstack sshkey private key begin rsa private key nmiicxaibaakbgqckp4li2tuc7mjcfvfoghin gxl6yjndsgwszsg wpkusgzbkbk nkjwlq26uavw4m mudsuokidn5n3rlj5i21umgvgducdoidb3 zqdc6 t3nvz j0 ny8zja9o0ibqeyewciuhbvmqtgd53e7p69h1jpfqfw7svx06qqsozmxbcfqidaqab naogaw5ms k2k1iezszcdebccfn49c0edwaopecnockqlexuyqowa vjyt v0iytr nh8 ocic9c7ccmab7g8ighvvjraojebx8b0xhk7awn4fy47i54 rj2yjvxntksp nfqqmrhgf4rd3dsy hk4vx1c2eu1cogdoc6hicngxstqmc4ecqqdo mgyxzkvkvt1 nftykwcvbktevz 3kfzod5mlmr qvw5vfq hpi5cafmzbvs5 no1dgf30rtrnlmbl njm12z37fakeamfht5wptxaothafdwk2uva9qt6ij1 unuqelokdbhbdqg0xcxnds ngwhvcd0nnksjdu kaaficb9 h0ksuoj8iwjbal3nxp69g4lungid a1cu c7f0vr nmjd4hv6hdtfvor2usnxr8ng p5iavmel5irziiyr0vuhmedex grs waii8cqbkm ngo2uhf1tmnhpqm9van9f9p5qewgrkwgu5g1vwmp4 gokjmqblt khpnu5umh5bhx nnsriizwqqwvlpxchuw8cqen2swto0v c0cmgpvsulagai1 hxyexd780xzi5e37k neuwkvtkl3dlnqelsaoths7q0ffmrejjoqapvuha5bam end rsa private key task test cs instance verify setup ssh key ok localhost msg all assertions passed task test cs instance setup affinity group ok localhost affinity type host anti affinity changed false name cloudstack ag task test cs instance verify setup affinity group ok localhost msg all assertions passed task test cs instance setup security group ok localhost changed false name cloudstack sg task test cs instance verify setup security group ok localhost msg all assertions passed task test cs instance setup instance to be absent ok localhost changed false task test cs instance verify instance to be absent ok localhost msg all assertions passed task test cs instance test create instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password km9bkyjsg password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify create instance ok localhost msg all assertions passed task test cs instance test create instance idempotence ok localhost affinity groups cloudstack ag changed false created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify create instance idempotence ok localhost msg all assertions passed task test cs instance test running instance not updated ok localhost affinity groups cloudstack ag changed false created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify running instance not updated ok localhost msg all assertions passed task test cs instance test stopping instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state stopped tags template linux debian 64 bit zone ch gva task test cs instance verify stopping instance ok localhost msg all assertions passed task test cs instance test stopping instance idempotence ok localhost affinity groups cloudstack ag changed false created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state stopped tags template linux debian 64 bit zone ch gva task test cs instance verify stopping instance idempotence ok localhost msg all assertions passed task test cs instance test updating stopped instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack display id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering micro ssh key cloudstack sshkey state stopped tags template linux debian 64 bit zone ch gva task test cs instance verify updating stopped instance ok localhost msg all assertions passed task test cs instance test starting instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack display id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering micro ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify starting instance ok localhost msg all assertions passed task test cs instance test starting instance idempotence ok localhost affinity groups cloudstack ag changed false created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack display id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering micro ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify starting instance idempotence ok localhost msg all assertions passed task test cs instance test force update running instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify force update running instance ok localhost msg all assertions passed task test cs instance test force update running instance idempotence ok localhost affinity groups cloudstack ag changed false created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state running tags template linux debian 64 bit zone ch gva task test cs instance verify force update running instance idempotence ok localhost msg all assertions passed task test cs instance test destroy instance changed localhost affinity groups cloudstack ag changed true created 2015 05 03t18 40 00 0200 default ip 185 19 28 191 display name cloudstack vm id 0b3013c7 2503 408f b410 5860402cef5b name cloudstack vm password enabled true security groups cloudstack sg service offering tiny ssh key cloudstack sshkey state destroyed tags template linux debian 64 bit zone ch gva task test cs instance verify destroy instance ok localhost msg all assertions passed task test cs instance test destroy instance idempotence ok localhost changed false task test cs instance verify destroy instance idempotence ok localhost msg all assertions passed task test cs instance cleanup ssh key changed localhost changed true fingerprint 55 c5 19 16 7a 58 d5 db 81 06 21 ed 9f e5 22 db name cloudstack sshkey task test cs instance verify cleanup ssh key ok localhost msg all assertions passed task test cs instance cleanup affinity group changed localhost affinity type host anti affinity attempts changed true name cloudstack ag task test cs instance verify cleanup affinity group ok localhost msg all assertions passed task test cs instance cleanup security group take while unless instance is expunged changed localhost attempts 25 changed true name cloudstack sg task test cs instance verify cleanup security group ok localhost msg all assertions passed task test cs instance cs instance ok localhost changed false failed false failed when result false task test cs instancegroup setup ok localhost changed false task test cs instancegroup verify setup ok localhost msg all assertions passed task test cs instancegroup test fail if missing name failed localhost failed true msg missing required arguments name ignoring task test cs instancegroup verify results of fail if missing name ok localhost msg all assertions passed task test cs instancegroup test present instance group changed localhost account mail renemoser net changed true created 2015 05 03t18 54 49 0200 domain mail renemoser net id e32e6f6a c862 491b b0b1 3c88bbbd19c9 name cloudstack ig task test cs instancegroup verify results of create instance group ok localhost msg all assertions passed task test cs instancegroup test present instance group is idempotence ok localhost account mail renemoser net changed false created 2015 05 03t18 54 49 0200 domain mail renemoser net id e32e6f6a c862 491b b0b1 3c88bbbd19c9 name cloudstack ig task test cs instancegroup verify results present instance group is idempotence ok localhost msg all assertions passed task test cs instancegroup test absent instance group changed localhost account mail renemoser net changed true created 2015 05 03t18 54 49 0200 domain mail renemoser net id e32e6f6a c862 491b b0b1 3c88bbbd19c9 name cloudstack ig task test cs instancegroup verify results of absent instance group ok localhost msg all assertions passed task test cs instancegroup test absent instance group is idempotence ok localhost changed false task test cs instancegroup verify results of absent instance group is idempotence ok localhost msg all assertions passed play recap localhost ok 126 changed 28 unreachable failed >>>cloud feature_pull_request
having task nested tasks in role leads for incorrect template path search issue type bug report ansible version environment osx yosemite 10 10 14c1514 ansible installed from pip summary not sure if this is an issue or wrong in using ansible assume that having subdirectory in roles myrole tasks is normal behaivior it just organizing your stuff around in this situation templates are being searched in not expected location steps to reproduce for example if you have this kind of task in your role `roles myrole tasks rhel repository yml` which has `template` action in it expected results expect that `rhel centos j2` templated should be searched in `role myrole templates rhel centos j2` actual results instead it searching in different locations here my template dir >>>bug_report
delegated for host sudo setting is being used instead of delegated to host settings issue type bug report ansible version environment summary setting `ansible sudo` for remote host to `true` forces `local action` tasks to use `sudo` even if the task says `sudo false` steps to reproduce create playbook for host whose `ansible sudo` value is `true` add this task and run the playbook expected results the `local action` task completes successfully actual results indicating that `sudo false` is not honoured for the `local action` if set the remote host `ansible sudo` value to `false` the `local action` works as expected >>>bug_report pending_closure
option to override playbook hosts parameter with all hosts sometimes when maintaining servers need to run playbooks against hosts there are in different groups from the one specified in the playbook hosts definition to avoid having to set all my playbooks to hosts all and use limit to decide which hosts to migrate better option would be to leave the hosts definition with the normal groups and use the proposed parameter all hosts combined with limit to migrate to different groups when necessary it can be useful when running ad hoc without inventory ansible playbooks all hosts ec2 py limit tag type webservers configure webservers yml >>>feature_pull_request
make include variable documentation consistent there is already good example of list variable ssh keys contained above this snippet so reuse the content here >>>docs_pull_request
enhancement get url should support custom headers following up on an older post https groups google com forum msg ansible project 2qkidj1kw1i 1hiyvz jwjuj would be great if get url would support headers this is required for example for the java download site to bypass the accept license agreement radio entry and probably other sites using similar restrictions http www oracle com technetwork java javase downloads jdk8 downloads 2133151 html currently have to use wget command variables >>>feature_idea
fix pylint error on cachefile does not exist since cachefile is used to show the error message when stat fail the variable need to be declared >>>bugfix_pull_request
intercept error when json is incorrect in cache file fix 10883>>>bugfix_pull_request
tweak vault description vault isn specifically for source control make description little more generic and descriptive >>>docs_pull_request
update intro dynamic inventory rst examples of special characters being converted to underscores for clarity >>>docs_pull_request
add ignore errors to command docs it would be awesome if the ignore errors option was listed on the command http docs ansible com command module html docs >>>docs_report
regression in variables precedence extra vars do not override values inside rolename vars interpolation upgraded from to and found the regression in variable interpolation and precedence still present in the variables from extra vars if used inside an interpolation within another variable defined in vars main yml lose their precedence imagine the following playbook ansible group vars all v1 group vars v1 v2 group vars v2 ansible inventories local local 127 ansible roles test role tasks main yml name print variables debug msg v1 v1 v2 v2 total total ansible roles test role vars main yml total v1 v2 ansible site yml name test playbook hosts all roles test role what happens if we launch `ansible playbook inventory ansible inventories local connection local ansible site yml extra vars v1 extra v1 pay attention to `v total` value ansible correct play test playbook gathering facts ok 127 task test role print variables ok 127 msg v1 extra v1 v2 group vars v2 total extra v1 group vars v2 play recap 127 ok changed unreachable failed ansible wrong play test playbook gathering facts ok 127 task test role print variables ok 127 msg v1 extra v1 v2 group vars v2 total group vars v1 group vars v2 play recap 127 ok changed unreachable failed may be related to bug 10817 >>>bug_report
should fix issues when the cache file is invalid json corruption fixes 10883>>>bugfix_pull_request
the documentation for ec2 ami represents the state of ansible per the devel branch not stable the ec2 ami module http docs ansible com ec2 ami module html documentation references tags which only exist as of the devel branch not stable line in devel https github com ansible ansible modules core blob e971543bd45c0e4b2affa0acf0cfbf7ea1964b1a cloud amazon ec2 ami py l260 missing in stable https github com ansible ansible modules core blob 4d27a18743a72e3a447f573ab84e1a1fb652d9cf cloud amazon ec2 ami py this could lead to confusion and unhappy users >>>docs_report
allow the use of http on custom ports in the fetch url function currently if you try to use fetch url on url when specifying https and custom port the port doesn get converted to an int >>>bugfix_pull_request
ask sudo pass in ansible cfg has no effect ansible mac osx 10 10 set in ansible cfg ask sudo pass true but when running the playbook it does not ask for password at cli ask sudo pass works fine also ask pass in the ansible cfg works as expected my ansible cfg >>>bug_report p2
ansible ec2 tags in roles being ignored hi am currently working on an ansible playbook to provision an ec2 instance it seems that after the ec2 instance has been provisioned the roles specified has been run but the tags associated with the role specified are being ignored example playbook ansible version regards steven>>>bug_report
ansible managed vcs information issue type feature idea ansible version ansible but ve checked that the feature isn in master environment summary the `ansible managed` macro is very helpful way of tagging file as being managed by ansible but including it will cause quite lot of deployment churn with multiple users since it dependent on the user running it and the path as well as the mtime of the file which may not be the time the file actually changed it would be great to have the following strings available to that macro from `git log file` author date hash shorthash short commit message as well as the current branch name thoughts on exactly how this should work welcomed >>>feature_idea
new ssh connections opened even with controlpersist 600s and pipelining true issue type bug report ansible version environment centos x86 64 running on both controller and hosts openssh 1p1 11 summary new ssh connection are opened for every task executed monitored with ps steps to reproduce ansible cfg defaults host key checking false retry files enabled false fact caching redis fact caching timeout 86400 forks 50 ssh connection ssh args controlmaster auto controlpersist 600s pipelining true example playbook yml name test persistent ssh connection hosts all sudo yes vars some list tasks command bin echo test with items some list gather facts and each new command opens new ssh connection example with vvvv each task runs this command each task opens new ssh connection establish connection for user gtirloni remote module command usr bin dd if dev zero of dev sdl bs 512 count exec ssh vvv controlmaster auto controlpersist 600s controlpath home gtirloni ansible cp ansible ssh stricthostkeychecking no port 7022 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 10 bin sh sudo sudo sudo via ansible key jathqtpyyfdjwbjyicbdzpargijdauto password root bin sh echo become success jathqtpyyfdjwbjyicbdzpargijdauto lang en us utf lc ctype en us utf usr bin python >>>bug_report
revamped base cli and moved galaxy to it own classes api ansible vault and ansible ad hoc should be done ansible playbook and ansible galaxy still need fixes but should mostly work missing ansible pull doc but they should be easy ports on top of this also threw in some fixes to display callbacks constants and errors >>>feature_pull_request p2
add become docs to the intro configuration for 10881 the docs on become are bit confusing in the example file https raw githubusercontent com ansible ansible devel examples ansible cfg there `become ask pass` and then on the become docs http docs ansible com become html there `ansible become pass` which allows you to set the password is `become ask pass` just missing from the new directives section >>>docs_pull_request p2
fact cache jsonfile exception issue type bug report ansible version ansible version ansible configured module search path usr share ansible same issue occurred with environment sles 11 sp3 summary was running playbook hit ctrl to stop it and now getting no json object could be decoded error whenever try to execute playbook or module the inventory appears to by ok because can list hosts any playbook that requires variable prompts for them before failing steps to reproduce run any playbook or module like ansible localhost ping or ansible playbook playbooks common yml expected results any playbook try to run fails with the message below actual results >>>bug_report
allow roles to use dictionary spec in dependencies pr based on input of previously rejected 10866 now based on v1 playbook code fixes 9280 >>>feature_pull_request
add documentation for privilege escalation become to ansible cfg by looking at the example file here https raw githubusercontent com ansible ansible devel examples ansible cfg it looks as though the new group would look similar to this can create pull request to add that section to the docs just wanted to confirm that will be the correct setup moving forward docs become docs http docs ansible com become html ansible configuration file docs http docs ansible com intro configuration html >>>docs_report
subelements lookup allow subelement property to be nested and add optional skip missing flag allow the subelement property to the subelements lookup plugin to be nested you can now refer to the mysql hosts subkey closes 9863 second set of patches addresses and closes 9827 by implementing an optional third list item holding dictionary of flags allowing skip missing yes to be set which will let the plugin just skip list items that do not contain the given subkey instead of raising an error >>>feature_pull_request
winrm https listener parent path command causes failure the running of this ps command https github com ansible ansible modules core blob devel windows setup ps1 l72 causes error on json conversion https github com ansible ansible blob devel lib ansible module utils powershell ps1 l68 its bit confusing since it doesn appear that winrm https listener parent path is used for anything but getting substring and in fact the error persists if you run the command and do not assign the output to variable leaving winrm https listener parent path undefined >>>bug_report windows
fetch checkum failing on freebsd targets issue type bug report ansible version fails with ansible ansible does not fail with ansible environment control mac os 10 10 darwin kernel version 14 mon dec 22 23 10 38 pst 2014 root xnu 2782 10 72 release x86 64 x86 64 target freebsd release p10 tue feb 24 21 28 03 utc 2015 summary checksum is failing for any fetch from target to control steps to reproduce fetch src etc passwd dest tmp test expected results no failure actual results failed int3 checksum c7087d1d5228292030790631f9704c917e07923c dest tmp test int3 etc passwd failed true file etc passwd md5sum d7d51960be535e352a9d01592caf0a15 remote checksum unmatched remote md5sum null msg checksum mismatch >>>bug_report
fix with inventory hostnames to work with vault this fixes 10875 so that the the lookup correctly passes the vault password to the inventory >>>bugfix_pull_request needs_revision
inventory hostnames lookup does not work with an encrypted vault file issue type bug report ansible version ansible environment summary the `inventory hostnames` lookup does not respect ansible vaults using the two in unison fails with the folllowing error vault password must be specified to decrypt path to vault file steps to reproduce create an encrypted vault file and run task similar to the following name print out all inventory hosts debug msg this is hostname item run once true with inventory hostnames hosts expected results task print out all inventory hosts ok host1 item host1 item host1 msg this is hostname host1 actual results task print out all inventory hosts fatal ny1 prod6 web001 int peer1 squarespace net vault password must be specified to decrypt opt ansible group vars spark manager fatal all hosts have already failed aborting >>>bug_report
connections hang indefinitely when remote machine forces password reset issue type feature idea ansible version environment freebsd centos potentially others summary work in an environment where sometimes password reset is forced on remote machine this is major inconvenience when working with ansible because ansible hangs until the remote machine closes the connection without error if ansible could catch this condition in some way that would be pretty great because otherwise it stops the progression of the entire playbook until the password is changed steps to reproduce run any ansible role against any remote machine where the user account password age has reached expected results ansible fails with error password is expired actual results ansible hangs until either the remote machine closes the connection or the program is terminated locally >>>feature_idea
empty notify produces exception issue type bug report ansible version environment centos 1503 x86 64 summary invalid yaml is accepted and causes runner exception steps to reproduce cat broken yml name invalid notify syntax hosts localhost tasks debug msg testing notify notify ansible playbook syntax check localhost broken yml playbook broken yml ansible lint broken yml echo ansible playbook localhost broken yml play invalid notify syntax gathering facts ok localhost task debug ok localhost msg testing notify traceback most recent call last file home gtirloni virtualenv dev bin ansible playbook line 323 in sys exit main sys argv file home gtirloni virtualenv dev bin ansible playbook line 263 in main pb run file home gtirloni virtualenv dev lib python2 site packages ansible playbook init py line 348 in run if not self run play play file home gtirloni virtualenv dev lib python2 site packages ansible playbook init py line 788 in run play if not self run task play task false file home gtirloni virtualenv dev lib python2 site packages ansible playbook init py line 548 in run task if len task notify typeerror object of type nonetype has no len >>>bug_report
removed deletion of salt by password lookup issue 10871 removed deletion of salt param from lookup file by password lookup filter when two dependent roles use single password lookup with encrypt parameter and without it leads to constant changed status of the one task >>>bugfix_pull_request needs_revision
password lookup plugin deletes salt in lookup file password lookup plugin deletes salt in lookup file this leads to constant changed status when two tasks uses same lookup one with encrypt parameter and other without for example >>>bug_report
add lineinfile integration tests for quoted string reference 10864 >>>feature_pull_request
wrong parsing of proxy response lead to ssl handshake failure issue type bug report really annoying and hard to spot ansible version ansible configured module search path none environment master opensuse 13 with running tinyproxy host sles11 sp3 with environment variable https proxy http master summary in urls py the method http request of the sslvalidationhandler class validates the proxy response by itself however if the proxy is slow to send its headers the first header can be read but not the remaining when the socket is wrapped the ssl module tries to read the sslprotocol and fails because it contains unexpected http headers the validation should wait for an line containing only as requested by http steps to reproduce try something like name download openssl 2a get url url https www openssl org source openssl 2a tar gz dest install user openssl 2a tar gz sha256sum 15b6393c20030aab02c8e2fe0243cb1d1d18062f6c095d67bca91871dc7f324a with proxy which answer very slowly after the first header expected results the task should be ok actual results msg failed to validate the ssl certificate for www openssl org 443 use validate certs no or make sure your managed systems have valid ca certificate installed paths checked for this platform etc ssl certs etc pki ca trust extracted pem etc pki tls certs usr share ca certificates cacert org etc ansible in fact the real ssl issue is errno ssl 491 error 140770fc ssl routines ssl23 get server hello unknown protocol>>>bug_report
lineinfile module can not inserting double quotes at the beginning and end of the line issue type bug report ansible version environment running on arch linux managing centos or arch linux summary when using the lineinfile module with with double quotes at the beginning and end of the line double quotes is missing similar problems in 9171 and 8806 has still not been completely solved steps to reproduce cat site yml expected results cat tmp myline txt actual results cat tmp myline txt >>>bug_report
support user specified order of operations in host patterns issue type feature idea ansible version devel environment summary support user specified order of operations in host patterns believe at least some of the relevant code is located in inventory get hosts https github com ansible ansible blob 61a30e5f49c14319c43f9321631a7c3f6f8b6554 lib ansible inventory init py l201 steps to reproduce expected results host patterns support parentheses syntax for specifying order of operations actual results this is to be expected since parentheses currently are not supported in host patterns >>>feature_idea
correct minor grammar error in playbook intro docs signed off by daniel farrell >>>docs_pull_request
clarify role spec dependencies and galaxy involvment fixes 10832>>>docs_pull_request p2
missing variables in the special variable vars issue type bug report ansible version ansible environment am running ansible in ubuntu 14 04 lts with playbook with local connection summary with ansible if include var file with `vars files` directive variables in these files are also in the special `vars` variable starting from ansible but also in in the special variable `vars` disappeared variables included with `vars files` directive steps to reproduce my vars yml play yml command expected results in ansible the output of `vars var key is `response` because can get the value of `var value` using the variable `var key` as key in the `vars` dictionary actual results in ansible but also starting from ansible `var key` and `var value` variable aren in the `vars` variable and canno access to the value of `var value` variable using the value of `var key` variable as key in `vars` >>>bug_report
include vars bug while using with first found hi have use case where am using ec2 py as `inventory` and my roles call config loader yml which trues to load yaml matching app name then just environment name and get quite crazy error when the contents of my variables are simple http foobar works but just foobar throws have made example of the bug here https github com unixunion ansible bug my structure but it seems to stem from the contents of my variables details for reproducing are in my repo k>>>bug_report
add test for https github com ansible ansible issues 9851 test case for https github com ansible ansible issues 9851 don have solution for the filter problem to commit>>>feature_pull_request
feature idea yum update only if already installed issue type feature idea ansible version environment centos summary have multiple servers that depending on their purpose contain different packages from the yum repo instead of having to run yum update prefer to have list of packages that mark to be updated like to be able to run ansible across all of my servers and be able to update the package but only if it installed you can assume that can specify list of packages per server group it would be general list steps to reproduce name update package if exists yum state latest name package name install false expected results if package name is installed yum will update that package else nothing happens returns an ok status actual results >>>feature_idea
ansible async task deletes shell script before execution issue type bug report ansible version ansible environment ansible host red hat enterprise linux server release santiago linux 32 431 29 el6 x86 64 smp sun jul 27 15 55 46 edt 2014 x86 64 x86 64 x86 64 gnu linux clients sunos 10 generic 147147 26 sun4v sparc sunw t5140 works sunos 10 generic 147147 26 sun4v sparc sunw t5140 fails summary when running command task using async we have some machines where it appears the remote files are getting deleted before the thread executes the command we have small set of solaris systems that see the issue was able to debug the issue down to where adding pause between running the command and the rm of the temp directory resolved the issues recently found the keep remote files true option and using that option allows the jobs to operate normally will try to validate the newer versions of ansible when create an environment for that we are also trying to isolate any differences between the machines where it works and the machines where it fails steps to reproduce using the playbook bash cat async test yml run through the test of an async command hosts all tasks debug msg connecting to ansible hostname name check an async command command bin sleep async poll register command result debug var command result stdout lines expected results bash sudo ansible playbook inventory hosts async test yml limit vv 	play teh 	gathering facts remote module setup 	ok 	task debug msg connecting to ansible hostname 	ok 		 msg connecting to 	task check an async command remote module async status jid 833295276491 19423 	changed ansible job id 833295276491 19423 changed true cmd bin sleep delta 00 03 037524 end 2015 04 28 14 08 31 432295 finished rc start 2015 04 28 14 08 28 394771 stderr stdout finished on 	task debug var command result stdout lines 	ok 		 command result stdout lines 	play recap ok changed unreachable failed actual results bash sudo ansible playbook inventory hosts async test yml limit vv 	play teh 	gathering facts remote module setup 	ok 	task debug msg connecting to ansible hostname 	ok 		 msg connecting to 	task check an async command remote module async status jid 226380590501 20067 	failed ansible job id 226380590501 20067 failed true results file root ansible async 226380590501 20067 	msg could not parse job output usr bin python can open file root ansible tmp ansible tmp 1430230132 79 13974167505095 command errno no such file or directory msg traceback most recent call last file root ansible tmp ansible tmp 1430230132 79 13974167505095 async wrapper line 112 in run command file usr lib python2 json init py line 307 in loads return default decoder decode file usr lib python2 json decoder py line 319 in decode obj end self raw decode idx end file usr lib python2 json decoder py line 338 in raw decode raise valueerror no json object could be decoded nvalueerror no json object could be decoded failed cmd root ansible tmp ansible tmp 1430230132 79 13974167505095 command root ansible tmp ansible tmp 1430230132 79 13974167505095 arguments data usr bin python can open file root ansible tmp ansible tmp 1430230132 79 13974167505095 command errno no such file or directory ansible job id 226380590501 20067 failed on 	fatal all hosts have already failed aborting 	play recap 			 to retry use limit root async test retry ok changed unreachable failed >>>bug_report p2
just few spelling error changes>>>docs_pull_request
feature request allow module defaults to be set in config file user should be able to set defaults for module in config file eg in ansible cfg >>>feature_idea
add logger for consul io py to help debugging hi to help on debugging consul with ansible added logger hope this will help thanks>>>feature_pull_request needs_rebase
get url dns resolution is done on the controller not the target get url sometimes fails if the dns configuration on the ansible controller is wrong names seems to be resolved on the controller then sent to the client suspect steps to reproduce configure your controller to mis resolve hostname by inserting into etc hosts github com try to download file on the target machine via get url this then fails because the target machine cannot find github com at the ip address >>>bug_report
fix for module role dependency declaration fix for module role dependency declaration module dependency declaration of git deps is claimed in the corresponding ansible documentation http docs ansible com playbooks roles html role dependencies however it not working in real life as documented in issue 920 https github com ansible ansible issues 9280 when declaring `git dep errors like this are produced error cannot find role in my ansible playbook roles https github com jaytaylor ansible docker registry or this simple liner fixes the base case >>>bugfix_pull_request
dont notify handlers from failing tasks issue type bug report ansible version environment running from ubuntu 12 04 managing ubuntu 14 04 summary force handlers can be used to run already notified handlers even if later task fails at the moment however handler is ran even if the only task that notifies it failed this seems superfluous theres no need to restart service if writing its configuration failed steps to reproduce hosts all gather facts false force handlers true tasks name notify action command bin false notify handle handlers name handle action debug expected results `handle` should not run actual results `handle` runs >>>bug_report
update ansible private keyfile to private key in documentation an old command line option was left in the documentation updated the option to be the new one >>>docs_pull_request p2
script module stdout missing if it would contain backspace sometimes script executed on the remote host by the script module which know for sure printed output does not have its output captured by ansible and included in registered variables etc task descriptions practically the same slightly different scripts first one sometimes has blank output even when the second one has non blank output during the same run the first task mount ephemeral definitely has multiple output lines on stdout in fact added extra debug echos to the very start of the script just to be sure also it formatted and mounted disks so quite sure it did run to completion the second task is very similar though without the initial debug echos and it currently seems to be working had reason to suspect the stdout of mkfs ext4 long story my debugging was more round about than this report suggests so sent just that to tmp mkfs ext4 log and sure enough now get the stdout was missing and what was it that mkfs ext4 was outputting which was perplexing ansible it appears that mkfs ext4 was backspacing over its progress fraction so it could re write it >>>bug_report p2
ec2 inventory script ec2 py needs better error messages guidance tried running ec2 py ec2 ini out of the box with all the proper boto configuration in place got error forbidden and nothing else obviously not helpful in tracking down the issue after hacked the script and added some additional error printing to the script got still it wasn clear what the problem was and where to go to fix it eventually guessed lucky and set rds false in ec2 ini and this worked suggestions rds should be defaulted to false especially since script fails cryptically for users not signed up to rds error message should indicate which part of the script failed rds ec2 etc error message should ideally suggest solution set rds false if you re not signed up to rds script should provide fuller error message not just forbidden >>>bug_report
support optional and multi receiver notifications was very surprised to find that if task fires notification handler for that notification must exist and that if there more than one handler declared for notification the documentation says nothing about what done but it looks like ansible arbitrarily picks the first handler it sees and fires that one it doesn execute all of them and doesn report an error both these behaviours make handlers much less useful when writing composeable re usable roles neither appears to be documented http docs ansible com playbooks intro html handlers running operations on change there no indication of how handler precedence operates when one role depends on another either related to 10829 which also concerns the utility of handlers what like to see is or something along those lines way to make notifications useful mechanism for extensibility in roles for hooks at certain stages of roles doing tasks >>>feature_idea
python compatible and style fixes>>>bugfix_pull_request needs_revision
make ec2 inventory plugin python compatible>>>feature_pull_request
copy fails when dest is hardlink copy modules fails with message copy dest path to existing hardlink src path to source file owner root group root mode 0644 >>>bug_report
cloudstack extend and fix cloudstack utils added generic methods and changed some parts to make use them but also added backward compatibility for the existing modules for now >>>cloud feature_pull_request
requiring roles from an external git repo doesn work as documented according to http docs ansible com playbooks roles html role dependencies can do but this doesn work when running playbook that has role that has this ansible tries to look on the local file system which of course fails cc bcoca sudarkoff >>>docs_report feature_idea p2
s3 exceptions being raised by boto on and master given name copy results to s3 s3 bucket nroute loadtest results object ansible date time date run id txt src tmp results run id txt mode put region eu east from master task copy results to s3 failed 52 166 46 failed true parsed false become success fwurcphsnjcinrjjpobxnjlqcvnazkld traceback most recent call last file home apenney ansible tmp ansible tmp 1429884459 29 240245887052132 s3 line 156 in def create bucket module s3 bucket location location default nameerror name location is not defined tried this with the latest boto 38 as well as 35 just in case it was recent regression have tried leaving the region in out of the task with no difference >>>bug_report needs_to_be_moved p2
immediate handlers feature idea ansible roles and handlers start hitting limitations when one role wants to fire actions implemented by another role immediately not just at the end of play handlers that can be declared immediate so that they fire as soon as notified would be very useful when composing multiple roles for example one role might need to perform tasks that requires restarting of services defined in another role multiple times throughout the series of tasks as far as can tell at the moment this must be done by exposing task snippets in one role to be used by inclusion in the second role using `includes it would potentially be lot cleaner to be able to invoke handlers to rerun configuration templates restart services multiple times throughout play etc >>>feature_idea
issue with include statements and role path my ansible include statement was working fine but recently after including ymls in subfolder it somehow brokes the role path here the tree of my project site yml inventory ini roles webservers files crt crt tasks main yml httpd yml dev httpd yml main yml prod httpd yml main yml templates httpd conf j2 vars main yml site yml name install base software sudo yes vars profile dev roles webservers roles webservers tasks main yml name install httpd include httpd yml name including specific tasks include profile main yml prior to this point it works just fine but the next step after including the profile main yml brokes the role path roles webservers tasks dev main yml name create httpd conf from template template src httpd conf j2 dest etc httpd conf httpd conf with items webservers httpd vhosts results an error task webservers create httpd conf from template fatal 192 168 input file not found at home me git repo projects ans roles webservers tasks templates httpd conf j2 or home me git repo projects ans httpd conf j2 fatal all hosts have already failed aborting so after this include it somehow thinks that role root is located in webservers tasks instead of webservers but in the same time it sees the variables in webservers vars path moreover it was working fine and recently just broke haven updated ansible nor edited it parameters just updated the playbook if specify the src templates httpd conf j2 it works fine but since this behaviour just appeared like from nowhere can rely on this path ve managed to use this workaround template src role path templates httpd conf j2 dest etc httpd conf httpd conf but that workaround the reason of auto pathing is broke is still undiscovered ansilbe version 1>>>bug_report needs_info p2
cloudstack fix project not found in utils minor fix to not only show projects of account if allowed >>>bugfix_pull_request
ssh controlpath should not be overridden by default ansible overrides the controlpath directive by default ignoring what is set in ssh config this means that connections that work with controlpersist using controlpath can fail to persist connections under ansible controlpath this bug only appears when using very long hostname or very long home path really would expect ansible to use the same controlpath as the underlying ssh configuration >>>bug_report
process is terminated due to stackoverflowexception issue type bug report ansible version ansible devel 716a87ff36 last updated 2015 04 23 12 58 07 gmt 500 lib ansible modules core detached head 022e5274e6 last updated 2015 01 11 15 27 34 gmt 500 lib ansible modules extras detached head a32869d492 last updated 2015 01 11 15 27 43 gmt 500 v2 ansible modules core detached head 27d5e5124f last updated 2015 01 11 15 27 48 gmt 500 v2 ansible modules extras detached head 8a4f07eecd last updated 2015 01 11 15 27 53 gmt 500 configured module search path none environment control os 10 10 client windows pro 64 bit summary attempting to make changes to local administrator account and get stackoverflowexception steps to reproduce process is terminated due to stackoverflowexception did execute the play with vvvv but not sure what to post here it pretty long expected results local administrator would have the description and fullname set to local and the password set to never expire actual results process is terminated due to stackoverflowexception >>>bug_report p2 windows
pretty format for json file caching it would be very nice to have an extra configuration option to get facts in json file cache formatted it easier to view and compare them with diff and git diff looks like that just two options for simplejson indent and sort keys true belive this code is in lib ansible cache jsonfile py >>>feature_idea
file lookups behave differently in role main var file vs in auxiliary var files issue type bug report ansible version ansible environment running from osx 10 targeting ubuntu 14 04 summary using file lookup in role main var file succeeds and an identical lookup in an auxiliary var file fails more specifically have role with two files in the vars directory `main yml` and `dev yml` in the role `tasks main yml` the first task is to conditionally include the `dev yml` var file using `include vars` the `dev yml` file contains lookup intended to read file in the role `files` directory the `main yml` file has lookup that reads successfully from the same `files` directory once the var defined using lookup in `dev yml` is referenced the playbook fails because the lookup plugin was unable to find the file steps to reproduce create role with `dev yml` var file in `dev yml` use lookup for file in the role `files` directory include the var file using `include vars` in the role `tasks main yml` the lookup will not succeed expected results expected lookups to function identically in all sibling var files actual results lookups succeed in `main yml` and fail in other files in the `vars` directory >>>bug_report
pull unable to redirect output from inside bash script have bash script that is kicking off `ansible pull` usr local bin ansible pull inventory file localhost directory var local sync url git repository key file ssh id rsa accept host key only if changed var log sync if manually trigger the pull everything works but when review var log sync` end up with the following this also happens if attempt to redirect output from my cron job this also happens when use the `2 1` redirect as well >>>bug_report
fix race condition in prepare writeable dir all ansible invocations will try to create home ansible cp` when two runs are triggered at the exact same moment they will both see `os path exists` return `false` and then try to create the dir they will then collide and one run will fail with `errno eexist` we can fix this by simplifying the code just create the dir and accept failure because of preexistence this is what the original code intended anyway >>>bugfix_pull_request
update facts py fixes for deprecationwarning object new takes no parameters on systems with python and timeouterror timer expired from get mount facts on 1>>>bugfix_pull_request
cmdline extra vars does not affect to vars inside include issue type bug report ansible version environment linux ubuntu summary while vars from inventory include with vars run with extra vars the vars in included is not affected steps to reproduce inventory include test yml included yml run expected results actual results >>>bug_report
omit not working as expected issue type bug report ansible version environment running from osx summary want to prevent some module options being set when it meets condition thought `omit` would be what want but it doesn seem to work properly steps to reproduce expected results db tv host is not set actual results `db tv host` being set to omit place holder 636798eadb717f89740d6247088d3c80af29b649` am misunderstanding how omit is to be used saw examples with item blah default omit but that does not fit my needs >>>bug_report
ansible galaxy support the include keyword in role file >>>feature_pull_request
ansible playbook fails to see inventory argument when using vault password file` or `vault password file` ansible playbook vpn yml vault password file ansible vault password foo io error unable to find an inventory file specify one with ansible playbook vpn yml foo io vault password file ansible vault password error unable to find an inventory file specify one with ansible playbook foo io vpn yml vault password file ansible vault password error unable to find an inventory file specify one with ansible playbook foo io vault password file ansible vault password vpn yml error unable to find an inventory file specify one with ansible playbook vault password file ansible vault password vpn yml foo io error unable to find an inventory file specify one with ansible playbook vault password file ansible vault password foo io vpn yml error unable to find an inventory file specify one with ansible playbook vpn yml foo io error unable to find an inventory file specify one with ansible playbook foo io vpn yml>>>bug_report
fixes vmware module utils resolves syntax errors in the `wait for tasks` removes throw from `find datacenter by name`>>>bugfix_pull_request
galaxy role path in config file is relative to cwd it should not imho hi don want to install all my deps into etc ansible` because think it better to not share all dependencies between several ansible project instead want to install my vendor like that so want to configure my ansible cfg like that because want portable installation don want to use absolute path now using vagrant to test my playbook and put my vagrantfile inside another directory so configured vagrant ansible to use specific ansible cfg because ansible looks at `cwd` like that but that not work as expected indeed have to use this kind of configuration to make it work and for me it does not make sense to make the `role paths` relative to my `cwd` because as said in other issue ansible can be fired from anywhere >>>bug_report p2
module pip fails by default problem running the pip module with following command works on first execution probably after installing python pip but fails on later executions maybe 24hrs later with following error workaround current workaround is to execute prior to the pip action solution proposal the pip module should offer an upgrade command like the apt module does with update cache yes references other sources where this problem occures found searching for solution https github com anarcher ansible docker registry issues https github com bobbyrenwick ansible pip issues 6>>>bug_report
service module not working properly hello ansible version 1ppa trusty playbook tryed to play this simple playbook against remote machine before playing playbook but on both remote servers it looks the same >>>bug_report
update documentation for lookups to mention the quoting issue using key syntax and recommend key syntax as an alternative>>>docs_pull_request
correct emphasis markup nit in playbooks vault rst it looks like the original intention was to italicize but someone was used to another markup language have switched the wrapped tags so we re showing italics and not broken link >>>docs_pull_request
add python to conrol machine requirements in docsite please see this thread in ansible project google groups https groups google com msg ansible project f30jfq5xw qexgsweakqyj>>>docs_pull_request
sudo exe with pbrun adding option hi thanks for providing the pbrun functionality as sudo exe for ansible was looking forward to it so that we can use it as part of our ops process using password over ssh keys are not an option and have setup the config as defaults ask pass true sudo exe usr local bin pbrun bin su sudo flags the resulting stack from vvvv is ssh password play setup gathering facts establish connection for user aaa remote module setup exec sshpass d4 ssh tt vvv controlmaster auto controlpersist 60s controlpath root ansible cp ansible ssh gssapiauthentication no pubkeyauthentication no user aaa connecttimeout 10 xxx bin sh mkdir home ansible tmp ansible tmp 1429636397 35 212799669152196 chmod rx home ansible tmp ansible tmp 1429636397 35 212799669152196 echo home ansible tmp ansible tmp 1429636397 35 212799669152196 put tmp tmpfm7flw to adshome aaa ansible tmp ansible tmp 1429636397 35 212799669152196 setup exec sshpass d4 ssh tt vvv controlmaster auto controlpersist 60s controlpath root ansible cp ansible ssh gssapiauthentication no pubkeyauthentication no user aaa connecttimeout 10 xxx bin sh usr local bin pbrun bin su usr local bin pbrun bin su sudo via ansible key ssss password root bin sh echo become success sss lang en us utf lc ctype en us utf usr bin python adshome aaa ansible tmp ansible tmp 1429636397 35 212799669152196 setup rm rf adshome aaa ansible tmp ansible tmp 1429636397 35 212799669152196 dev null failed xxx failed true parsed false rejected that command is not permitted by the powerbroker policy for your group evaluated records for assistance 	pbrun mypolicy more user 	aaa runhost 	xxx group 	z date and time 	2015 04 21 10 22 46 command bin su openssh 3p1 openssl 1e fips 11 feb 2013 debug1 reading configuration data etc ssh ssh config debug1 applying options for debug1 auto mux trying existing master debug2 fd setting nonblock debug2 mux client hello exchange master version debug3 mux client request forwards requesting forwardings local remote debug3 mux client request session entering debug3 mux client request alive entering debug3 mux client request alive done pid 11631 debug3 mux client request session session request sent debug1 mux client request session master session id debug1 mux client request session master session id debug3 mux client read packet read header failed broken pipe debug2 received exit status from master 127 shared connection to xxx closed it looks like gets added above not sure why that is the case on rhel6 ansible the debug above states the commands as bin sh usr local bin pbrun bin su usr local bin pbrun bin su removing the quotes around sudo exe to bin su produces the same result thanks for your help >>>bug_report
win copy template action plugins remain in repo issue type bug report ansible version environment all summary the win copy win file win template modules were added during earlier development and then reverted however win copy py and win template py remain in the actions plugins dir if they re going to eventually be used we can keep them if the new version of the modules isn going to use them they should probably be removed steps to reproduce look in the actions plugin directory >>>bug_report windows
got error when ask pass true hi all firt of all thanks for ansible love them but probably found something confusing when set `ask pass true` in `ansible cfg` get msg failed errno nodename nor servname provided or not known failed true running `ansible 9` on `os 10 10 3` against fresh `debian x64` server tried lots of options but it still doesn work so it ll be probably bug cry >>>bug_report
python compatible `except` statment>>>bugfix_pull_request
softlayer inventory include group by tags addition to softlayer inventory pluign to create groups for any tags assigned to server uses mask in the softlayer call to include all necessary info in results >>>feature_pull_request
changelog update cloudstack module names>>>docs_pull_request
minor improvements in ansible galaxy>>>bugfix_pull_request
fixed links>>>docs_pull_request
ansible install or upgrade issue hi there used ansible with success but when upgrade or uninstall and install again using pip pip install ansible upgrade and run ansible playbook got error that no module named ansible playbook ansible playbook traceback most recent call last file usr local bin ansible playbook line 44 in import ansible playbook importerror no module named ansible playbook root kmonticolo pip install ansible downloading unpacking ansible downloading ansible tar gz 916kb 916kb downloaded running setup py egg info for package ansible no previously included directories found matching v2 no previously included directories found matching docsite no previously included directories found matching ticket stubs no previously included directories found matching packaging no previously included directories found matching test no previously included directories found matching hacking no previously included directories found matching lib ansible modules core git no previously included directories found matching lib ansible modules extras git requirement already satisfied use upgrade to upgrade paramiko in usr local lib python2 site packages from ansible requirement already satisfied use upgrade to upgrade jinja2 in usr local lib python2 site packages from ansible requirement already satisfied use upgrade to upgrade pyyaml in usr local lib python2 site packages from ansible requirement already satisfied use upgrade to upgrade setuptools in usr local lib python2 site packages from ansible requirement already satisfied use upgrade to upgrade pycrypto in usr local lib python2 site packages from ansible requirement already satisfied use upgrade to upgrade ecdsa 11 in usr local lib python2 site packages from paramiko ansible requirement already satisfied use upgrade to upgrade markupsafe in usr local lib python2 site packages from jinja2 ansible installing collected packages ansible running setup py install for ansible changing mode of build scripts ansible from 600 to 755 changing mode of build scripts ansible playbook from 600 to 755 changing mode of build scripts ansible pull from 600 to 755 changing mode of build scripts ansible doc from 600 to 755 changing mode of build scripts ansible galaxy from 600 to 755 changing mode of build scripts ansible vault from 600 to 755 no previously included directories found matching v2 no previously included directories found matching docsite no previously included directories found matching ticket stubs no previously included directories found matching test no previously included directories found matching hacking no previously included directories found matching lib ansible modules core git no previously included directories found matching lib ansible modules extras git changing mode of usr local bin ansible to 755 changing mode of usr local bin ansible playbook to 755 changing mode of usr local bin ansible pull to 755 changing mode of usr local bin ansible doc to 755 changing mode of usr local bin ansible galaxy to 755 changing mode of usr local bin ansible vault to 755 successfully installed ansible cleaning up root kmonticolo uname openbsd kmonticolo generic mp i386 and now as newly created user ve got this root kmonticolo useradd test root kmonticolo su test ansible playbook traceback most recent call last file usr local bin ansible playbook line 44 in import ansible playbook importerror no module named ansible playbook >>>bug_report
mysql modules should offer my cnf path parameter that allow easy indempotence for distributions where default and secure system user exists this is the case on debian where the autogenerated file etc mysql debian cnf contains all the necessary credentials for maintenance tasks one could set reset it root password and uses etc mysql debian cnf for ansible related tasks >>>feature_idea
do not fail if there is threads fix 10784 if there is another ansible running who create the directory this can fail despites checking due to race condition so if there is exception we check that the file was not properly created in the mean time before raising error fixes 10784>>>bugfix_pull_request
correct minor spelling typos >>>docs_pull_request p2
cloudformation module requires template parameter even when doing state absent ansible version very simple task to delete cloudformation stack is throwing up unless provide valid path to file for template parameter the documentation says it is not required and the example shows it as missing from the absent example example task generates the following task delete cloudformation delete cloudformation stack failed localhost failed true msg missing required arguments template fatal all hosts have already failed aborting if you uncomment the template parameter and point it to any file not even valid cf template it works fine >>>bug_report needs_to_be_moved p2
expire password for user when creating new user account password can be set desirable behavior is to have the user login with the password once and the be forced to set new password immediately shell command could be used in this form password username but passing with items is clunky recommend the user module be enhanced to include expire password option with two flags yes and no see example below thanks >>>feature_idea
better output on undefined variable for assert issue type bug report ansible version ansible playbook devel 3db5d8199d last updated 2015 04 20 14 33 31 gmt 400 lib ansible modules core detached head a19fa6ba48 last updated 2015 04 20 14 37 19 gmt 400 lib ansible modules extras detached head df7fcc90d9 last updated 2015 04 20 14 37 23 gmt 400 v2 ansible modules core detached head 34784b7a61 last updated 2015 04 20 14 37 28 gmt 400 v2 ansible modules extras detached head df7fcc90d9 last updated 2015 04 20 14 37 32 gmt 400 configured module search path none environment os control host target host summary the assert module does not resolve variables in jinja steps to reproduce run the following playbook hosts localhost connection local gather facts false vars instance vpc tag value vpc tag value tasks assert that instance vpc tag value is defined msg required parameters missing debug msg instance vpc tag value expected results the assertion should fail as `vpc tag value` has not been set and return the msg defined in the task actual results the variable is not looked up during the `assert` and does not fail to resolve until it is called in the debug module play localhost task assert ok localhost task debug msg instance vpc tag value fatal localhost one or more undefined variables vpc tag value is undefined fatal all hosts have already failed aborting >>>feature_idea
consistently use oraclelinux in os detection previously mixture of oraclelinux and oracle linux was used causing the `ansible os family` fact not to be set to `redhat` fixes 10742 >>>bugfix_pull_request
updated intro to new become syntax also added link to full become docs fixes 10786>>>docs_pull_request p2
fix traceback with using gce on el6 with python crypto2 this fix resolves an issue on el6 systems where there may be multiple versions of pycrypto installed epel provides both `python crypto` and `python crypto2 6` these packages are co installable however modules importing the `crypto` library must specify which version to use otherwise the default will be used the libcloud `gce` provider relies on the `pycrypto` library and needs `2 6` or newer this change follows the same pattern established in `bin ansible` for specifying python library requirements >>>bugfix_pull_request
unable to find privilege escalation page by searching off docs ansible com trying to find the ansible privilege escalation http docs ansible com become html page is not possible when searching off http docs ansible com tried searching `become` `privilege escalation` and `escalation` to no avail only stumbled upon it by digging through the repo for mentions of `become` this is frustrating as an end user looking for the latest docs for the new way of handling `sudo` etc >>>docs_report p2
lookup module occansionally fails with `cannot create the path for the password lookup error was errno 17 file exists issue type bug report ansible version rc1 environment ansible run from docker container https github com generiklimited ansible docker to manage ubuntu 14 04 summary the `lookup` module can occasionally fail when running against multiple hosts the message received is `fatal cannot create the path for the password lookup error was errno 17 file exists believe the issue is that this line https github com ansible ansible blob 5dce745868720379f69c7b307a3addeafbea66e3 v2 ansible plugins lookup password py l105 needs to check to see if the error was that the directory already exists steps to reproduce note that this issue is occurring within sizeable ansible code base so the exact details might not be correct add variable in vars which gets its value from the `lookup` module `mysql password lookup password credentials service mysqlpassword create playbook which targets multiple hosts which uses the new variable run number of times making sure to remove the created file before each run expected results password file is created at the correct location and the value stored within it is used on all of the hosts actual results the `lookup` module will occasionally throw an error complaining that the directory the password file should be created in already exists >>>bug_report
parametrizing both delegate to and ansible ssh host is broken again recently upgraded to after having been stuck on for while and discovered the following bug issue type bug ansible version broken in stable tree detached head 9a07855151 last updated 2015 04 20 13 09 12 gmt 200 devel f5b00084e1 last updated 2015 04 20 12 36 25 gmt 200 works fine in bad commit according to bisect 4cd87ec93ec1f5266e5afaaa8e6734d642284afe see also 10327 and 9753 which are caused by the same commit environment ubuntu precise target host and trusty control host but probably summary the ssh connection for parametrized `delegate to uses the `ansible ssh host` as set for the original `inventory hostname` instead of the one set for the explicit one defined by the `delegate to variable steps to reproduce `group vars all` defines `ansible ssh host inventory hostname mgt mmis be `peer hostname inventory hostname node peer peer hostname is also part of the inventory basically if inventory host is `clusternode1` peer hostname becomes `clusternode2` some tasks have `delegate to peer hostname which needs to resolve this peer variable and then resolve its respective `ansible ssh host` expected results runner for the delegated task connects to peer hostname ansible ssh host actual results runner for the delegated task connects to inventory hostname ansible ssh host >>>bug_report p2
get mount facts timeout is very small and not ignored as expected ve analysed 10746 more deeply and found that my first suspition was wrong and timeout error was not really caused by lack of lsblk moreover it was not ingored as intened the reason is that uuid getting added by 10055 broke timeout handling because of python subprocess module code in execute child method there an except code catching all exceptions that why timeouterror is not caught in facts populate and ignored failed some host cmd bin lsblk ln output uuid dev sdi2 failed true rc 257 msg traceback most recent call last file line 1650 in run command file usr lib64 python2 subprocess py line 550 in init errread errwrite file usr lib64 python2 subprocess py line 988 in execute child data os read errpipe read 1048576 exceptions limited to mb file line 1796 in handle timeout timeouterror timer expired suggested solution get uuid without calling lsblk with subprocess margin note 10s timeout was enough before but with lsblk get mount facts on my system with no network filesystems mounted lasted even 15 seconds >>>bug_report
undefined names found by pyflakes in plugins inventory issue type bugfix pull request ansible version environment irrevelant slackware gnu linux summary fix missing names found by pyflakes for plugins inventory consul io py c02f114967bb3d0d63ba20a0a93854ee986541c7 plugins inventory softlayer py 79f2dca60a80839ab656eef656522fbef002e7af >>>bugfix_pull_request p2
error messages from cli should be sent to stderr issue type feature pull request ansible version environment irrevelant slackware gnu linux summary the cli in the inventory plugins directory should write their errors to `stderr` especially if they are meant to be called by inventoryscript https github com ansible ansible blob c3d34a538613eea3d6db03a700211887f697b443 lib ansible inventory script py l48 as the docker script does https github com ansible ansible blob 8c4161d4a12849afd46dea7c63b540b0437e03c3 plugins inventory docker py l178 note this is replacing the issue 10764 opened after my misunderstanding steps to reproduce execute incorrectly most of the scripts from the plugins inventory https github com ansible ansible blob devel plugins inventory directory ie expected results actual results error message is sent to `stdout` further notes some scripts use `sys exit error message which write the message to `stderr` and exit with code which is totally valid some scripts use `sys exit which would probably give exit status of 255 if the platform limit the exit code to bits wikipedia http en wikipedia org wiki exit status shell page http tldp org ldp abs html exit status html chose to use `sys stderr write as it is the more portable python syntax accross versions but didn change the scripts using the `print sys stderr form>>>bugfix_pull_request needs_rebase p2
don blow up on directory access denied when lookng for plugins when recursing through subdirectires looking for plugins don blow up if we hit subdirectory we re not permitted to list just move on this is particularly annoying when running ansible from home under os as ansible will recurse into home library where there are almost always directories the regular user may not list my first experience with running ansible version having followed the intro to the point of doing ansible all ping was to get screenful of exceptions not good start for novice ansible user >>>bugfix_pull_request
problem running playbook with roles with path that includes non ascii characters just learning ansible and my problem seems bit similar to 2752 and 3521 but in my case the path contains non ascii charaters so it not quoting problem think if my ansible config dir is in directory like this it will fail everything was fine until started to separate things to roles subirs the error popped up when tried to include role file from the main yml like in the example here https github com ansible ansible examples blob master lamp simple roles web tasks main yml the error message got is this if move everything to an only ascii dir path everything works fine home my user ascii dir ans test>>>bug_report
copy module creates an empty file named root with freebsd csh using ansible on freebsd 10 client with both debian and freebsd 10 servers on the freebsd boxes the `copy` module always creates an empty root file when `csh` is used as the shell which is the default for user `root` this can be reproduced at will using this tiny playbook hosts all user root tasks copy src etc hosts dest tmp hosts according to dtrace the file is opened by bin csh` this does not seem to happen when bin sh` is used >>>bug_report needs_info
fix ansible ssh control path string interpolation since ansible ssh control path use the old format directory we need to use the operator and not the format method at least for python >>>bugfix_pull_request p2
add requires on python six for add metaclass this also mean that this doesn run on rhel as of today >>>bugfix_pull_request p2
port some changes that occured on v1 get facts modules to v2 5c64956a7 set distribution release and version for netbsd ec01e071d adjusted for the possibility of lsblk not existing for fact gathering d4eddabb2 patch for bug 10485 ansible distribution fact populates as redhat on oracle linux systems 7813ffd71 adding uptime seconds fact for linux and darwin platforms 29cca0191 adding ovirt recognition for ovirt guests d0197195e handle etc os release files with raspbian in them 58a5f8dfa pulls machine id in ansible facts 1968f9969 wrong os family declaration for opensuse 5dec45e24 fix wrong distribution facts on sles opensuse and few others>>>bugfix_pull_request feature_pull_request
correct the ternary example fixes 10763 the `ternary` filter example in the docs is slightly wrong in the example the filter is being applied to the string john instead of the evaluation of `name john to solve this the evaluation must be wrapped in >>>docs_pull_request p2
makes ansiblemodule fail json write to stderr suggestion to fix bug 10764 strongly suggest error messages to be sent to `stderr` >>>bugfix_pull_request
docs make shell quoting rules explanation bit clearer personally got confused by the use of vs in the explanation maybe this explains it better >>>docs_pull_request p2
adding new vmware utilities module this pr adds the support for vmware utility module for frequently used functions such as `wait for task` `find datacenter by name` `vmware argument spec` `connect to api` `get all objs` this pr https github com ansible ansible modules core pull 1154 for the cluster and datacenter is using this module and has been tested >>>feature_pull_request
hostvars in ansible doesn read files in host vars when used with limit option in ansible using hostvars host bar fails when the following criteria are met ansible playbook is executed with limit inventory file is located in subdirectory rather the same level as the playbook this seems to have been introduced with as all previous ansible versions tested and do not manifest the same issue sample session showing structure and playbook executions on and sample other execution on finally the problem disappears when `inventory production` is moved to `production` >>>bug_report
meta flush handlers does not work in roles if tags is used issue type bug report ansible version devel rc2 environment tested on archos ubuntu 14 04 lts summary meta flush handlers` does not work in roles if role has tag and tags` is used with that role tag steps to reproduce yaml playbook test yml hosts localhost gather facts no roles role test role tags test role yaml role tasks test role tasks main yml shell echo test flush handlers start notify test flush handlers meta flush handlers shell echo test flush handlers end yaml role handler test role handlers main yml name test flush handlers debug msg should not run at the end bash ansible playbook test yml tags test role expected results play localhost task test role shell echo test flush handlers start changed localhost notified test role test flush handlers ok localhost msg should not run at the end task test role shell echo test flush handlers end changed localhost play recap localhost ok changed unreachable failed actual results play localhost task test role shell echo test flush handlers start changed localhost task test role shell echo test flush handlers end changed localhost notified test role test flush handlers ok localhost msg should not run at the end play recap localhost ok changed unreachable failed >>>bug_report p2
set distribution release and version for netbsd when running ansible from macos host to configure netbsd host ansible distribution and friends were set to na this patch fixes that for netbsd hosts >>>feature_pull_request
python compatibility fixes to parsing in v2 several changes to get python2 compatibility in `v2 ansible parsing` this included some changes to `v2 ansible utils unicode py` notes can always clean up the commit history if you want but figured more history is better than less ve back ported vaultaes for this pull request however there may be problems with it in python3 so especially appreciate some code review on it ll probably be submitting more thorough rewrite using the cryptography library and removing `vaultaes encrypt` >>>feature_pull_request
ec2 group fails if security group already exists issue type bug report version ansible ansible and ansible environment from debian jessie 64bit to ubuntu 14 04 ami 64bit summary was trying to run playbook that include task that sets up ec2 security group but it fails if the security group already exists if it does not exist then the task completes but once you run it again since the security group now exists it will fail steps to reproduce run playbook with the following task when the security group already exists expected results if the security group already exists and has the same rules as the task then the task should complete with no changes actual results >>>bug_report
fixed few typos in the become documentation just corrected some tiny typos >>>docs_pull_request p2
git module intermittent ssh connection errors issue type bug report ansible version environment controller os 10 10 controlled ubuntu 14 04 summary ansible consistently fails when updating several git repositories on `git` `with items` task the first time around when the repos are initially cloned works fine but afterwards it consistently fails after checking the first few repositories steps to reproduce can reproduce this problem in fairly minimal setup have clean `ubuntu 14 04` virtual machine as the `web dev test` host ip mapped through etc hosts` and setup in the `inventory` file as follows also have simple playbook `example yml` authentication is done through ssh agent forwarding and working properly obviously you should replace `git github com kilburn ansible test git` by repository that is accessible to you the content does not matter expected results running the playbook first time should clone or update all repositories each time without errors actual results the task usually fails after processing few items it does not happen every time so please give it few tries also it does not always fail on the same item observations no settings were modified between these two runs found the issue while working on non github hosted git repository so it is not github specific issue have tried enabling disabling pipelining and ssh `controlpersist` they make no difference am out of ideas on what could the cause be >>>bug_report needs_to_be_moved
adjusted for the posibolity of lsblk not existing for fact gathering fixes 10746>>>bugfix_pull_request p2
get mount facts does not work without lsblk gathering facts doesn work without lsblk utility ansible fails with message failed somehost cmd none ln output uuid dev sdb12 failed true rc 257 >>>bug_report p2
shell docs don cover different splitting behavour between args and normal variant the `args` and regular forms of the `shell` task behave differently to argument splitting and quoting in ways that re not immediately obvious do not appear documented and could cause malfunction and or even metachar related security issues these two things look the same but do different things because one passes the freeform string unquoted unescaped to the shell wheras one escapes it this will emit as expected however which looks the same will emit because the whole freeform arg is passed quoted to the shell in this form of the task this is an exceedingly dangerous and subtle behaviour change the docs really need to cover this especially for something where quote handling is quite so security critical as the shell the equivalent in non `args` form is actually where each argument is individually quoted >>>docs_report
made certain flags part of base to make them universally settable>>>feature_pull_request
setting sudo yes in vars main yml is ignored hi just upgraded from to and while my roles and inventory ssh configuration are unchanged inventory ssh configuration my role vars main yml this previously working task my role tasks main yml is now failing with whereas before the ansible upgrade it was working fine am not passing any sudo user related configuration in cli if add sudo yes to every task in the tasks main yml it works but clearly this is not something want to do has something changed in the sudo user precedence in the new ansible version that should know about this seems like bug to me but could be wrong thanks in advance yannis>>>bug_report
oracle linux no longer detected as red hat clone issue type bug report ansible version environment oracle linux server release summary oracle linux is mostly built from the same srpms as red hat enterprise linux so the `ansible os family` fact should be set to `redhat` this used to work in ansible believe that this is consequence of pull 10508 steps to reproduce expected results actual results >>>bug_report
ansible from homebrew on os 10 10 winrm kerberos error attempting to connect to host using winrm without kerberos fails with kerberos related error with ansible as distributed by homebrew have connection related variables defined for members of windows hosts group and playbook looks like ansible is local user on the windows host and member of local system administrator group it was working before and still works using 0rc1 is this an issue with ansible or the homebrew package it looks me like there might be problem with the way that ansible is failing over to plaintext auth after kerberos auth attempt fails >>>bug_report p2 windows
calling the same playbook multiple times in the parent playbook seems to only respect the variables in the last call in the parent playbook have this in foo yml have this the output that expect to get is but the actual output that get is would expect that because there is no phase in the first invocation of the playbook that variable should not be set is this expected behavior >>>bug_report
plugin loader should not return an exception if subdir is unreadable issue type bug report ansible version environment os summary plugin loader can return exceptions when traversing subdirs steps to reproduce on os the default file system is case insensitive if someone uses play in user home dir the plugin loader will traverse the library directory which can have files that are not readable by the user and produce an exception expected results no exception actual results as from ticket 10610 >>>bug_report
v2 integration test fails when performing check on resulting boolean value steps to reproduce make virtualenv pip install v2 test requirements txt pip install v2 cd test integration ansible playbook non destructive yml inventory integration config yml vvvv local result >>>bug_report
remove check of hardcoded aws region list you can extend boto to point at other regions that are defined in private cloud by defining ``boto endpoints`` or ``endpoints path`` in the `` boto`` file ansible was doing premature check against hard coded list of regions that interrupted this possibility this commit removes that and clarifies what the user can do if they specify non aws region >>>bugfix_pull_request cloud easyfix needs_info
v2 unit test errors out due to change to playiterator init arguments unit test errors out caused by 02e738500239fe5b724a814066b3af3bc412bed7 >>>bug_report
prefer dnf to yum on fedora 22 and later yum is deprecated and dnf is installed by default however the detection do not seems to take this in account and always use yum even when yum cli is just wrapper to tell use dnf as this is the case on f22 and later see package dnf yum as dnf is not installed by default except on f22 this shouldn break anything >>>feature_pull_request p2
unable to get stdout of the cat ing of file that contains and starts with special characters unfortunately the problem described in https github com ansible ansible issues 7299 has returned as of ansible version fails ansible hostxyz shell cat var log boot log sudo sudo password hostxyz success rc works properly ansible hostxyz shell cat etc motd sudo sudo password hostxyz success rc you are about to access duke university computer network that is intended for authorized users only you should have no expectation of privacy in your use of this network use of this network constitutes consent to monitoring retrieval and disclosure of any information stored within the network for any purpose including criminal prosecution current version ansible version ansible andy>>>bug_report p2
ec2 snapshot tests added bunch of unit tests for existing and new functionality of the ec2 snapshot module found here https github com ansible ansible modules core pull 1143 believe can get rid of that subproject update and squash the commit once ansible modules core pull is merged >>>feature_pull_request
fix windows paths containing spaces wrap windows paths with quotes to handle paths containing spaces updates to execution policy fix from 10664 so that parameters passed via splatting will work fixes 9999 windows integration tests pass for raw script ping slurp fetch >>>bugfix_pull_request needs_rebase p2 windows
running powershell script on windows remote host getting this error seems the powershell shebang is not installed have upgraded powershell installed the winrm pip also ran the configure ps script on the windows host failed 127 changed true rc 126 stderr bin sh root ansible tmp ansible tmp 1429094323 255856345700713 windows ps1 powershell bad interpreter no such file or directory using ansible >>>bug_report windows
jinja2 lstrip blocks as default dear ansible devs we often have long and complex templates with lots of jinja2 loops and conditionals it handy to indent them so to make it easier to read the template see that trim blocks is already the default in the template module think it makes sense to also set lstrip blocks users can easily override this by adding in the start tag the jinja2 documentation suggests that trim blocks and lstrip blocks works well in combination so it would be nice to have it as an ansible default >>>feature_idea
ansible stop at the step of sudo in playbook write sudo yes and sudo user root line if exec the playbook with paramater then linux pop the input dialog line ask the sudo password if input password error then the ansible will stop at the sudo task step no return error till express ctrl to terminate it the ansible look as dead or locked at somewhere this problem met some times no better solution >>>bug_report
fix variable name there is no role variable and given the test and code after that likely test on ds >>>bugfix_pull_request
remove old dead code variable no longer exist not used >>>bugfix_pull_request easyfix
missing import for ansible errors pylint >>>bugfix_pull_request
pylint warning the method warning is called warning>>>bugfix_pull_request
pylint show error no deprecations variable >>>bugfix_pull_request p2
add another error who seems to be all over the place for example on https github com ansible ansible blob devel v2 ansible parsing init py l141>>>feature_pull_request
fixed indent when looking at delegate to vars fixes 10699 10608 10661>>>bugfix_pull_request p2
delegated tasks do not use delegated host ansible ssh user variable 8224 the very same issue reappeared in ansible for some reason when delegate task to an existing host it provides no username but only key which results in root client0 vagrant test ansible version ansible root client0 vagrant test ansible playbook vvv inventory vagrant swift dynamic inventory py swift create and distribute rings yml play add storage devices to ring builders task swift storage add devices to rings add object devices to rings establish connection for user root remote module swift ring builder op add type object dev sdb region ip 192 168 50 weight 100 zone exec ssh tt controlmaster auto controlpersist 60s controlpath home vagrant ansible cp ansible ssh stricthostkeychecking no identityfile vagrant test insecure private key kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 192 168 50 bin sh mkdir tmp ansible tmp 1429015129 77 112957892190368 chmod rx tmp ansible tmp 1429015129 77 112957892190368 echo tmp ansible tmp 1429015129 77 112957892190368 fatal storage0 swift ring builder ssh error permission denied publickey password while connecting to 192 168 50 22 it is sometimes useful to re run the command using vvvv which prints ssh debug output to help diagnose the issue fatal all hosts have already failed aborting as you see in ssh no username is provided for swift ring builder even though root client0 vagrant test inventory vagrant swift dynamic inventory py host swift ring builder python mjson tool ansible ssh host 192 168 50 ansible ssh private key file vagrant test insecure private key ansible ssh user vagrant >>>bug_report p2
ansible permits ssh to send local lang and lc all env vars file misencoding filename corruption newer ssh versions like to send `lang` and `lc all` to the remote sshd so that the remote ssh session has the same locale as the local user session this makes ansible playbook execution including things like files created on the remote end dependent on the environment of the user running the playbook files may have different language text and or be in different text encoding file names may have different encodings too so that the file named `lvaro` in `en us utf 8` will be listed as lvaro` in `en us` even though it ll actually match the glob lvaro` as far as can tell ansible doesn support overriding environment variables for all tasks that run on given host hostgroup nor does it support the `environment` keyword at the playbook level under the `hosts` dictionary so it not currently easy to say always use the xx xx locale for this host these errors are often treated as minor and ignore able but they re anything but especially when they result in mixing utf and byte encodings this does not just affect people who use non english languages noticed the problem because use the `en au utf 8` locale on my workstation but most of the hosts manage only have the `c` `c utf 8` and `en us utf 8` locales configured the system falls back to `c` `perl` is particularly noisy about this http stackoverflow com 2499794 398670 the `locale` command will also complain the best solution imo is for ansible to use the remote end default locale by suppressing sending of `lang` and `lc all` over `ssh` by default this is most visible on debian and ubuntu systems which default to in etc ssh sshd config` as workaround for this issue users may wish to remove the above `acceptenv` directive from the `sshd config` on the server thus disallowing locales from being set by the `ssh` client alternately on the client side users may remove from their etc ssh ssh config` it does not appear to be possible to disable this on per host basis unfortunately see http superuser com 485569 167160 https bugzilla mindrot org show bug cgi id 1285 https bugs debian org cgi bin bugreport cgi bug 573316 so the ideal would be for ansible to override the `lc variables and `lang` before invoking `ssh` or for ansible to use its own global configuration file for `ssh` the simplest workaround is to create minimal `ansible ssh config` in your ansible project trees like and then override `ansible` default ssh command in an `ansible cfg` in your project tree like the downside is that if ansible default ssh command changes you won see the change >>>bug_report
add ansible cmdline variable so that notify plugins can obtain the actual command run the driver behind this change is to allow notify plugins to be able to inject the ansible command line into their messages not sure if this is the right place in the code but it works for me >>>feature_pull_request
knowing whether playbook is run in check mode issue type feature idea ansible version to this day this feature does not exist am running `ansible 1` environment summary it is natively impossible to know from task role or playbook if we are running in check mode http docs ansible com playbooks checkmode html or not steps to reproduce it can be very useful though for example some module `ufw` `git` require that the underlying executable must be installed lots of roles do that as first task if the task is run in check mode for the first time the role will fail same applies if you try to do changes to user that was not created to create symlink on file that was not copied over yet in some cases just knowing that we are in check mode is enough although agree that some cases require more work like checking the presence of an executable which `which` the presence of user with `id` but in the end knowing that we are in check mode is still very valuable even in those cases expected results variable an extra fact extra directive at the same level than `always run` `when` not sure what is the best way to present this but be happy to have others opinions actual results since it not part of ansible yet it still doable but through very hacky solutions http stackoverflow com questions 28729567 skip ansible task when running in check mode this same page also shows some more use cases for this >>>feature_idea
feature idea within host parallelization for with items loops this has come up before for example see this mailing list thread https groups google com forum topic ansible devel lhvukkszkua but the basic idea is that you may want to run large number of `command` module operations on single host in parallel via `with items` if they don have any dependencies on one another in that thread the specific example is 10 host inventory but with about 500 commands to run on each host each command taking seconds it seems that ansible has multi host parallelism baked into it deeply but doing any kind of within host parallelism requires some hackery for example you can trick ansible into using it multi host parallelism by creating fake inventory entries and having play that targets those hosts which are really all just aliases of the same machine as suggested here https groups google com msg ansible project 8yh4jy68kmk gjc2y44xjnaj depending on the complexity of your playbook this might get complicated to do and it obfuscates what really going on for people reading the playbook another thing you can do is to run script that has some parallelism internally for example you can template out script that forks and runs multiple commands but then you lose some of the nice things that ansible gives you around change detection and reporting so the idea here is effectively to add some kind of option to ansible to signal that it should try running multiple entries from `with items` list in parallel probably number indicating the desired level maximum of concurrent tasks when connecting to particular host can see this as being most useful with the `command` module or perhaps the `shell` module but there may be other use cases as well >>>feature_idea
add generic libvirt inventory plugin adds an inventory plugin for libvirt libvirt generic current limitations can only query single provider at time only queries running guests only queries the first interface returned for setting ansible ssh host grouping by tags requires that the domain xml doc is hardcoded to use https github com ansible ansible for the xmlns namespace as follows >>>feature_pull_request needs_revision
fixed wrong example of environment for setting path>>>docs_pull_request p2
update guide aws rst changed `wait` value according to ec2 module documentation>>>docs_pull_request
fixed changelog typos>>>docs_pull_request
bug new versions of system service py module fail to start php5 fpm service on ubuntu 14 04 issue type bug introduced by commit 8d53ef2f6055e174a10795bc5a084c3a36389678 ansible version stable branch is affected version works ok environment ubuntu 14 04 lts with php5 fpm dfsg 1ubuntu4 and upstart 12 steps to reproduce install ubuntu 14 04 lts with the php5 fpm package get ansible to do restart of the php5 fpm service module args name php5 fpm state restarted expected results ansible should be able to restart the service assuming the config is ok using upstart actual results ansible uses etc init php5 fpm to perform the restart and it fails comments we are using ansible from git clone not from the apt package found this problem was introduced by commit 8d53ef2f6055e174a10795bc5a084c3a36389678 in service py reverting this small changed makes it work for me tested by making the change in the temporary file on the target server in ansible tmp >>>bug_report p2
outcome of calculated variable different in play vs role vars trying to calculate the min quorum for elasticsearch and set it as variable if do this all in one play it works as expected this outputs nodes and es min master of now wanted to move this into role get the same node output but es min master of 71 suspect difference in execution of play vs role but really have no clue how this happens here is gist of simple role play full output which should make it easy to reproduce https gist github com discordianfish 88d0d8f21442c34a2e4e>>>bug_report
sudo and sudo user don work at the playbook level under certain conditions issue type bug report ansible version environment vagrant debian summary sudo sudo user don work when used as but do work at the task level this doesn seem like problem with vagrant itself but might be related to how vagrant is calling ansible which seems to only be through available flags settings either way it causes unreliable behavior steps to reproduce run `vagrant up` with the following files vagrantfile playbook yml tasks test yml expected results `whoami` should result in current user of `test` or at the very least the results should be consistent between playbook level and task level flag changes actual results `whoami` results in `vagrant` being the active user vagrant displays the ansible call as >>>bug_report
ansible load error was working with provisioning vagrant box using ansible and every time reload the vagrant with provisioning ansible used to run fine changed some provisioning script like some commands and since then get this error its not about the command as have already tested reverting back the changes but somehow get this error below assume its ansible failing to load my ansible version is >>>bug_report
sudo exe should be an inventory variable an not global one hi we have very large and heterogeneous environment with lot of solaris 10 11 and kinds of linux distribution the problem is that the sudo path is not the same everywhere if set sudo exe to usr local bin sudo in ansible cfg can have the solaris 10 working if set it to usr bin sudo get the solaris 11 and have to remove this setting to have the linux ones to work tried to add usr local bin and usr bin to the default path but ansible seems to ignore this by design think is there another solution to my problem other than requesting this feature sorry if don respect the standards on issues it the first time open one on github thank you for the great tool david>>>feature_idea
add create lock file to basic utilities prevents simultaneous execution of module by opening an exclusive lock file the lock file is automatically closed and removed at the end of the module run needed this capability for some custom modules which do terrible things if executed simultaneously and there are likely some other existing modules which could benefit from similar functionality any long running tasks like filesystem logical volume or vm creation >>>feature_pull_request needs_rebase
allow sudo true false to be set via extra vars re opening 2526 as it was closed as duplicate it is still reproducible in 01>>>feature_idea
update windows documentation to indicate how to specify kerberos auth related to changes made in 10664 >>>docs_pull_request windows
winrm connection fixes fixes executionpolicy issue described in https groups google com topic ansible devel yxqhs6oebpg discussion and introduced by 9602 fixes auth issues when kerberos is installed but not required for connection described in 10577 and https groups google com topic ansible project nnt 4bwisum discussion alternate implementation to 10644 remove winrm connection cache only useful when connecting to single host fixes issue from 10391 >>>bugfix_pull_request p2 windows
improve generation of debian changelog rather than manually maintaining the debian release history in `packaging debian changelog` let have the `makefile` handle that for us >>>feature_pull_request
delegate to prefers connection and remote user from play instead of host vars issue type bug report regression from ansible version 1rc1 environment ubuntu 14 04 controller windows 2008r2sp1 host summary example is worth thousand words additionally have the following variables defined for group winhost is part of these variables are defined in let say group vars win group yml steps to reproduce run the provided example expected results delegate to picks the connection information from the group vars and connects to the host successfully actual results 401 unauthorized basic auth failed if you uncomment the commented lines everything starts to work in ansible everything works fine as expected >>>bug_report p1
support inline comments in ansible cfg ansible cfg was defaults timeout 10 seconds result was ansible all ping traceback most recent call last file usr local bin ansible line 36 in from ansible runner import runner file usr local lib python2 site packages ansible runner init py line 36 in import ansible constants as file usr local lib python2 site packages ansible constants py line 110 in default timeout get config defaults timeout ansible timeout 10 integer true file usr local lib python2 site packages ansible constants py line 40 in get config return int value valueerror invalid literal for int with base 10 10 seconds can we support comments in config >>>bug_report p2
changes to api in freeipa compatibility fix small change for compatibility with freeipa version >>>bugfix_pull_request p2
use submodules for plugins issue type feature idea ansible version ansible and above environment ubuntu debian macos summary there are multiple ways to install ansible running from source latest release via os packages latest releases via pip however plugins distribution is not well formalized from source you get the plugins directory which is not included into pip package http docs ansible com developing plugins html distributing plugins and http docs ansible com intro configuration html speak about plugins distribution and path where deploy them but there is nothing about the inventory plugins which are part of ansible sources plugins inventory steps to reproduce expected results it would be nice to have dedicated repository ansible plugins to submit plugins extract like ansible example 9705 it could behave like ansible modules core and be git submodule and so beeing distributed via pip properly or released as dedicated pip package since it is already merged in ansible source tree actual results >>>feature_idea
doc developing plugins html distributing plugins issue type documentation inconsistency about plugins path in ansible ansible version all environment does not apply summary don know yet how to fix the doc and submit pr but http docs ansible com intro configuration html mention default plugins path like http docs ansible com developing plugins html distributing plugins mention default plugin path is steps to reproduce expected results actual results >>>docs_report
support querying systemd container information systemd writes run systemd container file in any container it starts to make it really easy to detect the container type this adds support for detecting systemd nspawn containers and any other container format that will write data there for compatibility otherwise we have to look for `1 name systemd system slice in proc cgroup` which not confident will be unique enough >>>feature_pull_request
ec2 vol module should wait until an instance is running in aws you can attach volume until the instance is in the running state if your first task is to spin up new instances and your second task is to attach pre existing volumes to them then your playbook will fail because the instances wouldn have been running at that point yet >>>bug_report needs_to_be_moved
v2 no json output all tasks are empty issue type bug report ansible version ansible devel 9e5c65babd environment mac os 10 10 summary try to get facts from any host ansible setup hosts yml vvv certs 12 expected results json with facts starting with actual results no facts the same with other modules they just become green without any actual work done >>>bug_report needs_info
updated outdated link to module directory core modules link updated and extras link added >>>docs_pull_request p2
save notifies to retry files that feature request once you have playbook that changes some configuration files and then reloads services by notifications there chance to miss reload if playbook fails by any reason next time ansible doesn think it changed the files >>>feature_idea
winrm py only use kerberos if the self user looks like domain user intended to fix https github com ansible ansible issues 10577 please test jon>>>bugfix_pull_request p2 windows
fix for when calling bootinfo throws permmission errors aix fixes https github com ansible ansible modules core issues 1108>>>bugfix_pull_request p2
remove redundant whitespace >>>docs_pull_request p2
handle blank lines and comments in galaxy spec files `ansible utils role spec parse` and v2 equivalent already handle when the roles file contains blank lines or comments make `ansible utils role spec parse` and `ansible playbook role requirement role spec parse` return more appropriate result fix ansible galaxy to make use of that information>>>bugfix_pull_request
fix indentation bcoca stable backport of https github com ansible ansible pull 10628 hadn realized that devel was based now when submitted the first pr>>>bugfix_pull_request p2
ansible not reading from aws env variables have aws access key id and aws secret access key in my environment variables set but got this instead as soon as did this with the same values it works ansible ubuntu 14 04>>>bug_report
print error message when no log is true without an error message many conditions are impossible to further diagnose there is risk that the error message might contain sensitive data but this information is more likely to be contained in other parts of the data structure as an example the current postgresql user module errors when db is readonly even if there is no change to the user but that separate pr no log unset no log set with this change note that most of the censorship still occurs which is really important when using with items otherwise the items including passwords get displayed >>>feature_pull_request
allow for installing of required roles when using ansible pull have required roles in requirements txt ansible pull has no way of being able to run `ansible galaxy install requirements yml` which means in order to run any role where the dependancies are installed with requirements txt have to store them in my ansible repo which is pita maybe add flag like requirements txt` that tells ansible pull to look for file in the repo root that contains roles to be installed before running the playbook >>>feature_idea p2
two volumes bound to the same dir starts docker with only one volume properly bound issue type bug report ansible version environment osx 10 10 docker build a8a31ef summary calling the docker http docs ansible com docker module html module with two volumes bound to the same directory causes docker to be started with only one valid mount the other mount in the docker container is mounted to nothing on the host severity using the same directory for two different mount points in the docker container is not common use case but it does come up the docker cli properly mounts all directories so this means the ansible module is not mapping of docker cli abilities extra newlines added for clarity steps to reproduce this bug is easy to reproduce by calling the ansible docker module and binding the same directory to two mount points in the docker container cause the issue is caused by lines 508 and 515 in ``ansible modules core cloud docker docker py`` because the ``self binds`` hash uses the host mount point as key to the hash since the host mount point can be used multiple times in the ``volumes`` array this python code is incorrect expected results both volumes should be mounted in the docker container from within the docker container you should be able to view both mounted volumes and see the files in the host `` tmp`` directory actual results the mount happens on the last entry in the ``volumes`` array that has the same host bind name >>>bug_report needs_to_be_moved
don pad aes ctr aes ctr doesn need to be padded because the ctr mode uses aes like stream cipher http www cryptopp com wiki ctr mode the mode does not require padding the plain text to the block size of the cipher >>>bugfix_pull_request needs_rebase p2
fixed typo>>>docs_pull_request
add environment handling to roles see also 8878 new subdirectory environment is available for roles the dictionary elements from the main yml file within are merged with those from previous roles later roles override previous ones finally the play environment is merged into the roles environment variables thus the lowest to highest precedence for any environment variable specified in multiple places is roles in role load order play task >>>feature_pull_request
need ability to created tagged ebs volumes and have them attached with delete on termination true first tried to create my ec2 instances with volume dictionary but that method doesn let me tag the volumes then tried to create the ec2 instances without the ebs volumes then created and attached the ebs volumes but that method doesn let me set them to delete on termination one alternative would have been to create the ec2 instances one at time with volume dictionary intending to loop through the volumes and tag them after the fact but then ran into the issue where unable to invoke my create one instance include in with sequential loop the ideal scenario for me would be to make ec2 support volume tags in the dictionary but be happy to get any method that works >>>feature_idea
use codecs module while reading writing json cache file utils jsonify might return unicode strings with non unicode data in them like xe4 in which case writing the file fails using codecs module fixes this >>>bugfix_pull_request needs_info
backup local now only tries to back up exising files returns otherwise fixes https github com ansible ansible modules core issues 1096>>>bugfix_pull_request p2
fix indentation incorrect indentation on line 2455 in lib ansible module utils facts py causes any custom modules that import module utils facts py to fail with an error similar to this this was introduced with https github com ansible ansible commit 29cca0191b19b5b4e5d6cc84992dc9a53b19c837 any ansible binaries suffer from this issue currently >>>bugfix_pull_request p2
rds snapshot and restore broken using ansible we re unable to snapshot an rds instance or to restore snapshot tried with boto 32 and 37 we use the following task ansible throws the following error >>>bug_report cloud needs_to_be_moved
replace in ec2 inventory as well dash is not variable ansible group name so it needs to be replaced as well without this you end up with things like tags including so you can refer to those variables in the plays even worst the error message when using it in conditions is ba wdoesn even exist see 5356>>>bugfix_pull_request p2
mac package managers ansible doesn seem to find homebrew or hombrew cask as valid package managers under osx output from ansible all setup hosts shows result of ansible pkg mgr unknown have both homebrew and homebrew cask installed on my machine are these not considered valid package managers for osx >>>feature_idea
replaced start at with start at task looks like there is typo in the documentation >>>docs_pull_request p2
fix kerberos transport when no password supplied issue type bugfix pull request ansible version ansible configured module search path opt ansible library environment red hat enterprise linux server release santiago summary if using kerberos transport on winrm and you don specify password winrm connection fails steps to reproduce get kerberos ticket attempt to connect to windows host ansible windows host win ping eansible connection winrm eansible ssh port 5986` expected results win ping returns pong actual results file usr lib python2 site packages ansible runner connection plugins winrm py line 87 in winrm connect cache key self user hashlib md5 self password hexdigest self host port typeerror md5 argument must be string or read only buffer not none`>>>bugfix_pull_request windows
unicode bug when using multibytes variables ansible im having an issue with the following jinja2 template playbook yml hosts yun remote user jefurry vars author tasks name shell echo hello debug msg author it works fine but when using multibytes variables in template im getting the following error playbook yml hosts yun remote user jefurry vars author tasks name local action shell echo author txt error details play yun gathering facts ok aliyun task failed aliyun 127 failed true parsed false traceback most recent call last file users jefurry ansible tmp ansible tmp 1428235901 38 125429082829696 command line 2073 in main file users jefurry ansible tmp ansible tmp 1428235901 38 125429082829696 command line 209 in main rc out err module run command args executable executable use unsafe shell shell file users jefurry ansible tmp ansible tmp 1428235901 38 125429082829696 command line 1691 in run command to clean args shlex split args encode utf unicodedecodeerror ascii codec can decode byte 0xe5 in position ordinal not in range 128 fatal all hosts have already failed aborting play recap to retry use limit users jefurry playbook retry aliyun ok changed unreachable failed if remove the non ascii character it works fine thanks >>>bug_report
make ansible galaxy version work for branches as well as tree ish squashes wip merges and replaces https github com ansible ansible pull 10478 version can now be branch tag or any supported by git including specific commit ids >>>feature_pull_request
v2 ssh connection error always connects as root ansible hryamzik setup certs 12 vvv play task setup establish connection for user root exec ssh tt controlmaster auto controlpersist 60s controlpath tmp ansible ssh port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user root connecttimeout 15 192 168 33 12 mkdir home ansible tmp ansible tmp 1428182372 85 107823806445548 echo home ansible tmp ansible tmp 1428182372 85 107823806445548 fatal certs 12 failed msg error ssh encountered an unknown error the output was failed true ansible setup certs 12 vvv establish connection for user hryamzik>>>bug_report p2
fix force handlers and allow it in plays and ansible cfg the force handlers` command line argument was not correctly running handlers on hosts which had tasks that later failed this corrects that and also allows you to specify `force handlers` in ansible cfg or in play this addresses the bug here https github com ansible ansible issues 10602 and implements the feature here https github com ansible ansible issues 10498>>>bugfix_pull_request p2
please provide deb packages for ubuntu utopic the ppa repository https launchpad net ansible archive ubuntu ansible does not provide packages for ubuntu utopic >>>feature_idea
update intro windows rst add bit about what windows versions ps3 is actually available for >>>docs_pull_request windows
update intro windows rst refer to powershell consistently >>>docs_pull_request windows
add ability to specify using ssh args in synchronize this pr coupled with soon to be linked ticket for the actual module itself adds new options `use ssh args` `ssh args` `use ssh args` which is boolean defaulted to `false` to keep current behavior is what is exposed currently via documentation but not in the `argument spec` `ssh args` string is not exposed via documentation and does appear in `argument spec` `use ssh args` is popped from the options and `ssh args` is added >>>feature_pull_request
cpanm not changed in anync mode name install cpanm apt name cpanminus state present when ansible os family debian name install net server ss prefork could take up to 10 minutes cpanm name net server ss prefork long poll async 1800 register cpanm async name spanm check net server ss prefork installation status async status jid cpanm async ansible job id register cpanm async result until cpanm async result finished notify reload app retries format 1800 fail msg net server ss prefork installation timeout when not cpanm async result finished cpanm async result never gets changed neither does cpanm async ansible mac os >>>bug_report
ansible galaxy does not support yaml issue type bug report ansible version environment running from osx summary get error when trying to pull role using ansible galaxy that has yaml extension on the meta file steps to reproduce `ansible galaxy install https github com picotrading ansible ulimit` expected results role installed successfully actual results `meta main yml` seems to be hardcoded in the bin https github com ansible ansible blob devel bin ansible galaxy l518>>>bug_report
delegate to not setting host variable issue type bug report ansible version environment local macosx 10 10 remote centos summary im trying to identify cases when playbook host dos not exists and playbook tasks are skipped steps to reproduce run playbook above and replace 192 168 with actual host you can reach expected results im expecting to set variable on localhost and change value if playbook are executed actual results im getting task fail as play skiped keeps true despite 192 168 can be reach and task executed code >>>bug_report p2
don recommend installing ansible via homebrew we should not recommend installing ansible via homebrew in my experience it is more trouble than it is worth and many support questions in ansible are result of homebrew some bad things that homebrew does in my opinion by default causes you to use usr local bin python` but without much explanation of such replaces the ansible bin scripts with shell scripts that manipulate `pythonpath` the `pythonpath` and above referenced shell scripts are specific to the installation of ansible via homebrew and pip does not install python dependencies in location inclusive to the modified `pythonpath` patches the source of ansible on the fly to reference non standard paths such as usr local etc ansible` this pr simply removes the homebrew reference and recommends using pip to install ansible on mac >>>docs_pull_request p2
make inventory plugin docker py work on local system and fix name fixes the containers name by using the name set by name or the first name set in names rather than preferring the name of links and dynamic names also properly sets the containers ip from networksettings ipaddress and uses localhost as hostname when running on local unix socket so it doesn break by passing null values to host while parsing yml json >>>bugfix_pull_request needs_info needs_rebase
force handlers does not run handlers when task fails issue type bug report ansible version ve verified this with ansible version ansible configured module search path none and ansible version ansible configured module search path none and ansible version ansible devel 0603b9c62c last updated 2015 04 02 10 28 17 gmt 400 lib ansible modules core detached head 613961c592 last updated 2015 04 02 10 28 46 gmt 400 lib ansible modules extras detached head eb04e45311 last updated 2015 04 02 10 28 19 gmt 400 v2 ansible modules core detached head 34784b7a61 last updated 2015 03 10 17 59 39 gmt 400 v2 ansible modules extras detached head 46e316a20a last updated 2015 04 02 10 28 19 gmt 400 configured module search path none environment running from mac os 10 10 if that makes difference summary using force handlers` doesn seem to do anything when passing force handlers` handlers only run if there are no failures on host after the notify occurs this is the same behavior as without force handlers` steps to reproduce run the following playbook with force handlers` hosts all tasks command bin true notify do ping command bin false handlers name do ping ping expected results would expect the final do ping handler to run on all hosts despite the fact that the bin false command failed because force handlers` is described to run handlers even if task fails actual results the do ping handler does not run ansible playbook playbooks test yml force handlers play all gathering facts ok 20150330 ok 20150330 ok 20150330 task command bin true changed 20150330 changed 20150330 changed 20150330 task command bin false failed 20150330 changed true cmd bin false delta 00 00 001327 end 2015 04 02 13 55 33 166623 rc start 2015 04 02 13 55 33 165296 warnings failed 20150330 changed true cmd bin false delta 00 00 001241 end 2015 04 02 13 55 41 165816 rc start 2015 04 02 13 55 41 164575 warnings failed 20150330 changed true cmd bin false delta 00 00 001264 end 2015 04 02 13 55 30 583206 rc start 2015 04 02 13 55 30 581942 warnings notified do ping fatal no hosts matched or all hosts have already failed aborting play recap to retry use limit users jesse test retry 20150330 ok changed unreachable failed 20150330 ok changed unreachable failed 20150330 ok changed unreachable failed thought the problem might be that all hosts failed but ve also tested this where single host fails rather than all hosts by adding when clause to the bin false task the do ping handler still does not run on the failed host with or without force handlers` >>>bug_report p2
fix getting name of container so links work this commit fixes getting names of docker inventory when using linked containers the containers will end up getting the name of the links instead of the name given with name therefore pop the last item in the array not the first >>>bugfix_pull_request needs_rebase
flat parameter on fetch should have options listed it looks to be boolean but doesnt show yes no as other params do http docs ansible com fetch module html>>>docs_report
bug fireball cannot execute any modules authentication or permission failure summary when attempt to use fireball mode get an error message when ansible is trying to deploy the module over the fireball connection ve traced this to fireball basically not interpreting the command in an insecure shell not sure if this is intentional but frankly have no idea how anyone has gotten this to work so that makes me think am missing something error message authentication or permission failure in some cases you may have been able to authenticate and did not have permissions on the remote directory consider changing the remote temp path in ansible cfg to path rooted in tmp failed command was mkdir tmp ansible ansible tmp 1427936806 99 221640878217542 chmod rx tmp ansible ansible tmp 1427936806 99 221640878217542 echo tmp ansible ansible tmp 1427936806 99 221640878217542 exited with result 127 fix was able to fix hack this by adding `use unsafe shell true` to utilities helper fireball py https github com ansible ansible modules core blob 950fe9ee56efdf84d944301c6d7df5b447331895 utilities helper fireball py l159 am not familiar enough with the context to determine if this is safe or correct but if understand the problem correctly fireball cannot without it example versions local host mac os 10 10 yosemite local libraries remote host centos x64 remote libraries many built by me from the fedora packages yay centos >>>bug_report
cloudstack add error result handling in async job the async job polling did not handle error state returned by the api >>>bugfix_pull_request
ansible vault encrypt is not idempotent encrypting and re encrypting file changes the contents of the file steps to reproduce create simple text file encrypt it save the encrypted version decrypt and re encrypt second time compare the two versions actual results the two files are different expected results the two encrypted files should be the same using git filters to encrypt my ansible vault files on the fly this issue causes git to think that the contents of the encrypted file are changing when my data is not actually changing >>>bug_report
manage aws users groups policies users https console aws amazon com iam home users groups https console aws amazon com iam home groups policies https console aws amazon com iam home policies are not managed by ansible >>>feature_idea
capture ioerrors on backup local happens on non posix filesystems fixes 10591>>>bugfix_pull_request
docker module choose random port if we didn pass variable in version if didn pass ports variable docker module will not bind any port to the docker host it worked correctly however in docker module choose random ports and bind to docker host think there is something wrong if remove this line ports docker ports default omit the docker module works correctly >>>bug_report needs_to_be_moved
lineinfile backup doesn work on fat32 issue type bug report ansible version environment running on arch linux managing raspbian on raspberry pi summary when using the lineinfile module with backup yes on fat32 file system get an exception it appears that some of the characters think at least the colon in the timestamp are invalid on fat32 steps to reproduce used the following task expected results it works actual results >>>bug_report
note added to source section added reminder to not use source install method if you re going to be installing ansible for tower system>>>docs_pull_request p2
support for asynchronous roles and playbooks issue type feature idea ansible version environment summary it would be nice to be able to submit an entire role or playbook as an asynchronous task it is often difficult to run complex playbook without ssh flaking out decorating every task with async is poor option and many tasks can even use async see 5841 packer does this naively when it making an image it uploads the ansible configuration to the remote then executes with remote copy of ansible which you have to install yourself despite being little cludgy this gets the desired behavior of fire once then forget for whole ansible playbook which to the best of my knowledge cannot be done using native ansible modules feel like it shouldn be that hard to implement this behavior in ansible itself perhaps in more clever manner than simply copying the files over >>>feature_idea
dont break everything when one of the vars in inject does not template wait till its used somewhere else to fail hopefully fixes 9944>>>bugfix_pull_request p2
using keys as key in dict breaks ansible runs because keys is function of dict the following task var fails with the following error renaming keys to something else like pubkeys works like charm >>>docs_report
possible fix for the first newline and triple newline problems potential fix for failing unittests currently if we give parse kv multiline nmessage1 multiline nmessage2 we get this failure the modification to line 214 logically seems to be the fix for that when we go through the next item do not append newline because we already did that when we exited the previous token loop however that creates different failure with this input blank nlines since we just messed with line 214 it seems like modifying line 254 so that we are allowed to append newlines right after another newline is the right fix after these two fixes all the current unittests pass >>>bugfix_pull_request p2
change ansibleconstructor for yaml to only return unicode strings modify the yaml constructor to always return unicode strings instead of returning unicode when non ascii characters are present and str otherwise >>>bugfix_pull_request p2
add switch to force winrm connection type currently if the system detects that kerberos libraries are installed it forces kerberos auth attempt on my os 10 10 machine this causes connections to fail since my machine is not joined to domain nor have any kerberos tickets been granted please add switch to force the winrm connection type >>>bug_report p2 windows
copy behavior changed from ansible to devel issue type bug report ansible version environment os 10 summary the copy behavior has changed from ansible to devel specifically sub directories found in src are not recursively copied to dest steps to reproduce create src directory foo and place sub directories and content in it the playbook yml test yml then the task found in test copy tasks main yml run the test expected results results should be the same as ansible which are actual results >>>bug_report p2
vagrant inventory exit on success current code has sys exit at the end of the codepath for the options help list and host these are not error conditions so should be returning for success not which is eperm operation not permitted newer vagrant versions examine the exit codes from subprocesses and interpret this as failure as do external scripts >>>bugfix_pull_request
typeerror exec command got an unexpected keyword argument become user hi we started getting this error when running playbook on lxc guest with ansible since is no longer available in the ppa this is showstopper the code below worked perfectly in now it breaks with this error >>>bug_report needs_info p2
small updates to community and contribution page>>>docs_pull_request p2
synchronize doesn respect ansible cfg ssh args we use custom ssh config with ansible it should respect the ssh args we set in the general config or we should have way to specify ssh arguments for rsync through the module >>>feature_idea
vsphere guest error hi all have bug or what ever you can think on but geting an error and just dont know why and want to slam the server am using vsphere guest to get info from my vcenter and create new vms and getting this error vsphere guest vcenter hostname xxxxxx guest ansible password value hidden username failed ansible2 failed true msg unsupported parameter for module username name test hosts all connection local tasks vsphere guest vcenter hostname vcenter username name password pass guest server vmware guest facts yes ansible configured module search path none pysphere if use python to connect the vcenter it is working but ansible not dont know how to get more info am using vvvv but think maybe the issue in the vcenter but don know what to look for thanks >>>bug_report
copy module with recursive empty dirs not copied over ansible mac osx controlling slackware linux hosts the copy module does not copy over empty directories directories that contain at least one file do get copied for ex this copy task >>>bug_report
readded sudo su vars to allow role includes to work with passed sudo su should fix 10550>>>bugfix_pull_request p2
made sequence more flexible it can now handle descending and negative sequences and is skipped if start end fixes 10401>>>bugfix_pull_request
role variables referencing group vars do not respect extra vars issue type bug report ansible version ansible environment summary ever since 313f26f866cec92e4dbe0e1d713a0ab0da647c98 if variable is set in `group vars` and overridden via extra vars` the value from `group vars` ends up being used when the variable is referenced in role variables steps to reproduce group vars all roles test role vars main yml roles test role tasks main yml main yml then call `ansible playbook some var val2 main yml` expected results actual results >>>bug_report
egg info is now written directly to lib due to the changes made in https github com ansible ansible commit 597c0f48f53067fa6bce785b86d934d903dd4d1d `ansible egg info` is now directly written to `lib` as result the directory is written removed and then the `mv` fails this pr moves the `python setup py egg info` after the removal and eliminates the `mv` >>>bugfix_pull_request
allow duplicates does not work with transitive dependencies issue type bug report ansible version environment ubuntu 14 04 summary when roles using the same transitive dependency more than level deep are applied to single host the transitive dependency is applied only once steps to reproduce have roles `postgresql third party` from ansible galaxy install and configure an instance of postgresql `roles postgresql commons meta main yml` commons settings for my projects allow duplicates yes dependencies postgresql third party `roles postgresql db1 meta main yml` creates database named db1 allow duplicates yes dependencies role postgresql commons db name db1 `roles postgresql db2 meta main yml` creates database named db2 allow duplicates yes dependencies role postgresql commons db name db2 enabling or disabling `allow duplicate` does not change anything when executing the playbook expected results would expect that the third party role is executed twice once for db1 and the other for db2 the end result would be the creation of the databases actual results the role is applied only once only the first database is created >>>bug_report
removed folding sudo su to become logic from constants as it is already present downstream in playbook play tasks hopefully fixes 10547 >>>bugfix_pull_request p2
always define error before using it when the error reason is forbidden the code throws python exception rather than simply outputting the exception reason it not nice to throw python exception when all the info to display proper message is available >>>bugfix_pull_request p2
update readme md to get debuild you need to install devscripts>>>docs_pull_request p2
update readme md think since ansible and the ansible modules have been splitted recursive should be added>>>docs_pull_request
add cobbler api authentication options add cobbler api authentication options username and password which can be provided if authentication is enabled or cobbler api is behind proxy that needs authentication >>>feature_pull_request p2
fix few spelling errors in the changelog>>>docs_pull_request p2
ansible cannot start upstart service issue type bug report ansible version environment managing centos from macos 10 10 summary the service module is failing to start an upstart service on centos steps to reproduce ansible hostname service name servicename state started expected results expected ansible to start the service this works on but fails on actual results ansible fails with the following error ansible ns1 ams as112 ripe net root service name ansible state started ns1 ams as112 ripe net failed failed true msg ansible unrecognized service >>>bug_report p2
keyerror include in v2 ansible task fail on the include modules >>>bug_report
fix consul inventory issue missing method param hi encountering an issue with the latest version of consul it looks like the api changed this update resolve the issue thanks>>>bugfix_pull_request p2
playbook sudo yes roles are not executed as sudo issue type bug ansible version from ppa stable environment linux ubuntu 12 04 host to linux debian wheezy target summary playbook roles are not executed as sudo anymore steps to reproduce consider the following playbook working with but no more working with the test yml roles addgroups tasks main yml expected results add the test group without any failure actual results failed zoo failed true name test msg groupadd permission denied groupadd cannot lock etc group try again later digging into the verbose mode we can observe that the addgroups role is still called with sudo with older version and not any more called with sudo with cheers>>>bug_report p2
v2 is returning success when module raises an uncaught exception if you modify v2 ansible modules core system ping py like this and then run v2 ansible you expect an error instead you get success message >>>bug_report p2
fix ansible galaxy add the missing parser variable https github com ansible ansible blob e1eca748fd0a7404145de5c591e10c0daf2e7b95 bin ansible galaxy l278 using variable was not declared >>>bugfix_pull_request p2
sudo true in config confuses argument parsing steps to reproduce potential cause this code https github com ansible ansible blob 8a0b8629e86efeddec7da5f8976231deee000f7f v2 ansible utils cli py l268 l280 migrates ask sudo pass` to the new `become` options but does not remove the sudo setting then this code https github com ansible ansible blob 8a0b8629e86efeddec7da5f8976231deee000f7f v2 ansible utils cli py l283 l301 fails because both settings are set version >>>bug_report p2
cloudstack common code used in cloudstack modules common code of cloudstack modules located in ansible modules extras >>>cloud feature_pull_request
reintroduce documented colon split ranges allow `webservers 25 as documented in http docs ansible com intro patterns html that the first 26 webservers so behaves differently to `webservers 25 which is 25 hosts works for both limit` and `hosts` the test documented in 9670 now works fixes 9670>>>feature_pull_request
add list comprehensions to handle structured lists useful for long structured lists and commands that can take multiple item parameters the ansible pip module brought down the time to install 80 packages from 45 minutes to minutes example usage >>>feature_pull_request
add migration how to for ansible haven found one so far maybe there aren that many migration things but at least had an issue with missing space which was perfectly fine in but is not in wrong correct >>>feature_idea
win configureremotingforansible improvements improved won throw errors if remoting is not already set up if ssl listener is already set up we verify that the cert being used is actually present on the local computer resets verbosepreference to the state it was in when the script started>>>bugfix_pull_request windows
fix some typos in changelog md>>>docs_pull_request p2
ansible is breaking this is likely some user error on my part but encountered it and it was incredibly frustrating we re using packer io to create amis we have base image that has ansible installed to do provisioning however during the provisioning process we were having ansible run `apt get upgrade` couple hours ago this started upgrading ansible to since the package was released and then subsequent tasks would fail with this error >>>bug_report p1
regression can use unicode charaters with shell module in this task used to work in but doesn work anymore in trace when running the playbook with vvvv then it works if remove all non ascii characters from the script >>>bug_report
doc building debian package asciidoc is required dependency>>>docs_pull_request p2
aws route53 and security token aka session token can make ansible work with secutiry token it doesn seem route53 module has this argument neither uses environment variable aws security token >>>bug_report cloud needs_to_be_moved
date and time filters issue type feature pull request ansible version environment all summary filters for manipulating dates and times in conditionals and variable expansions the filters allow the parsing and comparison of dates and times along with simple date arithmetic based around python timedelta see the accompanying test file for examples >>>feature_pull_request
10530 disable cowsay by default>>>feature_pull_request needs_revision
cowsay should not be enabled by default having cows fill my screen when running playbook is not the expected behavior and makes it hard to visually parse the output of ansible since cowsay is enabled not by setting but just by the presence of the cowsay binary on the system it is surprise whether or not cows will appear when run ansible playbook on new system instead of putting the burden of setting an environment variable on people who don want cows the default should be normal text output with no cows the environment variable should be renamed from ansible nocows to ansible cows this way we get sane unsurprising default but people can still get their cows if they so desire https github com ansible ansible pull 10531>>>feature_idea
rst j2 template better core module source wording>>>docs_pull_request
add support for sudo to be templated don know if this issue is related to 10317 bug but here is my problem if try to use boolean condition on the sudo field ansible does not take care of it step to reproduce launch the following playbook result expected launch id as root the third time and not as my current user >>>feature_idea
fixes ansible distribution release on debian 10 fixes 10445>>>bugfix_pull_request needs_revision p2
display better error message on role dependency yaml syntax error issue type bug report ansible version ansible environment summary improve yaml syntax error handling when using role meta main yml for dependencies in role right now if you have yaml syntax error specifically specifying list instead of dictionary for role dependencies it will throw python traceback that is not immediately clear steps to reproduce place this in your role meta main yml expected results ansible should throw an ansible yaml error for incorrect syntax in the playbook actual results python traceback >>>feature_idea
added installation instructions for arch linux hi thought make small contribution to the documentation ve built the docs and it looks good but be happy to make any adjustments if deemed necessary cheers henrik>>>docs_pull_request
slow performance issue issue type bug report ansible version ansible environment ubuntu 14 04 summary am using the many roles inside the playbook there are some tasks not all which take longer as inthe example below eg minutes just to make sure nginx service is running or minutes to create some folders don understand why this take really long just to verify service steps to reproduce here my tasks first task second task expected results several seconds for no change runs 40 seconds for creating all folders actual results first task second task >>>bug_report needs_info pending_closure
doc use literal code blocks for yaml examples without this the straight double quotes are displayed as curved quotes `` and `` >>>docs_pull_request
fix for obscure runtimeerror maximum recursion limit reached hi jimi since my paste on irc most likely already expired this should be the fix for what we ve been discussing today the issue was the assignment of stuff in init which goes through setattr and the `hasattr` check in there causes an infinite loop in getattr it might not be the best fix maybe getattr could also do with bit more defensive coding but it should work it does work for me at least if it doesn fix your issue please uploading the whole play roles and ll throw gdb at it >>>bug_report
rc2 bug playbook local or configured library dir does not allow to overrule standard module anymore issue type bug ansible version rc2ppa environment ubuntu summary previously local library folder relative to tha playbook dir or configured in ansible cfg was searched before the ansible packaged supplied module locations this allowed to use modified patched version standard module steps to reproduce had imported an old version from pull request for zabbix expected results the play just uses that older version of the module actual results which is parameter name that changed in the final version of that module that was merged in >>>bug_report p2
private property for vars prompt hangs whenever specify the private property on my vars prompt ansible takes my input but after pressing enter it hangs if take the private property out vars prompt works reference https github com ansible ansible blob 507a1ef0934b9a03c9c76c4faa84b89731f22748 docsite rst playbooks prompts rst hangs works ansible version ansible >>>bug_report p2
fixes brief spelling error fixes simple spelling mistake that was bugging me when read the online docs trying to make the docs as great as possible >>>docs_pull_request p2
role task rpm key key filename does not use roles files filename issue type bug report ansible version environment centos6 running ansible playbook hosts local provision playbook yml where hosts contains 127 summary provision roles jenkins files contains the file jenkins ci org key provision roles jenkins tasks main yml contains the line rpm key state present key jenkins ci org key but this fails as it cannot find the key file in the source the line that fails is line 92 in the file lib ansible modules core packaging os rpm key py which is doing remote os path isfile for the filename elif os path isfile key however when it is run from the playbook provision playbook yml with the keyfile in provision files jenkins ci org key rpm key state present key files jenkins ci org key then it works probably because the playbook directory is the working directory when the rpm key py is run steps to reproduce expected results actual results >>>feature_idea
now ansible ignores tempate errors on passwords they could be caused by random character combinations fixes 10468>>>bugfix_pull_request
update add host example in aws guide the add host module now uses groups instead of groupname to allow for specifying more than one group >>>docs_pull_request
v2 added context to template added support to be able to add an extra vars dictionary to tempate tasks>>>feature_pull_request
fixed command line pe options to be the same as in also fixed conflict with background option>>>bugfix_pull_request
do not throw error on skip tags when tag are not found since we want to skip these tags and they don exist anyways don think an error should be thrown since the result is the same as what the user wants we have repository of roles that we use to deploy and sometimes we skip cloning certain role because we don need it and thus its tags won exist even though the command still asks to skip that tag >>>feature_idea
configureremotingforansible ps1 and upgrade to ps3 ps1 chicken egg problem the example powershell script for setting up winrm on windows host in manner suitable for management with ansible requires powershell https github com ansible ansible blob devel examples scripts configureremotingforansible ps1 meanwhile this sample powershell script to upgrade to powershell3 suggests that it can be run inside an ansible task in the comments at the top https github com cchurch ansible blob devel examples scripts upgrade to ps3 ps1 chicken and egg though you can run upgrade to ps3 ps1 via ansible because you can setup winrm for ansible correctly with configureremotingforansible ps1 since configureremotingforansible ps1 requires powershell would be nice if configureremotingforansible ps1 didn require powershell then getting ansible working on node would be simpler as ansible itself could be used to get the node to powershell3 >>>feature_idea windows
correctly identifies oracle linux even when it lies and pretends to be redhat fixes 10485>>>bugfix_pull_request
fix patch action plugin patch use make tmp path to prevent from copying full patch file path patch fix remote src behavior according patch module documentation patch documentation says remote src us false by default that was not the case in the action plugin >>>bugfix_pull_request
vars and defaults are not documented anywhere in addition to hostvars ansible appears to have another magical data structures vars and defaults maybe also others of which have no idea these are not documented anywhere which is pity >>>docs_report
ansible distribution release returns na on raspberry pi the apt sources are default out of the box noobs just opened the box today was running some playbooks on it and noticed this specifically it was with icinga2 >>>bug_report
add umask support to git module as requested in 10279>>>feature_pull_request
now add host loads hostvars fixes 10500 after redo of inventory loading add hosts needed to call var loading explicitly >>>bugfix_pull_request p2
ignore pe methods that are not sudo for checksums until we get them working universally this restores previous behavior since su was added >>>bugfix_pull_request p1
service status fails issue type bug report ansible version environment centos summary if we want only to check the status of service the module service will force us to actually force either start or stop while we only want the get the state steps to reproduce expected results feel the command should not fail and just return the current status actual results here the command will fail the script if the returned status is not service processor is running failed hostname changed true cmd service service processor status delta >>>feature_idea
host vars for new hosts via add host are not loaded anymore currently we are using `add host` when we automatically build templates and it uses the variables provided in `host vars` file this works up to but in the variables from the `host vars` file are gone this is what delivers in the variables defined in `host vars` are gone this is the example used to show the problem >>>bug_report p2
su password prompt should be configurable in ansible cfg issue type bug report summary since version allows to configure alternative su implementations with su exe it should also be possible to configure su password prompt in ansible cfg because alternative su implementations have also alternative password prompts for example for ca sesu implementation of su the password prompt is please enter your password steps to reproduce set the following settings in ansible cfg su exe opt ca accesscontrol bin sesu su flags run something like this ansible hosts rhel6 guest user username ask pass become ask become pass become user root become method su service name ntpd state restarted expected results anisble runs task actual results ansible fails with failed ssh connection closed waiting for password prompt ansible version ansible devel 73f5a1fcdd last updated 2015 03 19 09 14 44 gmt 200 lib ansible modules core detached head 76198a8223 last updated 2015 03 19 09 15 49 gmt 200 lib ansible modules extras detached head cb848fcd9e last updated 2015 03 19 09 16 26 gmt 200 v2 ansible modules core detached head 34784b7a61 last updated 2015 03 19 09 17 05 gmt 200 v2 ansible modules extras detached head 46e316a20a last updated 2015 03 19 09 17 41 gmt 200 configured module search path none environment rhel6>>>feature_idea
method to run already notified handlers on failure we have problem with our provisioning with ansible at the current moment related to handlers we use handlers to restart services after modifying configuration but we can end up in bad situation sometimes when failure happens after the configuration has changed but before the notifications have run in this case the important service never gets restarted if you run the playbook again the configuration won be changed and it won trigger the restart but the playbook run will succeed like way to configure ansible so it will run any pending notifies before it ends with failure message it looks like there was some original talk about this feature in 4443 4766 and 4777 the last was different request then this always run handlers we don want to always run them but only when it appropriate >>>feature_idea
incorrect syntax for role include causes python stacktrace following the ansible documentation for role include http docs ansible com playbooks roles html made mistake in my syntax location of the and it caused python stacktrace instead of emitting an error message >>>bug_report p2
missing debug logs with windows issue type bug ansible version ansible installed into fresh virtualenv from pip environment ubuntu 10 04 summary trying to debug winrm issue but noticed the many of the debug logs are not getting printed out have currently set to here is the output for gathering facts some parts of messages show up added breakpoint to the verbose function just above the sanitize output command so think somewhere in sanitize output the message is incorrectly being sanitized steps to reproduce just run an ansible playbook with remote windows host and include the vvv option expected results to see the debug messages actual results see the summary >>>bug_report windows
recursive playbooks include crash it seems that ansible doesn detect recursive cyclic includes and just crashes it would be nice if ansible could check for this problem and issue warning issue type bug report ansible version steps to reproduce create playbook that includes itself expected results issue warning actual results >>>feature_idea
password expiration notice causes host to fail but task completes hello we had playbook fail this morning due to sudo password expiration notification your password will expire in days our linux servers all use samba joined to active directory to authenticate users the particular user who ran the playbook says that the actual tasks completed successfully but the host failed which caused the playbook to fail at the end of the task has anyone ever encountered this before thanks jay>>>bug_report
dig lookup plugin add support for specifying rdclass this enhances https github com ansible ansible pull 10311 by allowing the class to be specified for doing `version bind` lookups >>>feature_pull_request needs_rebase
adding comment filter this patch is adding new jinja2 filter called `comment` which allows to decorate the text with chosen comment style the main motivation behind it is to be able to have nicer `ansible managed` string the current `ansible managed` string is one and very long line the `comment` filter allows to split the string on multiple lines and decorate it with desired comment style for example if we override the `ansible managed` string in `ansible conf` like this then we can decorate the text with the `comment` filter like this that will create the following output the filter has couple of predefined comment styles and it also allows to define completely new styles inline here is couple of examples of how to use it that will produce the following output >>>feature_pull_request needs_rebase
fix retrieving private address fixes 10480>>>bugfix_pull_request
make it possible to access the http response data in fetch url without this change you would not be able to access the http response data via read this is useful so that you can display errors to users if the api you re communicating with uses non standard headers for error indication>>>feature_pull_request
set theory dict support incorporated 10483 and added support to the rest of the set theory functions test play results >>>feature_pull_request
become su fixes added missing inventory override for become method created new pe class bsdsu due to big differences in su options need to check aix solaris for linux fixes issues seen with su now that checksums do use it when present>>>bugfix_pull_request p1
avoid path issues by determining the path of ansible pull and using its issue type bugfix pull request ansible version environment linux ubuntu 14 04 trusty tahr summary running ansible pull as cron job by root can fail calling ansible and ansible playbook due path issues this reports itself as file not found error ar 17 20 32 01 ip 172 31 221 cron 9295 root cmd usr local bin ansible pull ssh bootstrap bootstrap xyz com opt bootstrap bootstrap hosts test yml tmp cronlog starting ansible pull at 2015 03 17 20 21 01 traceback most recent call last file usr local bin ansible pull line 237 in sys exit main sys argv file usr local bin ansible pull line 193 in main rc out err cmd functions run cmd cmd live true file usr local lib python2 dist packages ansible utils cmd functions py line 29 in run cmd subprocess popen cmdargs stdout subprocess pipe stderr subprocess pipe file usr lib python2 subprocess py line 710 in init errread errwrite file usr lib python2 subprocess py line 1327 in execute child raise child exception oserror errno no such file or directory steps to reproduce add the following to the root crontab usr local bin ansible pull ssh bootstrap bootstrap xyz com opt bootstrap repo bootstrap hosts test yml tmp cronlog fix avoids path issues by determining the path of ansible pull and using its path to run ansible and ansible playbook >>>bugfix_pull_request
ansible distribution fact populates as redhat on oracle linux systems `ansible oracle linux os instance setup filter ansible distribution will return oracle linux os instance success ansible facts ansible distribution redhat changed false` ansible lsb id seems to populate properly on these systems etc redhat release on said system is being populated by oracle as red hat enterprise linux server release santiago `>>>bug_report
set fact merge dict variables properly set fact does not merge dict variables but replaces the old dict with the new one instead the playbook will result in this pull request fixes the incorrect behavior resulting in the correct output with the tasks above >>>bugfix_pull_request needs_rebase needs_revision
extending union filter for dictionaries this patch allows to use the `union` filter for dictionaries the possible use case is as follows >>>feature_pull_request
mysql issue with mysql user module issue type bug report ansible version environment ubuntu 12 04 vagrant box summary it seems that mysql user module doesn play well with new version of mysql server due to changes in mysql user table for instance lack of password column it impossible to re run the playbook that contains mysql user command steps to reproduce please run this sample task twice name create mysql user mysql user name sample user password sample password priv example com all state present host example com expected results expect to have sample user created in the database it work during first run but when you run the playbook again there is an error actual results following error file home vagrant ansible tmp ansible tmp 1426543220 97 273462604863673 mysql user line 462 in main changed user mod cursor user host password priv append privs file home vagrant ansible tmp ansible tmp 1426543220 97 273462604863673 mysql user line 176 in user mod cursor execute select password from user where user and host user host file usr lib64 python2 site packages mysqldb cursors py line 173 in execute self errorhandler self exc value >>>bug_report needs_to_be_moved
if gce instance not have public ip set none sorry my english is terrible google compute engine dynamic inventory script gce py does not care about instance not have public ip if inst public ips is empty array set none >>>bug_report
openstack plugins ignore private address although the option is there private it fails traceback most recent call last file openstack py line 161 in main file openstack py line 149 in main inventory openstackinventory args private args refresh file openstack py line 58 in init self clouds shade openstack clouds self openstack config file usr local lib python2 dist packages shade init py line 68 in openstack clouds for in config get all clouds file usr local lib python2 dist packages os client config config py line 221 in get all clouds clouds append self get one cloud cloud region name region file usr local lib python2 dist packages os client config config py line 327 in get one cloud config self get base cloud config cloud file usr local lib python2 dist packages os client config config py line 159 in get base cloud config vendor file self load vendor file file usr local lib python2 dist packages os client config config py line 112 in load vendor file for path in self vendor files typeerror bool object is not iterable possible solution https gist github com gherivero 5406e5ee7db98cd36148 but will need some changes on shade working on it>>>bug_report needs_info needs_to_be_moved
ensure ansible galaxy works for scm clones when specified version differ from repository default branch fixes https github com ansible ansible issues 10477 >>>bugfix_pull_request
ansible galaxy fails to install roles when specified version differs from repository default branch when we run ansible galaxy specifying version some branch thats not the repo default branch we see because the clone is using the default branch and has not pulled down the objects required to perform the export we have developed fix that specifies the branch for the clone so the subsequent archive succeeds which we will submit in pull request >>>bug_report
darwin uptime seconds fact another try for darwin platform with the uptime seconds fact using the get sysctl method returns the following for boottime am guessing depending on the version of mac os that the order of what is returned is different or one or the other is returned maybe it changes after reboots this commit should handle any of those cases wrapping this up in try except seems yucky but not sure how else to handle it >>>feature_pull_request
ansible actions on remote server are influenced by the local even if ssh as root issue type bug report ansible version environment local osx 10 10 remote debian summary when doing `user foobar ansible playbook remote server playbook yml` where remote server is root some server in ssh configs and attempting to do unexpected results will occur in this case actions won actually happen as foobar but as root steps to reproduce run ansible as local user and attempt to take sudo sudo user actions as that user on remote server while ssh as root example playbook test yml failure example foobar is the user on the local system `foobar ansible playbook remote test yml` result `changed remote changed true cmd whoami stderr stdout root warnings success example barfoo is the user on the local system `barfoo ansible playbook remote test yml` result `changed remote changed true cmd whoami stderr stdout foobar warnings expected results regardless of the local user if ssh in as root and performing sudo user actions the actions should take place as that user actual results if the local user and the sudo user are the same username the command actually runs as root >>>bug_report
including diff in runner results return so the playbook playbook callba playbook callbacks or plugins can deal with it if you run ansible with diff the diff content is created in the subthreads of the multiprocess execution then is passed back to the runner but the runner in the partition results method is ignoring the diff so it never gets back to the playbook and cannot be used by the callbacks or stats modules that means that nothing can use the diff to deal with it plugins diff analysis storing in db printing in an specific format sending by email with this pull request that just adds line to the code the diff content is passed back to the playbook so the playbook callbacks stats or plugins can use it to perform extra operations it doesn add extra load to the network because the diff is already being passed to the main thread runner allowing configuration of remote cp the same as remote tmp is allowed instead of being hardcoded in the code>>>feature_pull_request needs_revision
add fedora 21 to the ansible galaxy meta template fedora version 21 is out since december 2014 but not listed in the meta main yml template created by ansible galaxy init not 100 certain that this is the right repo for that bug tried adding the version myself but the list of possible platforms ist queried from the galaxy api bin ansible galaxy l314 https github com ansible ansible blob 4f5ca4bb4c7f69bc153c6d819dded0974aced2f3 bin ansible galaxy l314 ansible version environment osx 10 10 steps to reproduce ansible galaxy init test expected results entry with 21 in test meta main yml after line 38>>>feature_idea
ignore errors on fire and forget reboot command results in unreachable host ssh error issue type bug report ansible version ansible configured module search path none environment centos linux release 1406 core summary am trying to reboot remote machine using the fire and forget technique describe in and with poll async and ignore errors true am getting an ssh error fatal dc cmp 01 example com ssh error data could not be sent to the remote host make sure this host can be reached over ssh when executing command reboot this may be related to upgrading from ansible el7 noarch to ansible el7 noarch normally would downgrade and retest but yum is failing to rollback the transaction am fairly certain this task was working before the upgrade have been using it for while http docs ansible com playbooks async html https support ansible com hc en us articles 201958037 reboot server and wait for it to come back steps to reproduce run the following task expected results expect the machine to reboot and ansible to properly ignore any ssh error actual results ansible playbook output important to note the command does go through can see that the machine is properly rebooted and comes back up >>>bug_report
apt module does not work well when specifying version along with with items loop when trying to install several packages with this task only package2 last one in the loop is forced to install with version package1 is installed with the latest version found on the repository running the playbook with vvvv can se how the command is eventually executed remote module apt name package1 package2 update cache yes state present force yes got it working by rewriting the task as following >>>bug_report
error when using plugins inventory openstack py with shade attempting to use openstack py with the latest version of shade and receive the following error hoping emonty will know what up addendum when comment out line 492 of shade init py the image cache error goes away and make it to another error when wrap shade meta py 115 in try except the script succeeds and get my inventory note running this against cisco openstack installation and it may indeed be some unique characteristic of it that causes it to sometimes have null values for server image id however it would be cool if this didn kill openstack py >>>bug_report
internal system is interpreting the password has being template issue type bug report ansible version environment host managed os steps to reproduce when asked for the sudo password insert the following `gr jbp 8i92m 9xz` this password has been revoked the role common yml itself is irrelevant but it asks for sudo by starting with expected results it should start running the playbook on the remote machine actual results it seems to me that the above password is being interpreted by the internal template system since by chance the password contains the chars >>>bug_report
fix for issue 10422 issue type bugfix pull request ansible version summary outputs informative error message when aws credentials are not available >>>bugfix_pull_request needs_revision p2
don convert numbers and booleans to strings before this change if variable was of type int or bool and the variable was referenced by another variable the type would change to string after this change the type of the variable will get preserved for as long as possible eg defaults main yml if you output `config` to json or yaml the port would get represented in the output as string instead of as number but secrets would get represented as dictionary this is mis match in behaviour where some types are retained and others are not this change should fix the issue >>>bugfix_pull_request
string with backslash at the end have file with the following content exec javacmd jvm opts djava util logging config file vertx jul config vertx home conf logging properties dvertx home vertx home dvertx clustermanagerfactory org vertx java spi cluster impl hazelcast hazelcastclustermanagerfactory classpath classpath org vertx java platform impl cli starter in my playbook have the following task name enable log4j sudo yes lineinfile dest vertx home bin vertx line dlog4j configuration file vertx home conf log4j properties dorg vertx logger delegate factory class name org vertx java core logging impl log4jlogdelegatefactory regexp djava util logging config file when execute ansible it says `error there was an error while parsing the task` figured the problem is the backslash at the end of the `line` string however need this backslash because in the final file it escapes the line break tried two backslashes but got the same error tried to insert space between the backslash and the quotation mark but then the final shell file is invalid because the backslash escapes the space character and not the line break is this bug or am doing something wrong thanks michel >>>bug_report
s3 sync not syncing timesstamps properly aws s3 sync is not fetching updated files from my bucket as you can see the bucket version of this file is more current and should be getting synced down however found this in the documentation exact timestamps boolean when syncing from s3 to local same sized items will be ignored only when the timestamps match exactly the default behavior is to ignore same sized items unless the local version is newer than the s3 version that not what is happening and that behavior is just plain wrong it should not be the location of the file that determines whether it should be synced or not it should instead be where am telling aws s3 to sync from and to the correct behavior should be to ignore same sized items unless the source version is newer than the target version >>>bug_report needs_to_be_moved
adding uptime seconds fact for linux and darwin platforms adds ansible uptime seconds facts for linux and darwin platforms this fact might able to be extended to other bsd platforms using sysctl >>>feature_pull_request
correct version number is the latest stable now believe >>>docs_pull_request
unclear documentation of set fact module using ansible think the documentation of the set set fact module is unclear http docs ansible com set fact module html this module allows setting new variables variables are set on host by host basis just like facts discovered by the setup module these variables will survive between plays would think that these variables will survive between plays suggests different semantics than the current behavior my expectation based on that description was that facts defined by the module would behave as though these facts had been defined as by file in etc facts such that ansible host setup would include any facts previously defined on that host via set fact task >>>docs_report
docsite returnval docs now adds module return values documentation to the web docs >>>docs_pull_request p2
git clone with connection local creates bare repo not normal checkout using in vagrant machine using the git module and trying to clone repo its creating bare repo instead of checking out the source unable to make it checkout the repo normally unless connection local flag is removed anyone experiencing the same thing >>>bug_report needs_to_be_moved
add tox and travis ci support add tox integration to run unittests in supported python releases travis ci is used for test execution additionally the unittest `testquotepgidentifier` was updated to support using `assert raises regexp` on python sample travis ci output available at https travis ci org ansible ansible builds 54189977>>>feature_pull_request p2
ansible galaxy forgive meta main yml mishaps issue type bugfix pull request ansible version wthames wthames ansible devel ansible version ansible devel c8de03d516 last updated 2015 03 13 11 14 59 gmt 1000 lib ansible modules core detached head 31cc5f543f last updated 2015 03 13 11 15 44 gmt 1000 lib ansible modules extras detached head 8baba98ebe last updated 2015 03 13 11 15 06 gmt 1000 v2 ansible modules core detached head 34784b7a61 last updated 2015 03 05 14 11 54 gmt 1000 v2 ansible modules extras detached head 46e316a20a last updated 2015 03 05 14 11 54 gmt 1000 configured module search path none environment summary for roles not created through ansible galaxy init but manually meta main yml may not exist or contain dependency information handle such cases gracefully warn but cope when meta main yml is missing warn but cope when meta main yml is inaccessible or unparseable warn but cope when meta main yml contains no dependencies data warn but cope when meta main yml effectively has dependencies none the latter case looks like all of the above cases are treated as an empty dependency list steps to reproduce create role without meta main yml file and try to install it create role with meta main yml but with no dependencies section and try to install it cope with other general problems like inaccessible or unparseable meta main yml or null dependencies section expected results warning is generated but role installation continues actual results currently ansible galaxy install bombs out when meta main yml is missing or broken with nonetype error >>>bugfix_pull_request
ansible docker module errors out summary executing task using the docker module throws an error note that the same task was working fine on the same host but has suddenly started throwing and error also if convert this to execute the task using command module it works am executing the following task from my playbook to start docker container task galera server start the galera docker service establish connection for user centos remote module docker ports 3306 3306 4567 4567 net host volumes dockers mariadb dockers mariadb command dockers mariadb mariadb start sh image e9198fa0274a name mariadb v1 remote module docker ports 3306 3306 4567 4567 net host volumes dockers mariadb dockers mariadb command dockers mariadb mariadb start sh image e9198fa0274a name mariadb v1 remote module docker ports 3306 3306 4567 4567 net host volumes dockers mariadb dockers mariadb command dockers mariadb mariadb start sh image e9198fa0274a name mariadb v1 exec ssh vvv controlmaster auto controlpersist 60s controlpath users bdastur ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentic ation no user centos connecttimeout 120 172 22 191 206 bin sh sudo sudo udo via ansible key pxezevjstnzroeefsfsjkhiraikpqaht password root bin sh echo become su ccess pxezevjstnzroeefsfsjkhiraikpqaht lang en us utf lc ctype en us utf usr bin python exec ssh vvv controlmaster auto controlpersist 60s controlpath users bdastur ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentic ation no user centos connecttimeout 120 172 22 191 207 bin sh sudo sudo udo via ansible key rnyxokantfsypwbjkmurcqcjfzaboxmp password root bin sh echo become su ccess rnyxokantfsypwbjkmurcqcjfzaboxmp lang en us utf lc ctype en us utf usr bin python exec ssh vvv controlmaster auto controlpersist 60s controlpath users bdastur ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentic ation no user centos connecttimeout 120 172 22 191 208 bin sh sudo sudo udo via ansible key wcfuqrjabayucinpbrncciuuxvjtzyap password root bin sh echo become su ccess wcfuqrjabayucinpbrncciuuxvjtzyap lang en us utf lc ctype en us utf usr bin python failed 172 22 191 206 failed true parsed false become success pxezevjstnzroeefsfsjkhiraikpqaht openssh 2p2 osslshim 8r dec 2011 debug1 reading configuration data etc ssh config debug1 etc ssh config line 20 applying options for debug1 etc ssh config line 102 applying options for debug1 auto mux trying existing master debug2 fd setting nonblock debug2 mux client hello exchange master version debug3 mux client forwards request forwardings local remote debug3 mux client request session entering debug3 mux client request alive entering debug3 mux client request alive done pid 25739 debug3 mux client request session session request sent debug1 mux client request session master session id traceback most recent call last file line 3032 in file line 1406 in main file line 1274 in started file line 1185 in start containers typeerror start got an unexpected keyword argument pid mode debug3 mux client read packet read header failed broken pipe debug2 received exit status from master >>>bug_report
autoenv script doesn hurt anyone not using autoenv https github com kennethreitz autoenv and helps those that do >>>feature_pull_request
ansible ignores extra words in interpolated task issue type bug report ansible version environment osx summary using extra vars on the command line causes values to be truncated if they contain spaces steps to reproduce run `ansible playbook irc yml local new name tom hanks or `ansible playbook host irc yml local var` where var simply contains `new name tom hanks` where irc yml is expected results an error actual results >>>bug_report
libvirt lxc connection won work on non selinux enabled platforms like ubuntu there is long standing bug in virsh that will affect users of ubuntu or any platform that does not ship selinux https www redhat com archives libvirt users 2013 july msg00146 html on ubuntu platforms the only advertised security model for lxc per `virsh lxc capabilities` is `none` when executing `virsh lxc lxc enter namespace` like the libvirt lxc connection plugin does this results in the following error the libvirt lxc connection plugin would see this on every `exec command` `put file` and `fetch file` making the plugin rather unusable under the circumstances the workaround suggested in the ml thread is to invoke `lxc enter namespace` with the noseclabel` option hesitant to send patch for `libvirt lxc py` to that effect though because have no way to test on an selinux enabled lxc system >>>bug_report
add account id grouping to ec2 py dynamic inventory it possible to run multiple incarnations of ec2 py to pull in hosts from multiple aws accounts but the hosts have no attribute or grouping to distinguish which account they are in this change adds an aws account id attribute to instances and corresponding group allowing instances to be identified by account in multi account environments >>>feature_idea
fixed and reintroduced syncronize test fakerunner object needed become method to be it default sudo >>>bugfix_pull_request p2
include vars is replacing hash even when hash behaviour merge issue type bug report ansible version ansible environment for completeness this is osx 10 ubuntu 12 04 summary include vars is replacing hash even when hash behaviour merge steps to reproduce with hash behaviour merge set in ansible cfg or ansible hash behaviour merge as an environment variable trivial command ``ansible playbook local test plyabook yml vv`` test playbook yml name wrapper for testing testrole hosts localhost gather facts no roles testrole roles testrole tasks main yml include vars defaults default yml include vars defaults ubuntu yml name demo debug msg foo to nice json roles testrole defaults default yml foo key value key value list list element list element dict subkey value subkey value roles testrole defaults ubuntu yml foo key value list list element dict subkey value expected results if it were only shallow merge with replacement of deeper parts of the structure would expect to see ``key value b`` unchanged in the output ok localhost msg dict subkey value key value key value list list element and if it were supposed to be deep merge would expect to see lista with elements and dicta should have subkeys one of which has the value from the 2nd file ubuntu yml foo key value key value list list element list element list element dict subkey value subkey value actual results the actual results are the same as for hash behaviour replace task testrole include vars defaults default yml ok localhost ansible facts foo dict subkey value subkey value key value key value list list element list element task testrole include vars defaults ubuntu yml ok localhost ansible facts foo dict subkey value key value list list element task testrole demo ok localhost msg dict subkey value key value list list element >>>bug_report
ansible distribution release is na for debian 10 squeeze using ansible but the problem still exists in >>>bug_report
replace error with strings inadvertently containing regexp group reference issue type bug report ansible version ansible version ansible configured module search path usr share ansible environment summary when trying to replace value in file replace thinks use group reference which is not present however actually have string that contains the text which is escaped to and therefore perceived by replace as group reference understand why this happends and maybe it just me doing things the wrong way but just can see what should do differently steps to reproduce playbook https gist github com horrorhead 691035576a0c79a42c33 file reproduce replace error yml text file https gist github com horrorhead 07f18c290500c1269452 file replace txt expected results had expected this to replace the line value sometext with value sometext 8somemoretext actual results the play fails with the following error >>>bug_report
synchronize py module failing for rhel tikanga rsync out format unknown option when am running ansible playbook from rhel tikanga am getting following error failed ip 127 cmd rsync delay updates ff compress archive rsh ssh none stricthostkeychecking no out format prd file tar gz roles server files abc tar tgz root remoteip tmp failed true rc msg rsync out format unknown option rsync error syntax or usage error code at main 1231 client fatal all hosts have already failed aborting am using synchronize module of ansible for copying operation which is failing since rsync out format unknown option have also changed synchronize py module by adding some lines of code to avoid the above prblem please look into this as for rhel its not working thanks and regards kunal dembla>>>bug_report
services not starting properly on centos6 hello writing simple playbook helping with provisioning node with cloudera manager on centos6 have the following directive in it however it does not work as expected the service doesn get started every time run ansible get the following after some digging found out that the service returns the following when check it status after some digging got to https github com ansible ansible modules core blob devel system service py l573 which seems to explain why the service isn getting started have the following questions why is the textual output parsed before the return code it seems like very unreliable way to check if service is running as the example above shows pretty much every service ve run into adheres to the lsb in the lsb section why is return code 69 checked it does not appear in the specification linked in the comment how do get around it should simply run service cloudera scm server db start instead of using the service module or is there more elegant way >>>bug_report needs_to_be_moved p2
null stdout inside vagrant hi setting up vm on osx running unusable version but actually running scripts shell command raw script give me null stdout switch to osx it works fine>>>needs_info
configureremotingforansible ps1 certvaliditydays not hooked up small bug but affecting people like me that are downloading this raw via within our playbooks https raw githubusercontent com ansible ansible devel examples scripts configureremotingforansible ps1 the ps1 param certvaliditydays` is collected but never passed to `new selfsignedcertificate validdays certvaliditydays` on line 140 145 which keeps the value at the defaulted 365 days in my case never want to replace the cert for the life of the box >>>bug_report
fixes password error detection for ssh connection plugin removes sycnronize test that does not work with current sudo setup fixes 10434>>>bugfix_pull_request p1
stack trace with rc using vagrant ansible integration ansible version stack trace >>>bug_report p1
vm extra config section of vsphere guest isn being applied ansible devel ffb281d when using the vsphere guest module noticed that this configuration option was not working tried using beat beta datacentrename beta datacentrename vm beta the vm would always end up in the same folder as the template to troubleshoot the issue added the notes field and it didn take either it appears that the vm extra config section isn being applied which would explain why some of the options tried didn generate error messages either ansible devel ffb281d last updated 2015 03 04 01 13 13 gmt 500 here is my play >>>bug_report needs_to_be_moved p2
fixed traceback when user implicitly sets the become method fixes 10430 also removed redundant resolution of sudo su for backwards compatibility which confused the conflict detection code >>>bugfix_pull_request p1
add aix mounts information example snippet what it now can return >>>feature_pull_request
traceback from new elevation code in 9rc1 issue type bug ansible version ansible devel 57aa404 rc1 f0bdf01 54 minutes ago brian coca fixed bad paren in connection plugin environment summary traceback coming from privilege elevation patch steps to reproduce results >>>bug_report p1
typo lead led>>>docs_pull_request
use to unicode in jinja2 vars if type is str if hostvars has unicode value unicodedecodeerror occured this pr will fix it how to reproduce error >>>bug_report
ansible galaxy force install with dependencies issue type bugfix pull request ansible version ansible devel 3b6102e9a2 last updated 2015 03 11 14 38 19 gmt 1000 lib ansible modules core detached head bd997b1066 last updated 2015 03 09 15 37 21 gmt 1000 lib ansible modules extras detached head e60b2167f5 last updated 2015 03 09 15 36 08 gmt 1000 v2 ansible modules core detached head 34784b7a61 last updated 2015 03 05 14 11 54 gmt 1000 v2 ansible modules extras detached head 46e316a20a last updated 2015 03 05 14 11 54 gmt 1000 configured module search path none environment summary `ansible galaxy install force` does not work correctly with dependencies it just says they are already installed rather than reinstalling them as expected also warn if the same role with different versions is installed steps to reproduce create role with dependency run `ansible galaxy install rolesfile roles` to install the role and then `ansible galaxy install rolesfile roles force` to reinstall while the top level roles in the rolesfile will be reinstalled the dependencies will not be expected results dependencies are force reinstalled too actual results dependency xyz is already installed skipping >>>bug_report
registered variable or fact is unavailable in second play with hosts 127 issue type bug report ansible version ansible configured module search path none environment osx 10 10 using homebrew to install ansible summary when playlist has two plays with `hosts 127 1` facts or registered variables from the first play fall out of scope for the second play steps to reproduce evaluate this playbook `test yml` the ansible inventory may also be relevant expected results actual results both plays are declared as `host 127 1` but the second play runs as if it were `hosts localhost` possibly this is done after reverse lookup somewhere inside ansible because of this the variable scope appears to change for the second play this causes the variables `resp` and `hostname test` to be undefined possible workarounds use `hostvars 127 as in the test case or declare `hosts localhost` for both plays however there may be similar situations where ansible quietly remaps hostname to some other value if the value is not easily determined that may be difficult to work around >>>bug_report
allow value mapping on task register issue type feature idea ansible version environment summary in my playbook like to map the result of module output more granular than just assigning the full module result object to the variable but rather just property of that result steps to reproduce expected results actual results unfortunately can do mapping and ansible doesn allow extension in this way to let me override its behavior here so forced to do something like >>>feature_idea
no json object could be decoded when not exporting aws credentials and using ec2 inventory script executing `ansible playbook` with ec2 inventory ec2 and forgetting to export credentials throws very confusing and non verbose python exception this happened to me various times and each time wasted 30 minutes in tracking down the source of the problem `ansible playbook` should return reasonable error with suitable explanation and not an exception ec2 https github com ansible ansible blob devel plugins inventory ec2 py >>>bug_report p2
rax module ultis prevent an empty error message it appears that not all of the exceptions that can be caught while authenticating contain message in such case we ll at least repr the exception class to provide an error message see https github com ansible ansible modules core issues 919>>>bugfix_pull_request
add missing aix network facts discovery by default aix store all information for network interfaces in odm database so using given tools this information is read and returned as facts>>>feature_pull_request
allow include statements to set vars when including plays issue type feature idea ansible version ansible configured module search path none environment summary allow include statements to include full playbooks not just tasks files steps to reproduce the include statement is limited because it doesn allow on the included file side to define default values for the variables it would be great to have an include statement that could process default variables for example include included yml vars name test with `included yml` containing vars name noname user name var foo tasks shell echo name name user user var var executing the include statement should result in echo of `name test user test var foo` this would also allow including of playbooks that could otherwise could be run indemendently expected results name test user test var foo actual results invalid syntax >>>feature_idea
handle etc os release files with raspbian in them this changes the `ansible distribution release` fact from `na` to `wheezy` for raspbian it has no etc lsb release` file in `base files` and patched etc os release` >>>feature_pull_request
rpm key does not work if there is no previous key imported ansible tested hi run into the issue on redhat with minimal installation while trying to setup epel and adding the key via file from fs the module failed without an error message after adding the first key manualy everything works as expected saw in the pull request history that there was similar issue see https github com ansible ansible pull 6323 this fix is already applied on my running system as it was merged long time ago if you need more information please let me know kind regards tony>>>bug_report needs_to_be_moved
avoid the ignore errors statement in the introduction the `ignore errors` statement is legacy statement that in most cases is superseded by the `failed when` statement to not encourage to use ignore errors replaced it by the `failed when` statement also provided an example of the `changed when` statement >>>docs_pull_request needs_revision
make the example somewhat more feature complete new users might think that state started implies that the service is also started at boot time which isn by adding it this change makes clear distinction between the service state and whether it is enabled at boot and it makes the example more feature complete as this is what most people would be doing anyway >>>docs_pull_request
added list tags option and also show tags in list tasks option example listing all tags in play example display tags when listing tasks >>>feature_pull_request
implement and filters in ec2 py ini this extends the ec2 inventory source filtering syntax to include for anding filters together as suggested by cchurch few days ago https groups google com forum utm medium email utm source footer msg ansible project cv4koyyw6ou shni0 hss0j>>>cloud feature_pull_request
ansible osx get service tools not implemented on target platform issue type bug report ansible version environment target osx 10 10 host osx 10 10 summary when running service task or handler such as the following ansible will report back with an error saying that it couldn find an implementation of `get service tools` steps to reproduce see summary expected results would expect ansible to ensure the specified service is running actual results ansible reports an error saying `get service tools` is not implemented on the target platform >>>feature_idea
preliminary privlege escalation unification pbrun todo add docs and update examples become constants inherit existing sudo su ones become command line options marked sudo su as deprecated and moved sudo su passwords to runas group changed method signatures as privlege escalation is collapsed to become added tests for su and become diabled su for lack of support in local py updated playbook play and task objects to become added become to runner added whoami test for become sudo su added home override dir for plugins removed useless method from ask pass forced become pass to always be string also uses to bytes fixed fakerunner for tests corrected reference in synchronize action plugin added pfexec needs testing removed unused sudo su in runner init removed deprecated info updated pe tests to allow to run under sudo and not need root normalized become options into funciton to avoid duplication and inconsistencies pushed suppored list to connection classs property updated all connection plugins to latest become pe>>>bugfix_pull_request feature_pull_request p2
adding ovirt recognition for ovirt guests ovirt uses kvm this is quick check definition to make ovirt vms register themselves as kvm virtualization type and guest virtualization role >>>feature_pull_request
strange behavior with accelerate mode hi we are facing problem using accelerate mode on playbook particular we run the playbook from jenkins slave single client to two remote server at the first run all is work fine the daemon is started and task executed also the following execution is ok the problem coming when run the pb after more of hours in this case the daemon on the remote server are still present and the pb logs are task skel create folder attempting connection to 172 31 10 10 via the accelerated port 5099 172 31 10 10 sending request for validate user 172 31 10 10 waiting for validate user response 172 31 10 10 in recv data waiting for the header 172 31 10 10 received nothing bailing out falling back to ssh to startup accelerated mode attempting to start up the accelerate daemon is seems that is not validate the user if kill the daemon all is work fine again please can you help us with this problem thanks marco >>>bug_report
updated ansible and my dicts are no longer merging every time run playbook get this error error failed to combine variables expected dicts but got dict and nonetype have hash behaviour merge set in my ansible cfg if switch to hash behaviour replace my playbook runs as far as can see have no syntax errors in my various var files this only popped up in the past couple days after updated to the latest devel code ansible version ansible devel fb717ffd6c last updated 2015 03 06 15 47 53 gmt 700 lib ansible modules core detached head b0bc6f1379 last updated 2015 03 06 15 47 58 gmt 700 lib ansible modules extras detached head 46e316a20a last updated 2015 03 06 15 47 58 gmt 700 v2 ansible modules core detached head 34784b7a61 last updated 2015 03 06 15 47 58 gmt 700 v2 ansible modules extras detached head 46e316a20a last updated 2015 03 06 15 47 58 gmt 700 configured module search path none on ubuntu 14 04 64bit running ansible from the git repo suggestions >>>bug_report
add new keyword `skip with empty range` to `with sequence` statement this implements the feature request in 10403 it adds new keyword `skip with empty range` default value `false` to the `with sequence` statement which allows skipping task if the range is empty `count end` not sure this is the best name for the keyword though so appreciate alternative in particular more concise suggestions also don know if it would be more intuitive to reverse the logic have keyword `error on emtpy range` with default value `true` >>>bugfix_pull_request
add note to section loops that the when statement is processed per item minor doc enhancement as per discussion in 10400 >>>docs_pull_request
new keyword for with sequence in order to skip task if count end issue type feature request ansible version environment summary when using `with sequence` programmatically in combination with variables it would be useful to allow negative value for the `count` argument or `start` value that is larger than `end` currently this results in an error can count backwards but it could be useful to simply skip the task if the range is empty this could be achieved by adding an extra keyword `skip with emtpy range` although it should probably be less verbose which would be `false` by default for backwards compatibility example expected results the task should be skipped because `skip with empty range` is `true` actual results currently the task fails with the error message can count backwards of course `skip with emtpy range` needs to be omitted when running the example above because it is not supported yet >>>feature_idea
do not fail if count in with sequence statement this is an attempt to fix issue 10401 it does indeed fix the error described there but not sure if it introduces any other problems that not aware of would have added unit test but couldn find any for `with sequence` also saw that the files `lib ansible runner lookup plugins sequence py` and `v2 ansible plugins lookup sequence py` are almost identical what is the difference between the two should add the fix to the latter as well once it is approved >>>bugfix_pull_request
with sequence should not fail with count issue type bug report ansible version environment summary the `with sequence` statement should not fail when used with `count 0` instead it should just skip the task steps to reproduce here is minimal playbook `bug yml` to illustrate the issue it can be run with `ansible playbook local localhost bug yml` expected results the task should be skipped because `count 0` actual results the task fails with the error message can count backwards which is counterintuitive because `count` is zero not negative >>>bug_report
add prefixing and suffixing fuctionality to assemble module complements ansible ansible modules core 901 had no idea what was doing with this action and v2 stuff and all that but what did in the end felt kinda right >>>feature_pull_request
changes to unittests that verify units for interval and ttl durations also tests corrected logic for service re registration>>>feature_pull_request needs_revision
documentation fix path in test module hacking example fix small path issue in the test module example command>>>docs_pull_request
templating error in registered stdout believe there an ansible parsing error in this shell task that then leads to template error here sample playbook test yml that ran against host with docker installed `ansible playbook test yml hosts dockerhost v` compare the output of the shell task get image name using `docker inspect` which uses go template similar to jinja2 syntax and therefore must be escaped to the shell task that parses the same value through series of shell commands the stdout value is the same for each shell but the debug task fails for `docker inpect` but not the other tmp https cloud githubusercontent com assets 253579 6517942 5edd8b70 c36e 11e4 89e6 0e06a90d3458 png >>>bug_report
mention `view` in the ansible vault docs not sure this is the correct way to include the note please update this or tell me if there better way >>>docs_pull_request
to json fails on inventory yaml inventory all the things name run inventory setup name fails with error local action debug msg hostvars inventory hostname to json >>>bug_report needs_info
facts py throws exception when run on rhev hypervisor 10383 this is the pull request for https github com ansible ansible issues 10383 red hat enterprise virtualization hypervisor 20150128 el6ev the rhev hypervisor is locked down version of rhel that red hat provides to rhev customers the ovirt equivalent is called ovirt node the setup module throws an exception when run against rhev hvs the problem lies in the get lsb facts function in the file facts py when run the function attempts to parse the output of the lsb release command or the contents of the file etc lsb release if the command is not detected in either case the function expects to find colon delimited key value pairs eg distributorid redhatenterpriselinux however the text of the command file on the hvs only contains redhatenterprisevirtualizationhypervisor the exception is thrown when the get lsb facts function attempts to split the output on the colon ve worked around the problem by adding test for colon to the sanity check that precedes the split >>>bugfix_pull_request
improve error message for winrm without password if no password is given the winrm connection will raise an python error that contains no direct hint to the source of the error please add check for missing password and raise descriptive error message thx for your great work >>>feature_idea windows
update playbooks vault rst typo fix passwords files >>>docs_pull_request p2
allow customization of group by tags would like to have cleaner cache in my ec2 dynamic inventory this pull request enable customization of tag prefix the default is prefixed with `tag because we have multiple vendors would like to customize the prefix to be called `aws may generate other dynamic inventory group prefixed with `vendorx this change should keep the backwards compatibility enable whitelisting only certain tags will be used for group by tags there are many other tags may be created manually for other purposes human readable record or managed by other team would like to whitelist tags that are only used for managing ec2 resources you can specify comma separated list of tag to be used for grouping >>>cloud feature_pull_request
don log item data for skipped tasks under no log tasks with `no log` set should not log data remove log of item data for skipped tasks in loops fix for 10387>>>bugfix_pull_request p1
task names do not render correctly when they contain variable with filters for instance in role vars main yml have the following then have task that uses this variable in its name this produces the following output >>>bug_report
flexible tag based naming for ec2 hosts introduces destination format and destination format tags to allow the construction of host names based on one or more ec2 tags and python format string >>>cloud feature_pull_request
allow overriding ansible python interpreter not sys executable when ansible python api code is run from django under uwsgi the sys executable is being returned as usr bin uwsgi instead of python this means playbooks can be executed looking for way to override this or feature request to add configuration variable to override it >>>feature_idea
facts py throws exception when run on rhev hypervisor issue type bug report ansible version ansible environment red hat enterprise virtualization hypervisor 20150128 el6ev the rhev hypervisor is locked down version of rhel that red hat provides to rhev customers the ovirt equivalent is called ovirt node summary the setup module throws an exception when run against rhev hvs the problem lies in the get lsb facts function in the file facts py when run the function attempts to parse the output of the lsb release command or the contents of the file etc lsb release if the command is not detected in either case the function expects to find colon delimited key value pairs eg for line in out split if len line continue value line split strip if len line or not in line continue value line split strip >>>bug_report p2
10295 may have broken `ansible doc l` have the devel branch checked out and was having bum luck running `ansible doc l` getting lots and lots of errors like this still rookie level with python so tried to zero in on the bug with `git bisect` bingo found that reverting the changes in 10295 made `ansible doc l` worked as expected >>>bug_report p2
ansible distribution not set within docker container using ansible to provision inside of docker containers based on https github com phusion passenger docker ``ansible distribution`` does not appear to be set despite the container being ubuntu based the following is the lsb release output from inside the container the following error message is triggered cannot find any documentation on how ``ansible distribution`` is set or when it would not be expected to be present working around the issue by manually setting ``ansible distribution`` in the playbook vars >>>bug_report
check that vault password is correct before running playbook issue type feature idea ansible version environment summary currently ansible does not check that the provided vault pass is correct before running the playbook this can be frustrating as you won know the password was wrong until you hit an encrypted file in the run and can mean lot of easily avoidable failures steps to reproduce create an ansible vault encrypted file and add it to playbook run with ask vault pass` and supply incorrect password expected results if the vault pass supplied at the prompt is wrong the playbook won run actual results the playbook runs regardless of whether or not the vault pass is correct and you won know until it comes across an encrypted file and errors with `decryption failed` >>>feature_idea
ansible docker ssh authentication or permission failure effect ansible version os ubuntu 14 04 64bit docker docker version build 5bc2ff8 opensshserver openssh 1p1 ubuntu 2ubuntu2 openssl 1f jan 2014 the problem is ansible can access ssh to docker container but on normal host is working fine setup env >>>bug_report
var in lookup is undefined if task has no name in if define var homevar home and then have this action debug msg homevar is lookup env homevar get message >>>bug_report
default vars aren evaluated when used within include statement in dependency role when requiring dependency that uses var `path` that has been defined in defaults main yml` within the dependency in an include statement the var is not evaluated and instead the following error is returned `debug msg path evaluates the var correctly so this seems to only affect includes roles dependency defaults main yml roles dependency tasks main yml roles root meta main yml when `path` is passed while requiring the dependency as follows the var is correctly evaluated so this seems to fail only when the default from roles dependency defaults main yml` should be used roles root meta main yml tested with ansible and discovered while testing 10374 >>>bug_report
role path evaluates to path of dependency role instead of requiring role when requiring role as dependency in roles child meta main yml`and passing the `role path` introduced in https github com ansible ansible commit 7051cdeb57d947a213803ca28a4e1a6a2f905d26 as follows `foo` evaluates to the path of the dependency `parent` in this example instead of the path of the role that specified the dependency `child` in this example cc srvg>>>bug_report needs_info
incorrect keyword argument error incorrect keyword argument error it should be errors >>>bugfix_pull_request
rework the shell quoting of remote checksumming instead of getting rid of pipes quote use pipes quote and get rid of the manually entered toplevel quotes this should properly escape backslashes quotes and other characters also fix the new checksumming python one liner for csh ansible shell type needs to be set to csh fixes 10363 fixes 10353>>>bugfix_pull_request p2
look for role name in an additional key given that when using remote role dependencies its not really expected to use the `role` key in the dependency dictionary but rather the `scm` `src` `version` and `name` keys should not the `name` key also be checked when resolving roles might fix 9280>>>bugfix_pull_request needs_rebase
allow executable non script inventory files this fixes 10068 without breaking backwards compatibility sometimes having an ansible directory on network share means it mounts automatically with no easy way to get around it >>>bugfix_pull_request needs_revision
synchronize module using wrong hosts from inventory issue type bug report ansible version environment ansible on ubuntu 14 10 managing debian wheezy hosts summary the synchronize modules uses 127 host from group on which it does have to run on steps to reproduce inventory file apidbdeploy 192 168 number api 192 168 number 192 168 number api hosts children apidbdeploy api memcache api 127 handler on api hosts task synchronize task will use 127 from memcache api as destination host if change 127 from memcache api with my host 192 168 it works well expected results actual results >>>bug_report needs_info pending_closure
removed subprocess import fixes 10361 >>>feature_pull_request
failed to checksum remote file issue type bug report ansible version ansible environment centos7 on both summary the error occured during processing template with the backslash in the name of the file steps to reproduce am trying to re create systemd mount file some characters in the filename must be escaped which means replace them by sequence x2d for the first time everything works as expected file on the destination was succesfully created but during the next run checksum failed expected results repetitive runs error actual results failed item etc systemd system opt my failed true item etc systemd system opt my x2dmountpoint mount msg failed to checksum remote file checksum error code >>>bug_report p2
clean up openstack inventory to use cleaner interface we introduced cleaner interface point in shade so that group logic can live in ansible since it ansible specific and metadata munging can live in and be functionally tested in shade consume it >>>bugfix_pull_request p2
subprocess is useless in ansible inventory init py now hi seem you guy can need remove this line https github com ansible ansible blob release1 lib ansible inventory init py l23 or subprocess is useless now >>>feature_idea
provide list of current linux capabilities issue type feature idea ansible version current development environment linux environments docker lxc openvz virtual machines containers summary ansible should provide list of currently present linux capabilities this can be especially useful in restricted environment for example docker lxc container to check if certain actions are allowed before executing them examples missing `cap sys time` means that we cannot change system clock so installing `ntpd` is not needed missing `cap net admin` means that we cannot manage network interfaces or firewall so tasks roles related to these can be confidently skipped steps to reproduce current capabilities can be easily checked with command available from `libcap2 bin` package on debian based systems here bash script that parses the output of that command and returns json formatted list of capabilities separate variable indicates if capabilities are enabled or not full `root` access expected results in ansible facts if `libcap2 bin` package is present on remote host there should be separate variable `ansible system capabilities enforced` which indicates that capabilities are enabled or disabled and list of current capabilities in separate list `ansible system capabilities` actual results currently there no such functionality present >>>feature_idea
string to vars not working anymore in ansible v1 hi in v1 it was possible to do this in template but it not working anymore in the usecase myvars yml third party code master yml task mytemplate j2 error >>>bug_report p2
git archive in ansible galaxy fails for non default branch versions trying to install branch that is not the default typically master via ansible galaxy fails because `git archive` cannot handle remote branches introducing `git checkout` solves this problem by pulling the remote branch onto the local machine my concrete example was which caused >>>feature_pull_request
fix detect of docker as virtualization type not only match` docker but also `docker followed by hex id example from my docker container shortened >>>bugfix_pull_request
with items does not work as expected in yum module an optimization in executing the yum module and by the looks of it also apt pkgng and zypper causes dynamic names not to be evaluated as expected an example of this problem is demonstrated in this gist https gist github com firehed 7e044873b371fcbdceb8 the source of the issue appears to be in `runner init py 750 758` while using less dynamic approach was suggested in irc it not an acceptable solution for the infrastructure we re using it easy enough to work around with more verbose syntax but the point still stands that the interaction between `with items` and `yum` doesn work as expected suggestion for resolution expand the jinja2 templating when converting the item list to single item include patch but don know the internals well enough at the moment if such resolution would be accepted with patch willing to do some research and create one if it relevant this is from installed via homebrew on os >>>bug_report
ansible cfg inline comments not working hello had to change my remote tmp directory because was getting permission errors changed it and the resulting line was remote tmp tmp home ansible tmp didn know that commenting this out inline doesn work and there are other bash type comments in the file but as it happens cfg file doesn exactly have bash syntax only when deleted the part after the did my new path work properly my suggestion would be to add warning about it can do pull request for it if the maintainers think it good idea thanks >>>bug_report needs_info
broken checksumming with tcsh as login shell it looks like commit 8150b14d8d4a1d49a80ff9b4ace660ba4d03141e broke dry run execution for template module as backslash escaping is unsupported feature in csh tcsh shell family >>>bug_report needs_info
aws security group management error when adding entries by group name issue type bug report ansible version boto 36 environment os 10 ubuntu 12 04 05 python summary came across an issue when managing sg group entires via boto ansible got this error on one of my environments both aws sg config and ansible playbook were in sync when it comes to entries adding new sg and populating it worker fine just the second run was not working as aws api complains about duplicated entries the workaround here was to change group name some name to group id sg xxxx steps to reproduce expected result no changes to sg entries actual result error about duplicate entries>>>bug_report cloud needs_to_be_moved
update doc for testing pr with mock dependency update in the docsite reflecting the mock dependency for running the unit tests for example for the test introduced in 10346>>>docs_pull_request
add ansible ssh host when execute `zabbix py host hostname returens an empty dict eg add `ansible ssh host` to the dict will returns the host ip that ansible dynamic inventory can do something in the host >>>feature_pull_request needs_rebase
make version report the active config file this is useful for troubleshooting this replaces 9598 which did this but also had lot of refactoring that made it more complex this one is much simpler cc bcoca sontek sudarkoff>>>feature_pull_request
task name not being templated currently many name fields are being displayed with jinja templates unexpanded this is because the name field is being displayed in callback when the task is started but the proper variables aren all known until the task is run on specific host so that we can look up inventory variables for instance fixing the display issue is very hard on v1 and we re reworking both display and variable handling in v2 so we should look at making the name field properly expand there sample playbook expected output actual output brought to my attention in issue 10321 >>>bug_report
bug fix search only for files as candidates apparently found recently introduced bug in 68e86de 2015 02 17 optimize the plugin loader if folder is found matching the plugin name it is retrieved have experienced the issue using digital ocean module it is not usable now have added test for it but have had to add mock as dependency think it is necessary in order to do good testing >>>bugfix_pull_request p2
add documentation for the new openstack inventory>>>docs_pull_request p2
vault running an inventory file with vault the inventory file contains ssh login details as hostnames user password run the playbook with script run run inventory file yml ask vault pass it not able to decrypt the file while it checking ssh each vm that is in the inventory as it still getting encrypted info from the inventory >>>feature_idea
galaxy role file path property ignored for dependencies greetings using the `path` property in my `galaxy roles yml` file to specify where the roles should be installed likewise unfortunately `modx` dependencies are not installed in `pathx` the system default is used instead or in recent enough ansibles ansible cfg `roles path` should be used here this is inconsistent with the behavior of `ansible galaxy install modx pathx` which will install dependencies in `pathx` as well is this bug >>>bug_report
fixed include tags issue described by issue 9862 https github com ansible ansible issues 9862 issuecomment 75912714>>>bugfix_pull_request
add the complex args to the module execution result currently if you write callback plugin http docs ansible com developing plugins html callbacks if you use the standard syntax or the pure yaml one see 10163 you get different objects as the result of the module execution given the following playbook and the following plugin if you run `ansible callback plugins plugins callbacks make mine` from the `test integration` directory you will obtain with this pr you will obtain you are now able to use `complex args` to display the same informations as `module args` >>>feature_pull_request
supervisorctl module falsely returns ok when called with insufficient permissions task like the one below supervisorctl name myservice state restarted will result in an ok if called without sudo assuming the supervisor daemon is run under root though the service is not restarted >>>bug_report needs_to_be_moved
error in cron example http docs ansible com cron module html examples removes cron file from under etc cron cron cron file ansible yum autoupdate state absent it would seem that you also need to add name so this would become cron name yum autoupdate cron file ansible yum autoupdate state absent >>>docs_report
do until loops fail to evaluate stdout lines issue type bug report ansible version latest development branch environment fedora 21 summary `until` statements fail to evaluate `stdout lines length` however `stdout split length` evaluates as expected and can be used as workaround steps to reproduce run playbook comparing stdout lines in an until loop like the one below >>>bug_report
regression issue when parsing arguments issue type bug report ansible version ansible configured module search path usr share ansible environment sles 11 sp3 summary this parsing error appeared after upgrading from ansible to ansible removing the single quote within the prompt string resolves the issue steps to reproduce name remind user to update the ansible inventory file pause prompt important add or update name in ansible inventory file etc ansible hosts continue msg expected results task remind user to update the ansible inventory file hostname important add or update in ansible inventory file etc ansible hosts and zenoss press enter to continue actual results task remind user to update the ansible inventory file fatal hostname traceback most recent call last file usr local lib64 python2 site packages ansible py2 egg ansible runner init py line 590 in executor exec rc self executor internal host new stdin file usr local lib64 python2 site packages ansible py2 egg ansible runner init py line 792 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file usr local lib64 python2 site packages ansible py2 egg ansible runner init py line 1027 in executor internal inner result handler run conn tmp module name module args inject complex args file usr local lib64 python2 site packages ansible py2 egg ansible runner action plugins pause py line 91 in run self pause type self duration unit self seconds self prompt file usr local lib64 python2 site packages ansible py2 egg ansible callbacks py line 181 in vv return verbose msg host host caplevel file usr local lib64 python2 site packages ansible py2 egg ansible callbacks py line 190 in verbose msg utils sanitize output msg file usr local lib64 python2 site packages ansible py2 egg ansible utils init py line 1002 in sanitize output parts parse kv str file usr local lib64 python2 site packages ansible py2 egg ansible utils init py line 793 in parse kv vargs split args args file usr local lib64 python2 site packages ansible py2 egg ansible module utils splitter py line 185 in split args raise exception error while splitting arguments either an unbalanced jinja2 block or quotes exception error while splitting arguments either an unbalanced jinja2 block or quotes >>>bug_report p2
windows specific filter that supports splattering convert yaml dict to powershell hash based upon conversation from https groups google com forum starred ansible project jojvfohowqm tested with test flags test win splat filter etc ansible hosts make test winrm>>>feature_pull_request windows
changed from hash merge to combine vars which resets default to overwrite and not merge hashing fixes 10328 but not 10327>>>bugfix_pull_request p2
respect global settings when merging hashes this patch improving condition in the `merge hash` function to respect the global settings for merging hashes it allows to merge hashes only if the `hash behaviour` is set to `merge` in `ansible cfg` >>>bugfix_pull_request bug_report p2
vars resolving group by special case of bad resolving in group by where key points to var holding another var issue type fancy corner case bug ansible version introduced in current devel as well as and up in the tree the bug was introduced by 4cd87ec93ec1f5266e5afaaa8e6734d642284afe note that while the bug is unrelated this faulty commit is the same as for 9753 environment tested on ubuntu 14 04 summary using key pointing to variable that itself is defined as another variable construct in combination with group by the resulting key probably that subvar is onlky calculated once for the first host so all hosts are put in the same group steps to reproduce create an inventory `hosts` file with some hosts where the first three chars point to datacenter and provide this variable in `group vars all yml` test with the commmand `ansible all hosts local group by key datacenter also change the first host in the inventory file from `dc1 ch1 bl1` to `dc2 ch1 bl1` and observe the difference expected results works with ansible release1 ad675235e2 last updated 2014 12 02 10 53 48 gmt 200 actual results or after changing the first host in the inventory file from `dc1 ch1 bl1` to `dc2 ch1 bl1` >>>bug_report p2
add vsphere guest clone create in set folder or create folder if not exists solutions already exist look at seba response in pysphere mail group https groups google com msg pysphere eltcafnlscw abnk87z1houj >>>feature_idea
register list hash variables reopening of https github com ansible ansible pull 6674 can register result in hash or list simply add to the var name to append result in list or key to save result in hash exemple >>>feature_pull_request needs_rebase
updated changelog with content added gitattributes added missing v1 v1 content to changelog not sure if you want this but added gitattributes file which sets merge union for the changelog md file this means that merge conflicts will be less likely if multiple people are updating the file >>>docs_pull_request p2
pkgng and interactive dialogs issue type bug report ansible version environment master os 10 slaves freebsd 10 summary some packages provide interactive dialogs question after installation `pkgng` hangs up on those does not return bad exit code or anything steps to reproduce atm the `postfix` package is good example for this bug create playbook containing the following task run the playbook ansible will hang up without any message error most likely because the `pkg` utility on freebsd started postfix specific interactive script you can check on the script by installing postfix manually using `pkg install postfix` expected results expect packages with interactive dialogs to either not install or go with the default option provided by the dialog virtually hitting enter if there is `readline` somewhere quickfix use command instead and make pkg quiet and default to yes suggestion to resolve this issue add additional options to the `pkgng` role force yes boolean adds the y` flag to the `pkg` call quiet boolean adds the q` flag to the `pkg` call >>>bug_report needs_to_be_moved
add new function to ipaddr filter to return the nth host within given network this is very useful for calculating known hosts within network gateway as nthhost or nthhost >>>feature_pull_request
jinja2 to json filter fails for module hi `set fact volume ids json volume ids to json where volume ids abc def ghi fails with `error an unexpected type error occurred error was undefined is not json serializable` traced `undefined` to the value of `a` in to json https github com ansible ansible blob devel lib ansible runner filter plugins core py l55 ansible jinja2 python ubuntu 14 04 do not ask me why but adding `str inside the function triggers `a` to be useful again def to json args kw convert the value to json str make sure is an object dumps can work with return json dumps args kw >>>bug_report p2
skips certain ssh errors and attempts to continue should fix 10225 as alobbs did for the v2 version of the connection plugin>>>bugfix_pull_request p2
some grammatical updates just some grammatical updates for readability if these are ok can do some more >>>docs_pull_request
ansible sudo ignored when ansible ssh user is not set issue type bug report ansible version ansible environment debian summary ansible sudo ignored when anisble ssh user is not set steps to reproduce be root in root ssh config set username and key for host put the host in group and in group vars add sudo yes expected results ansible uses sudo actual results ansible does not use sudo workaround repeate the username in group vars as ansible ssh user>>>bug_report p2
plaintext https transport connecting over http fixes https transport but where if using https winrm via plaintext auth ansible attempts to connect over http instead>>>bugfix_pull_request p2 windows
v2 avoids ssh runtime error fixes bug 10225 prevents an exception from raising in some corner cases where ssh might be misconfigured it seems not to fix specific problem although it makes the method little bit more solid >>>bugfix_pull_request p2
prevents trailing zeros to be truncated from strings in hosts ini inventory variables fixes bug 10281 during the string conversion process trailing zeros were lost as result of the conversion of the value to float number that means that for instance given the 20 the value read was which caused issues under some circumstances >>>bugfix_pull_request p2
reorganization of jinja2 filter documentation jinja2 filter documentation has been moved to separate document another separate document contains ipaddr filter documentation >>>docs_pull_request
new lookup plugin `dig for performing dns lookups this makes `dnstxt py` obsolete and recommend it be removed >>>feature_pull_request
vsphere guest vm clone and power state ability to keep machine off after clone from template now it mutually exclusive parameters are mutually exclusive state from template fresh ansible >>>feature_idea
vsphere guest abbility to change vlan reconfigure state need all parameters even if you need only one thing change vlan change memory size also seems that annotation notes doesn work at all my testing playbook https gist github com vadamec 95bb855330a00dff325a vlan and annotation task succesfuly pass vcenter shows that it tries to do something but result is no change at all maybe some misunderstanding more useful examples in documentation is only what need >>>cloud feature_idea
file test doesn run via su issue type bug report ansible version ansible environment local gentoo remote debian summary running playbook with ask su pass and after copying file with my ssh user can read the created file as expected running the playbook again will fail because ansible is running some tests to check the given file testing if the file is readable will fail because my ssh user can read 0600 file of root with vvv it looks like these tests aren excuted with su example output think this tests defined in lib ansible runner shell plugins sh py in function checksum should also run with su if is given >>>bug_report p2
ability to change state of node in f5 issue type feature idea ansible version ansible environment rhel summary as part of the bigip node module would like the ability to set the state of node this would accomplish the equivalent of going to local traffic nodes nodename state enabled disabled forced offline from the web interface steps to reproduce not applicable expected results not applicable actual results not applicable>>>feature_idea
fixes 9836 don check ssh key permisions under win cigwin this allows to run ansible as vagrant provisioner on windows control machine via cygwin https www cygwin com or babun http babun github io it fixes 9836 with error output also people suffering https plus googleapis com pixelfairy posts jcd3hgp45jb http www opennet ru openforum vsluhforumid1 96005 html https forums frontier co uk showthread php 57986 page 31 1677897 viewfull post1677897 >>>feature_pull_request
cartesian adds cartesian product lookup plugin>>>feature_pull_request
add ldom support this patch adds ldom support for series sparc cpus >>>feature_pull_request
utf variables in inventory resulting in unicodedecodeerror issue type bug report ansible version devel devel environment debian arch centos echo lang en us utf summary utf variables in inventory resulting in unicodedecodeerrorused when used in template fatal localhost 127 msg unicodedecodeerror ascii codec can decode byte 0xc3 in position ordinal not in range 128 failed true note but same value in group vars works steps to reproduce demo repo https github com resmo ansible uft8 template bug cat inventory localhost var from inventory run ansible playbook test yml inventory actual results ansible playbook test yml inventory play localhost gathering facts ok localhost task var from group vars ok localhost task var from inventory fatal localhost msg unicodedecodeerror ascii codec can decode byte 0xc3 in position ordinal not in range 128 failed true fatal localhost msg unicodedecodeerror ascii codec can decode byte 0xc3 in position ordinal not in range 128 failed true fatal all hosts have already failed aborting play recap to retry use limit home resmo test retry localhost ok changed unreachable failed >>>bug_report needs_info
devel fails with syntaxerror get this running the latest code from git here suspect this may be related to 10285 in commit c2023f6 specifically >>>bug_report p1
template task fails when dest is directory the following playbook will fail hosts all sudo yes tasks template src file txt dest opt the error code will be msg failed to checksum remote file checksum error code opt file txt does not exist after running the playbook this worked in ansible so the issue was probably introduced within the last couple of days the copy module doesn have this problem >>>bug_report p2
extra vars doesn work with chroot connection type ansible version environment probably not related but it is debian 57 deb7u1 x86 64 gnu linux summary using extra vars` with chroot connection type doesn work more specifically the playbook will complete without error if the extra vars aren used or if they are defined elsewhere but the values supplied appear to be ignored steps to reproduce given debian chroot environment created via bootstrap vz https github com andsens bootstrap vz and located at target 71c89a96 root` if run the following playbook with the following inventory file located at target 71c89a96 root tmp bootstrap inventory` like so actual results get the following output expected results ve tested that this works outside of the chroot like so >>>bug_report p2
allow requesting list to lookup plugins instead of delimited string so now you can do something like should fix 10291 >>>bugfix_pull_request
creating templated file on vagrant shared folders fails issue type bug report ansible version ansible environment os 10 10 vmware fusion professional vagrant vagrant vmware fusion summary when running template task on vagrant shared folder the playbook run is stopped with the error the file is generated and on subsequent runs also when changing it no error occurs created sample repository that showcases the error by erasing the file after creating it so every vagrant provision run leads to the error steps to reproduce clone my sample repo https github com timbuchwaldt vagrant ansible bug run vagrant up expected results the file is created without an error actual results >>>bug_report
use vagrant machine names in dynamic inventory vagrant names the machines and using those names in the dynamic inventory allows much better use of ansible against vagrant setup also make the host information fetching more efficient >>>feature_pull_request
ansible connect windows winrm connection error 500 winrmtransport ssl certificate verify failed certificate verify failed ssl 581 accessing win7 machine using the windows automatic default self signed cert requires opting out https www python org dev peps pep 0476 opting out error message from pywinrm `winrm connection error 500 winrmtransport ssl certificate verify failed certificate verify failed ssl 581 the quick and really dirty see link test was that added and removed the line to urllib2 py the pywinrm https github com diyan pywinrm pull 43 pull request might help to make that happen env ansible control gentoo x64 ansible1 pywinrm client windows service pack my steps control cat etc ansible hosts win 192 168 cat etc ansible group vars win2 yml ansible ssh user administrator ansible ssh pass 3krxusezvdx5 ansible ssh port 5986 ansible connection winrm then run the scripts on windows server 2012 r2 upgrade to ps3 ps1 configureremotingforansible ps1 https github com ansible ansible blob devel examples scripts configureremotingforansible ps1 read http damonoverboe org post ansible and windows basic set up the question >>>bug_report p2 windows
noauthhandlerfound from ec2 ami using python2 on ubuntu 10 04 hi very much aware am trying to do something on soon to be unsupported os but unfortunately right now don have choice trying to use ansible to create an ami of machine am provisioning however seem to be running into the same issue with python on ubuntu 10 04 when running the exact same role ve worked on under 12 04 and 14 04 with python it works flawlessly my code is when running this on 10 04 get the following error used debug to make sure that my variables are being set correctly which they are would appreciate any input on this cheers>>>bug_report cloud
add support for mounts in solaris facts>>>feature_pull_request
lookup plugins cannot return list to jinja2 template issue type bug ansible version ansible also tested by bcoca on current devel environment summary if lookup plugin returns list one two three this is stringified and returned to jinja2 template as string `one two three` steps to reproduce environment lookup mini py playbook template expected results expected the following from `lookup mini blah actual results results from running above playbook >>>bug_report p2
removed bare variable detection as this confuses people and forced us to allow for bare expressions>>>feature_pull_request
slow deployment using winrm over https sorry first bug report here let me know if ve messed anything up not provided enough info issue type bug report not 100 sure it is bug perhaps there is reason for the way it is ansible version ansible freshly built rpm from git ansible git201502182043 environment centos summary found on updating ansible found that test playbook to windows took long time to run debug output showed that it was attempting to use http rather than https for the endpoint despite my port being set to 5986 further investigation showed that the transport schemes in winrm py ordered the schemes for https as kerberos https plaintext http plaintext https as was not using kerberos it was falling to plaintext http believe the correct code should be transport schemes http kerberos http plaintext http plaintext https https kerberos https plaintext https plaintext http changing to this sped up windows connections as the http connection no longer had to time out steps to reproduce run ansible playbook against windows host expected results ansible will use the https transport before http actual results ansible uses http transport before https endpoint http oxygenwin05 5986 wsman transport plaintext endpoint https oxygenwin05 5986 wsman transport plaintext >>>bug_report windows
ansible playbook fails when passed string containing quote when pass ansible playbook string containing quotes it fails with error parsing argument string try quoting the entire line the string in question is contained in dict that is passed directy to custom module from my dynamic inventory when printed from the shell it appears to be formatted correctly attendence body testing quote system info ansible version ansible configured module search path usr share ansible uname linux facetoe 13 44 generic 73 ubuntu smp tue dec 16 00 22 43 utc 2014 x86 64 x86 64 x86 64 gnu linux lsb release no lsb modules are available distributor id ubuntu description ubuntu 14 04 lts release 14 04 codename trusty >>>bug_report
rearranged math filters should also help with avoiding collisions with the math lib>>>bugfix_pull_request
pulls machine id in ansible facts implements 10221>>>feature_pull_request
ssh connection fails when controlpath has spaces dashes when running ansible from slave job in jenkins that has spaces dashes in it ansible fails to correctly escape the job name while trying to connect to remote host ve confirmed this works as intended while running via command line on the same box >>>bug_report p2
extra vars not accessible from within dynamic inventory missing feature or design decision think it would be nice to have extra vars propagated as command line arguments to dynamic inventory script also don get the purpose of cmd self filename list in https github com ansible ansible blob devel lib ansible inventory script py 40 passing list as second argument seems to me kinda pointless edit now the ugly workaround for requested feature is echo myparam1 value1 myparam2 value2 ansible playbook play yml and reading sys stdin from dynamic inventory script>>>feature_idea
zeros are truncated from strings issue type bug report ansible version `ansible 2` environment mac osx 10 running against ubuntu 14 04 summary when defining string trailing `0`s get removed steps to reproduce in my inventory in my playbook output expected results 20 actual results >>>bug_report p2
unable to set umask mode for git module there appears to be no way to make the git module among others respect any umask setting besides the ansible default of 022 have tried globally setting umask using pam umask and locally with bashrc all our git repos need group read write permissions not the ansible default 600 can you tell me how this can be overridden instead ve had to resort to using shell commands rather than the git module because that allows me to set umask manually before executing git clone >>>feature_idea
ec2 vol detaching using instance none is not working issue type bug report ansible version environment mac os mavericks summary wanted to detach an ec2 volume followed the documentation on http docs ansible com ec2 vol module html and got an error from aws api because of the `none` on the `instance` field steps to reproduce detaching an ec2 volume as per the documentation http docs ansible com ec2 vol module html expected results have the volume `vol xxxxxx` detached and ready for use on another instance actual results >>>bug_report p2
add solaris zone support for inventory and connection>>>feature_pull_request
yum module and with items issue type bug report ansible version tested on both latest git version as well as ansible environment deploying from mac os python deploying to centos python summary when using the yum module with with items in the latest version state present seems to be included as part of the package name list steps to reproduce run the following task have tested surrounding item with single and double quotes the only work around which ve found to work is using the alternative syntax expected results the four packages should be installed without the need for using alternate syntax actual results >>>bug_report p2
optimize plugin loader update after testing the change requested in pull request 10268 added minor fix to not search for plugins in non existing directories if this is not the correct way to fix an ongoing pull request sorry not aware of possibility to do an update to an existing pull request so created new pull request >>>bugfix_pull_request
multi file custom modules with modulereplacer outside ansible module this change allows writing multi file ansible modules and store them outside ansible module utils directory for easy ansible core upgrade the custom modules can have external imports that would be recognized by modulereplacer the idea is that you can configure you custom modules directory like other ansible vars example via env ansible custom modules or ansible cfg custom modules some path lib modules and place there your files then just include ansible module custom in your custom module mine websrv and that would be merged by modulereplacer info in the ansible cfg have already library path ansible cfg custom modules some path lib modules library path some path lib modules we could use the same variable but it would be wise to have this configuration separated >>>feature_pull_request
mention is undefined in docs instead of is not defined issue type documentation report ansible version environment na summary the docs mention using is not defined for checking if variable is undefined however this fails for nested dicts throws an error while `a is undefined` skips the task as expected >>>docs_report
ansible shell module silently succeeds with empty command issue type bug report ansible version environment centos 64bit summary when running playbooks against centos or rhel host tasks using the shell module appear to succeed but do not actually appear to run the specified command the task returns exit code empty stderr stdout and status changed but without actually running the command specified steps to reproduce create an obviously bad incorrect task using the shell module execute the playbook note that test shell command succeeds marked changed and the register output of the command shows empty stderr stdout and exit code of expected result command executes actual result command does not execute >>>bug_report
added cleaning pyc files to prevent python using the pyc when the py is gone>>>feature_pull_request
make behavior consistent when using creates option with modules there are three distinct behaviors in use with modules that have creates or removes arguments command module shell module changed false unarchive module uri module changed false and skipped true script module skipped true this pull request makes these behaviors consistent with the command and shell modules reserving skipped status for actions which are truly not evaluated >>>bugfix_pull_request p2
addition of ld library path for custom python openssl environments following changes would allow for defining custom ld library path per host in inventory or in ansible config default for all hosts that is important for environments with custom python openssl settings example myhosts somehostname ld library path home user mycustomlib opt openssl lib usr local lib>>>feature_pull_request
fixed jsonify test>>>bugfix_pull_request
fix links to ansible devel in documentation pages>>>docs_pull_request
ansible galaxy mismatches unquoted single dot version numbers in requirements yml issue type bug report ansible version environment ubuntu 14 04 summary it seems that when `requirements` file contains an unquoted `version` tag with only single character the parser coerces the version number to floating point value causing `ansible galaxy` to be unable to match the version id it is of course possible to work around the problem by surrounding the version with string delimiters but this nevertheless looks like inconsistent behavior steps to reproduce using nsg graphite https galaxy ansible com list roles 1176 as an example create the requirements file containing src nsg graphite version and run `ansible galaxy` with it expected results `ansible galaxy` successfully installs the role since the version exists actual results downloading role graphite owned by nsg role is scm none src nsg graphite version name nsg graphite the specified version was not found in the list of available versions release date 2015 02 07t20 47 33z id 3238 name release date 2014 07 29t14 26 41z id 1121 name release date 2014 07 26t00 01 21z id 1068 name release date 2014 07 25t15 26 38z id 1056 name release date 2014 07 25t15 17 07z id 1057 name as you can see `version` is an fp value in the first dict whereas it always `unicode` object in the version reference dict >>>bug_report
feature galaxy idempotency for motivation see commit message to 8948f40 >>>feature_pull_request needs_rebase
set proper file permissions umask 077 in write data so the file permissions remain consistent across all ansible vault operations that use write data addresses issue 10253>>>bugfix_pull_request
add new rax find bootable volume to assist with boot from volume this pr adds new `rax find bootable volume` shared function to assist with boot from volume functionality extends `rax to dict` to include info about the boot source changes `rax find image` to prevent it from calling `fail json` if required add update some docstrings>>>feature_pull_request
fix umask calculation on file creation fixes 10257>>>bugfix_pull_request
wrong umask calculation in ansiblemodule atomic move the correct permission for new file are calculated using `0666 umask` while xor yields the correct result for the most common umask 022 it is incorrect for example umask of 077 should create files with 600 permissions but ansible creates them with 611 0666 0077 the correct calculation is `0666 umask`>>>bug_report needs_info
added winrm kerberos configuration information this documents using the `kerberos` module to use the control machine tgt to authenticate to windows domain accounts >>>docs_pull_request windows
valutpass fix in password reorg should fix 10254>>>bugfix_pull_request p2
ask vault pass seems to be broken issue type bug report ansible version ansible devel 2da35a55a5 environment ansible host ubuntu 14 04 client hosts ubuntu debian and raspbarian summary normally run quick playbook wrote to upgrade my hosts with an encrypted vault file holding their sudo passwords ansible playbook apt upgrade yaml ask vault pass this quick working when did git pull this morning so picked revision that was definitely old than my last pull happened to pick fd987f5395 didn have time to do bisect this morning but will plan to do so as soon as have chance unless of course someone fixes it before get that chance steps to reproduce have an encrypted vault have playbook that uses that encrypted vault run playbook with ask vault pass and it fails whether you type the right password or not gives stack trace unfortunately can copy it from the terminal am using on andriod but the lines are ansible bin ansible 208 ansible bin ansible 117 ansible lib ansible utils init py 1130 global name vault pass is not defined can just run ansible host ask vault pass and get the error as well though in that case when it works nothing happens since no action was specified also still exits with so little will take little more work if was to automate bissect expected results should run playbook using encrypted sudo in the vault actual results errors out with stack trace >>>bug_report p2
ansible vault edit does not properly retain file permissions issue type bug report ansible version ansible version ansible devel 2da35a55a5 last updated 2015 02 16 10 38 29 gmt 500 lib ansible modules core detached head aa6c73f11b last updated 2015 02 16 10 38 34 gmt 500 lib ansible modules extras detached head 2ffd7235e5 last updated 2015 02 16 10 38 34 gmt 500 v2 ansible modules core detached head 34784b7a61 last updated 2015 02 12 16 14 10 gmt 500 v2 ansible modules extras detached head 312d59061c last updated 2015 02 12 16 14 15 gmt 500 configured module search path none environment os is mac os 10 10 the user account is managed in an active directory domain not managing any remote hosts summary `ansible vault edit` does not retain the permissions of the file steps to reproduce expected results actual results >>>bug_report
bundle install binstubs can be set as async task ruby have the following ansible include file my problem is that this run exclusively if remove the last two lines `async 1800` and `poll 3` if try to run it as is get have stumbled on bug or is this the expected behaviour in which case why is so >>>bug_report needs_info
role variables containing other variables are not changed when the inner variables are set by extra vars if set variable in role which refers to another variable then override the second variable with extra vars` the original variable is unchanged here an example cat playbook hosts 127 connection local gather facts false roles eof mkdir roles vars tasks cat roles vars main yml var var2 this is var eof cat roles tasks main yml debug var var debug var var2 eof ansible playbook playbook var expected output play 127 task debug var var ok 127 var task debug var var2 ok 127 var2 this is play recap 127 ok changed unreachable failed actual output play 127 task debug var var ok 127 var task debug var var2 ok 127 var2 this is play recap 127 ok changed unreachable failed am running ansible from epel ansible el6 noarch >>>bug_report p2
improve yaml parsing performance by 25 by using pyyaml cparser loader this is with pyyaml 11 the cparser loader is good bit faster than the python loader in my tests with safeparser time ansible playbook dummynonconnectinghost site yml vault password file vault pass dev null 613 76s user 86 28s system 97 cpu 11 54 65 total` with csafeparser time ansible playbook dummynonconnectinghost site yml vault password file vault pass dev null 439 21s user 82 81s system 98 cpu 52 45 total` >>>feature_pull_request p2
add `groups` back into inline templates this fixes 9888 in low impact way at the expense of not addressing the entire problem other things in `inject` not explicitly imported into `temp vars` and by extension `hostvars` >>>bugfix_pull_request p2
document redis kv python package dependency mention in docs that the redis kv lookup requires that the redis python package is installed >>>docs_pull_request
add droplet name support for host in digital ocean py have found using the dynamic inventory using ip addresses bit diffecult added using droplet names too the current code assumes that the droplet names are unique if they are not the first one in the droplet list will be matched >>>cloud feature_pull_request
issue with yum module centos7 and possibly rhnplugin spacewalk issue type bug report ansible version ansible environment centos 64bit summary trying install mariadb from repo managed by spacewalk similar to rhn steps to reproduce expected results installs maradb galera server from mariadb repo that is setup and synced actual results >>>bug_report p2
ansible template sometimes created directory instead file issue type bug ansible version ansible environment my home system is linux 13 39 generic 66 ubuntu smp tue oct 28 13 30 27 utc 2014 x86 64 x86 64 x86 64 gnu linux and host system linux 13 36 generic 63 ubuntu smp wed sep 21 30 07 utc 2014 x86 64 x86 64 x86 64 gnu linux summary have this task template src supervisord hexlet ide conf j2 dest ide release root supervisord hexlet ide conf sudo yes tags ide and sometimes when running this tack see that in destination directory supervisord hexlet ide conf is not file it directory with file supervisord hexlet ide conf when remove this directory and try run this task again supervisord hexlet ide conf becomes file steps to reproduce do not know the right steps to reproduce this problem but sometimes saw this problem since ansible when started using them >>>bug_report
enable sudo mode if user explicitely ask for sudo password since using ansible without sudo will not result into anything useful and since we are doing this already for the ask su pass option we should as well be consistent on it user came on the irc today with the exact problem of having without the required options >>>feature_pull_request
add list vars options function wanted way to list out variables without running any plays note made clean merges rebase with my code should be working now ref https github com ansible ansible pull 10143>>>feature_pull_request
apt module should list changed packages updates downgrades installs in check mode maybe only when diff is also specified might implement that myself if there is support of this idea >>>feature_idea
make ssh plugin resilient against invalid entries in hosts file should mitigate issue discussed here https groups google com forum utm medium email utm source footer msg ansible project 0yagecva9ji 2ephw3l48mqj>>>bugfix_pull_request
remove auth token and port openstack module utils changes to v2 tree>>>feature_pull_request
add deprecation notices to the old nova inventory>>>docs_pull_request easyfix feature_pull_request needs_revision
shell autocompletion for test module executable change log autocomplete is useful tool and python provides one argcomplete is python autocomplete tool that can be instaled as follows 			 pip install argcomplete it provides bash completion capabilities currently have added this tool optionally for test module if user has installed one he can get suggestions for arguments on command line removed optparse optparse has been deprecated since version according to me this is needed change >>>feature_pull_request
add support for parentheses in pattern definition the pattern processing algorithm processes the pattern in regular intersection exclude order it would be interesting to support parentheses so users can be more complex patterns ex webservers dbservers staging would mean all webservers plus only the staging dbservers >>>feature_idea
referencing vlan interfaces in templates does not work from an host get the following facts including vlan enabled interface unfortunately it is impossible for me to reference the ip address within template where monitor interface is defined in the inventory file like this ceph04 monitor interface bond0 1062 the template results in the following errors >>>bug_report
aformat jinja2 filter this is simple alternative format filter which comes in hand when mapping data formatting function over list eg suppose we have list like we could format join their names in template or playbook using the following construct >>>feature_pull_request
add how to load extra variables directly from file using not sure if should generate the final man page now tried with a2x but version wasn updated so probably missing manifest file somewhere submitting only the updated asciidoc reason https groups google com topic ansible project xpcgvejde discussion>>>docs_pull_request
patch action plugin does not require dest dest is not required as patchfile can have that info and the module did not require it should fix https github com ansible ansible modules extras issues 258>>>bugfix_pull_request
fixed broken link added links to both core and extras git repos also bumped date to 2015 >>>docs_pull_request
small change to guid gce rst project name should be project id >>>docs_pull_request
indexerror list index out of range hi all am using ansible since months uptill now it was well and good but now it is giving error on every ansible command for ex running ping modue ansible vvvv 172 27 59 27 ping establish connection for user root remote module ping exec ssh tt vvv controlmaster auto controlpersist 60s controlpath root ansible cp ansible ssh port 22 kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no connecttimeout 10 172 27 59 27 bin sh mkdir home ansible tmp ansible tmp 1423718954 13 54115388015450 echo home ansible tmp ansible tmp 1423718954 13 54115388015450 172 27 59 27 failed traceback most recent call last file usr lib python2 site packages ansible runner init py line 590 in executor exec rc self executor internal host new stdin file usr lib python2 site packages ansible runner init py line 792 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file usr lib python2 site packages ansible runner init py line 1025 in executor internal inner result handler run conn tmp module name module args inject complex args file usr lib python2 site packages ansible runner action plugins normal py line 57 in run return self runner execute module conn tmp module name module args inject inject complex args complex args file usr lib python2 site packages ansible runner init py line 475 in execute module tmp self make tmp path conn file usr lib python2 site packages ansible runner init py line 1267 in make tmp path result self low level exec command conn cmd none sudoable false file usr lib python2 site packages ansible runner init py line 1173 in low level exec command in data in data file usr lib python2 site packages ansible runner connection plugins ssh py line 291 in exec command not in host file self not in host file self host file usr lib python2 site packages ansible runner connection plugins ssh py line 236 in not in host file if tokens find self hashed key magic indexerror list index out of range >>>bug_report p2
update outdated command description in section latest release via yum in section `latest release via yum` there are two outdated descriptions and made the following changes to reflect the latest git clone command needs to have recursive` to let git pull the submodules otherwise ansible modules wouldn be compiled based up context `rpmbuild` folder is in current directory ansible` instead of directory home directory >>>docs_pull_request
the authorized keys documentation does not specify that giving key url is available since issue type documentation bug report ansible version now devel environment but os summary the documentation http docs ansible com authorized key module html says that using the key param with url will download and use that key however it not available in any released ansible and the documentation does not say that it requires the unreleased steps to reproduce see this in the docs try it in expected results it works as per the documentation actual results it doesn work as it not in an ansible could get through pip the docs should say that it available in and up to make it clear that it new feature that being said the new feature is wonderful thankyou thanks to jmainguy on irc for helping me track it down >>>docs_report p2
made sure passwords are strings also strip vault input for usage as it is for encryption should fix 10166>>>bugfix_pull_request p2
provide host uuid in ansible facts ansible should provide consistent machine id uuid in facts if available sources of consistent uuids are according to machine id http man7 org linux man pages man5 machine id html manpage etc machine id` var lib dbus machine id` if these aren available on system as an alternative ansible could provide random uuid in separate fact depending on presence of `uuidgen` utility on ansible controller host then user could grab that randomly generated uuid and save it in local ansible facts for later consistent use for example uuid can be used to identify host uniquely for accounting tracking virtual machines or containers across systems etc >>>feature_idea
more integration tests for rax modules this pr adds integration tests for the following modules rax clb rax clb nodes rax facts rax keypair rax meta rax network rax cbs rax cbs attachments rax identity rax cdb rax cdb database this doesn cover all rax modules but am getting there want to get what have merged sooner rather than later incase cannot get to the remainder any time soon >>>feature_pull_request p2
unexpected default sudo user behavior issue type bug report ansible version environment fedora control host to debian wheezy target host all logins are through regular user that uses sudo to become root root login via ssh is restricted and root does not have password standard google compute engine setup summary had root set as the default user for sudo the deployment user has full sudo privileges to any other user and command then tried to indicate sudo user on single task in role to pull down git repo with the correct permissions and used on the command line to enter the sudo password for the deployment user but kept getting hangs with ssh connection error waiting for sudo or su password prompt steps to reproduce start playbook with hosts targethost remote user deploymentuser sudo yes roles rolename in the role tasks name pull down git repo as application user sudo user appuser git accept hostkey yes dest path to directory key file path to ssh secretkey pem version master repo repourl expected results the playbook would sudo to root as default unless otherwise indicated and sudo would all work with the same supplied password for the deployment user actual results auth log on the target host indicated failed attempts at sudo password and playbook did not work until manually specified hosts targethost remote user deploymentuser sudo yes sudo user root roles rolename at the beginning of the playbook then the playbook executed as expected and the git repo was pulled down as the appuser so there is some difference between manually specifying the sudo user and relying on the configured default in ansible cfg this may be related to open issue 9616 it sounds similar >>>bug_report p2
suggest renaming copy no on unarchive to something else after using ansible for over year still regularly get bitten by this know there has been few other issues with less than friendly people but wanted to open civil discussion to create path towards renaming this into something much more explicit core problem keep getting bitten by unarchive doing local archive remote host instead of remote archive remote host copy no sort of solves this problem but really requires you to carefully parse the documentation based on some googling other people regularly have this problem as well question is there better naming for this to make it explicit for people who want to unarchive files they download to machines or should remote be the default remote yes might also be better naming convention than copy no >>>feature_idea
tasks use do until by default by default if task fails ansible does not retry the task ansible tasks can be dependent on many moving parts and so transient errors are common do until loops can be used to retry tasks and must be specified for each task individually retrying task is such commonly used feature it would be useful to be to have this enabled by default this patch adds the ability to enable do until loops on all tasks by default this feature is enabled with the constant default do until retries enabled three additional constants are added default do until retries default do until delay default do until condition default do until condition is set to register success by default where register is used as placeholder for the tasks registered variable do until loop can be disabled on task with until null >>>feature_pull_request
add md5sum sha1sum option to get url module sha256sum is too slow issue type feature idea ansible version environment summary my playbooks spend considerable amount of time calculating sha256 hashes would be great to have `md5sum` option to speed up things while still playing the crc check role >>>feature_idea
set proper permissions for ansible vault view fixes issue 10214 sets umask before creating the temporary file and sets it back to the original value when file is created >>>bugfix_pull_request p1
ansible vault view writes world readable files in tmp issue type bug report ansible version ansible environment debian summary `ansible vault view` do not set the proper umask when writing the temporary file to tmp thus on many systems it makes the file world readable files managed by ansible vault often containing sensitive data this may be security issue steps to reproduce expected results actual results >>>bug_report p1
vmware inventory script updates from tower major refactor of inventory script to return useful facts from host systems and guest vms group vms by resource pool datastore network guest os and template set ansible ssh host >>>feature_pull_request
update ec2 inventory script with changes from tower adds to changes from 6676 to support nested vpc group and vpc grouping for rds adds to changes from 8822 to ignore invalid instance filters implements grouping by ami id based on 7573 implements configuration options to limit which groups are created automatically based on 7573 >>>feature_pull_request
ansible not pulling images from private docker repository ve problems with ansible automatically pulling docker images from my private repository do login first via and then tried the following instructions everyone gave me an error `msg docker api error no such image` doing manually `docker run registry foo 8888 app` did pull and start the image had to manually insert any ideas >>>bug_report
template module broken when modifying symlinks if you attempt to template file that symlink and the file is already up to date the code path for the template module attempts to invoke the file module this is done right here https github com ansible ansible blob devel lib ansible runner action plugins template py l158 you can see right before the module invocation it attempts to wipe the `src` parameter from the module arguments unfortunately if you use complex args it doesn wipe that attribute from there so the `src` parameter continues to be passed to the file module this then ends up hitting the following error https github com ansible ansible modules core blob release1 files file py l264 ve tested this on ansible and and it appears to be present in both >>>bug_report p2
add possibility to add custom additional ssh known hosts files in ansible cfg issue type feature idea ansible version environment os running ansible archlinux latest up to date as of 2015 02 10 managed os ubuntu lts 14 04 up to date as of 2015 02 10 summary here the thing we use ssh jump hosts so we ab use `proxycommand` ssh option that in turn requires to have some configuration in ssh config file ssh config created ssh config file which is kept in repository with ansible stuff it referenced in shipped ansible cfg by means of so figured that it would be nice idea to also add ssh known hosts file to repo that way if provision some new hosts confirm their identities then noone else will need to do the same when custom ssh known hosts file is referenced in custom ssh config file and is different than one of defaults which are checked in `lib ansible runner connection plugins ssh py` then ansible will assume that hosts don have their keys accepted and will instead run in serial mode serialization is also forced in aforementioned file whether to keep ssh known hosts file in vcs or not is subject for another discussion but please notice that root cause is custom ssh known hosts file path and not versioning function which checks whether hosts key is already accepted is defined in and is called steps to reproduce set custom ssh known hosts file path in your ssh config >>>feature_idea
typo in galaxy rst>>>docs_pull_request needs_revision
disable keyscan on `git urls `git isn ssh url do not check the host key of it >>>bugfix_pull_request needs_revision
add hp ux network facts added support for hpux network facts>>>feature_pull_request needs_info
adds kerberos authentication to winrm if available if the kerberos module is available winrm will attempt to establish kerberized connection to windows server this allows use of windows domain accounts which are quite often the only kinds of accounts enabled on enterprise networks this also pulls the `transport schemes` variable up into the `winrm connection` class this lets tests or future modifications alter the list of available schemas without reaching into `connection init identical to 10161 but now with moar devel >>>feature_pull_request windows
revert adds kerberos authentication to winrm if available reverts ansible ansible 10161 not supposed to merge against release branches >>>windows
fixes su ssh with null prompt this should fix 10170>>>bugfix_pull_request p2
debug requires connection with client when using winrm when try to use debug task in my role noticed that when run it on future linux machine ssh connection there is no problem but when the machine is going to be windows machine so requiring winrm this task hangs ansible exh345 werner rhevm ansible testnixpxe debug msg testjen platform dev inventory vvvv establish connection for user exh345 testnixpxe success msg testjen ansible exh345 werner rhevm ansible testwinpxe debug msg testjen platform dev inventory vvvv establish winrm connection for user ansible on port 5986 to testwinpxe winrm connect transport plaintext endpoint https testwinpxe 5986 wsman winrm connection error 500 winrmtransport errno 113 no route to host winrm connect transport plaintext endpoint http testwinpxe 5986 wsman winrm connection error 500 winrmtransport errno 113 no route to host testwinpxe failed 500 winrmtransport errno 113 no route to host sidenote both of these machines don exist yet just added them to the host file so ansible knows them already because create these machines with ansible as role on the to be created machine but with delegates and the moment that finishes want to continue with their required roles after the machine creation is completed ansible exh345 werner rhevm cat createvm yml hosts all gather facts no vars prompt name passwd prompt rhevm password private yes pre tasks fail msg you should limit the hosts you re running on when play hosts groups all run once yes roles createvm webserver and run this with ansible exh345 werner rhevm ansible playbook createvm yml testwinpxe platform dev inventory which works perfect for linux machine so it creates the vm and runs the rest of the required roles but on the windows machine it doesn because of the required connection with the windows to output debug msg >>>bug_report windows
attribute skipped is not set on command module output when using creates issue type bug report ansible version ansible installed via the epel repository ansible version ansible configured module search path usr share ansible environment issue reproducible on oracle linux and amazon linux 2014 09 summary in ansible the skipped attribute on registered variable is not being set in the output from command module task using creates this makes it difficult to control subsequent tasks this issue is not present in ansible epel or ansible debian wheezy steps to reproduce playbook skipped yml hosts all tasks name check whether file exists command bin true creates tmp file register check file name debug check file debug var check file name pause for second pause seconds when not check file skipped inventory file hosts local localhost ansible connection local command ansible playbook hosts skipped yml expected results this is the check file variable using previous version ansible from epel task debug check file ok localhost check file changed false cmd bin true invocation module args bin true creates tmp file module name command rc skipped true stderr false stdout skipped since tmp file exists stdout lines skipped since tmp file exists actual results this is the check file variable using ansible the output is identical except the skipped attribute is missing causing the skipped macro to return false in this case the following pause task always runs whether the file exists or not task debug check file ok localhost check file changed false cmd bin true invocation module args bin true creates tmp file module name command rc stderr false stdout skipped since tmp file exists stdout lines skipped since tmp file exists >>>feature_idea needs_info
make su promt aix compatible su suuser date suusers password >>>bugfix_pull_request
include vars logs sensitive vault encrypted role vars when verbose issue type bug report ansible version ansible playbook version ansible playbook configured module search path usr share ansible environment linux dev03 32 504 el6 x86 64 smp fri dec 12 16 05 43 est 2014 x86 64 x86 64 x86 64 gnu linux summary senstive role vars that are encrypted with ansible vault are logged when verbose logging is enabled steps to reproduce have created an example playbook which demonstrates the problem https github com jamesdmorgan ansible1 vault logging expected results would expect that data stored in the vault would never be logged or at least be obfuscated actual results sensitive information is logged >>>bug_report p2
filtering by vpc not applied to rds instances in ec2 inventory script ec2 py to produce the issue one needs an ec2 account with two or more vpcs setup and an rds instance running in one of them now use an instance filter in the ec2 ini file as follows to filter for all resources in the vpc group not containing the rds instance instance filters vpc id vpc myid besides getting all the resources in that vpc group you will get meta data and other information for any rds instances in the other vpc group as well unsure whether this is bug in the ec2 py script or whether the vpc filtering feature is simply not supported by boto >>>cloud feature_idea
support for patch module to have master as src this compliments the patch plugin and allows for src to be copied from master>>>feature_pull_request
unsupported parameter error when using resource tags to tag vpc resource getting an error when trying to use resource tags in ec2 vpc module tasks name create vpc local action module ec2 vpc region region cidr block 10 16 resource tags name development vpc the error received is task create vpc in region failed localhost 127 failed true msg unsupported parameter for module resource tags fatal all hosts have already failed aborting also ec2 vpc module is not able to tag the subnets created for example running the below code name create vpc in region local action module ec2 vpc region region cidr block 10 16 subnets cidr 10 24 az us east 1a resource tags environment development name public subnet cidr 10 24 az us east 1b resource tags environment development name public subnet cidr 10 24 az us east 1d resource tags environment development name public subnet executes correctly but the tags are not getting created the above error can be reproduced by executing the code above >>>bug_report p2
output of template module inconsistent return vars between runs hi issue type bug report ansible version ansible devel 68d45122c2 environment host tested on both ubuntu 14 04 and osx 10 10 yosemite remote not applicable summary using the template module to write files locally and registering the created files then using the `path` field of those registered variables in another template when accessing the registered variable on the first run it does not contain the `path` variable when the task is re run it works fine steps to reproduce here is gist https gist github com rob johnson 8408ac61853671f2f95b to reproduce it is in the rendering of `dockerfile j2` that the error occurs particularly when accessing the `file path` variable expected results the registered variable contains the expected fields on the first run this fails with the error actual results `fatal localhost 127 msg ansibleundefinedvariable one or more undefined variables dict object has no attribute path failed true it is successful on the second run thanks edit here the output of adding debug var files` to the `site yml` playbook first run second run >>>bug_report needs_info
ignore errors from `shutil rmtree` when removing temporary directory this fixes an issue have when installing roles from yaml requirements file here my requirements file am running which works the first time but on subsequent runs am running osx 10 it should be safe to ignore errors here as this is temporary directory thanks sparkling heart >>>bugfix_pull_request
update playbooks delegation rst there space missing hosts 127 should be hosts 127 >>>docs_pull_request
avoid running pre post tasks on plays with no roles tasks issue type feature idea ansible version environment na summary if play won run any tasks for exaple because none were selected by tags its pre and post tasks shouldn run the current behavior can cause problems when using tags to deploy single application out of several from larger playbook steps to reproduce large playbooks describing several clusters of applications with pre post tasks for load balancers cleanup etc deploying one app using tags expected results the first playbook pre post tasks shouldn be run because tags deselected all of its tasks actual results the current way of using tags app3 pre tasks post tasks` causes machines to be removed from the lb and immediately re added without any work done on them >>>feature_idea
better missing editor message fixes 10182>>>bugfix_pull_request
fixing ticket 9845 man pages contain duplicate author section removed duplicate author section in man pages >>>docs_pull_request
adds complex tag management adds special tag always always runs no matter what tags skip tags says adds special keywords for tags all all tagged untagged tasks tagged only tagged tasks untagged only untagged tasks always only run tasks tagged always think this covers all cases described in various tickets asking for more fine control over tags>>>feature_pull_request
ansible vault missing editor message unclear issue type bug report ansible version ansible configured module search path none environment running ubuntu 14 04 lts summary when ansible vault invokes an editor for example when creating new file and that editor is not found the message presented is unclear about exactly what is going on steps to reproduce run editor testing ansible vault create test expected results expected ansible vault to give me bit more information to what was happening for example something like error failed to launch editor errno no such file or directory maybe even what editor it was trying to launch actual results >>>bug_report
`unarchive` option `creates` check does not work correctly when using non equals sign syntax issue type bug report ansible version ansible configured module search path none environment mac os 10 managing debian summary the `creates` option of the `unarchive` action is supposed to check if the archive has already been unarchived on the destination this can be used to prevent large archive file from being copied for example this check does not work correctly if the complex syntax non inline non equals sign syntax is used when the non equals sign syntax is used the check always results in the archive being copied even if the archive has been successfully extracted before if the equals sign syntax is used then the check is performed correctly and the file is not copied unnecessarily this issue was reported to the mailing list later in the thread unarchive module creates does not work https groups google com forum msg ansible project jwyfl8zw8qw 5n1cqmml7a0j but no issue was created in github afaict steps to reproduce name install files unarchive src files my large archive zip dest opt my dest creates opt my dest my directory copy yes sudo yes expected results after the playbook was successfully run once the large archive file should not be copied to the destination again as the opt my dest my directory` directory from inside the archive now exists actual results the large archive file is always copied the only way to avoid this is to use the inline equals sign syntax like so name install files unarchive src files my large archive zip dest opt my dest creates opt my dest my directory copy yes sudo yes as side note see 9538 includes the comment removing the creates line makes the issue go away as does changing it to equals notation which makes me wonder if it related >>>bug_report p2
connection type ssh pipelining enabled sudo no requiretty in etc sudoers results in task timeout issue type bug report ansible version environment control system mac osx managed system ubuntu 14 04 summary there is syntax error in the ssh command used by ansible to create connection and execute sudo command on the target system ubuntu 14 04 when the playbook runs from my control system mac running osx get the following output running the ssh command by hand reveals the following error after the connection is established and authenticated notice the `debug1` line above there are no quotes surrounding the command being passed to bin sh` running similar command by hand on the target system with shell debugging enabled get this it appears as if bin sh` is eating the k` when we run the command fully quoted we get the expected results as previously stated this is ubuntu 14 04 system so bin sh` is linked to bin dash` can get the command to execute correctly from the control system the mac by placing double quotes within the outer most single quotes of the command passed to ssh and escaping the double quotes to the p` flag of `sudo` there is one similar issue 9544 that has comments reflecting this behavior after fix for paramiko hang has been merged this is likely the problem that the commenter is encountering >>>bug_report needs_info p2
ansible ec2 external inventory script only finds jump hosts not the internal servers the ansible ec2 external inventory script does not detect internal hosts which are hidden behind jumphost the script is described here http docs ansible com intro dynamic inventory html example aws ec2 external inventory script it only finds the jump hosts for each environment but not the internal servers with the command ec2 py list >>>bug_report p2
obfuscate passwords in variety of output fixes 10101 did some testing with the following playbook and the following commandline found several sources of output that did not identify and hide password strings this pull request should fix that for the v1 tree some questions to answer before merging should be obfuscating passwords in stdout and stderr output when calling fail json from basic py ansiblemodule run command obfuscation can be overzealous in some cases and so don know if this would end up making debugging hard in some cases no log true will hide the stdout and stderr output if we decide not to hide stdout stderr couldn find password obfuscation code in the v2 tree inspecting the output shows that there is little bit of password obfuscation occurring in v2 but it isn complete we probably need to at least modify basicpy run command in v2 as well and there may be other places there may also be more logging displaying code yet to go into v2 and those would have to be checked for unobfuscated passwords afterwards as well >>>bugfix_pull_request p2
please document vault password file in cli manpages hello it would be great if the manpages for ansible and ansible playbook would document the option vault password file currently the option can be discovered only by searching the internet regards ed>>>docs_report
add scaffolding for serverspec integration testing this adds an option serverspec to create scaffolding to support integration testing with kitchen serverspec as described here https github com neillturner kitchen ansible >>>feature_pull_request pending_closure
make collins attributes more accessible make collins something variable instead of attribs something ssalevan image of phil https pbs twimg com profile images 1078039058 philcollins 10 jpg >>>feature_pull_request
use termios instead of stty for compatibility solaris does not have stty size but stty outputs in different format instead of branching on operating system it is more portable to use termios to get the terminal parameters >>>bugfix_pull_request
outdated note on git module documentation believe the following is outdated note if the task seems to be hanging first verify remote host is in known hosts ssh will prompt user to authorize the first contact with remote host to avoid this prompt one solution is to add the remote host public key in etc ssh ssh known hosts before calling the git module with the following command ssh keyscan remote host com etc ssh ssh known hosts the accept hostkey parameter to the module should handle this for users now >>>docs_report
reformat and clarify yaml syntax descriptions>>>docs_pull_request
missing problematic support for su pass in ssh py the following use of ansible playbook with remote su ing to root fails when we use the default ssh transport and hence `ssh py` but succeeds when we use use the `transport paramiko` connection driver the failure in the ssh driver occurred at this line https github com ansible ansible blob release1 lib ansible runner connection plugins ssh py l338 since the `self runner sudo pass` variable is `none` it makes sense that it is `none` since we aren using sudo but not sure why we ended up at this line in the first place it appears that `utils su prompts check su prompt sudo output does not evaluate to true so we end up in sudo specific loop this code is quite complicated it may make sense to break out su related action into separate block for maintainability reasons >>>bug_report p2
role dependencies condition issue have variable hbase standalone that set to false in defaults but for my current host it true and here how my dependencies look like so hadoop role is not included that fine but oracle jdk is also ignored works fine if change the order though mac os ansible >>>bug_report
ansible sudo pass for numeric passwords hi there is bug with python types when we use numeric passwords in inventory file `self runner sudo pass` interpreted as integer and concatenation fails >>>bug_report p2
long delay in ansible playbook strace shows loop that stats non existing module files issue type bug report ansible version environment summary we re using ansible for quite while now and for now we re very happy about it only one small thing is bothering me and it that there delay between launching ansible playbook and the actual process of deploying for some reason suspected something related to ssh but finally ve made some time free to investigate the issue and see with strace that there is loop searching for non existing module files after some debugging found out that the problem should be in usr lib python2 site packages ansible playbook play py but can seem to find what the exact problem is steps to reproduce execute ansible playbook for example expected results no delay between prompt for password and start of playbook deployment actual results long 15s delay between prompt for password and start of playbook deployment fragment from the strace output when the delay appears the above seems to loop for while and eventually continues with the normal actions >>>bug_report
filters after default omit filter the omit placeholder issue type bug report ansible version environment os 10 10 14c109 summary filters following the `default omit filter keep filtering steps to reproduce given `user info` as an array of user objects some of which had an array of group names that user should be in and some that lacked groups key all together had the following task would expect this to omit `groups field that lacked an `item groups` key and include `groups filed with csv list of the items in the array `item groups` instead all `item`s have `groups parameter some which have `groups set to setting `default fixes the issue but that results in all users having blank `groups field which is different that omitting them what would prefer in this case it seems like filters following an `default omit should not be run or maybe just not seeing why they would be which is why this seems like bug expected results would expect filters following `default omit filter to not be run against the omit placeholder object actual results filters are run against the omit placeholder object >>>bug_report
add intro to playbook docs using yaml dictionaries something my team and have found for working with playbooks that helps keep them neat and organized is setting modules to be multi lined we started with the character for multi line strings in yaml but that lead to all kinds of odd quoting issues we ve since found in the ec2 module example that ansible supports yaml dictionaries for the module args but there aren any docs on the topic so here some >>>docs_pull_request
adds kerberos authentication to winrm if available if the `kerberos` module is available winrm will attempt to establish kerberized connection to windows server this allows use of windows domain accounts which are quite often the only kinds of accounts enabled on enterprise networks this also pulls the `transport schemes` variable up into the `winrm connection` class this lets tests or future modifications alter the list of available schemas without reaching into `connection init >>>feature_pull_request windows
too many open files or file descriptor out of range in select while gathering facts from coreos machine with 200 running containers while executing `ansible infrastructure somehost fqdn setup` getting following result result is same while using ansible release and `devel` brach everything works fine if kill all containers or have 40 containers running using `defunctzombie coreos bootstrap` role with docker py to prepare coreos machine >>>bug_report p2
unable to read registered output of docker inspect format issue type bug report ansible version ansible configured module search path usr share ansible environment debian unstable summary trying to use the registed output of `docker inspect format results in fatal error interestingly enough this works with ansible but not with also works when just using the output of `docker inspect without the format` option steps to reproduce use the following `playbook yml` hosts localhost connection local tasks know this task returns the information we inpect below in ansible facts docker containers but to uncover the bug `docker inspect format will be used name start test container docker image busybox name sleep command sleep 10 volumes srv state running name read image hash of container command docker inspect sleep register inspect name read image hash of container command docker inspect format index image sleep register image name read name of container command docker inspect format name sleep register name name read directory of container volume command docker inspect format index volumes srv sleep register volume we can us with items on the variable names since the encountered fatals will end the loop prematurely debug var stdout name clean up test container docker image busybox name sleep state absent execute it on host which has docker installed and running for in inspect image name volume do ansible playbook playbook yml done expected results `inspect stdout` should contain the complete json output `image stdout` should be the hash of the official `busybox` docker image `name stdout` should be sleep` `volume stdout` should be something like var lib docker vfs dir 92fd93ceedababafb4d61615749e093dd170cae4f2f1ec092fc11159b6b0b7c5` actual results `inspect stdout` correctly contains the complete json output with the debug task for `image stdout` fails with `fatal localhost template error while templating string expected name or number` the debug task for `name stdout` fails with `fatal localhost template error while templating string unexpected the debug task for `volume stdout` fails with `fatal localhost template error while templating string expected token end of print statement got string >>>bug_report
vault password initialized to false instead of none by playbook init the default value of vault password should be none because in utils init py the expectation is that if you didn specify vault password it will be none if vault is encrypted data if the file is encrypted and no password was specified the decrypt call would throw an error but we check first since the decrypt function doesn know the file name if vault password is none raise errors ansibleerror vault password must be specified to decrypt path data vault decrypt data show content false but the playbook init method initializes it to false which causes the above check for none to be skipped and then the vault will try to decrypt with none vault passowrd which of course fails class playbook object def init self playbook none vault password false force handlers false >>>bug_report needs_info
add missing dependency to deb package ran into this while testing playbook in docker container using ubuntu utoptic as the base >>>bugfix_pull_request
expand validation to work with upstart issue type bug report ansible version off devel as of 5eafa1e7c3 environment target ubuntu 14 04 control machine os 10 summary the template validate command does not work with upstart configs as the temporary filename used for the action does not end in conf and instead is passed to init checkconf as source this was referenced in passing in https github com ansible ansible issues 9112 on september 24th with bcoca providing it wasn meant to work for everything statement which ve warmed on when thinking about potential work arounds still opening the issue in case anyone has clever idea of how to fix this and as target for future searches potential work arounds not using the validate command on upstart templates running init checkconf in future task and adding failed when clause using customized init checkconf script the template module allowing for parameter that functions like temporary filename as work around for scripts programs that do file extension checks my employer hiring an intern to verify my configs and optionally act as scapegoat when break things steps to reproduce use the template module with the validate command for an upstart file task name uwsgi should start with the os template src upstart emperor conf dest etc init uwsgi conf owner root group root mode 0544 validate init checkconf template arbitary for contents just needs to exist description uwsgi emperor start on runlevel 2345 stop on runlevel 06 exec usr local bin uwsgi ini etc uwsgi emperor ini run `ansible playbook` with the playbook containing the task calling that template expected results init checkconfig should run against the file and either output file etc init uwsgi conf syntax ok or error file etc init uwsgi conf syntax invalid or should error out if the destination parameter given to the template module does not end in conf actual results running the task task uwsgi uwsgi should start with the os failed 127 failed true msg failed to validate rc error error file must end in conf results in init checkconf raising this error with simple echo filename egrep conf die file must end in conf with the variable printed on error we have msg failed to validate rc error error file must end in conf filename source where source as the filename is failing the file extension check >>>feature_idea
vagrant guide updating private key location since vagrant released in december 2014 the private key file is autogenerated for each box and has new location here is the changelog for more info version changelog https github com mitchellh vagrant blob master changelog md 170 december 2014 the new location folows this structure vagrant machines machine name provider private key`>>>docs_pull_request
backup retention we use the backup option of the template module to keep older versions of config files to possibly go back if necessary but the backup option keeps backup files and does not remove older versions of the files currently we implement new method after every time we backup to cleanup older version but it would be cool to be able to specify the retention period or the retention count >>>feature_idea
if hosts section contains list dict instead of list str stacktrace is dumped used list of dicts for the hosts section apparently not legal but ansbile does not explain where in my document the error is the result is apparently the hosts section doesn accept list of dicts like the roles section does you can argue whether this would be useful hoped it would because it seemed good for my use case however ansible should at least say where in the yaml file the structure is incorrect line number now it just guesswork >>>bug_report
9471 removed blank line when running with diff fixing issue 9471 here are test runs using the template module and checking the diff between two files the first run the diff is shown on the output then the file is updated diff is run again since there is no diff there will be nothing in the output playbook used for the test >>>bugfix_pull_request
filter plugins for ip arithmetic can be used for traversing long ip ranges in playbooks and templates >>>feature_pull_request
faster than normal clone using git clone depth see https github com ansible ansible issues 10080 10080 by default git will clone full repository it will eat your disk space for example the linux kernel git repository larger than 1gb if you clone full repository you may take long times and need more diskspace we can make things getting easier just clone git repo with depth it will working as normal but save your time and diskspace >>>docs_pull_request
adding list vars option to ansible playbook wanted way to list out variables without running any plays first commit is the implementation of the code second commit is my efforts to refactor and implement some pep8 standards to this file >>>feature_pull_request
v2 added retry configs pending is actual functionality to make it conditional>>>feature_pull_request
fixes 10051 as suggested by aikomastboom fixed 10051>>>bugfix_pull_request p2
it would be nice to have ssh path in ansible cfg have configuration where the system ssh in my path does not contain all the control directives and openssh is installed at different location not in my path it would be very convenient if could configure something like in `ansible cfg` as downstream packager this would also allow me to ship an example `ansible cfg` together with the package and an openssh dependency to get users smooth start >>>feature_idea
initial draft virtualbox inventory script works for me short simple no cache as it is normally local>>>feature_pull_request
saner ansible pull output use ansible pull in cronjob manually redirect stdout to dev null in this cronjob because only want to be notified of errors my cron is setup in way that it sends me an email if the cronjob has any output at all the annoying thing is that receive an email everyday saying `starting ansible pull at 2015 01 29 00 00 20` that the case because someone decided that it would be good idea to write this to stderr even though it isn an error message thus decided to change this and send pull request while doing so discovered that ansible doesn write message to stderr when it was unable to pull the remote repositiory therefore changed that as well >>>bugfix_pull_request
`mandatory` filter not working issue type bug report ansible version environment tested on rhel5 and on rhel6 summary `mandatory` filter doesn seem to work steps to reproduce in `ansible cfg` set parameter `error on undefined vars` value to `false` playbook expected results expected the following output and no file in destination path actually wiped out the code from `mandatory` function in `filter plugins core py` leaving only this line so as to force an error and cause failure actual results getting this output and file tmp dummy bar mandatory on destination host >>>bug_report p2
couldn read packet connection reset by peer running ansible playbook slaves add gateways yml tags update hadoop gateway ldap play gateways gathering facts establish connection for user ubuntu establish connection for user ubuntu remote module setup remote module setup exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588438 33 68302313180656 chmod rx home ansible tmp ansible tmp 1422588438 33 68302313180656 echo home ansible tmp ansible tmp 1422588438 33 68302313180656 exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588438 33 83221910380178 chmod rx home ansible tmp ansible tmp 1422588438 33 83221910380178 echo home ansible tmp ansible tmp 1422588438 33 83221910380178 put tmp tmp1ky9nx to home ubuntu ansible tmp ansible tmp 1422588438 33 83221910380178 setup put tmp tmpmvsnr1 to home ubuntu ansible tmp ansible tmp 1422588438 33 68302313180656 setup exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key zkxrwityxbjjmsfaamygofakyhxtghdx password root bin sh echo sudo success zkxrwityxbjjmsfaamygofakyhxtghdx lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588438 33 68302313180656 setup rm rf home ubuntu ansible tmp ansible tmp 1422588438 33 68302313180656 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key gftimjrguorhfwrgucuklenukdieinnb password root bin sh echo sudo success gftimjrguorhfwrgucuklenukdieinnb lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588438 33 83221910380178 setup rm rf home ubuntu ansible tmp ansible tmp 1422588438 33 83221910380178 dev null ok ec2 54 149 112 230 us west compute amazonaws com ok ec2 54 68 59 104 us west compute amazonaws com task cdh hadoop gateway set debconf variables establish connection for user ubuntu establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config dblogin vtype boolean value false remote module debconf name ldap auth config question ldap auth config dblogin vtype boolean value false exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588440 76 194671152877403 chmod rx home ansible tmp ansible tmp 1422588440 76 194671152877403 echo home ansible tmp ansible tmp 1422588440 76 194671152877403 exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588440 77 166275726564362 chmod rx home ansible tmp ansible tmp 1422588440 77 166275726564362 echo home ansible tmp ansible tmp 1422588440 77 166275726564362 put tmp tmplt11ms to home ubuntu ansible tmp ansible tmp 1422588440 77 166275726564362 debconf put tmp tmp8q5lka to home ubuntu ansible tmp ansible tmp 1422588440 76 194671152877403 debconf exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key wwkhhwlvfousfuwvdcldpjnmdibpqcns password root bin sh echo sudo success wwkhhwlvfousfuwvdcldpjnmdibpqcns lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588440 77 166275726564362 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588440 77 166275726564362 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key hubbrrgmfeierhqikffcapfwdxrfodgk password root bin sh echo sudo success hubbrrgmfeierhqikffcapfwdxrfodgk lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588440 76 194671152877403 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588440 76 194671152877403 dev null ok ec2 54 68 59 104 us west compute amazonaws com item key dblogin value type boolean value false changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key dblogin value type boolean value false msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns base dn vtype string value dc tango dc me exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588443 01 185053784548948 chmod rx home ansible tmp ansible tmp 1422588443 01 185053784548948 echo home ansible tmp ansible tmp 1422588443 01 185053784548948 ok ec2 54 149 112 230 us west compute amazonaws com item key dblogin value type boolean value false changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key dblogin value type boolean value false msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns base dn vtype string value dc tango dc me exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588443 01 118820964325829 chmod rx home ansible tmp ansible tmp 1422588443 01 118820964325829 echo home ansible tmp ansible tmp 1422588443 01 118820964325829 put tmp tmpbliblq to home ubuntu ansible tmp ansible tmp 1422588443 01 118820964325829 debconf put tmp tmp9ay0k8 to home ubuntu ansible tmp ansible tmp 1422588443 01 185053784548948 debconf exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key lpxlcdgvgbspcpgbvodmbqjmbbiwqqxy password root bin sh echo sudo success lpxlcdgvgbspcpgbvodmbqjmbbiwqqxy lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588443 01 118820964325829 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588443 01 118820964325829 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key gctvaqhhwqskauvydjluwoyuywqtqvfb password root bin sh echo sudo success gctvaqhhwqskauvydjluwoyuywqtqvfb lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588443 01 185053784548948 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588443 01 185053784548948 dev null ok ec2 54 149 112 230 us west compute amazonaws com item key ldapns base dn value type string value dc tango dc me changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key ldapns base dn value type string value dc tango dc me msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config rootbinddn vtype string value cn admin dc tango dc me exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588445 26 73987810477468 chmod rx home ansible tmp ansible tmp 1422588445 26 73987810477468 echo home ansible tmp ansible tmp 1422588445 26 73987810477468 ok ec2 54 68 59 104 us west compute amazonaws com item key ldapns base dn value type string value dc tango dc me changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key ldapns base dn value type string value dc tango dc me msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config rootbinddn vtype string value cn admin dc tango dc me exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588445 29 141353088496960 chmod rx home ansible tmp ansible tmp 1422588445 29 141353088496960 echo home ansible tmp ansible tmp 1422588445 29 141353088496960 put tmp tmpf4k0yc to home ubuntu ansible tmp ansible tmp 1422588445 26 73987810477468 debconf put tmp tmpfpzcr2 to home ubuntu ansible tmp ansible tmp 1422588445 29 141353088496960 debconf exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key jnjsspcvlfzhpkfrlefgdjlegvxrlrto password root bin sh echo sudo success jnjsspcvlfzhpkfrlefgdjlegvxrlrto lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588445 26 73987810477468 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588445 26 73987810477468 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key adnwwoonziacpglcfcpjftlqcixbppkk password root bin sh echo sudo success adnwwoonziacpglcfcpjftlqcixbppkk lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588445 29 141353088496960 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588445 29 141353088496960 dev null ok ec2 54 149 112 230 us west compute amazonaws com item key rootbinddn value type string value cn admin dc tango dc me changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key rootbinddn value type string value cn admin dc tango dc me msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns ldap server vtype string value ldap ec2 54 149 231 61 us west compute amazonaws com exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588447 52 205455746505871 chmod rx home ansible tmp ansible tmp 1422588447 52 205455746505871 echo home ansible tmp ansible tmp 1422588447 52 205455746505871 ok ec2 54 68 59 104 us west compute amazonaws com item key rootbinddn value type string value cn admin dc tango dc me changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key rootbinddn value type string value cn admin dc tango dc me msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns ldap server vtype string value ldap ec2 54 149 231 61 us west compute amazonaws com exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588447 53 237748027705687 chmod rx home ansible tmp ansible tmp 1422588447 53 237748027705687 echo home ansible tmp ansible tmp 1422588447 53 237748027705687 put tmp tmpunjnle to home ubuntu ansible tmp ansible tmp 1422588447 52 205455746505871 debconf put tmp tmpm4gbcg to home ubuntu ansible tmp ansible tmp 1422588447 53 237748027705687 debconf exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key ihkxccdvdpdxvjxbdflgxinocnxvnjut password root bin sh echo sudo success ihkxccdvdpdxvjxbdflgxinocnxvnjut lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588447 52 205455746505871 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588447 52 205455746505871 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key wxjcvbemhmikmorcrnxdjosnuthusswu password root bin sh echo sudo success wxjcvbemhmikmorcrnxdjosnuthusswu lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588447 53 237748027705687 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588447 53 237748027705687 dev null ok ec2 54 68 59 104 us west compute amazonaws com item key ldapns ldap server value type string value ldap ec2 54 149 231 61 us west compute amazonaws com changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key ldapns ldap server value type string value ldap ec2 54 149 231 61 us west compute amazonaws com msg establish connection for user ubuntu ok ec2 54 149 112 230 us west compute amazonaws com item key ldapns ldap server value type string value ldap ec2 54 149 231 61 us west compute amazonaws com changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key ldapns ldap server value type string value ldap ec2 54 149 231 61 us west compute amazonaws com msg remote module debconf name ldap auth config question ldap auth config dbrootlogin vtype boolean value true establish connection for user ubuntu exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588449 75 136686315933486 chmod rx home ansible tmp ansible tmp 1422588449 75 136686315933486 echo home ansible tmp ansible tmp 1422588449 75 136686315933486 remote module debconf name ldap auth config question ldap auth config dbrootlogin vtype boolean value true exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588449 75 239243737001346 chmod rx home ansible tmp ansible tmp 1422588449 75 239243737001346 echo home ansible tmp ansible tmp 1422588449 75 239243737001346 put tmp tmppzndxi to home ubuntu ansible tmp ansible tmp 1422588449 75 239243737001346 debconf put tmp tmpln01wn to home ubuntu ansible tmp ansible tmp 1422588449 75 136686315933486 debconf exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh sudo sudo sudo via ansible key ebhvtqybyohqyqwztyyfgnbanugsmewx password root bin sh echo sudo success ebhvtqybyohqyqwztyyfgnbanugsmewx lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588449 75 239243737001346 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588449 75 239243737001346 dev null exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh sudo sudo sudo via ansible key cwikbatmlpiojezlgqvbltjelkrwnsmb password root bin sh echo sudo success cwikbatmlpiojezlgqvbltjelkrwnsmb lang en us utf lc ctype en us utf usr bin python home ubuntu ansible tmp ansible tmp 1422588449 75 136686315933486 debconf rm rf home ubuntu ansible tmp ansible tmp 1422588449 75 136686315933486 dev null ok ec2 54 149 112 230 us west compute amazonaws com item key dbrootlogin value type boolean value true changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key dbrootlogin value type boolean value true msg establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns ldap version vtype select value ok ec2 54 68 59 104 us west compute amazonaws com item key dbrootlogin value type boolean value true changed false current ldap auth config binddn cn proxyuser dc example dc net ldap auth config bindpw password omitted ldap auth config dblogin false ldap auth config dbrootlogin true ldap auth config ldapns base dn dc tango dc me ldap auth config ldapns ldap server ldap ec2 54 149 231 61 us west compute amazonaws com ldap auth config ldapns ldap version ldap auth config move to debconf true ldap auth config override true ldap auth config pam password md5 ldap auth config rootbinddn cn admin dc tango dc me ldap auth config rootbindpw password omitted item key dbrootlogin value type boolean value true msg exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 149 112 230 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588451 99 104820353281966 chmod rx home ansible tmp ansible tmp 1422588451 99 104820353281966 echo home ansible tmp ansible tmp 1422588451 99 104820353281966 establish connection for user ubuntu remote module debconf name ldap auth config question ldap auth config ldapns ldap version vtype select value exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home mzhou ansible cp ansible ssh stricthostkeychecking no kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user ubuntu connecttimeout 20 ec2 54 68 59 104 us west compute amazonaws com bin sh mkdir home ansible tmp ansible tmp 1422588452 89564755750509 chmod rx home ansible tmp ansible tmp 1422588452 89564755750509 echo home ansible tmp ansible tmp 1422588452 89564755750509 put tmp tmpru4md2 to home ubuntu ansible tmp ansible tmp 1422588451 99 104820353281966 debconf put tmp tmpcswgee to home ubuntu ansible tmp ansible tmp 1422588452 89564755750509 debconf fatal ec2 54 149 112 230 us west compute amazonaws com failed to transfer file to home ubuntu ansible tmp ansible tmp 1422588451 99 104820353281966 debconf ssh exchange identification read connection reset by peer couldn read packet connection reset by peer fatal ec2 54 68 59 104 us west compute amazonaws com failed to transfer file to home ubuntu ansible tmp ansible tmp 1422588452 89564755750509 debconf ssh exchange identification read connection reset by peer couldn read packet connection reset by peer fatal all hosts have already failed aborting play recap to retry use limit home mzhou add gateways retry ec2 54 149 112 230 us west compute amazonaws com ok changed unreachable failed ec2 54 68 59 104 us west compute amazonaws com ok changed unreachable failed >>>bug_report
add shell script to fast update ansible repo add shell script to fast update ansible repo see https github com ansible ansible issues 10081>>>feature_pull_request needs_revision
client side validation for winrm connections issue type bugfix pull request ansible version ansible detached head 16f9ebd last updated 2015 01 29 22 28 40 gmt 100 environment osx 10 10 yosemite windows server 2012 azure python default dec 15 2014 10 01 34 gcc compatible apple llvm clang 600 56 on darwin summary since python ssl certificates are rejected by default if invalid and as result python will object to self signed certificates see https www python org dev peps pep 0476 the current configuration for windows clients sets up self signed cert for for the https connector if runtime is used to connect to this server then https connection will be rejected this patch allows you to provide certificate to validate the ssl connection either via the ansible config property ansible client validation cert or as cli arg client validation cert steps to reproduce running the window example with python install and verbose logging the connection fails with certificate error establish winrm connection for user sgargan on port 5986 to sgargan cloudapp net winrm connect transport plaintext endpoint https sgargan cloudapp net 5986 wsman winrm connection error 500 winrmtransport ssl certificate verify failed certificate verify failed ssl 581 winrm connect transport plaintext endpoint http sgargan cloudapp net 5986 wsman expected results running with the certificate specified in the ansible cfg or from the commandline the connection succeeds as follows winrm connect context verification cert users sgargan downloads ansible pem establish winrm connection for user sgargan on port 5986 to sgargan cloudapp net winrm connect transport plaintext endpoint https sgargan cloudapp net 5986 wsman remote module win ping >>>feature_pull_request needs_rebase windows
add dynamic group intersections to inventory file issue type feature idea ansible version ansible environment summary like to use group patterns to find the intersection of two dynamic groups then make those groups the children of other groups ve tested two methods and either get an error or no results method from below is the most intuitive based on the documentation for patterns and dynamic inventory groups steps to reproduce hosts ec2 py and hosts ec2 ini http docs ansible com intro dynamic inventory html example aws ec2 external inventory script hosts static expected results large blue circle control large blue circle method large blue circle method actual results large blue circle control red circle method red circle method >>>feature_idea
fix for memory fact gathering have host which started to fail while gathering facts after the addition of expanded memory facts in pr 9839 traceback most recent call last file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 4278 in main file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 137 in main data run setup module file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 81 in run setup facts ansible facts module file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 4217 in ansible facts facts update hardware populate file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 2339 in populate self get memory facts file home ansible ansible tmp ansible tmp 1422536976 05 133253824703289 setup line 2375 in get memory facts cached memstats swapcached keyerror swapcached my problem host doesn have swapcached in proc meminfo it may be better to set defaults for these keys since the values provided by proc meminfo can change from version to version >>>bugfix_pull_request p2
fix wrong distribution facts on sles opensuse issue type bugfix pull request ansible version ansible devel de1aab3711 last updated 2015 01 27 10 20 42 gmt 200 environment host centos clients suse enterprice linux server 11 sp3 suse enterprice linux server 12 summary the collected facts on sles are not correct see https github com ansible ansible issues 9634 steps to reproduce ansible setup server grep distribution expected results or actual results the facts about distribution release and version are wrong please review the code and give feedback >>>bugfix_pull_request needs_info
utf chars in task name makes step barf issue type bug report ansible version devel fef435cc2a environment ubuntu 14 10 to clarify env has those defined lang fr fr utf language fr fr summary if you use an utf8 chars say an accent in task name and use step to run the playbook it crashes when it tries to display it steps to reproduce set up name for task that includes an accent and run the playbook with step test yml command ok vm msg hey actual results >>>bug_report p2
hang on gathering facts setup module happening with both ansible and ansible host is ubuntu 14 10 here is trace running the module manually lang lc ctype usr bin python trace trace home hegemon ansible tmp ansible tmp 1422521131 23 61156481541441 setup let me know if you need the full trace >>>bug_report
ec2 py ecryptfs home directory generates too long filenames error have my home directory encrypted with ecryptfs which is supported out of the box in ubuntu also use ec2 py to create dynamic inventory when create group vars directory with or without files in it get the error error group vars blahblahawsblahblah yml is not accessible file name too long please check its permissions there appears to be hard limit when using ecryptfs of 143 characters for the filename there are no plans to change the limit the recommended action is to use the statfs syscall to check the filename length limits in the application since it not uncommon to use ecryptfs on ubuntu workstation submitting this bug reference https bugs launchpad net ecryptfs bug 344878 >>>bug_report
reference tests readme me in the makefile notes https github com ansible ansible issues 6776>>>docs_pull_request
perl version of ansible module utils if nobody objects going to write and contribute to cpan `ansible moduleutils pm` to make it as easy to write modules in perl as it is in python well broadly as easy don know the details yet more info when ve got more to share >>>feature_idea
add opencsw for solaris>>>docs_pull_request
add support for local remote syslog logging this plugin will log ansible runs plays to syslog server thanks for this great software>>>feature_pull_request
v2 added draft url lookup to keep v2 compat>>>feature_pull_request
url lookup now you can loop over what url returns with the same usability and security concerns of piping curl wget into your shells this does nothing fancy can easily be expanded to handle specific needs of different urls ftp authentication https etc >>>feature_pull_request
adds integration tests for new ec2 asg features fixes asg termination in cleanup script depends on https github com ansible ansible modules core pull 601 >>>feature_pull_request
template module not happy with utf chars in filenames issue type bug report ansible version devel a63e4c595f environment ubuntu 14 10 summary using template module if the source file contains utf characters in its name it makes it barf steps to reproduce test utf8 yml create hh txt run the playbook expected results file copied and rendered actual results haven looked lot further as was in hurry so just renamed my files it also happens if the directory you re work in has accents in it had something like home gilles technique dploiement and it wouldn work might get into it deeper if have time >>>bug_report p2
sourcing env setup produces stderr output when sourcing the `env setup` to setup ansible from source get the following output from stderr understand these are harmless based on https github com ansible ansible issues 9951 however when sourcing this as part of my bash environment this error becomes distracting each time load new shell my workaround has been to redir stderr to dev null in addition to stdout but this seems less than ideal especially if there was an actual error needed to be aware of is it possible to address this somehow or at least send it to stdout somehow thanks >>>bug_report needs_info
unexpected output from ad hoc redirect hi am trying to collect all the facts from some systems and redirect the output to file but using more than fork corrupts the output doing it without redirect the output in the shell looks ok prod scansys py is my dynamic inventory script ansible prod scansys py all setup root tmp test fork json ansible prod scansys py all root setup tmp test forks json tmp test fork json looks fine tmp test forks json has mixed data here is small snippet of the tmp test forks json content device dev mapper srv001 srv mysql fstype srv001 success ansible facts as you can see facts from different servers are mixed which seems to be caused from the asynchronous return of the data ansible version from the ubuntu precise ppa is this correct behaviour because without redirecting there is no problem in the shell with more than fork >>>bug_report
problems with non ascii strings from extra vars see 10007 ansible playbook toto yml foo with hosts 127 connection local tasks debug msg plop foo this result in the same problem but with different codepath >>>bug_report p2
already tested playbook with su command now results in typeerror issue type bug report ansible version environment fedora 21 summary when try to execute command using su receive typeerror steps to reproduce command ansible playbook sudo play yml ask vault pass vvvv result >>>bug_report p2
added integration tests builddeps for apt module integration tests for ansible ansible modules core 704>>>feature_pull_request
subversion password shows in failure message when using password this is test and checkout fails following error message is shown failed webserver localhost cmd usr bin svn non interactive trust server cert no auth cache username testuser password is test info tmp checkout failed true rc stderr svn e155007 tmp checkout is not working copy>>>bug_report p2
include msg attribute when all retries have failed issue type bug report it regression ansible version environment na summary when task fails after all retries the result doesn include the msg attribute so the only way to figure out why it fails is to pass two flags and see the control message for each retry steps to reproduce playbook using ec2 elb expected results failure result includes the error message actual results no error message passing vv >>>bug_report
set from jinja are treated as strings issue type bug reports ansible version environment na summary jinja expressions that output set aren converted to lists just left as strings this looks related to https github com ansible ansible issues 9622 builtin set filters like difference don really output sets most of the time so this happens mostly with custom filters looking around is seems like the result of the template isn safe eval ed for sets only dicts and lists steps to reproduce playbook expected results actual results >>>bug_report
add ansible fw manager fact main use will be to know when to use firewalld module or ufw module to open ports but more can be surely found >>>feature_pull_request
make setup py work with python and requiring linked to https github com ansible ansible issues 10094>>>feature_pull_request
expand reties parameter from template along with delay >>>feature_pull_request
setup py not python3 friendly hi when installing via pip with python3 it fails assume this is to be backward compatible but using print in setup py will probably fix it then using future or any other 2to3 magic if compatibility with python is requirement there not doing pr as not sure what the policy is in this regard but this is trivial unless there are python3 incompatibilities somewhere else this was tested on devel 53a3644ecd49dc7e9ee1a5ba5131a9298055dd33 >>>feature_idea
mysql db does not change character set without manually forcing database drop create database with this will have the default character set now specify the correct character set and rerun the play you will still have the default need to force drop by setting state absent running the play and going back to state present to get the new character set to take effect >>>bug_report
in env setup use basename in case starts with dash issue type bugfix pull request ansible version environment `openbsd beta generic mp fri jan 23 08 52 52 cet 2015` summary hacking env setup executes the basename command without protecting it against string values of starting with dash for example in pdksh which is the standard shell on openbsd has ksh in steps to reproduce use current git checkout of ansible source code execute hacking env setup` inside `ansible` directory expected results actual results >>>feature_pull_request
apt key module issue with url cert issue type bug report ansible version ansible environment host fedora 21 client debian summary yaml name add duo packaging key apt key url https www duosecurity com apt gpg key duo state present failed to validate the ssl certificate for www duosecurity com 443 use validate certs no or make sure your managed systems have valid ca certificate installed paths checked for this platform etc ssl certs etc pki ca trust extracted pem etc pki tls certs usr share ca certificates cacert org etc ansible wget can download the file without issue the root certificate is present in etc ssl certs and qualys ssl labs shows no chain issues https www ssllabs com ssltest analyze html www duosecurity com 54 230 34 152 have also tried downloading both the root certificate and the intermediate and putting them in etc ansible but this doesn have any effect raising this issue here as the get url code is in this repo let me know if you want any additional debug >>>bug_report p2
document that dnstxt lookup requires dnspython add line in the docs to specify that dnstxt requires that you have the dnspython package installed >>>docs_pull_request
fix checksum calculation for large files fixes https github com ansible ansible issues 10086 now reading files in chunks>>>bugfix_pull_request needs_revision p2
shell checksum validation fails on large files current issue type bug report ansible version ansible configured module search path none environment linux summary current implementation reads whole file into memory for files larger than available memory it fails steps to reproduce try fetching large file from remote server expected results it should work actual results changed false file root foobar folyondar sport tar gz msg unable to calculate the checksum of the remote file and the file does not get created locally >>>bug_report
allow missing subelement keywords to be optionally ignored this request is simple change to `subelements py` and `constants py` which allows the user to optionally ignore missing keywords on `with subelements` loop the change is new configuration item `ignore missing subelements` and the logic to use the variable in `subelements py` the default for this config variable is false which causes the code in `subelements py` to behave as usual and raise an error when subelement keywords are missing the default behavior is less flexible but since some users may have written their playbooks or roles to depend on this we leave it as the default however the more flexible and typical usage of this feature will be to have `ignore missing subelements` set to true which allows for flexible data patterns in the application of tasks looping with `with subelements` the items for which there is no corresponding key are simply ignored at our site this feature is important and in use for using ansible in managing keys in our user `authorized keys` file in that not all of our users have the same number of ssh keys and some of our users have no ssh key >>>feature_pull_request
change logic for freeipa inventory plugin to obtain all hosts the original version of this script only returned hosts from the ipa server that were members of group this version returns all hosts as well as host groups and their members it also returns the ssh fingerprint variable for each host >>>feature_pull_request
make sure to load ec2 submodule before referencing it issue type bugfix pull request bug report ansible version summary the profile argument does not work for the s3 module because the `boto ec2` submodule is never imported when evaluating `ansible module utils ec2 boto supports profile name` steps to reproduce run playbook using the s3 module with the boto `profile` argument actual results >>>bugfix_pull_request p2
add dictmap function provides useful function to map list with keys to values via dictionary sample usage result >>>feature_pull_request
can we put shell script into the ansible git repository directory like ansible update sh >>>feature_idea
for fast install from git source can we using git clone depth for fast install from git source can we using git clone depth the main repository growing fast it will take more disk space to clone the full ansible repository can we save our diskspace and getting faster to finish the clone process how about >>>feature_idea
add docs for csvfile lookup>>>docs_pull_request
ansible support for consul issue type feature pull request ansible version environment osx 10 10 yosemite linux ubuntu 14 04 trusty tahr 13 37 generic summary initial commit of ansible support for the consul clustering framework http consul io submission includes support for creating and registering services and checks reading writing and lookup for values in consul kv store creating and manipulating sessions for distributed locking on values in the kv creating and manipulating acls for restricting access to the kv store inventory support that reads the consul catalog and group nodes according to datacenters exposed services service availability arbitrary groupings from the kv store this submission makes extensive use of the python consul library and this is required as dependency and can be installed from pip steps to reproduce the tests were written to target vagrant cluster which can be setup by following the instructions here http github com sgargan consul vagrant note that this submission contains only the inventory lookup plugins and tests the modules are contained in commit to the ansible modules extras project >>>new_plugin
`defaults main yml` overriding variables `include vars in roles in `defaults main yml` in `vars darwin yml` in `tasks main yml` assume this is run on darwin machine we get where would expect to get `baz` the work around is to ditch the `defaults` folder and instead load it with defaults file with `with first found maybe am doing something backwards here but the `defaults` folder seem to take higher precedence over including variables selectively included in the task >>>bug_report
the result of diff is not present in the output of the template module issue type bug ansible version and environment centos and osx summary when using the template module one would expect for the diff to be present in the registered var that is not the case steps to reproduce use the template module register it into var and check the output expected results for the registered var to contained the diff info actual results >>>feature_idea
makes tasks sudo directive templatable this pull request is fix for issue 10074 use template expansion to evaluate value before setting sudo su parameters reorder source code to get all variable before evaluation for sudo and su parameters >>>bugfix_pull_request
tasks sudo directive is not templatable issue type bug report ansible version ansible environment debian testing amd64 summary using ansible not able to use variable in order to change sudo parameter for task have try with the following playbook hosts all vars prod true tasks name show me shell whoami echo prod sudo prod and the result is the following `changed edited changed true cmd whoami echo true delta 00 00 009227 end 2015 01 23 15 21 18 719197 rc start 2015 01 23 15 21 18 709970 stderr stdout robin ntrue using current head 53a3644ecd49dc7e9ee1a5ba5131a9298055dd33 of devel branch still have this issue steps to reproduce create file name tmp foo yml with the following contents hosts all vars prod true tasks name show me shell whoami echo prod sudo prod run `ansible playbook tmp foo yml` expected results output should contain `changed edited changed true cmd whoami echo true delta 00 00 009227 end 2015 01 23 15 21 18 719197 rc start 2015 01 23 15 21 18 709970 stderr stdout root ntrue actual results `changed edited changed true cmd whoami echo true delta 00 00 009227 end 2015 01 23 15 21 18 719197 rc start 2015 01 23 15 21 18 709970 stderr stdout robin ntrue >>>bug_report
jinja stuck in endless loop 100 cpu usage my ansible configuration causes ansible to lock up using 100 cpu managed to reduce to problem to the following it seems that the string files test baz is parsed by jinja which tries to resolve test as variable ending in an endless loop if rename the variable or the directory it works as expected so while there is simple workaround this seems like bug and took me while to isolate not sure though if the problem is in jinja itself or in the way ansible is using it >>>bug_report p2
ansible fqdn shouldn this variable be the full hostname of the target host not what is found in etc hosts facter fqdn is correct version example machine name is host domain com etc hosts 172 17 20 20 pp host domain com facter fqdn host domain com ansible fqdn pp host domain com >>>bug_report p2
module ini file should be capable of comments in files found the bug 4522 and read the documentation of the module ini file which states that ini file will remove all comments the issue is though that they are required sometimes one example is the module files in php the comment priority 05 is essential and used by some cli commands like php5enmod if the comment is missing it will place the module in the wrong order those comments are really important could someone please enable comment support for the module ini file it seemed to be working in the past found it in ansible changelog v1 https raw githubusercontent com ansible ansible v1 changelog md where it says support comments in ini file module >>>feature_idea
ignore version file in ansible doc issue type bugfix pull request ansible version environment `openbsd beta generic mp 791 sat jan 17 21 24 04 mst 2015` summary using ansible doc produces python traceback when it tries to parse the version files inside the modules directories the version file is missing in the ignore files list steps to reproduce install ansible package or clone devel branch with git run ansible doc expected results list of modules actual results the traceback see above appears while ansible doc is parsing the module files after that it lists the modules >>>bugfix_pull_request p2
fix ansible doc list on solaris on solaris usr bin stty` has no `size` option however usr ucb stty` does have this option install package `compatibility ucb` to get usr ucb stty` on solaris 11 >>>bugfix_pull_request p2
executable and non executable inventory files should not be conflated ran into the following error when running ansible playbook myinventory using vagrant on windows host the problem is that vboxfs as does many other filesystem options will set the execute permission on all files if mounted on filesystem that isn unix like such as fat or ntfs my workaround is ugly in vagrant am mounting my source files second time so that can refer to version of my inventory file without such as config vm synced folder vagrant nox mount options fmode 666 consider the decision to execute an inventory file as script based solely on its execute permission bad idea this is non obvious problem and common use case here as some examples of other users coming across the same problem http stackoverflow com questions 26859360 cant use ansible inventory file because it is executable https groups google com forum topic ansible project ram6moejwv4 https github com phansible phansible issues 71 it also allows malicious user to execute script with elevated privileges all they need is write permission on non script inventory file possible solution is to use separate command line option if an executable inventory should be used although this does not provide backwards compatibility >>>feature_idea
regex replace seems to be unable to replace with issue type bug report ansible version environment ubuntu 14 04 lts summary this bug report is similar to 8672 but addresses slightly different problem all want to do is replace one character in string with the same character prepended with backslash for example turn lorem into lorem or lorem ipsum into lorem ipsum steps to reproduce ve tried several different approaches example playbook file hosts 127 connection local vars test1 lorem regex replace test2 lorem regex replace test3 lorem regex replace test4 lorem regex replace tasks debug var item with items test1 test2 test3 test4 expected results expect at least one of the `test` variables to be lorem` actual results >>>bug_report
document checksum error codes issue type docs pull request ansible version environment summary document checksum function error codes steps to reproduce get checksum error have to dig through the code to find out what the number means expected results error codes documented actual results see steps to reproduce>>>docs_pull_request
support ssh two factor authentication issue type feature idea ansible version ansible environment ubuntu server 14 04 summary be able to deploy on servers that use ssh with two factor authentication tuto to enable two factor authentication with public key google authenticator on the server http www justgohome co uk blog 2013 07 better two factor ssh authentication on ubuntu html http www justgohome co uk blog 2013 07 better two factor ssh authentication on ubuntu html expected results ansible playbook should ask the code of the two factor authentication as it does with the parameter for password authentication actual results ansible playbook is stuck at ssh initialisation when the server asks the code >>>feature_idea
clarify order in which handlers are run when reading the documentation found that note not explicit enough although one could deduce the behavior because alternative run orders less likely still think it is better to be explicit about this in documentation >>>docs_pull_request
create set global module can someone create module for set global it would work the same way as set fact except the variable is not pinned to host the main purpose is to access the variable between playbooks the other option here is to make registered variables accessible between playbooks >>>feature_idea
error when using readlink filter no filter named readlink issue type documentation report ansible version environment summary the other useful filters http docs ansible com playbooks variables html other useful filters section of the variables http docs ansible com playbooks variables html document page references filter named `readlink` but it doesn seem to exist steps to reproduce playbook that reproduces the issue expected results expected output like this actual results note that there is filter in lib ansible runner filter plugins core py called realpath https github com ansible ansible blob cce87acfedaeca097bf6e84ea8618b226bd2d98d lib ansible runner filter plugins core py l324 so maybe it should be realpath instead of readlink >>>docs_report
verify prompt is not null if prompt is none endswith throws the following error traceback most recent call last file usr lib python2 site packages ansible runner init py line 590 in executor exec rc self executor internal host new stdin file usr lib python2 site packages ansible runner init py line 792 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file usr lib python2 site packages ansible runner init py line 1025 in executor internal inner result handler run conn tmp module name module args inject complex args file usr lib python2 site packages ansible runner action plugins normal py line 57 in run return self runner execute module conn tmp module name module args inject inject complex args complex args file usr lib python2 site packages ansible runner init py line 553 in execute module res self low level exec command conn cmd tmp su true in data in data file usr lib python2 site packages ansible runner init py line 1166 in low level exec command in data in data file usr lib python2 site packages ansible runner connection plugins ssh py line 337 in exec command elif sudo errput endswith prompt typeerror expected character buffer object>>>bugfix_pull_request
replace module does not obey follow yes issue type bug report ansible version ansible el7 noarch from epel repo ansible configured module search path none environment ol7 13 55 el7uek x86 64 summary replace module does not obey follow yes following snippet replaces etc sysconfig grub symlink pointing to etc default grub steps to reproduce name remove rhgb quiet replace dest etc sysconfig grub regexp rhgb quiet follow yes expected results leave etc sysconfig grub symlink in place and modify etc default grub it points to actual results etc sysconfig grub symlink is replaced by correctly modified etc default grub file the original etc default grub file is left in place unmodified >>>bug_report
cleanup and expand freeipa inventory script it now accepts cl this is simply cleanup and expansion of the existant code to conform with the guidelines >>>feature_pull_request
ansible does not create known hosts file if none exists when pinging ec2 user some host ansible all ping paramiko the authenticity of host some other host can be established the ssh rsa key fingerprint is some fingerprint are you sure you want to continue connecting yes no yes paramiko the authenticity of host some other host can be established the ssh rsa key fingerprint is some other fingerprint are you sure you want to continue connecting yes no traceback most recent call last file usr lib python2 site packages ansible runner connection plugins paramiko ssh py line 393 in close key stat os stat self keyfile oserror errno no such file or directory home ec2 user ssh known hosts some other host success changed false ping pong traceback most recent call last file usr lib python2 site packages ansible runner connection plugins paramiko ssh py line 393 in close key stat os stat self keyfile oserror errno no such file or directory home ec2 user ssh known hosts some other host success changed false ping pong >>>bug_report
allow non string bool arguments to modules issue type feature request ansible version environment ubuntu osx summary in the following file we see why ansible will silently ignore non string bool arguments passed to modules ansible lib ansible utils init py this makes tasks using custom modules silently fail if they are written to expect eg list the ``groups`` parameter is silently dropped understand that it is awkward to serialize lists into the shlex format that modules accept one possibility would be to allow multiple instances of the same key ``environment production host asdf groups foo groups bar`` regardless it kind of silly reason to cripple modules perhaps could also support json parameter transfer steps to reproduce write module that supports list or dict parameter expected results data is passed through to module actual results parameter is silently dropped >>>bug_report needs_info
add the uuid of the device in ansible mounts variable this will return na if the command is unsuccessful as older oses may not have the lsblk command >>>feature_pull_request
asynchronous actions and polling does not honor remote tmp issue type bug report ansible version environment running managing from linux ubuntu 14 04 summary asynchronous actions and polling should save intermediate files as well in the directory provided by remote tmp but files get saved in home ansible async steps to reproduce execute async job expected results files should be in the directory provided by remote tmp actual results intermediate files are in home ansible async >>>feature_idea
v2 ssl configurable now uses replacer code to set defaults depends on config changes included in 9808>>>feature_pull_request
delegate to not resolved in module running the following task name put the configuration on all dispatcher hosts template src template name nginx conf dest etc nginx sites available vhostname domainname delegate to item with items dispatchers where dispatchers is list of hosts dispatcher local fails for me with fatal ninja local dispatcher lcoal traceback most recent call last file usr local lib python2 dist packages ansible runner init py line 594 in executor exec rc self executor internal host new stdin file usr local lib python2 dist packages ansible runner init py line 822 in executor internal complex args complex args file usr local lib python2 dist packages ansible runner init py line 1032 in executor internal inner result handler run conn tmp module name module args inject complex args file usr local lib python2 dist packages ansible runner action plugins template py line 94 in run remote checksum self runner remote checksum conn tmp dest inject file usr local lib python2 dist packages ansible runner init py line 1238 in remote checksum python interp inject hostvars inject delegate to get ansible python interpreter python file usr local lib python2 dist packages ansible runner init py line 103 in getitem result self inventory get variables host vault password self vault password copy file usr local lib python2 dist packages ansible inventory init py line 442 in get variables raise exception host not found hostname exception host not found item it appears delegate to is resolved to correct host in https github com ansible ansible blob release1 lib ansible runner init py l921 but not reinserted into inject the following patch to lib ansible runner init py seems to work at least for me 932 inject delegate inject set resolved delegate to into inject so modules can call remote checksum inject delegate to self delegate to >>>bug_report p2
fact caching slows down ansible execution almost times issue type bug report ansible version ansible environment centos summary with fact caching enabled ansible runs few times slower than without it steps to reproduce enabled fact caching via redis adding the following lines in `ansible cfg` and installed redis support for python using pip this works without problem but the problem is that whole ansible started executing few times slower than before with fact caching disabled with fact caching enabled the most interesting thing is that even tasks that are being skipped run extremely slow basically whole ansible slows down expected results it should execute faster with fact caching since it doesn need to fetch facts from the host actual results it runs almost times slower than without fact caching >>>bug_report
run once does not accept parameters issue type bug report ansible version environment macos 10 summary run once doesn accept variable as value checking documentation didn find anything asserting this should not be supported steps to reproduce run this playbook on any multiple ip hosts returns the following no syntax error but run once true has not be accepted as valid instruction >>>bug_report
add vault support to file lookup plugin the file lookup plugin now automatically decrypts ansible vault encrypted files for example yaml hosts localhost connection local tasks name show secret stuff debug msg lookup file files secret stuff name non secret stuff debug msg lookup file files not secret if files secret stuff is encrypted with ansible vault running the example playbook with provided vault password will print the contents of files secret stuff this is based on 8110 and 8533 but updated for the latest devel branch and with an added integration test >>>feature_pull_request
make the source of template errors visible this fixes the mysterious traceback issue in 9888 instead of template evaluation failure in vars files causing tracebacks like this with no hint of the source of the error it will print out the snippet that caused the problem instead you get this think this is actually fairly reasonable given that most inline templates are pretty short the full path to the file would be better but couldn figure out the plumbing looked at v2 but it seems too green right now >>>bugfix_pull_request needs_rebase needs_revision
ansible fails to connect under cygwin private key error issue type bug report environment win cygwin 33 ansible devel 4cb7f654b6 python summary although the key has correct permissions rw the noob none 2k jan 19 11 36 private key connection fails as python reports wrongly the permissions commenting out https github com ansible ansible blob devel lib ansible runner connection py l47 fixes this >>>bug_report
fix copy paste in plugins docs >>>docs_pull_request
please allow duplicate parameter in raw module too please add raw to modules allowed to have duplicate parameters https github com ansible ansible blob be4dbe76b9fbdd7e377f0d0c3ace61fa6e855e04 lib ansible runner init py l444 is shell module self module name in command shell is shell module self module name in command shell raw thank you >>>feature_idea
add server mode thus is preliminary commit for review of an implementation of server mode this spawns an http server and runs the playbook whenever specified url is hit please don merge yet there some cleanup that needs doing as well as the addition of separate thread please do provide feedback though >>>feature_pull_request
modified the version numbers in one section on index of docs to reflect their current state >>>docs_pull_request
pkg resources distributionnotfound related to 8575 and 7219 issue type bug report ansible version root localhost sovereign dpkg ansible desired unknown install remove purge hold status not inst conf files unpacked half conf half inst trig await trig pend err none reinst required status err uppercase bad name version architecture description ii ansible dfsg all configuration management deploym environment linux localhost localdomain 13 44 generic 73 ubuntu smp tue dec 16 00 22 43 utc 2014 x86 64 x86 64 x86 64 gnu linux it on kvm vps summary ansible does not load dependencies properly steps to reproduce run ansible playbook expected results ansible works actual results root localhost sovereign ansible playbook hosts site yml traceback most recent call last file usr local bin ansible playbook line in import pkg resources file usr lib python2 dist packages pkg resources py line 2749 in working set workingset build master file usr lib python2 dist packages pkg resources py line 444 in build master ws require requires file usr lib python2 dist packages pkg resources py line 725 in require needed self resolve parse requirements requirements file usr lib python2 dist packages pkg resources py line 628 in resolve raise distributionnotfound req pkg resources distributionnotfound ecdsa 11>>>bug_report needs_info p2
add missing register small bug in playbook in the docsite>>>docs_pull_request
str object has no attribute format issue type bug report development branch regression environment debian lenny summary parse error in latest dev no such error in steps to reproduce any module except of raw show such error when talking to the old lenny box debian5 with such packages expected results no error as in >>>bug_report
adds seconds to backup timestamp fix 9911>>>feature_pull_request
start up performance boost for bigger inventories starting somewhere between 1k 10k hosts there is some user noticeable lag between hitting enter and output starting after profiling taking the easy wins list hosts` on 10k host inventory has much more satisfying response time this pr adds very simplistic `bob 0000 9999 inventory and improves the performance in the top two places called out by running `python cprofile time bin ansible all test units inventory test data huge range list hosts` the top profiler identified time spenders are called out with before after in each commit >>>feature_pull_request needs_rebase
bug report ansible does not work with tls enabled on docker daemon issue type bug report ansible version `ansible 2` environment mac osx yosemite summary after enabling tls for docker connections in the environment ansbile does not seem to use the settings steps to reproduce when the following env vars are set and the following playbook is run the following error output occurs which appears to indicate that it is making connection over http expected results would expect ansible to connect to the docker daemon and provision the containers actual results ansible exits with status code >>>feature_idea needs_info
jinja2 variable start string cannot be set issue type bug report ansible version at least including latest `devel` branch environment summary ansible cannot template config files that need to preserve syntax exim config and there seems to be no workaround preserving the ability to template such files earlier versions had the ability to specify `variable start string` in the template but that was removed without providing any alternative cf unresolved but closed 9491 8347 8101 8040 it would be great to leave at least one of the issue tickets pertaining to this problem open until an actual fix is committed so people who are burnt by the inability of ansible templating such files have ticket to see the current state steps to reproduce take your typical production exim main configuration file containing copious amounts of and and try to deploy it using the template module add jinja2 variable start string variable end string at the start of the templated exim config expected results ansible should use for variable expansion and leave the exim syntax alone while preserving the ability to use jinja2 features in the template actual results fatal example net msg ansibleerror file templates configure j2 line number 683 error expected token end of print statement got failed true >>>feature_idea
aks added to list filter tests added new filter to list this causes values to be coerced into list so the subsequent recipe can iterate on it even if it just single item use case was the `debops ansible users` role which makes use of `forward` attribute which is one or more addresses the 95 use case for forward` is single address the average user of this role will leave the forward attribute empty or put single address in it if that value is not list the `debops ansible users` role appears to work but it creates broken address of list of single characters separated by commas because it trying to create list of addresses separated by commas ve filed an issue on that role but in examining how to fix it in my own repo there didn seem to be an obvious way to coerce scalar value into list and filters seemed to be the right way to address this so here new `to list` filter used something like this forward item forward to list this pull modifies `filter plugins core py` and `testfilters py` the tests passed also added the same filter to the corresponding `core py` in the `v2` directory but the tests there don seem to be as well developed so didn pursue the test implementation there >>>feature_pull_request
add filter to turn string into uuid this filter was made because needed to create idempotent uuids when installing the agent for go http go cd which uses uuids to distinguish the agents from each other the filter doesn do anything special when the string is empty would this be good idea to add an assert for hope this would be useful for inclusion in core >>>feature_pull_request
this will add the uuid of the device in ansible mounts variable this will return na if the command is unsuccessful as older oses may not have lsblk command >>>feature_pull_request needs_revision
handle cp437 encoding returned from pywinrm per https github com diyan pywinrm blob master winrm protocol py l62 pywinrm opens shell with winrs codepage 437 the stdout stderr in the response we get back is python `str` instance encoded as cp437 so decode that into `unicode` instance before passing back to ansible should fix the issue described in https groups google com topic ansible project ur9kl1o p7u>>>bugfix_pull_request needs_rebase p2 windows
new jinja2 resolve filter translates list of domain names into list of ip addresses you can select ips by address family by default filter lists ipv4 and ipv6 addresses usage in jinja2 template get list of ipv4 addresses for list of domains domains resolve ipv4 domains resolve v4 domains resolver get list of ipv6 addresses for list of domains domains resolve ipv6 domains resolve v6 domains resolve >>>feature_pull_request
feature request send all logs to syslog hello issue type feature request ansible version environment running from arch to rh pool summary at work we manage hundreds if not more rh vms with ansible we are several in the team to push changes it happens that things break once in while and we have no current way of tracking who did what since all users are runnign ansible from their machine we would love to have the possibility to send every ansible playbook and ansible too run to syslog we have syslog server in the network where we would like to send events to steps to reproduce none expected results user should be able to send ansible stdout to syslog with info like hostname user ip command run and output actual results no syslog compatibility thank you for the good work >>>feature_idea
cannot resolve inventory group varaible in task where both delegate to and template are defined hi the following statment in task works in but got exception in on both centos and centos if you comment out the template and enable the debug statement it works display the the variable headserver correctly in tasks in the playbook in an inventory it defines the headserver any workaround or patch to fix it thanks >>>bug_report
handle json load errors as ansible error instead of ugly stacktrace my only worry is obscuring the source of the errors>>>bugfix_pull_request
ansible now captures returncode errors on inventory scripts should fix 10013>>>bugfix_pull_request
inventory script errors not checked or exposed issue type bug report feature idea ansible version environment running from os against ubuntu trusty summary if using dynamic inventory script that fails ansible does not fail how expect including checking exit status and relaying output at least stderr steps to reproduce have an inventory script that fails exits non zero use it `ansible playbook site yml path to script` see ansible blow up still trying to parse json in the output expected results would expect ansible to check the script exit status around here https github com ansible ansible blob 1b8faa68d99f2f1f373df4ce43e6c2ff71d81257 lib ansible inventory script py l45 and ideally relay at least stderr to me example actual results >>>bug_report
change the default search order to galaxy ansible com to community rating issue type feature idea summary change galaxy ansible com search to be reverse ordered rating by default currently it listing things in order of owner name which isn very helpful if you say search for composer on https galaxy ansible com list roles there are roles without any ratings before hitting finding the one we should be installing suggest changing it to reverse order community rated so the top rated one and likely the most relevant one is listed first to avoid confusing newbies like me >>>feature_idea needs_to_be_moved
add vault new password file support to rekey added vault new password file` option to the `ansible vault rekey` command in order to rekey vault file without interactive prompts >>>feature_pull_request
vars files cannot expand inventory file issue type bug report ansible version amoe kruis2 dev ansible test vars files ansible version ansible devel 02bc014bcd last updated 2015 01 15 10 02 09 gmt 100 lib ansible modules core detached head 8c8be0e48c last updated 2015 01 14 15 02 30 gmt 100 lib ansible modules extras detached head ffa8abf979 last updated 2015 01 14 15 02 34 gmt 100 v2 ansible modules core detached head 27d5e5124f last updated 2015 01 14 15 02 40 gmt 100 v2 ansible modules extras detached head 8a4f07eecd last updated 2015 01 14 15 02 45 gmt 100 configured module search path none also reproduced on stable this did not happen in os is debian stable wheezy summary listing paths under `vars files` directive that include expansions involving `inventory file` will not work the files will not be read for variable definitions steps to reproduce `playbook yml` hosts localhost vars envi inventory file basename vars files vars envi yml tasks debug msg my var `vars development yml` my var bar now run amoe kruis2 dev ansible test vars files ansible playbook development playbook yml expected results expected the file defining `my var` to be included and the value to be printed actual results play localhost gathering facts ok localhost task debug msg my var fatal localhost one or more undefined variables my var is undefined fatal all hosts have already failed aborting play recap to retry use limit home amoe playbook retry localhost ok changed unreachable failed >>>bug_report
customize indent in yaml and json filters this commit allows to customize indent in the `to nice yaml` and the `to nice json` filters >>>feature_pull_request
problems with non ascii strings from dynamic inventory issue type bug report ansible version devel environment ubuntu 14 04 lts x86 64 summary when using dynamic inventory if variable definition contains non ascii characters but correct utf sequences or even correct unicode escapes u00e1` it will later fail at whatever template expansion attepted wheter it from the playbook itself or through the `template` module the problem seems to be related to the fact that jinja2 can only handle either python unicode objects or plain ascii strings but not strings encoded in utf as it is receiving right now steps to reproduce configure ansible to use the following inventory script and then try to execute the following example playbook expected results actual results notes as temporary fix we applied the following patch to our installation however this simple change is semantically significant even though it seems to pass the test suite see below we are not sure it is the proper place to fix it test run >>>bug_report
support aws profiles with cloudformation module issue type feature idea ansible version environment linux summary like ec2 module http docs ansible com ec2 module html cloudformation module http docs ansible com cloudformation module html should support `profile` for switching between different aws accounts credentials only way to configure credentials is to either set them as environment variables or pass directly to module as `aws access key` and `aws secret key` which requires extra work and is not that convenient secure steps to reproduce define `profile` parameter to task expected results with `profile` attribute specified for invocation the according profile should be activated in boto so boto config would be read credentials from aws credentials` used etc actual results not supported atm >>>feature_idea
when running ansible playbook with syntax check it fails without an inventory specified issue type bug report ansible version >>>feature_idea
feature idea allow fine grain register assignment in loop elements issue type feature idea ansible version environment linux summary running into deployments where need to assign labels indices to individual loop items it would be really ideal if we could assign loop via register type of operation expected results loop over lists that have particular label and it would greatly increase readability if could assign my own label to loops element via register or some new register item type of object envision this register item to work as follows name assing floating ip to vms quantum floating ip state present network name network public instance name item instance name internal network name item internal network register item item instance name with items instance name vm a6 internal network network a6 instance name vm b7 internal network network b7 later on it would be desired to have access to vm a6 id actual results currently we register single value and have referenced an array index like networks results id this is difficult to read and is not invariant upon data reordering >>>feature_idea
lookup within playbook vars section does not see inventory variable issue type bug report ansible version environment rhel summary we have the following lookup in playbook using custom lookup plugin where `network` is an inventory object this results in in related vein for scalar inventory variable we were able to work around this by by referencing playbook local variable `customeridredef` over inventory variable `customerid` suspecting some sort of inventory variable visibility issue note this used to work with ansible steps to reproduce create the following files tmp foo txt test yml inventory sh then expected results print out file content `whatever` actual results >>>bug_report
copy modules fails if lookup files are reference in group vars issue type bug report ansible version environment rhel summary for some reason the copy module bombs out if lookup file is referenced in group vars even though the copy task itself does not reference that variable and the file does exist relative to the role directory steps to reproduce please see this gist https gist github com tgolly 930dce54307139f9c758 you ll see that authorized key tasks successfully references the listofkeys variable and deploys the file then the file and stat tasks both work without error then copy bombs out even though it doesn reference the listofkeys variable from group vars all expected results the file is copied without error actual results task myrole copy src etc hosts dest tmp foo fatal localhost could not locate file in lookup public keys somekey >>>bug_report p2
loading environment specific variable files via vars files no longer working issue type bug report ansible version ansible ansible ansible devel ce4f1163be last updated 2015 01 13 18 11 50 gmt 500 environment centos summary loading environment specific variable files via `vars files` no longer working for syntax steps to reproduce have variable `ourenv` that defines specific environment this variable is defined in inventory file used to load environment specific values via `vars files` as demonstrated in https gist github com marktheunissen 2979474 after upgrade to facing problem with loading environment specific properties sample site yml sample inventory file sample vars env dev single yml sample vars env defaults yml output in unexpected output in correct it seams to me that no issues with loading these variables directly if replace vars env ourenv yml vars env defaults yml with vars env ourenv yml but want to have failback to defaults option also if pass `ourenv` via command line ourenv dev single it works as expected but think it bad practice splitting environment knowledge between inventory file and command line arguments can somebody take look why are no longer work in `vars files` with variables expected results `pg wal buffers` should be set to `4mb` actual results `pg wal buffers` is set to `value` >>>bug_report p2
windows user id and thus the user profile path containing space breaks ansible windows modules issue type bug report ansible version ansible version ansible devel fe53d86a83 last updated 2015 01 07 01 33 18 gmt 400 lib ansible modules core detached head 0d551d8d24 last updated 2015 01 07 01 33 50 gmt 400 lib ansible modules extras detached head d4f5b6d41a last updated 2015 01 07 01 33 51 gmt 400 v2 ansible modules core detached head cb69744bce last updated 2014 12 23 17 22 30 gmt 400 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 12 23 17 22 50 gmt 400 configured module search path none environment cat etc lsb release distrib id ubuntu distrib release 14 10 distrib codename utopic distrib description ubuntu 14 10 uname i686 summary found out the hard way with an existing windows user account with userid containing space and thus also the value of the temp environment variable breaks many of the ansible windows modules due to treating the derived tmp path as two separate paths rather than path containing space example of this issue manifests due to the use of `shlex split in `ansible lib ansible runner shell plugins powershell py` steps to reproduce create windows admin account user with userid containing space user name such that the user profile path is `c users user name setup winrm using the `configureremotingforansible ps1` script under this windows user account add windows host to windows group in ansible hosts file setup host vars winhostname for windows host as per ansible windows documentation etc try using ansible modules such as ansible winhostname win ping ansible winhostname script anypowershellscript ps1 expected results ansible should retrieve the shortname equivalent path from the windows host so that spaces are not included in the value for the temp environment variable and thus the derived tmp directory on the windows host used by ansible modules possible workarounds the trivial case of don do that and use windows account without space in the userid somehow get the format of the temp directory and other paths that include userprofile as part of the directory path windows cmd shell will automagically store the format of the path in temp for backwards compatibility with apps that don handle long names with spaces well but for some reason powershell when run via `winrm` in ansible uses the long path format and thus includes the space in the path in temp as retrieved via env temp` in `powershell py` when building path to tmp directory equivalent for windows unfortunately getting powershell to return the version of file system path is non trivial see here http technet microsoft com en us library ee692751 aspx and here http blogs technet com heyscriptingguy archive 2013 08 01 use powershell to display short file and folder names aspx or possibly somehow call `win32api getshortpathname on the remote host using similar techniques as demonstrated here http learn powershell net tag win32api actual results ansible returns errors from powershell to the effect of `powershell script users user ps1 not found` >>>bug_report p2 windows
tasks from include executed on false condition issue type bug report ansible version ansible devel f1fdddb640 last updated 2015 01 13 14 06 26 gmt 400 lib ansible modules core detached head 8c8be0e48c last updated 2015 01 13 14 09 53 gmt 400 lib ansible modules extras detached head ffa8abf979 last updated 2015 01 13 14 09 53 gmt 400 v2 ansible modules core detached head 27d5e5124f last updated 2015 01 13 14 09 54 gmt 400 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 10 31 10 08 32 gmt 400 configured module search path usr share ansible environment ansible node 12 04 lts precise pangolin x64 managed node 12 04 lts precise pangolin x64 summary using simple role to manage users and ssh keys on remotes the role should only make changes when the users variable is defined for some reason tasks that use with subelements loop got evaluated when the yml file should not be included the users variable is undefined steps to reproduce the relevant portion of the role tasks main yml tasks debian yml expected results expected all the tasks in debian yml to be skipped since the users variable is undefined tasks main yml actual results when running ansible playbook the task manage ssh authorized keys from include fails >>>bug_report p2
add stdout lines to results when using with items issue type the ``stdout lines`` field of result object created in 1058 does not appear on registered variables created in ``with items`` loop ansible version environment arch linux centos centos summary when combining variable registration of shell commands with item lookup loops the registered variables don contain the ``stdout lines`` convenience field if this existed it would allow complex loops with the ``with subelements`` lookup steps to reproduce the bug is apparent in the ansible documentation http docs ansible com playbooks loops html using register with loop expected results the example above should have ``stdout lines`` field in each result object actual results the example above does not have ``stdout lines`` field in each result object >>>feature_pull_request p2
delegate to doesn support expressions in seems that has breaking change related to delegate to in earlier releases it was possible to use an expression as the value of delegate to now an error is thrown by certain modules including fetch notice that few changes were made in runner init py that may be the cause of the regression here is sample to reproduce the error playbook inventory error message >>>bug_report needs_info p2
hash filters adds hash and password hash filters for your encryption needs>>>feature_pull_request p2
correcting spelling mistake change uncrypted to unencrypted >>>docs_pull_request
use current directory in preference to all other paths when looking for host group vars this allows playbook reuse with different variables in the current directory structure ansible playbook shared inventories shared playbooks authenticate yml with vars in the current working directory in group vars and host vars >>>feature_pull_request needs_info
universal handlers issue type feature idea ansible version seeing this error on os yosemite when running ansible version http pastebin com sgixpzfh should be environment running from mac os and centos managing el5 and el6 summary make handlers role agnostic so that they can be called from any role regardless of play steps to reproduce expected results actual results a>>>feature_idea
source hacking env setup throws an error bash unbound variable just ignored it and the installation worked fine after the make install part but still think this should be fixed in case someone wants to install ansible using script or something >>>bug_report needs_info
mechanism to help prevent accidentally adding non encrypted file to source controll feature enhancement suggestion ran into situation where accidentally commited an unencrypted vault file to git repository was thinking of naming scheme for the vault files where the encrypting of the file would add an ending ex my secrets yml unencrypted my secrets yml enc encrypted then my secrets yml could be added to the gitignore making it much harder to accidentally commit unencrypted secrets in git repo this would require the ansible vault command to modify the ending of the file when encrypt and decrypt commands are applied it would also require modif to the unclude var module ex include vars my secrets yml alternate ending enc the include var module would look for one of the two endings perhaps there is better way to deal with the problem have concluded that as it stands it is better to leave the secrets file out of source control gitignore but then some convenience is lost it could be said that enforcing discipline of reviewing of each file before commiting is good practice and would avoid such situations and would completely agree but find that it nice to have an extra layer of protection when discipline alone fails the ability have gitignore entry to make sure cleartext secrets stays out of source controll would be this extra protection perhaps there is way to achieve the same results without changes to the include var module maybe something like include vars my secrets yml enc ignore errors yes include vars my secrets yml failed when somesecret not in vars along with having my secrets yml in gitignore and having ansible vault rename the file when encrypted and decrypted >>>feature_idea needs_info
apply template to task handler name on initialization apply template to task handler name on initialization saves lots of time when having tens of handlers it saves hundreds of calls to template >>>feature_pull_request
variable inheritance no longer works in ansible issue type bug report ansible version environment macosx summary variable inheritance no longer works in ansible steps to reproduce role depend on role in `role meta main yml` in role `vars main yml` in role `vars main yml` expected results when executing role we should see db reset yes and this should instead for test value actual results when executing role got wrong variable values `db reset no` and `test this should not appear >>>bug_report
does setting ansible sudo yes in inventory file and sudo yes in playbook the same issue type bug report ansible version environment local remote summary depending on the location of sudo enabling option sudo password input is failing or not steps to reproduce remote ssh user is `deploy` which is in the `sudo` group and sudo is working inventory file `inventory` playbook `playbook yml` command expected results the file root write access` should have been created which only root can do actual results the play fails other ways which works it works if you enable sudo either with sudo` on the command line or with `sudo yes` into the playbook like this believe important to be able to enable or not sudo from the inventory and not from the command line or the playbook themselves because all servers may not have sudo installed debian vs ubuntu >>>bug_report p2
fix typo>>>docs_pull_request p2
aws credentials are not being used by ec2 tag issue type bug report ansible version ansible configured module search path none ansible head as of 2015 01 12 boto 35 environment running from archlinux system targeting remote aws linux instances summary the aws credentials from environment variables or boto configuration files are not being passed to the ec2 tag module steps to reproduce minimum working example expected results tags being updated created on aws ec2 instances actual results the ec tag module is failing everytime with the following error which is caused when the credentials are not configured properly however have valid home boto with the credentials section correctly configured the ec2 dynamic inventory script and connecting and listing tags with plain boto work fine passing credentials with environment variables don work the only workaround found was specifying the key values in the play like this iirc this was working around may 2014 when first made this role edit formatted the issue using the ansible issue template sorry for the delay >>>bug_report
wait for hangs with default options issue type bug report ansible version environment mac os 10 10 yosemite with homebrew summary the wait for module hangs if no port or path is specified steps to reproduce the following task hangs expected results expected the above task to wait for server finishing its booting process got that impression from https support ansible com hc en us articles 201958037 reboot server and wait for it to come back and it seemed logical like default value ``port 22`` actual results the ansible script hangs burning lots of cpu cycles because the lack of options is not checked for in the elaborate if statement in the wait for module >>>bug_report
copying remote files have the requirement to copy file on remote server in this case both the source and destination are on the remote server doing this as copying file extracted through another command into 2nd location so far ve struggled to get this working in an idempotent manner ve come across the following ways around it but both have drawbacks this works but won allow the file to be updated when it changes only works for static files this works better but feels wrong and makes the tasks files way too big >>>feature_idea
ansible facts do not discover multiple gateways for other interfaces than eth0 hello issue type bug report ansible version environment running from arch to rh pool summary ansible facts do not discover multiple gateways for other interfaces than eth0 steps to reproduce setup host with multiple eth and multiple routes with default gw and multiple gw for other subnets expected results user should have access to non default gw from the facts actual results nowhere in the facts results see my non default gw using ansible at work we have an environement with hundreds of hosts we manage with ansible they all have eth interfaces with differents routes and gateways for each of them when run the setup module to discover facts see that only reported about eth0 gateway and none of my other gateways are found example for one host as you can see nowhere is found eth2 gateway 10 110 129 shouldn the fact setup structure forsee gateways for other interfaces and put them where they fit ansible eth0 ipv4 gateway ansible eth1 ipv4 gateway and ansible eth2 ipv4 gateway if they don exist they should be set to this shouldn impact ansible default ipv4 gateway same for ipv6 thanks for the good work edit now that try to find another way to get other gateways realize can have multiple gateways for the same interface for multiple subnets destinations so it likely bit more tricky still think this structure is missing ansible eth2 ipv4 gateway 10 110 129 but what if have another gateway for yet another subnet under eth2 there is need for structure to store the various gateways associated to their destinations or the various destinations associated to their gateways hey the whole routing table is missing think it can be summed up this way here is what would need forget ansible eth2 ipv4 gateway since we have an array of values multiple gateways per interface and even per destinations forget ansible eth2 ipv4 gateways since we have no way to match gateway to dest since the routes are missing anyway it could be added higher up could work with parse route and get same for ipv6 granted we already have destination gateway 10 110 since its default but at least there is place for all routes or same for other interfaces and ipv6 second structure is not that bad actually makes better sense to look for routes under ansible eth2 ipv4 alternative create extra tasks and register those gateways values to be able to push correctly my route config or maybe custom module >>>feature_idea
sporadic winrmtransporterror 500 winrmtransport issue type bug report ansible version ansible configured module search path none environment ansible runner ubuntu 14 04 managed machine windows 2008 r2 sp1 summary from time to time we get the following ansible error it does not seem that this is caused by timeout because the previous task finished just few seconds before the failing one for example seconds in the case am looking at the moment we use latest version of pywinrm steps to reproduce unfortunately none it is sporadic issue that we see regularly let say once per day expected results the task to execute successfully actual results the described error >>>bug_report windows
symlink handling changes in configuration issue type bug report ansible version ansible environment control host ubuntu 14 managed host centos x64 summary ve come across an issue in ansible relating to how it handles symlinks it no longer manages steps to reproduce create symlink through ansible subsequently remove the config for the symlink in ansible and replace with either file template directory run ansible agains the host ansible doesn handle this and the run fails ansible actually seems to update the symbolic link to point to it self this results in invalid symbolic link ve had to remove this through ad hoc command for now but it should be removed and replaced by the file module really expected results expect ansible to either remove the symlink or throw an error that clear actual results ansible sets the symlink to be infinite loop ansible doesn handle this and the run fails ansible actually seems to update the symbolic link to point to it self this results in invalid symbolic link ve had to remove this through ad hoc command for now but it should be removed and replaced by the file module really >>>bug_report needs_info
fact values are unexpectedly jinja templated recently traced confusing error message template error while templating string unexpected end of template expected end of print statement to the hostvars class in lib ansible runner init py is running fact values through jinja and had fact containing jinja interpretation of fact values is very surprising and seems dangerous as well if this behavior is untentional then it should be corrected and if it is intentional then it should be possible to disable it and disabled by default argue small self contained test case follows tested with ansible file hosts file library foo with the execute bit set file test yml and file bar it can be empty or contain whatever ansible playbook hosts test yml play test gathering facts ok localhost task foo ok localhost task copy src bar dest tmp bar fatal localhost template error while templating string unexpected end of template expected end of print statement >>>bug_report p2
synchronize with first found very bad failure mode issue type bug report or at least dubious behaviour ansible version environment linux summary when `synchronize` is used with `with first found` and the latter returns no matches then ansible will by default invoke an rsync of the local to the remote since this is rather counter intuitive and dangerous private data could be copied by accident would suggest to change the default steps to reproduce expected results task should be skipped since neither `foo` nor `bar` exist on the source actual results ansible invokes `rsync root remote tmp foo` woops >>>bug_report
get rid of bash compound command to make more portable the compound command is available on many modern shells as an enhanced substitute for bin test but it is not part of the posix standard and not available on all posix compliant shells implement in different manner to enhance portability >>>feature_pull_request
naming item variable in item lookups regularly find myself looping over registered variables in chains this results in variable names like ``item item item `` in my playbooks the attached patch allows naming the ``item`` variable within an item lookup for clarity see the attached example >>>feature_pull_request
add logging of exceptions this pr needs more changes but here is the gist this particular change helped me find out that this particular unhelpful error message >>>feature_pull_request
ansible fqdn variable uses socket getfqdn which can provide weird results ve been seeing some weird results show up in `ansible fqdn` and finally tracked down why ansible fqdn uses socket getfqdn which appears to collect the system hostname and then loook it up in dns if dns doesn exist for the host or worse it exists out on the internets because now just about anything is allowed as tld you get someone elses result for example have vm who hostname is set to `allinone computer` run `ansible test` against it and get these values in the results yurika dot wtf so do some digging namely an strace against python script that calls socket fqdn see here for the script and strace https gist github com paulczar ee2a9cf3871038fd8beb turns out socket fqdn calls `uname` from which it collects the name `allinone computer` it then calls out to resolve that via dns which since don have dns server with records for computer` it calls out to the tld dns hints which happens to actually return result because computer is now valid tld it gets back an ip address 77 78 104 and the it looks up the ptr record for that ip which gives it thus ansible thinks my fqdn is `yurika gransy com` there are many reasons for person not to have dns confgured or worse to have had their dns poisoned or broken for some reason for the hostname that they re using and in my opinion it could lead to some very undesirable behavior if had used `ansible fqdn` as the destination for syslog then be sending all of my logs out to some random host on the internets >>>bug_report p2
ansible hostname variable is wrong or is documented wrong in the documentation http docs ansible com playbooks variables html it says however in the code ansible is actually doing this means if our hostname is potato bacon as returned by the linux `hostname` command or read from etc hostname` the `ansible hostname` will actually be written as `potato` which is incorrect according to the documentation since the hostname as the system reports it is actually `potato bacon` as much as would like to see `ansible hostname` report the hostname from the system it probably been incorrect for too long to change it so recomment the documentation is updated be something like >>>docs_report
add integration tests for the rax module this pr includes new integration test role `test rax` new `cleanup rax py` the new integration tests cover the large majority of functionality in the `rax` module >>>feature_pull_request
docker module now generates an error with docker and docker py the docker module now errors with it looks like this issue https github com docker docker py issues 446 is that something that addressed here ansible docker out of epel and docker py from pip ansible docker version build 39fa2fa docker py >>>bug_report cloud
v2 added environment to play also added both environment and no log inhertiable by task>>>feature_pull_request
environment variables expanded inconsistently when used in values for ansible in ansible cfg from prior dialogue https groups google com forum topic ansible devel slfac zebvm on ansible devel shell variable expansion is handled inconsistently for values of ansible when they are brought in via ansible cfg some are expanded and some are not was suggesting that they be treated consistently and that they all be expanded michael wrote that really good point and this should definitely be consistent let add an expand true to the get config method and we can take it however note that the v2 refactoring is still underweigh for core so you may wish to just file this as bug report from constants py >>>bug_report feature_idea
apt repository failed to validate the ssl certificate for launchpad net 443 issue type bug report ansible version ansible configured module search path usr share ansible environment running from linux mint 17 based on ubuntu 14 04 managing ubuntu 10 04 12 04 summary adding ppa with the apt repository module fails with certificate validation problems manually running add apt repository on the host works steps to reproduce expected results ppa added under etc apt sources list actual results >>>bug_report
ssh host key changed issue type bug report ansible version ansible configured module search path none environment mac os summary if host identification changed in regards with ssh known hosts ansible swallows the warning and nothing is output not even at vvvv this results in ssh denying to forward agent for no apparent reason even if it is set up in ansible cfg ssh connection ssh args forwardagent yes steps to reproduce change host identification for one of your hosts in ssh known hosts set up ansible cfg to forward agent observe agent forwarding to fail when connecting to the host expected results warning about identification mismatch actual results silent ignore>>>bug_report
bug report ansible vault errors with odd length string ansible version environment cygwin summary have vaulted file created on another system on that system it works without any problems however when run it on my local system get the following error steps to reproduce run ansible vault debug view vars vaulted vars yml expected results display content of the file actual results it doesn matter if enter correct password or not or simply press enter it always errors out >>>bug_report
vars files cannot use templated path anymore worked in upgraded to and am getting lot of `error while evaluating conditional` errors what can do to help you guys assist me in diagnosing this problem >>>bug_report p2
to replace `running` with `started` issue type docs pull request ansible version branch devel environment summary service module parameter don have `state running` please replace `state started` http docs ansible com service module html steps to reproduce see document http docs ansible com test strategies html expected results state use actual results `state running`>>>docs_pull_request
make main tasks file of role parameter make something like this possible >>>feature_pull_request
added before after module info to error message it not always very obvious what you ve done wrong when you get the error below having the before after lists of module args makes it lot easier >>>feature_pull_request
add tests for using deb files this adds couple of basic integration tests for the install local deb file functionality of the `apt` module the final test doesn work now but will once https github com ansible ansible modules core pull 53 is merged >>>feature_pull_request
with dict and with items mishandle quotes issue type bug report ansible version environment ubuntu 14 04 summary items with quotes in them trip over ansible and they can cause it to blow up or to silently discard quotations steps to reproduce using ini module for illustration the issue applies to all modules except debug will explode with or it may silently discard the quotes same issue just less noticeable so it easy to miss produces quoting the usage doesn help because produces >>>bug_report
support for variable handlers consider this errors on ansible with it would awesome to define handlers with variable reference >>>feature_idea
feature request add ansible galaxy install save think `npm install save` basically if run `ansible galaxy install geerlingguy drush save ansible yml` today then the following entry will be generated in my `ansible yml` or appended if the file exists on the fence as to whether it should think about dependencies at this point or not say no since `ansible galaxy` handles that maybe it could be flag like recursive` though >>>feature_idea
fix various inventory scripts to use env python fix https github com ansible ansible issues 9948>>>bugfix_pull_request
expand in filename given as option for ansible and ansible playbook fix https github com ansible ansible issues 9937>>>feature_pull_request
gce py uses usr bin python causes errors for virtual environments the gce py script uses the os install usr bin python executable instead of the executable located by usr bin env this causes problems for users who run virtual environments because they will likely not have apache libcloud installed >>>bug_report
don double the count of for linuxhardware cpuinfo keys on vendor id and model name keys check for xen paravirt and handle processor facts accordingly proposal to resolve https github com ansible ansible issues 9759>>>bugfix_pull_request p2
wrong order of rendering of variables issue type bug report ansible version environment ubuntu trusty summary dynamic variables defined in in role test vars main yml rendered after the playbook role test tasks main yml has been played steps to reproduce use the provided vagrantfile to provision vm the whole code of failing example can be found at https www dropbox com qdvsm7tirzlnav6 bug tgz expected results actual results >>>bug_report p2
failing lookup affects copy template file even when not part of the task issue type bug ansible version ansible environment debian gentoo summary the copy and template modules throws an error with wrong file in ansible everything is fine and ansible copies the jail conf in ansible cannot copy any file while have lookup defined in group vars even if the defined lookup is not used in any playbook steps to reproduce group vars all ssh users name evo key lookup file evo pub tasks main yml name copy fail2ban config copy src jail conf dest etc fail2ban jail conf expected results ansible task common copy fail2ban config changed evosrv test actual results ansible task common copy fail2ban config fatal evosrv test could not locate file in lookup evo pub >>>bug_report p2
failed when and ignore errors ignored in check mode in roles in copy module and probably others issue type bug report ansible version also verified in ansible environment debian jessie but probably irrelevant summary when running playbook with roles in check mode and role has copy task with missing input file ansible handles this as an failed task even when instructed to ignore this check with or when the same task is executed in the master playbook file itself instead of the role files the failed status is ignored as requested steps to reproduce not really minimal playbook and role files ansible playbook hosts test yml check expected results actual results if the failing task in roles test tasks main yml is removed it visible that the exact same task modulo file names in the playbook itself runs successfully ignoring the error as it should this happens because ansible is caling path dwim relative from lib ansible utils init py to figure out the full file name for given relative file name when this function does not find file and running in check mode this raises an errors ansibleerror which aborts for this host the ignore errors setting or the failed when constraint are not checked here when not running in check mode it just returns the last checked file name removed the check as seen in the patch below and then it works as expected for me not failing when run with failed when false or ignore errors true failing when not run with either settings removing this check makes my case work don know what it does break >>>bug_report
ansible setup reports incorrect disk sizes issue type bug report ansible version ansible devel 1698b17b14 last updated 2015 01 05 16 46 59 gmt 1100 environment centos linux release 1406 core command used ansible all setup ask pass summary actual results ansible all setup ask pass grep gt ssh password size 99 tb size 223 57 gb size 37 83 gb size 17 58 gb size 55 90 gb size 28 tb size 21 83 tb the largest drive in the system is 3tb clearly size checking reporting has bug expected results fdisk output may help sudo fdisk grep gt disk dev sde 3000 gb 3000592982016 bytes 5860533168 sectors disk dev sdc 60 gb 60022480896 bytes 117231408 sectors disk dev sdb 240 gb 240057409536 bytes 468862128 sectors disk dev sda 960 gb 960197124096 bytes 1875385008 sectors disk dev sdd 1000 gb 1000204886016 bytes 1953525168 sectors idea why not parse sudo fdisk output for disk sizes >>>bug_report
fixed bad exampel for library that was library path which of course did not work as config looks for library to construct the path >>>docs_pull_request
bug report multiline parsing in `local action` results in module not found issue type bug report ansible version environment os 10 tried with ansible installed from homebrew and in virtualenv from pip summary the changes to module argument parsing in ansible ansible 317ab06bc6bdecd8a3b9c254702d6d7ea7e334d9 ansible ansible 8d0c1dd2faa21074d12832c074a4f4afa9e577e2 mean that on ansible `local action` and presumably anything else that takes module name as its first argument no longer strips newline characters from the module name resulting in module not found errors when ansible looks for `module name n` rather than `module name` originally reported as ansible ansible modules core 368 switching from the syntax we had been using in our playbooks on and earlier to fixes it but not sure if this is intentional behavior steps to reproduce here the shortest playbook could come up with to reproduce the problem expected results with ansible actual results >>>bug_report
improve docs in regards to custom module creation it necessary to give people instructions on how to use all these praised features like custom language modules >>>docs_pull_request needs_revision
cant use in module path works ansible playbook ask pass myplaybook txt module path home pc ansible library does not work ansible playbook ask pass myplaybook txt module path ansible library so in my opinion this doesnt make sense because launching this in terminal as pc user so there should theoretically be no confusion as to which computer is meant and which user is meant by the module path >>>bug_report
fixes 9415 fetch should use hostname instead of ip for directory name 9415 >>>feature_pull_request p2
inconstent and confusion output of `debug` issue type bug report ansible version environment does not matter summary if variable is undefined `debug var some undefined variable` does not tell so but outputs the name of the variable as it content this is very confusion esp if the variable content is assumed to be the same as the variable name see below for reasonable example for this steps to reproduce run this playbook on any host actual results the output is shortened expected results would expect the output of the first debug action to be something like reasonable example debops pki debops ansible pki uses the variable `secret` for specifying the directory to store secret data see this line debops ansible pki blob master tasks pki yml l16 obviously secret also is reasonable default value for this variable but the following output conceals the fact that the variable is undefined >>>bug_report
add role directory to template lookup locations 7106 this addresses jinja2 doesn allow to use template includes outside playbook dir 7106 >>>feature_pull_request
ansible playbook should support running without with an empty inventory file issue type bug report ansible version ansible configured module search path none environment summary ansible playbook should not signal an error when no inventory file is specified should treat it as empty and perhaps output warning instead this is valid use case for local playbooks where all plays are delegated to 127 with connection local steps to reproduce create playbook run it with ansible playbook test yml expected results the playbook should run and output the current working directory actual results >>>bug_report
fix some mistakes in chanelog md>>>docs_pull_request
make mirror clone rather than regular clone this permit to give git branch as version for ansible galaxy which in turn open interesting way of managing the roles in seamless fashion >>>feature_pull_request
retry exec command via ssh issue type feature pull request ansible version devel environment summary this pr adds the option to retry failed ssh executions if the failure is caused by ssh itself not the remote command this can be helpful if there are transient network issues retries are only implemented in the openssh connection plugin and are disabled by default retries are enabled by setting ssh connection exec retry to an integer greater than steps to reproduce running long series of playbooks or short playbook against large cluster may result in transient ssh failures some examples logged here https trello com 1yh6cseq 13 ssh errors expected results ansible should be able to retry an ssh connection in order to survive transient failures actual results ansible marks host as failed the first time it fails to contact it >>>feature_pull_request
ansible ssh port template not expanded for synchronise issue type bug report version ansible version ansible configured module search path none environment vagrant vbox ubuntu 14 04 summary we have playbook which deploys onto remote server through non standard ssh port the variable is defined in roles common vars main yml as deploy ssh port 3500 in the playbook file vars ansible ssh port deploy ssh port the playbook runs perfectly communicating with the server and installing files until it reaches the synchronise task then it fails with an error msg command line line bad number rsync connection unexpectedly closed bytes received so far sender rsync error unexplained error code 255 at io 605 sender debugging this reveals the command being sent is `rsync delay updates ff compress archive no owner no group rsh ssh none stricthostkeychecking no port deploy ssh port rsync path sudo rsync files from tmp inventory files out format home user source user ipaddress home user note `deploy ssh port` isn expanded which was validated by print in ansible modules core files synchronize py steps to reproduce relevant task in roles render tasks main yml name rsync files tags code synchronize args src source dest home user owner no group no rsync opts files from tmp inventory hostname files relevant var in roles common vars main yml deploy ssh port 3500 relevant playbook hosts render user user sudo true vars ansible ssh port deploy ssh port roles wl render expected results `rsync` command to pass actual results msg command line line bad number rsync connection unexpectedly closed bytes received so far sender rsync error unexplained error code 255 at io 605 sender nb all other tasks using the same template work perfectly and changing `ansible ssh port deploy ssh port to `ansible ssh port 3500` works as expected >>>bug_report
github and ansible galaxy use https github and ansible galaxy use https not http also correct tower url>>>docs_pull_request
strip formatting from module lists http docs ansible com list of all modules html before dnf manages packages with the dnf package manager after dnf manages packages with the dnf package manager>>>feature_pull_request
correct url to github so links work when testing locally previously if you did make webdocs and we would link to http localhost ansible dev github com ansible ansible modules core>>>docs_pull_request
update github url replace git github com ansible ansible git with https github com ansible ansible git for working checkouts>>>feature_pull_request
bug report etcd url setting is not respected issue type bug report ansible version environment ubuntu 14 04 os yosemite summary the etcd lookup has configurable host setting for connecting to etcd nodes that are not localhost there are two ways to accomplish this etcd url setting in ansible cfg ansible etcd url environment variable only the second environment variable seems to have any effect steps to reproduce create an external etcd cluster with nodes on different machines than those from which you will be running ansible create playbook that pulls one or more variables from etcd via lookup example playbook roles my role vars main yml my var lookup etcd foo bar baz put the following setting in the defaults section of the playbook ansible cfg etcd url http etcd node mydomain net 4001 run playbook expected results my var is defined with value from etcd actual results my var is an empty string workaround use ansible etcd url environmental variable with every playbook run >>>bug_report
when including tasks parameters are not passed or resolved correctly when using the include statement in role to execute some task with parameters the parameters are not passed or resolved correctly example >>>bug_report
bug report ec2 instance id does not exist issue type bug report ansible version environment ubuntu 14 04 summary this appears to be similar to 7906 when provisioning several instances in loop via the ec2 module instance tagging will frequently fail with name provision new instances ec2 count image ec2 image instance type ec2 instance type aws access key ec2 access key aws secret key ec2 secret key keypair ec2 keypair volumes ec2 volumes instance tags name item region ec2 region group id ec2 sg id vpc subnet id ec2 subnet id wait no with items new hosts task provision new instances changed localhost item host 23 internal com changed localhost item host 24 internal com changed localhost item host 25 internal com changed localhost item host 26 internal com changed localhost item host 27 internal com failed localhost item host 28 internal com failed true item host 28 internal com msg instance tagging failed invalidinstanceid notfound the instance id xxxxxxx does not exist failed localhost item host 29 internal com failed true item host 29 internal com msg instance tagging failed invalidinstanceid notfound the instance id yyyyyyy does not exist changed localhost item host 30 internal com fatal all hosts have already failed aborting>>>bug_report cloud
bug report sometimes lookup plugins do not recieve the proper variables sometime lookup plugins do not receive the proper variables in our case sometimes our custom lookup plugin receives groups in the inject ed variables and other times it does not ansible version broken in known to work in the broken commit via git bisect is 4cd87ec93ec1f5266e5afaaa8e6734d642284afe something about how this commit adds extra vars also removes the groups key environment linux ubuntu 14 04 summary groups should be in the injected variables in lookup plugins this is sometimes true in but not always steps to reproduce have not yet managed to construct minimal version of this am still trying to figure out good way to do that we have lot of different interacting components can reproduce it reliably in our environment but minimally you are going to need custom lookup plugin have it fail if groups is not in inject some templating action final notes can provide more information as needed just ask notes on commit 4cd87ec93ec1f5266e5afaaa8e6734d642284afe before commit 4cd87ec93ec1f5266e5afaaa8e6734d642284afe inject hostvars merge hash inject combined cache self extra vars this looked like host name vars after commit it looks like vars host name vars vars perhaps those extra vars should have been nested in the host name key note host name stands in for the actual host name >>>bug_report needs_info pending_closure
ansible galaxy list fails with traceback see below edited the original issue noted that on clean install the etc ansible roles` the default path for roles in galaxy does not exist leading to an error message >>>bug_report p2
indicate roles when listing tasks resolves 6216 hello here tiny patch to indicate roles when listing tasks same way we do while running them regards from moscow and happy new year alex>>>feature_pull_request
removed early check for empty inventory the `ansible playbook` script throws an error for empty inventory files before creating playbook object and running its plays this is sometimes unwanted since some playbooks may contain only action to be performed on localhost which is implicit see 6442 and 9712 >>>bugfix_pull_request
added steps for installing ansible from source>>>docs_pull_request
backup for file modules is broken feature basically backup local uses the minutes as the lowest unit of time it implies that if two backups are done of the same file during the same minute one will be lost wouldn it be possible to improve it using real timestamp or by at least adding the seconds if someone wants to rely on the backup option the only reliable solution is to follow the command with sleep minute it hard to accept that here is the current implementation https github com ansible ansible blob 5bc81f9ae7a0b13dab8a741081261660f1080727 lib ansible module utils basic py l1269>>>feature_pull_request
fix some typos in developing modules rst>>>docs_pull_request
fix bug in second demo setup yml aws example in the aws guide the second example of the demo setup yml did not include the register ec2 attribute >>>bugfix_pull_request
improve wording in playbooks intro rst was reading the docs and thought that wording seems off >>>docs_pull_request
git module not work with update option ansible not worked not failed but not cloned working have already been reported >>>bug_report needs_info
its it in docsite rst intro adhoc rst noticed this grammar error while reading through the intro and figured send quick pr >>>docs_pull_request
do not evaluate glob in shell am getting the following error on just cloned repository >>>bug_report
feature idea run syntax file role etc checks before asking for passwords user inupt for example if running play than needs the ask sudo pass flag then ansible should not ask for the password until after it checked for syntax errors that all the roles exist and other pre task checks >>>feature_idea
to json not working on variable when running ansible v1 in the below playbook to json fails to handle basic variable it was confirmed in the mailing list here https groups google com forum msg ansible project b1enyrc7xbi r0n9yqmtyj8j>>>bug_report
fixed facts gathering for strict remote umasks changes instead of calling `chmod` to change the mode for the directory after its creation the umask is temporarily altered before calling `mkdir` to ensure the parent directories that are possibly created have the desired mode too detailed explanation if the remote umask is very strict 077 the facts gathering fails for non root users with the following message the reason is the following in `lib ansible runner shell plugins sh py` temporary directory is created with `mkdir p` subsequently the desired mode is set with `chmod` possibly created parent directories do not get `chmod`ed and the non root user won be able to execute the setup module >>>bugfix_pull_request needs_rebase p2
add route53 replace names feature to ec2 dynamic inventory script this commit adds route53 replace names boolean to the inventory script it aims at replacing the main name of ec2 instances by their first cname in route 53 if any as of the implementation simply had to move the route53 related stuff up in the `add instance` method and use the already collected route53 record sets think it fair to avoid wildcard entries tell me if wrong the corresponding ml thread is here https groups google com forum topic ansible devel nbidwzo1gge as mentionned in the ml this change is an other option for completes the following prs 7395 7601 9825>>>cloud feature_pull_request
command line arguments that contain there does not seem to be way to pass command line arguments that contain to modules despite the quoting ansible splits on the resulting in this on the command line the same is true if you use ansible key value syntax >>>bug_report p2
git module overwrites local commits hi this is relatively easy to reproduce git clone your repo cd your repo touch asd git add asd git commit asd now start an ansible playbook to pull your repo to the same destination expected result merge or at least warning result all local commits are deleted this is definitely not intended as without the commit and with force no there is warning with the commit and force no all files are overwritten without warning >>>bug_report
fix ansible distribution facts for ubuntu hardy this patch fix ``ansible distribution `` facts running on ubuntu hardy ansible all setup filter ansible distribution before ansible all setup filter ansible distribution after >>>bugfix_pull_request needs_info needs_rebase
doc mention smart gathering for facts caching>>>docs_pull_request
cloud modules sts support redux supersedes https github com ansible ansible pull 9889 add support for aws security token service temporary credentials to all aws cloud modules rationalize sources and ordering of security credentials for consistency across modules update documentation to use shared doc fragment and consistent usage information across modules >>>cloud feature_pull_request
fix ansible galaxy install error empty yaml file if we execute `ansible galaxy install requirements yml` on valid empty yaml file the following error occurs file bin ansible galaxy line 764 in execute install roles left map ansible utils role yaml parse yaml safe load typeerror argument to map must support iteration further `roles done` was never used assume this should have been named `roles left` signed off by ren moser >>>bugfix_pull_request
add solaris enhancements and smartos fixes this pull request fixes annoyances on smartos hosts wrong pkg mgr is detected not ssh public key fingerprints are printed and distribution release version is misisng also added two functions which print dmi and disk facts am using smbios utility which is shipped with solaris by default for gathering disk facts am gathering information for sderr kstat module which prints information such as disk vendor disk product serial number size numerous error metrics etc >>>feature_pull_request needs_revision
documentation update the vagrant guide issue type docs pull request ansible version devel v1 environment summary solve problems raised in 7665 by maspwr mention that this guide corresponds to vagrant features and for now invite to rely on `config ssh insert key false` to avoid private key mess in multi machine environment remove the `vagrant init` example which is not really useful when following this guide invite to gather advanced details direclty in the vagrant ansible provisioner documentation to avoid repetitions discrepancies over time explain how to know the exact `ansible playbook` command that is generated and used by the vagrant ansible provisioner steps to reproduce expected results actual results a>>>cloud docs_pull_request
cloud modules sts support redux add support for aws security token service temporary credentials to all aws cloud modules rationalize sources and ordering of security credentials for consistency across modules update documentation to use shared doc fragment and consistent usage information across modules >>>cloud feature_pull_request
`groups groupname length` in group vars evaluates incorrectly in some contexts given this inventory and this `group vars all` would expect this to happen and it does however if do this which does not really involve templating get this beauty this is true in devel 5ed7a55990 this was not true in or or 0>>>bug_report p2
use send instead of sendv on the systemd journal fixes 9886 on `systemd 216 13 fc21` with `ansible fc21` the simple example from 9886 is triggering journald assertions for some reason the ansible module arguments being passed into `journal sendv` are causing the problem but passing them into `journal send` as keyword arguments seems to work around the issue >>>bugfix_pull_request
systemd journald assertions being triggered am triggering systemd assertions with this playbook which boils down to the following in the `module utils basic py` which triggers this issue with `systemd 216 13 fc21 x86 64` >>>bug_report
use svg instead of png to get better image quality>>>docs_pull_request
variable substitution occur only once when delegate to using with serial issue type bug report ansible version environment centos summary variable substitution occur only once when delegate to using with serial steps to reproduce hosts playbook yml expected results actual results workaround playbook yml >>>bug_report p2
let module params to have default values taken from another module param this makes it possible to gradually introduce some new variables to module without breaking it for older clients good example is file stat get md5 older and get checksum newer variables with this patch it is possible to set get checksum to have default value of get md5 it allows to introduce new variables more gradually without breaking runtime characteristics for existing playbooks when running using newer version of ansible if somebody disalbed get md5 then obviously they don want to do get checksum too to enable new behaviour just set default value for module param to string equal to some other param for the same module like >>>feature_pull_request
facts caching fix missing json in jsonfile caching>>>bugfix_pull_request
vars plugin regression bug issue type bug report ansible version devel head f9c203feb68e224cd3d445568b39293f8a3d32ad environment ubuntu 12 04 summary localhost is not getting vars of vars plugin we configured vars plugin which does an dns lookup and set the ip in the last play we loop over hostvars of group all which includes localhost but localhost does not have the ip set by the vars plugin steps to reproduce see example playbook on https github com resmo ansible vars plugin bug bash git clone https github com resmo ansible vars plugin bug git cd ansible vars plugin bug git ansible playbook site yml expected results as in play localhost gathering facts ok localhost task debug msg localhost ok localhost msg localhost play group1 task debug msg inventory hostname ok www ansible com msg www ansible com ok www google com msg www google com play www twitter com task debug msg item hostvars item ip ok www twitter com item www twitter com item www twitter com msg www twitter com 199 16 156 70 ok www twitter com item localhost item localhost msg localhost 127 ok www twitter com item www ansible com item www ansible com msg www ansible com 213 221 253 138 ok www twitter com item www google com item www google com msg www google com 173 194 113 242 play recap localhost ok changed unreachable failed www ansible com ok changed unreachable failed www google com ok changed unreachable failed www twitter com ok changed unreachable failed actual results play localhost gathering facts ok localhost task debug msg localhost ok localhost msg localhost play group1 task debug msg inventory hostname ok www ansible com msg www ansible com ok www google com msg www google com play www twitter com task debug msg item hostvars item ip ok www twitter com item www twitter com item www twitter com msg www twitter com 199 16 156 230 fatal www twitter com one or more undefined variables dict object has no attribute ip fatal all hosts have already failed aborting play recap to retry use limit home resmo site retry localhost ok changed unreachable failed www ansible com ok changed unreachable failed www google com ok changed unreachable failed www twitter com ok changed unreachable failed >>>bug_report
handle quoting of values in dict parameters in https github com ansible ansible modules core issues 543 the user is trying to set dictionary parameter via string non complex args syntax this is failing because the value contains comma inside of quotes and the naive parsing of the parameter thinks that the comma is dictionary field separator this will fix that as side effect it also allows space to be separator not just comma for example the new code should do this >>>bugfix_pull_request
precedence order change for top level and inventory level group vars issue type bug report ansible version working in broken in and environment suse 11sp3 summary the inventory level group vars same directory as inventory are not overriding the top level group vars same directory as playbooks steps to reproduce created stripped down environment to demonstrate the issue find group vars group vars all yml roles roles test roles test tasks roles test tasks main yml test test group vars test group vars all yml test inventory test yml group vars all yml contains single entry testvar top level test group vars all yml contains single entry testvar env level the playbook invokes roles test tasks main yml which contains the single task debug var testvar the following steps illustrate the change in behaviour sudo pip install ansible dev null ansible version ansible ansible playbook test test yml play myhost task test debug var testvar ok mst env level env level play recap mst ok changed unreachable failed sudo pip uninstall ansible dev null sudo pip install ansible dev null ansible version ansible configured module search path none ansible playbook test test yml play myhost task test debug var testvar of mst top level top level changed play recap mst ok changed unreachable failed expected results was not expecting this order to change would expect to be able to set values in the group vars at the playbooks level that would apply to all of my environments test stage uat production and values in the group vars at the inventory level for values that differ between environments logging level endpoint addresses heap sizes etc such that they override those generic values actual results as illustrated above it seems that the top level group vars overrides the inventory level group vars can see similar issue reported about precedence but not exactly this one>>>bug_report docs_report p2
ansible git module does not fetch new branches when branch points to the same commit issue type bug report ansible version a55c6625d4771c44017fce1d487b38749b12b381 latest dev environment target os ubuntu 14 04 target git version summary ansible git module does not fetch new branches when branch points to the same commit steps to reproduce create simple git repository run such task update the repo so that new branch would point to the same commit rerun task expected results task updates the source actual results task fails >>>bug_report
fix conditionals doc example use most recent parameters for yum>>>docs_pull_request
lineinfile create yes with check fails with selinux issue type bug report ansible version ansible also tried on latest dev environment centos summary `lineinfile` module when using `creates yes` with check` fails on machine which is running selinux with selinux set to permissive if file doesn exist already know `lineinfile` is now in ansible modules core but this is not bug with the module but with the core specifically with the file `ansible lib ansible module utils basic py` steps to reproduce selinux needs to be enabled in my case it is set to permissive and here is the test playbook to reproduce this problem expected results the playbook should report that task as changed actual results the task fails >>>bug_report p2
bug report core module user fails to generate ssh key in default location issue type bug report ansible version ansible devel a55c6625d4 last updated 2014 12 21 17 35 19 gmt 100 lib ansible modules core detached head dfe7f6c6d6 last updated 2014 12 21 17 41 58 gmt 100 lib ansible modules extras detached head 317654dba5 last updated 2014 12 21 17 42 06 gmt 100 v2 ansible modules core detached head cb69744bce last updated 2014 12 21 17 42 14 gmt 100 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 12 21 17 42 22 gmt 100 configured module search path usr share ansible environment ansible node ubuntu 14 04 x86 64 managed ubuntu 14 04 x86 64 summary when managing users using the core user module ve tried to set the generate ssh key option to yes for already existing user on the managed node and got the following error steps to reproduce create simple new user on the managed node using the user module in the following playbook execution set the generate ssh key parameter to yes without specifying explicitly the ssh key file parameter expected results pair of keys generated in user home directory actual results failed managed node item generate ssh key true name user1 authorized key failed true item authorized key generate ssh key true name user1 name user1 rc msg failed to create home user1 home ssh errno no such file or directory home user1 home ssh fatal all hosts have already failed aborting note setting the parameter ssh key file explicitly works fine for example home user1 ssh id rsa >>>bug_report
when using tags with roles the notify actions run at the end of the role not the end of the script issue type bug report ansible version ansible environment ubuntu 14 04 summary when using tags with roles the notify actions run at the end of the role not the end of the script basically you get different running order steps to reproduce >>>bug_report
bug include statement is no longer parsing variables and is expecting all include files to be in the same directory structure issue type bug report ansible version working in and earlier broken in and above environment tested in centos amazon linux amzn ami hvm 2014 09 x86 64 ebs ami b5a7ea85 and mac osx 10 10 summary include statements no longer work with variables specifying directory locations in include statements work with variables specifying directory locations in and below steps to reproduce install ansible place an include file in directory in different location to your main ansible files create variable referencing that directory use an include that uses that variable to reference the include file watch the script work as expected when run install ansible or higher watch the script break as ansible tries to find the variable name as part of the file structure expected results ansible should run the script and reference the file location using the variable actual results ansible breaks with error longer explanation that wrote first before remembering the template just updated to using the epel branch and now my playbooks that use include statements that reference files held in other locations outside of the base ansible scripts directory structure are no longer working ve tested this in as well and the bug or is that break of compatibility with previous versions that has been introduced happened sometime between and have until now been using set of variables to hold custom file locations outside of the directory structure that holds the bulk of my ansible scripts and role files in this example held in usr ansiblefiles the variables reference specific projects and are reused heavily in vars config that would look like would reference that in an include statement like so previous to version of ansible would then have the include statements run as expected and would reference the file as since now get the following error have thousands of lines of ansible scripting written and do have need to have files located in other directories as they are part of different projects trying to resolve this in any other way than downgrading ansible to version would be nice but after reading through the commits that have happened in the last couple of months can pinpoint exactly which commit broke the existing functionality this is easy to reproduce by installing ansible using an include that calls yaml held in different directory structure upgrading to ansible and seeing the script break >>>bug_report
cache json fixes now uses utils jsonify which does proper utf8 encoding removed unneeded and possibly error producing json import this should fix 9700>>>bugfix_pull_request
display cyan error message instead of red when ignoring errors some tasks are designed to fail under certain conditions and the play should continue as described here http docs ansible com playbooks error handling html ansible provides the ignore errors field you can set to yes the problem is that ansible currently still displays red error message in this case which is visually distracting and causes the impression to casual observer that something went wrong this change in the on failed callback checks if ignore errors is true and if so displays the error message in cyan which is the color of the ignoring message >>>feature_pull_request
include vars py should have an optional namespace parameter issue type feature idea ansible version environment summary the include vars module is useful for bringing in json and yaml formatted data from variety of sources but in many cases the names in these sources are quite generic ie hosts or name if the module accepted and added an optional namespace parameter this would prevent collisions and unexpected behavior for common variable key names for example instead of hosts it could be added to facts as my external data hosts in other words the option would result in the variables being imported as the content of dict named after the namespace parameter steps to reproduce import some yaml or json formatted data using include vars expected results facts should be optionally imported into custom namespace ie dict named after the namespace parameter rather than directly into the root namespace actual results facts are imported directly into the root namespace making conflicts likely possibility >>>feature_idea
improve jsonfile this make the plugin use internal format more resilient against someone fiddling directly with it by using extension >>>feature_pull_request needs_rebase
inventory host variables and include parameters in name are not expanded even though the docs at http docs ansible com playbooks intro html say variables can be used in action lines suppose you defined variable called vhost in the vars section you could do this tasks name create virtual host file for vhost template src somefile j2 dest etc httpd conf vhost this does not work at least not for variables defined in the inventory host vars the playbook or passed to `include` as parameters this task works fine and installs or removes the package based on the boolean setting name install libpam shield pam shield enabled pam shield enabled apt pkg libpam shield state present if pam shield enabled else absent however the output includes the variable task install libpam shield pam shield enabled pam shield enabled >>>bug_report
add explicit error when fact caching connection is not set by default jsonfile is not documented and the error message when fact caching connection is not set is bit puzzling so error message would be beeter documentation too while redis is faster for bigger setup jsonfile is fine for small setup and is easier to deploy the module will then stop ansible playbook as this match better the philosophy of ansible being fail fast system >>>bugfix_pull_request
with subelements allow subelement property to be nested rax instances id rax addresses public addr 10 addr 10 action some attr item id ip item addr with subelements rax instances rax addresses public >>>feature_idea
include tags not working with ansible issue type bug report ansible version el6 environment centos release final summary tags from includes are being ignored tags from within playbook are working just fine after downgrade to ansible el6 this is working steps to reproduce include someotherplaybook yml tags test tag ansible playbook someplaybook yml target somehost test tag expected results tags should not be ignored actual results error tag not found in playbook test tag possible values >>>bug_report
run once misbehaving in combo with serial the final post possible misunderstanding in the closed issue 8543 is explaining what happens with current implementation so while it being discussed or about to be implemented differently can you please fix the documentation that is quite misleading http docs ansible com playbooks delegation html special warning would be nice when using run once and serial issue type documentation report ansible version ansible environment centos ubuntu 14 04 summary run once task is executed once per pass resulting of the use of serial statement that misleading because the documentation http docs ansible com playbooks delegation html says it similar to when inventory hostname webservers it is not when serial is used an explicit special caution should be inserted in that section regarding the use of serial combined to run once steps to reproduce expected results the task should be executed only on the first host actual results the task is executed on each host >>>docs_report
test git add tests for `refspec argument includes basic test of the clone and update cases >>>feature_pull_request
added description for flag and ask su pass 9846 fixes documentation issue 9846 >>>docs_pull_request
certain filters require tests which aren imported name debug debug msg reject odd issue type can you help us out in labelling this by telling us what kind of ticket this this you can say bug report feature idea feature pull request new module pull request bugfix pull request documentation report or docs pull request ansible version let us know what version of ansible you are using please supply the verbatim output from running ansible version if you re filing ticket on version of ansible which is not the latest we greatly appreciate it if you could retest on the latest version first we don expect you to test against the development branch most of the time but we may ask for that if you have cycles thanks environment what os are you running ansible from and what os are you managing examples include rhel centos ubuntu 12 04 13 10 bsd solaris if this is generic feature request or it doesnt apply just say not all tickets may be about operating system related things and we understand that summary please summarize your request in this space you will earn bonus points for being succinct but please add enough detail so we can understand the request thanks steps to reproduce if this is bug ticket please enter the steps you use to reproduce the problem in the space below if this is feature request please enter the steps you would use to use the feature if an example playbook is useful please include short reproducer inline indented by four spaces if longer one is necessary linking to one uploaded to gist github com would be great much appreciated expected results please enter your expected results in this space when running the steps supplied above in the previous section what did you expect to happen if showing example output please indent your output by four spaces so it will render correctly in github viewer thingy actual results please enter your actual results in this space when running the steps supplied above what actually happened if you are showing example output please indent your output by four spaces so it will render correctly in github thanks again >>>feature_idea
bug report mixing templated variables from defaults and vars leads to odd results issue type bug report ansible version after upgrading issue was present in too environment ubuntu 12 04 summary when doing calculations often use variables defined in the vars main yml file for role if such calculations include variables parameters from the defaults main yml file this leads to very odd results steps to reproduce minimized test case https sky q1cc net bugreports ansible 01 ansible bug tar gz run after changing the inventory appropriatly everything runs local though remote machine is not actually altered expected results actual results additional info if one were to edit the file roles buggy main yml to say remove the filter everything works as expected possible workaround use set fact to do calculations that involve both types of variables http docs ansible com set fact module html >>>bug_report
delegate to templating problem when using groups var issue type bug report ansible version environment ubuntu 14 04 summary when using delegate to with an inventory variable that uses another variable that includes the group variable the delegate to host isn templated correctly if the variable is defined in the playbook or if it using the group var directly it works as expected steps to reproduce inv server1 ansible connection local server2 ansible connection local group vars all server list groups all first server server list first playbook yml hosts server1 tasks debug var first server variable is templated correctly here ping delegate to first server expected results actual results >>>bug_report p2
digitalocean key generation issue type bug report ansible version ansible configured module search path none environment mac os summary if an ssh key exists in digitalocean trying to state present the same ssh public key with another name fails steps to reproduce create an ssh key on the webui and name it key1 run this ansible task expected results one of an explanatory error message the key being renamed the id of the already existing key being returned possibly with the name key1 actual results >>>bug_report cloud
make issue rypes as an enumeration easier to copy paste and delete all except the correct line >>>docs_pull_request
copy module fails with json and with items issue type bug report ansible version ansible but present at least since environment ubuntu 14 10 with ansible in virtualenv jinja2 markupsafe 23 pyyaml 11 ansible argparse ecdsa 11 paramiko 15 pycrypto wsgiref summary similar to gh 5914 the copy module fails when there json with variables in the content field and it is run with `with items` steps to reproduce expected results file containing 123 actual results play localhost gathering facts ok localhost task copy failed localhost item 123 failed true item 123 msg could not write content temp file expected character buffer object fatal all hosts have already failed aborting play recap to retry use limit home username jsonbug retry localhost ok changed unreachable failed >>>bug_report
to nice json produces invalid json issue type bug report ansible version reproduced in and environment ubuntu 14 10 with ansible installed in virtual env pip freeze babel jinja2 markupsafe 23 pyyaml 11 ansible argparse cffi cliff cmd2 cryptography ecdsa 11 enum34 futures iso8601 10 jsonpatch jsonpointer jsonschema netaddr 12 netifaces 10 oslo config oslo i18n oslo serialization oslo utils paramiko 15 pbr 10 prettytable pyopenssl 14 pyasn1 pycparser 10 pycrypto pyparsing python cinderclient python glanceclient 15 python keystoneclient 11 python neutronclient 10 python novaclient 20 python statsd python swiftclient pytz 2014 10 requests simplejson six stevedore warlock wsgiref summary `to nice json` does not properly escape strings leading to newlines quotes and null characters among others in the output steps to reproduce expected results in tmp bug` actual results in tmp bug` >>>bug_report
unable to revoke privileges for mysql user issue type bug report ansible version ansible ansible configured module search path none environment environment ubuntu server 14 10 64 bit running in virtualbox summary the default mysql install comes with privileges to allow anonymous users to access the `test` and `test databases would like to remove all privileges for anonymous users unfortunately using the `mysql user` module fails with an error steps to reproduce run this task expected results privileges should be revoked no errors should be thrown actual results unfortunately it does not revoke the privileges and throws an error `>>>bug_report
su hangs when home directory does not exist for the user hi there ve encountered an infinite hang when using the following command line and this example output anisble vms randomuser su ask su pass whoami after poke around in the source code found that the verbose output wasn enough to tell me what was going on made minor change to determine what was the cause the output of the said command above now looked similar this after this saw that the password prompt was at the end of the string and what solved the issue was the following patch the output of the ansible command is now regards arlinton>>>bug_report
the man page for ansible lacks description for su ask su pass hi there looks like the man page lacks the mention of any su flags the su flags nicely described on the command line help usage ve seen this in and other releases if you need more details please let me know regards arlinton>>>docs_report
man pages contain duplicate author section the man pages contain two author sections in ansible author ansible was originally written by michael dehaan see the authors file for complete list of contributors author doctype manpage author the second one seems unnecessary regards markus>>>docs_report
apt with given package file fails in check mode issue type bug report ansible version environment debian debian summary ansible playbook check fails with apt module when given debian package file steps to reproduce have the following two tasks the first copies the deb file over the seconds installs the file name copy package deb copy src package deb dest tmp name install package deb apt deb tmp package deb evidently the package will not be copied over to the destination and thus it will also be missing there when it should be installed expected results the command declaration should execute without failure actual results running the tasks will result in the following when running ansible playbook task pkginstall install package deb fatal target failed to parse traceback most recent call last file root ansible tmp ansible tmp 1418844629 25 111234292060365 apt line 1907 in main file root ansible tmp ansible tmp 1418844629 25 111234292060365 apt line 523 in main force force yes dpkg options dpkg options file root ansible tmp ansible tmp 1418844629 25 111234292060365 apt line 299 in install deb pkg apt debfile debpackage deb file file usr lib python2 dist packages apt debfile py line 57 in init self open filename file usr lib python2 dist packages apt debfile py line 66 in open self debfile apt inst debfile self filename systemerror could not open file var cache apt archives package deb open no such file or directory unable to determine the file size fstat bad file descriptor read error read bad file descriptor fatal all hosts have already failed aborting>>>bug_report
add pciid to linuxnetwork interface fact issue type feature pull request ansible version devel environment linux summary add pciid to the linuxnetwork fact object this commit adds pciid to the linuxnetwork fact object pciid is gathered if the symlink sys class net device exists example emphasis >>>feature_pull_request
testing pull requests submodule testing addition to docs simple but helpful addition to the documentation for testing submodule pull requests>>>docs_pull_request
revert merge pull request 9611 from jhawkesworth win copy file template ansible core this reverts commit 27d2539fcd3e215d3c3a91a9f17ce4b80690d001 reversing changes made to bfe08560ec3c2444955a352be522c6bbf4e92204 conflicts 	lib ansible modules core>>>windows
memfacts as opened originally in 9766 this is the same thing just in it own branch as it should have been from the start to avoid pr conflicts original text below this fixes problem originally discussed here https github com ansible ansible issues 8035 as discussed in the issue tracker the output now looks like the following and it includes the old top level facts to preserve backwards compatibility >>>feature_pull_request
runner remote checksum traceback when used with delegate to containing var in it issue type bug report ansible version environment ubuntu 12 04 summary modules using `runner remote checksum` like template copy etc are broken when used with delegate to containing var in it steps to reproduce take following playbook and save as delegat test yml then run as following note that local doesn make any difference for the purpose of this ticket expected results results from actual results >>>bug_report p2
friendly role name doesn seem to work for local files issue type feature idea ansible version environment osx summary friendly role names don work for local files steps to reproduce include the following into playbook expected results playbook runs that show the task as actual results >>>bug_report
ssh key permisions check in ansible lib ansible runner connection py prevents ansible from working on windows from vagrant file issue type feature idea ansible version ansible environment windows enterprise babun ansible from pip vagrant summary know is unsupported to run ansible on windows control machine just want to have it noted down that the in the following file ansible lib ansible runner connection py lines checking if the key is readable by group and world in the current form is the only thing that prevents ansible being used as provisioner for vagrant thank you steps to reproduce environment set up like here http www azavea com blogs labs 2014 10 running vagrant with ansible provisioning on windows expected results hoped that it will run as it runs flawlessly from outside vagrant when invoked with actual results commenting the check out allows provisioning with ansible from vagrant definition file >>>bug_report
cloudstack add dynamic inventory>>>cloud feature_pull_request
support variable values with dashes undoes 35d138a since it not needed anymore playbook that tests the original bug and the new dashes bug >>>bugfix_pull_request p2
attributeerror module object has no attribute issue type bug report ansible version environment ubuntu 14 04 summary https github com ansible ansible commit 7ab1e525755b155cc148abf5b5bba4cb34afb99a just broke this any idea why steps to reproduce using ansible on ec2 to bootstrap each instance with user data script here small snippet that doesn work dummy yml expected results execute hostname actual results error message above >>>bug_report p1
math filters provides bit more than wished for in 9831>>>feature_pull_request
wishlist please add additional math filters to jinja2 logarithm issue type feature idea ansible version ansible environment ubuntu 12 04 summary ansible is missing logarithm function steps to reproduce example or something similar expected results example output actual results by itself jinja2 only provides few math functions as the documentation in http jinja pocoo org docs dev templates math states this is rarely useful in templates but exists for completeness sake in ansible however jinja2 is just the only way to do math calculations in my case was looking for way to round up to the next power of which is commonly done by taking the logarithm rounding upwards then taking the power of of the result sadly jinja2 is missing the logarithm part suppose logarithms are fairly common operation and should not require an additional addon >>>feature_idea
fix vars prompt no false default values issue type bug report ansible version environment summary `no` and `false` default values in `vars prompt` become steps to reproduce expected results actual results >>>bugfix_pull_request
ssh port in ansible cfg overrules per host port setting in ssh config issue type bug report ansible version environment ubuntu 14 04 summary ansible uses port 22 when there is no `ansible cfg` in home or the current working dir as long as an empty file is there everything works as expected this problem doesn come up for all my servers tried to find out which servers aren affected so far my best guess is if there is `proxucommand` then everything works as expected steps to reproduce delete ansible cfg` and do the same as before expected results port value in ssh config` is respected with or without local `ansible cfg` actual results when there is no ansible cfg` or ansible cfg` port value of some servers in ssh config` is not respected default port 22 is used instead >>>bug_report
exception host not found item issue type bug report ansible version buggy ok ok ok environment ubuntu 13 10 summary throws an exception steps to reproduce exact task have check summary section for example one expected results actual results >>>bug_report needs_info p2
feature request allow subelement loops to have missing subelements issue type feature idea ansible version ansible environment centos summary allow with subelement loops to have missing subelements without error steps to reproduce given the vars like to run the following code essentially skipping the greg user because the subelement authorized is deliberately missing currently get the error expected results expect the missing subelement to be skipped actual results >>>feature_idea needs_info
allow ec2 tags to be used to address servers in ec2 dynamic inventory my use case for this pr is addressing instances using domain names separate from ec2 public and private dns names the pr is completely backward compatible >>>feature_pull_request
fixed error handling for the enabling of ps remoting power shell remoting will throw an exception if you attempt to enable it while one of your network interfaces is set to public currently this error is hidden and the script continues to execute until it attempts to test ps remoting to localhost at that point the code fails with the following error unable to establish an http or https remoting session this happens because ps remoting didn start in actual fact the error that should have been thrown was the one that occurred when an attempt was made to enable ps remoting have removed the try catch and set the erroraction to stop so that the script doesn continue and the correct error is displayed it will also now be clear why the script failed and how to rectify the problem >>>bugfix_pull_request p2 windows
ansible sudo pass override from inventory affects all subsequent hosts in run issue type bug report ansible version environment osx 10 10 ubuntu 12 04 14 04 summary it appears that inventory variables are not limited to the host they are for steps to reproduce create inventory file with three hosts listed the second one should specify the sudo password using ansible sudo pass host one 127 host two 127 ansible sudo pass some password host three 127 run the ping command using one fork ansible ping assume host one and host two using sudo password other than some password expected results the ansible sudo pass option is only applied to the host it is listed for actual results using my example inventory host three fails with failed sudo password error original issue text in my hosts file have couple of hosts that specify the sudo password using the ansible sudo pass option example alpha 192 168 10 localhost 127 ansible sudo pass vagrant beta 192 178 10 found when doing command on all example ansible all ping that some of my hosts would fail due to invalid sudo password it appeared to be semi random until set the forks value to now every host that comes after localhost complains about an invalid sudo password it appears to me that the ansible sudo pass value is being used for hosts other than the ones specified it for am running on osx 10 10 am using the system python interpreter which is and am using ansible installed via brew >>>bug_report p2
add private key opt add parameter private key on the ansible pull script to specify the ssh private key to use on the repository it check if the key file exists before running the checkout >>>feature_pull_request
template module changes permissions on containing directory if dest is directory issue type bug report ansible version environment from mac os 10 python to centos summary permissions on templated file are applied to the containing directory if mode is specified and file already exists steps to reproduce example case user source tmp cat test j2 this is test template user source tmp cat test yml name test template hosts all tasks template src test j2 dest tmp mode 444 root target ls ald tmp drwxrwxrwt root root 4096 dec 15 14 39 tmp root target ls al tmp test j2 ls cannot access tmp test j2 no such file or directory user source tmp ansible playbook ks target test yml sudo password play test template gathering facts ok target task template src test j2 dest tmp mode 444 changed target play recap target ok changed unreachable failed root target ls ald tmp drwxrwxrwt root root 4096 dec 15 14 42 tmp root target ls al tmp test j2 root root 24 dec 15 14 42 tmp test j2 user source tmp ansible playbook ks target test yml sudo password play test template gathering facts ok target task template src test j2 dest tmp mode 444 changed target play recap target ok changed unreachable failed root target ls ald tmp dr root root 4096 dec 15 14 44 tmp root target ls al tmp test j2 root root 24 dec 15 14 42 tmp test j2 expected results the second playbook run should not have resulted in any changes the template was copied correctly in the first run and had the correct permissions set on it actual results the second playbook run alters the permissions on the containing directory instead of verifying them on the templated file this has stopped working since ansible x>>>bug_report needs_info p2
using git with ssh should read ansible ssh user ssh config if need an ssh connection from managed host it should be possible to use both agent forwarding and the user ssh config file as well am on and it does not seem to work there >>>feature_idea needs_info
members of list must start with `` ``>>>docs_pull_request p2
run once tasks are skipped without checking the delegate to host 9784 the fix is to choose the `delegate to` host when defined and included in the target host list instead of the first one in the list for running the tasks marked with `run once` >>>bugfix_pull_request p2
allow globbing in creates and removes directives fixes 1904 see https github com ansible ansible modules core pull 513>>>feature_pull_request
ansible galaxy file parameter full path hi it would be nice when you setup galaxy dependencies file like this to be able to specify the name of the final module path the goal is when launch it like this get folder roles nginx which is better than having roles jdauphant nginx thanks>>>feature_idea
fix add support for ssl protocol version configuration option hello am re submitting this request for bcoca this fix allows you to set the ssl protocol version in the ansible cfg file it also fixes couple of places where ansible was not setting the ssl protocol version properly for url calls so connecting to host where only tlsv1 was supported would not work >>>bugfix_pull_request p2
request honor the no proxy environment variable in ansible would like to re submit this feature request after working out issues with my fork the no proxy environment variable on linux systems is not being honored by ansible this adds support for that thanks>>>feature_pull_request
fixes 302 copy fails when source file is identical to the destination and destination is hard link >>>bugfix_pull_request p2
add etcd backend for caching facts this backend is modeled on the redis one but using the builtin expiration system of etcd after looking at various options for the etcd module settled on etcd because it was the easiest to install with pip but it should be trivial to change the client >>>feature_pull_request
document the behavior when directory is used for group vars and host vars you can use directory instead of flat file this permit to have for example private file coming from git repo containing per host variables and file coming from public repository or less restricted internal repository >>>docs_pull_request
added retry file command line option in some cases need to run the same playbook with differnet options in ths case the retry file is overrited added option to specify custom retry file if not specified the default is used not able to run these playbook paralel ansible playbook playbook1 yml var1 val1 playbook1 val1 retry playbook1 val1 retry ansible playbook playbook1 yml var1 val2 playbook1 val2 retry playbook1 val2 retry >>>feature_pull_request
error evaluating conditional when using async status until parameter issue type bug report ansible version environment os version 10 build 13d65 summary when using fire and forget check on it later the async status job has trouble with parsing the variable used in its until parameter job result finished instead of checking to make sure the job is finished and looping the playbook errors steps to reproduce the following playbook reproduces the error the playbook output is expected results when using ansible version the playbook runs correctly with results that look like actual results results when using v1 or v1 devel >>>bug_report p2
utils combine variables does not update new variable thread safety python api issue type bug report ansible version ansible environment debian summary we are using ansible python api with threaded workers running the same playbook with different extra vars passed to them when used like this localhost delegated task seems to keep the variable from previously running playbook and not the current playbook this is caused by https github com ansible ansible blob devel lib ansible utils init py l1497 when called from inject utils combine vars inject self setup cache get host will cause old values to be retained for the first task steps to reproduce https gist github com sulochan c6a59fc3e0b94889639c both python thread using threading and playbook example is on the gist when threads are run you will see the second one will print the wrong id expected results each thread should be able to call the same playbook with different variables fix fix looks to be simple giving priority to new value in combine vars although have not looked at if there is any side effect to it ie https github com ansible ansible blob devel lib ansible utils init py l1497 should return dict items items rather than dict items items >>>feature_idea
add lvm facts to setup module issue type feature pull request ansible version devel environment linux summary gather lvm facts in setup module this commit adds linuxhardware get device facts and calls that from populate lvm facts are only gathered if the setup module is running as root and the lvm utilities are available tested by searching for vgs if the conditions are met facts are set for each volume group and logical volume example test lvm data facts returned test as non root test without lvm utilities available >>>feature_pull_request
possibility to call callback `runner callbacks on verbose message` in `a nsible callbacks verbose` function passing runner instance to `ansible callbacks vv vvv vvvv` functions >>>feature_pull_request
ansible shell action doesn handle redirect correctly issue type bug report ansible version environment ubuntu 12 04 vagrant box summary it seems that shell action has some issue handling stdout redirect my action is ve tried any kind of quoting but it always fails with error simply rolling back ansible to made the action back to work as usual this seems to be affecting any shell action with redirect within steps to reproduce simply run playbook with shell action using redirect >>>bug_report needs_info p2
update digital ocean py to provide meta header dynamic inventory plugins are supposed to provide meta header to speed things up this plugin doesn have that header ve added the header for the list option the speed increase is pretty big even when this plugin is used alone if you have multiple dynamic inventory plugins and one of them doesn do meta things get extremely slow especially when you have lots of hosts see issue 9774 https github com ansible ansible issues 9774>>>cloud feature_pull_request
add support for templating in vars prompt>>>bugfix_pull_request needs_revision
kwargs passing for connection type plugins issue type feature idea ansible version latest environment summary don see any documented way to configure connection type plugins steps to reproduce expected results configurable connection type plugins actual results not configurable connection type plugins don see any documented way to configure connection type plugins most of the existing plugins use an init call similar to this some of the plugins have custom variables in the ansible cfg file to define the way they work ssh connection ssh args` for example the ansible cfg file should be parsed such that any variables listed under connectiontype connection are passed as set of keyword dict parameters kwargs to the plugin in other words if had this in my ansible cfg my custom plugin connection my custom executable usr bin bar could expect to be able to run be happy to put together pull request if this is deemed reasonable if so little direction on where the parsing happens and where the connection type plugin gets called would be helpful have look at lib parsers config parser py and lib runners connection plugin magic py >>>feature_idea
role foo vars main yml overrides from include vars aren used in parameterized include assignments issue type bug report ansible version ansible devel ae054dbc40 last updated 2014 11 27 02 43 21 gmt 000 also reproduced with and environment amazon linux summary if variable from role foo vars main yml is overridden via include vars the old value rather than the new value is used when evaluating parameterized includes steps to reproduce create these files main yml roles vars main yml roles vars alt yml roles tasks main yml roles tasks main yml expected results play 127 gathering facts ok 127 task include vars alt yml ok 127 task debug var foo ok 127 foo good task debug var bar ok 127 bar bad task assert failed 127 assertion bar good evaluated to false failed true >>>bug_report p2
ansible string variable values that contain dashes yield unexpected results when used in conditional issue type bug report ansible version environment ubuntu 14 04 summary testing the truth value of string variable should fail if the variable has dashes in the value it will evaluate as true steps to reproduce example play actual results expected results >>>bug_report
run once tasks are skipped without checking the delegate to host issue type bug report ansible version environment any summary as `run once` will always target the first host in the list if that host is supposed to skip set of tasks due to some condition for instance it will also skip any `run once` tasks even though they may `delegate to` other hosts which are willing to run that task steps to reproduce playbook targets group of hosts say `host1` `host2` `host3` role in that playbook is applied conditionally `when some flag` `host1` does not have the flag set while `host2` and `host3` do the regular tasks within that role are therefore only applied on `host2` and `host3` and are skipped on `host1` as expected expected results in the above scenario for task marked with `run once yes` and `delegate to host2` would expect it should run on `host2` since it does have the flag set actual results however the above mentioned `run once` task will also be skipped by `host1` as it the first one in the list don expect this to be the intended behavior but merely consequence of the current implementation as that task which should run only on `host2` has no reason to be skipped >>>bug_report
ansible apt cache fetchfailedexception marks the host as failed issue type seems ve encountered bug when using apt update cache module ansible version piotr bladerunner workspace ansible ansible version ansible configured module search path usr share ansible environment ansible is running on but the host that fails is running summary when apt update cache returns an error 404 ansible marks the host as failed steps to reproduce add the following play to your playbook if one of the repos fails to download ansible will mark host as failed expected results ansible should continue processing other plays from playbook actual results >>>bug_report p2
fix the comment about arguments as this was changed long time ago>>>docs_pull_request
ansible installation error in current version have installed ansible from ppa repo using following steps my operating system is ubuntu 14 04 lts while get the version get the following error ansible version >>>bug_report p2
fix typo for the word maintaining looks like my editor removed the whitespace at the end of the line let me know if should revert that >>>docs_pull_request
augment sys path to find modules relative to bin ansible this avoids the need to source hacking env setup when using bin ansible from local git repository clone of the ansible repository similar but slightly different augmentation already exists in bin ansible playbook >>>feature_pull_request
ansible utils git repo info now supports branch names with slashes issue type bugfix pull request ansible version environment osx 10 10 10 summary if your branch name contains the branch name is not shown properly steps to reproduce `git checkout test git repo info branch` expected results actual results >>>feature_pull_request
fix up formatting for code sections in guide aws>>>docs_pull_request
digital ocean inventory still uses old per host lookup issue type bug report ansible version ansible environment my workstation mac os 10 10 yosemite python not managing anything yet new to ansible and just doing tests with inventory scripts anyway the hosts ssh ing to are linux ubuntu and amazon ami summary if you use multiple dynamic inventory scripts at once some scripts are run with host` for each and every host not just the hosts they provide but hosts coming from the other scripts too steps to reproduce ve created the ansible inventory` directory and ve placed there the `ec2 py` and `digital ocean py` dynamic inventory scripts downloaded from `plugins inventory` on github ve configured the scripts with my credentials for ec2 and do testing these scripts manually they both work just fine note before each step below delete the caches of both inventory scripts then do that works fine looking at the process tree list while ansible is being executed see ansible running `ec2 py list` then it launches big pile of ssh processes all is well then do works fine see ansible running `digital ocean py list` then it runs `digital ocean py host` for each host in the list then ssh and get my results all is well then do expected results fast execution if any of the inventory scripts is run with host` it should only run for the hosts it provides actual results the last step is where things go wrong the command is completed just fine overall but when look at the process list while it running see this ansible runs one of the scripts with list` then it runs the other script with list` then it runs `digital ocean py host` for each and every host not only for hosts in do but for hosts in ec2 as well that cannot possibly be correct first off it very slow it takes lot of time for the do script to investigate unnecessarily the hosts that actually belong to ec2 secondly the do api servers are doing unnecessary work pretty sure `digital ocean py host` should only be executed for the do hosts note not sure if this is related but one difference between the ec2 and the do scripts is that the ec2 script actually generates the meta tag at the top of its output whereas the do script does not regardless the current behavior should not take place no matter whether script generates meta or not >>>feature_idea
template rendering failure reports on wrong item using with items issue type bug report ansible version environment os 10 10 deploying to ubuntu 14 04 lts summary as discussed in 3907 you get `typeerror unsupported operand type for strictundefined and strictundefined error when your template contains hyphens in the variable names observe that when deploying multiple templates using `with items` this error is reported on the preceding template or perhaps on the first one ve only got two here steps to reproduce `templates logging ini` contains `format env name node flavor ansible ec2 instance id service name name process message s` expected results an error on `logging ini` actual results corroborating data points with original `client cfg` and fixed `loggg ini` template deploy completes emptying out `client cfg` complete did not make difference correctly rendered client cfg was present on the box after each failure message >>>bug_report p2
allow retries to be templatable fixes 5865>>>bugfix_pull_request
allow ansible vault protected vars to be used with dynamic inventory issue type feature idea ansible version environment summary currently ansible vault can only be used with static files on disk within playbook tree dynamic inventory scripts push out group vars and host vars as part of the inventory definition in json format however there no way to store and transmit av protected items there you would have to implement the encryption decryption logic yourself outside of ansible we re using hybrid approach right now where virtually all variables are stored and delivered by the dynamic inventory script but we also have handful of av protected global group vars on disk within the playbook tree it would be great if we could migrate those to the dynamic inventory system as well steps to reproduce create new json convention for ansible vault items allow items to be seamlessly decrypted during playbook runs expected results actual results >>>feature_idea
make error message easier to understand and to act upon issue type feature pull request ansible version ansible environment summary make error message more helpful and clear steps to reproduce just use role inside playbook that isn defined yet or has different or wrong name expected results like to tell me what role ansible was looking for and didn find an error message like this what like to see error cannot find role postgres in home user src clients company ansible hosts machine roles postgres or home user src clients company ansible hosts machine postgres or home user src clients company ansible roles postgres actual results the actual error message am getting from ansible is error cannot find role in home user src clients company ansible hosts machine roles postgres or home user src clients company ansible hosts machine postgres or home user src clients company ansible roles postgres if you are used to seeing this kind of error message you ll quickly know what wrong however as an uninitiated you ll wonder therefore propose to explicitly name the role ansible is looking for thanks>>>feature_pull_request
typo fix in playbook delegation docs >>>docs_pull_request
typo fix>>>docs_pull_request p2
added vars plugin have written and used vars plugin which other people might find useful both as an example as well as variable plugin for the real world use adding new example plugin which uses python files to add extra variables to the current set of variables the directory `python vars` is scanned for python files only the ones named as the current group are taken into account each such file is scanned for the function `run host and its result is merged into the current variable set for example let assume the current host is in the group `dns` then `python vars dns py` can contain def run host return zones example com and the variable `zones` will be defined as the variable for the current host >>>feature_pull_request
expand memory facts in facts py this fixes problem originally discussed here https github com ansible ansible issues 8035 as discussed in the issue tracker the output now looks like the following and it includes the old top level facts to preserve backwards compatibility >>>feature_pull_request
add tags for inventory adds tags for the dynamic inventory based on libcloud and updates the key name parameter key name is the new parameter and has been so for several versions all users should have upgraded need this to work with customer on switching to ansible for his workflow thanks>>>cloud feature_pull_request
moar tests adds complex templated when condition explicit templating added couple of with options with undefined templated vars>>>feature_pull_request p2
exception host not found item when using templates and with items issue type bug report ansible version ansible playbook configured module search path none environment management node arch minions ubuntu 14 04 summary getting backtrace using `with items` and `template` module together steps to reproduce with version get backtrace using the following playbook expected results template should be deployed on frontends actual results trying to run this get if change `template to `command bin hostname` everything works as expected the template content is irrelevant just static stuff no vars inside additionnal notes bissected this to commit e81a6da49b4bc142b4ec9a5d2c4e43d1a34aa408 >>>bug_report p2
openwrt can start service no such file or directory issue type bug report ansible version ansible configured module search path none environment host arch linux target openwrt barrier breaker summary possibly missing initscript support for openwrt steps to reproduce see below expected results see below actual results see below on the openwrt platform latest version barrier breaker statement like this returns an error like this the correct way to start this service is like so this fails with any service not just `dhcpd` >>>bug_report p2
lookup file should have option to santise imput issue type bug report feature idea ansible version environment fedora 19 summary sourced variable has issues with content containing and probably also the lookup file function should provide an option to sanitise input making it compatible with output elsewhere the current setup makes it what you mean is what you get requiring additional handling for and possibly also the sanitation option would allow one to set it what you see is what you get and let ansible handle modifying to for more transparent use steps to reproduce consider myplaybook yml vars announcement content lookup file outage announce banner txt tasks name set announce banner lineinfile dest var www html myapp params regexp announcehtml line announcehtml announcement content outage announce banner txt this service will upgraded at 00 utc 2014 12 24 expected results playbook can do lineinfile with and not require actual results the playbook bombs out >>>feature_idea
ansible processor reporting duplicates issue type bug report ansible version devel as of fa51e8f36ddefbb3e8e59ecd370696b2918b9fab environment ubuntu 14 04 lts summary `ansible processor` seems to be reporting double the number of vcpus on the system output of `ansible setup` output of proc cpuinfo steps to reproduce expected results actual results >>>bug_report p2
ansible galaxy offline not mentioned in manpage issue type documentation report ansible version environment rhel summary behind firewall `ansible galaxy init` fails unless the offline` option is given see also 9687 however the offline` option is not mentioned in the manpage steps to reproduce expected results actual results >>>docs_report
valueerror traceback raised on ansible playbook invocation tested on osx and debian hello issue type bug report ansible version on debian on osx environment on debian on osx yosemite 10 10 summary sadly received valueerror traceback when trying to run ansible playbook steps to reproduce every time specify an inventory file using either i` or inventory file` seem to get this error very frustrating make sure to give file expected results if there problem with my invocation of the command want message saying what did wrong if the error is in file it should tell me about the error actual results please let me know if there is any additional information can provide to help move things along thanks >>>bug_report
major slow down in task execution with large inventory devel and issue type bug ansible version devel and bisect leads to 29d41bb789383c3ff59269b28877ea0f270f5861 which is also cherry picked in environment ubuntu 14 04 12 04 summary ansible became very slow in task exectution compared to earlier versions steps to reproduce the extra time is obvious amongst others in template task one needs large inventory with many variables before this becomes noticeable test with simple play that gather facts and has template task that contaians ansible env from the facts expected results task executes in less than second actual results task executes in less than in to seconds >>>bug_report
ansible cannot overwrite role variable issue type bug report ansible version environment macos centos summary ansible cannot overwrite variable in inventory file as ansible steps to reproduce configuration detail actual results ansible playbook expected results ansible playbook >>>bug_report p2
ansible fail to copy file template error while templating string in when do that it works copy src file j2 dest mydest in it doesn work anymore ansibleerror template error while templating string unexpected end of template here is my directories roles role files file j2 tasks main yml >>>bug_report needs_info
ansible galaxy install should fail gracefully when role source changes but name stays the same issue type bug report ansible version environment control host os managed hosts summary `ansible galaxy install` should gracefully tell user to uninstall role if it already exists on disk but he or she attempts to install it from different `src` this should return non zero exit code but not output traceback the use case is you have role installed from galaxy and either something is fixed upstream but the author hasn tagged version or refreshed galaxy to know about the tag you fork the role and fix it yourself and want to use your fork while waiting on upstream to merge your fix in either case you change the `src` of the role you had in `requirements yml` but leave the name the same so that you don need to update the includes in any playbooks using it steps to reproduce this is contrived example in that the two requirements files below actually install the same version of the role but it does work to demonstrate the problem since the `src` changes in reality the updated requirements file would be referring to some hotfix version or branch install this `requirements yml` with `ansible galaxy install requirements yml` but now you want to point to an interim fixupdate the requirements as such expected results `ansible galaxy install ignore errors requirements yml` on the updated file above should inform the user that role with the same name already exists and he or she should either change the name or `ansible galaxy remove neel rundeck` and try again actual results an ugly traceback >>>bug_report
ansible galaxy overly strict requirements txt parsing issue type bug report feature request hash comments used to work not sure if breaking them is considered bug if they weren documented as supported previously so if not consider it requestcomments should be supported stuck out tongue closed eyes ansible version environment control host is os managed is summary `requirements txt` containing blank lines and some lines beginning with as comments worked as expected in but throws exceptions in even single blank line at end of the file causes an exception though if that the only one then it spurious because all of the work is done steps to reproduce create `requirements txt` with the following contents we re on an old version because of blah blah stouts jenkins include blank line with newline at the end too ansible galaxy install requirements txt expected results successful role installation without errors actual results remove the comment but leave the trailing newline and the role will install but you ll still get the ugly exception spewed to output >>>bug_report p2
background task has different job ids on different hosts issue type bug report behavior inconsistent with docs ansible version environment summary docs say background tasks get some job id on all servers but the ids are different steps to reproduce run command on multiple servers in the background for example ansible all apt upgrade safe 3600 expected results the docs http docs ansible com intro adhoc html time limited background operations say the same job id is given to the same task on all hosts so expected the returned `ansible job id` to be the same for each server actual results returned ansible job ids are different >>>docs_report
add integration test for ansible modules core 460 please see https github com ansible ansible modules core pull 460 this integration test uses the `file` module to set `state touch` on hard link currently in ansible that causes an error ansible modules core pull 460 https github com ansible ansible modules core pull 460 fixes that if there is generally better way to coordinate prs for changes that span across submodules of the project please let me know >>>feature_pull_request
role parameters don override role vars when using role as dep using include issue type bug report ansible version ansible configured module search path none also present in head environment ubuntu 14 04 summary this may be considered pretty edge case when depending on role and using role parameters to override variable defined in the role `vars` directory the variable value will revert to its original value the role parameter ignored if the role uses an include task the dependency part is important if the playbook uses the parameterized role directly it works as expected steps to reproduce roles parent vars main yml var default value roles parent tasks main yml name before include debug var var include empty yml name after include debug var var roles parent tasks empty yml this can be empty roles child meta main yml dependencies role parent var not default play yml hosts localhost roles child working playbook yml hosts localhost roles role parent var not default expected results actual results >>>bug_report p2
included playbooks fail to match hosts issue type bug report ansible version from ubuntu ppa environment ubuntu 14 04 summary when including playbook using hosts variable which denotes the hosts the playbook should be run for as explained at https groups google com forum topic ansible project c8bdwptr640 this worked fine with ansible but started failing with ansible steps to reproduce tried to come up with simple playbooks reproducing the problem take the following example playbooks and inventor files test inventory test yml test include yml then run `ansible playbook test yml test inventor` expected results with ansible ansible playbook test yml test inventory play group gathering facts ok localhost task debug msg it works ok localhost msg it works play recap localhost ok changed unreachable failed actual results with ansible ansible playbook test yml test inventory play group skipping no hosts matched play recap >>>bug_report p2
extra vars parsing fails in issue type bug report ansible version environment ubuntu 14 04 summary when using json string as the argument to an ansible playbook in get the folowing error error failed to combine variables expected dicts but got dict and list steps to reproduce expected results playebook is executed successfully actual results error failed to combine variables expected dicts but got dict and list >>>bug_report needs_info
make inventory dir be available to vars files resolution templating issue type bug report ansible version environment fedora 21 summary you cannot use `inventory dir` with `vars files` it just not available to the update vars files` method steps to reproduce run with `ansible playbook hosts` and files hello` containing and group vars all yml` containing `included inventory dir files hello` shows that `inventory dir` is correctly set but `hello` which should be set by `files hello` is never set expected results `vars files` should be able to expand `inventory dir` actual results >>>bug_report feature_idea
add more info to error messages instead of fatal vagrant one or more undefined variables start command is undefined we now get fatal vagrant one or more undefined variables start command is undefined module name debug module args msg start command start command file users marca ansible roles pythonapp tasks main yml which immediately points me to the error in large library of roles cc sontek sudarkoff>>>feature_pull_request
added dynamic inventory plugin for proxmoxve hosts grouped by host servers it is possible to get information about host host parameter and get list of grouped hosts list parameter default true connection credentials are readed from ini file >>>feature_pull_request
mentioned gathering settings in fact caching the default of implicit bypasses the cache unless gather facts false>>>docs_pull_request
dynamic inventory should have implicit localhost and or empty inventory files shouldn be an error issue type bug report feature idea ansible version ansible environment summary since the introduction of implicit localhost with `local action` it is legitimate to want to run playbook with an empty inventory file at present an empty inventory file or an empty dynamically generated inventory from `ec2 py` in the situation where no ec2 instances exist running triggers an error even if the only plays are for `local action` the accepted workaround when not using dynamic inventory seems to be to supply localhost but this is apparently not recommended practice additionally this also requires the use of `ansible connection local` to work around an issue with `synchronize` trying to log onto `localhost` via ssh it appears better workaround is to supply completely invalid ip in the inventory list as this case is handled explicitly via and and does not require workaround for `synchronize` ansible playbook 999 999 999 999 playbook yml there appears to be no workaround to this situation when using dynamic inventory and even if an explicit `localhost` entry was added to the inventory it would complicate the use of the `all` parameter for `hosts it seems like with the addition of implicit localhost the commit see should now either be reversed and or have the same special implicit localhost handling that the undocumented approach gained with it is possible that in some situations it would still be appropriate to issue warning in the case of an empty inventory if there are no `local actions` in the playbook as it stands both these situations are hinderance to green fields deployment situations which as first use situation seems like an important thing to get right equally if for some reason all your vms have been terminated by bad `exact count` bug for example the issue specifically in relation to dynamic inventory is mentioned in but this seems to have been buried thanks steps to reproduce run the following against an ec2 account with no vms running ansible playbook plugins inventory ec2 py playbook yml the playbook should have `local action` commands to set up vms expected results an ec2 instance should be created etc actual results error provided hosts list is empty>>>bug_report
documentation module s3 unclear description of overwrite force believe there is an error in the documentation of the overwrite force parameters in the s3 module documentation the parameter name is documented to be overwrite however the examples do not mention this parameter but use force instead which is not documented maybe these two parameters have been confused >>>docs_report
git clone hanging with v1 issue type bug report ansible version environment summary since update one of my git commands hangs forever steps to reproduce expected results it working with ansible `v1 2` actual results the task hangs if ssh and check the folder it looks like it crashes on submodule can reproduce it with the cli >>>bug_report p2
add dynamic ansible inventory based on information from chef server this ansible inventory plugin generates groups based on chef environment attribute with host option it is possible to gel all information about node which you can get with knife node show node >>>feature_pull_request
improvements to community documentation noticed that the community information contributing documentation page could be improved so made some improvements looking through the rest of the documentation couldn find any consistency with regards to text wrapping so used `fold` to wrap the file to 100 characters also there are few grammatical fixes some phrasing alterations generally made in order to maintain more formal tone and some sentences have been rearranged to improve the flow of the text the raw diff is little messy due to the changes in text wrapping but github rendering of the rich diff makes the actual changes lot clearer >>>docs_pull_request
issue 9704 better handling of missing python when they python interpreter is set incorrectly for the machine the file is being checked for for the local or the remote the error manifests as readability or directory missing error which can be very misleading >>>bugfix_pull_request p1
jinja2 variables not being parsed in at head of playbook correctly issue type bug report ansible version environment ubuntu 14 04 lts server summary jinja2 variables are no longer parsed correctly on ansible on playbook for properties before the tasks are defined such as name and host steps to reproduce have vars yml file like so this is the playbook used will then run the ansible command ansible playbook myplaybook yml etc ansible ec2 py extra vars env stg playbook config myvars yml expected results in ansible the vars for at least the `hosts` property get parsed correctly this is the method we use to dynamically touch aws resources by tags understand that we can do this via custom inventories with my custom path inventory but wanted to check if this behaviour is still supported or if its bug actual results since upgrading to the vars are no longer parsed>>>bug_report p1
submodule ansible examples at examples playbooks instead of this let have this >>>feature_pull_request
directory existance checks relying on shellmodule checksum will fail when the python interpreter doesn exist only issue type bug report ansible version last working release first affected release working in devel branch no commit introduced d4d23b1b1f6b65edb13032104da11dee1b7d639f environment local system ubuntu 14 04 remote system freebsd 10 summary when using python interpreter that doesn exist on the local machine it set to the location on the remote machine shellmodule checksum will return meaning the python interpreter doesn exist not meaning the file the checksum was asked for is directory an example of module that checks directory existence with shellmodule checksum is `unarchive` with it dest param steps to reproduce set your python interpreter to path that doesn exist on the local machine using module such as unpack attempt to do directory existance check unarchive src dev zero dest tmp expected results the directory existence should be confirmed in the example above unzip should fail actual results the module fails with msg dest dir must be an existing dir error >>>bug_report p2
syntax check does not print file name if it fails to parse issue type bug report ansible version environment summary if you specify list of playbooks to ansible playbook syntax check and one fails on parsing ansible playbook will halt but not tell you which file caused the failure this is annoying if you are checking large set of playbooks steps to reproduce the above example show two playbooks the syntax of yml is fine yml is invalid syntax check does not print that the error is with yml expected results actual results see steps to reproduce >>>bug_report
better exception handling with delegated hosts this should fix 9698>>>bugfix_pull_request p2
adds filter allowing user to ensure that variable ends with path separator allows playbooks to control path separator presence for prompted directorieswithout resorting to regexes and relying on os path to do it the right way for us some user provided path some user provided path some user provided path some user provided path >>>feature_pull_request
fact cache unicode error issue type bug report ansible version environment linux ubuntu 11 summary jsonfile fact caching use `json dump` directly if some utf character is included in the fact the exception occurred think it should use util jsonify instead steps to reproduce ansible playbook to host which produces utf facts such as `ansible date time weekday expected results playbook runs actual results this exception occurred >>>bug_report
re add line that allows for complete playbook templating issue type bugfix pull request ansible version environment running from mac os 10 10 running against debian squeeze summary we currently have set of playbooks that want to run on set of groups of hosts so we ve added variable to the hosts part of playbook we have the group name built by variable in group vars file which also uses some info from extra vars and have the group added dynamically line was deleted in commit 9a0f8f0 that breaks this and this commit adds this back in the tests for `test var precedence` have been run without any issues showing up after this revert steps to reproduce we use aws and tagging but you should be able to reproduce this without using aws group vars test test yml run something like the following expected results actual results >>>bugfix_pull_request p2
exception when variable name and delegate to hostname match issue type bugfix pull request ansible version environment running on mac os 10 10 running against debian squeeze summary am using variable to designate my delegate host the variable name was using was bastion and the hostname returned was also bastion it in my ssh config file under that name when these two values are the same looking up the variable in the hostvars comes back successful but fails when trying to lookup value inside of the dict it believes is available steps to reproduce have host named something such as bastion currently have one setup in my ssh config playbook to reproduce this bug expected results actual results >>>bug_report p2
allow gitkeep in the jsonfile fact cache dir issue type feature pull request ansible version devel environment ubuntu 12 04 managed from arch summary would like to add gitkeep` file to the `cache dir` used by the `jsonfile` fact cache so can run ansible from fresh checkout of my repo without any additional setup this pr modifies the `jsonfile` fact cache so that it ignores hidden files in the `cache dir` rfc bcoca >>>feature_pull_request
ansible doc get module list text breaks if not on tty issue type bug report ansible version ansible environment os should be independent of the os though summary `ansible doc list` breaks if stdin is not tty this makes it impossible to obtain list of all modules within another program an online help system for ansible modules like https github com lunaryorn ansible doc el steps to reproduce run expected results list of all ansible modules just like in `ansible doc list` without dev null` actual results the following traceback >>>bug_report p2
request honor the no proxy environment variable would like to submit this feature request the no proxy variable is not being honored by ansible this adds support for that in module utils urls py thanks>>>feature_pull_request
the command module chdir arg is parsed incorrectly when using dictionary syntax and async issue type bug report ansible version ansible environment running ansible on and managing os 10 10 running ansible on debian and managing ubuntu 14 04 summary `command` where the `chdir` argument is specified in an `args` dictionary is ignored or the value is replaced with the root directory when `async` is also used steps to reproduce download and run this gist https gist github com lukeorland 1feaef1be7640ad8fa65 with the command expected results the expected result is for the playbook to run successfully without any failures actual results the task touch file with async mapping syntax fails with permission denied error due to ansible attempting to touch file under the directory >>>bug_report p2
ansible is available in the main gentoo repository signed off by justin lecher >>>docs_pull_request
fixes for fetch module when connecting to windows hosts abadger made changes in https github com ansible ansible commit f1267c0b053e5975dc08c151530c802015902242 and https github com ansible ansible commit bc4272d2a26e47418c7d588208482d05a34a34cd to shell plugins that weren applied for powershell this pr adds powershell implementations of the `expand user` and `checksum` methods also reduced the buffer size for fetching files to 5mb was getting an ioerror with some ec2 windows hosts when using 1mb buffer >>>bugfix_pull_request p2 windows
ansible galaxy should not connect to api server unless its needed as title currently trying to init or install from scm role without external connectivity results in an error that the api server cannot be contacted >>>feature_idea
include inventory modules in distribution currently inventory modules are only available on github it would be cool if they could be bundled in with the release so they can be used without needing to be separately downloaded>>>feature_idea p2
changed plugin load priority to be path based not suffix based this should fix 9674>>>bugfix_pull_request p2
referencing host variable from another file doesn always work anymore issue type bug report ansible version current head e61e8a37f50860534610ef767315d70ba61583a2 bug introduced by https github com ansible ansible commit f1267c0b053e5975dc08c151530c802015902242 diff af869caf5f6f46706dbf35970e39c686r1166 environment summary referencing host variable from another file doesn always work anymore this is follow up for 9667 it describes related but distinct issue that isn fixed by e61e8a37f50860534610ef767315d70ba61583a2 steps to reproduce run the playbook in https gist github com jscheid 5e688b3ba00cd9af6c83 more generally define two variable files that each use `to json` on variable defined in the other file resp use the `template` action expected results should be able to reference variable defined in other file output with 716f3eb6d98af14dc896f4bd3b551c7c85febb6c and on target host actual results unable to reference variable defined in other file output with f1267c0b053e5975dc08c151530c802015902242 or e61e8a37f50860534610ef767315d70ba61583a2 >>>bug_report p1
disk size for advanced drives over tb is incorrect sys block sdx queue physical block size does not correlate with sys block sdx size for advanced drives larger than 2tb sys block sdx queue logical block size correlates with both see 9549 this undoes work done by 5761 we may want to rather keep displaying the physical block size for sector size but then the math of sectors sectorsize will no longer hold true perhaps we want to report logicalsectorsize and physicalsectorsize using logical sector size seems like the best option for now >>>bugfix_pull_request p2
make sure the port obtained from parsing url is an integer this playbook demonstrates the problem it fails for me with >>>bug_report p2
allow multiple vault password files this pr adds support for passing multiple vault password file when decrypting all the files will be used in turn until one matches tried not to break vars plugins which are passed the current vault password in case there or password but they will break for they ll get list in `vault password` tried to change v2 too `make newtests` passes but don really know how to make sure the v2 changes work >>>feature_pull_request
not pulling library modules if core exists issue type bug report ansible version environment os summary ve got modified version of rhn channel in library folder after upgrading from to the un modified version gets pulled instead of the modified version steps to reproduce export ansible keep remote files change rhn channel module copy into library folder and run test playbook against rhn channel ssh into the target host and take look at the rhn channel file in ansible tmp expected results modified version gets used actual results shipped version gets used >>>bug_report needs_info p2
report location filename and line number for inventory syntax errors when ansibleerror is raised for syntax error in an inventory file report filename and line number to help pinpointing the error >>>feature_pull_request
fact caching docs don mention gathering smart issue type documentation report ansible version environment summary the documentation on fact gathering http docs ansible com playbooks variables html fact caching doesn say anything about the advantages of setting `gathering smart` in your ansible cfg file in conjunction with fact gathering if you do this and don explicitly specify `gather facts` in your plays then apparently ansible will only gather facts if the fact cache is empty or stale >>>docs_report
cannot express host pattern that is group slice issue type bug report ansible version ansible environment summary host pattern to do list slicing does not work as described in http docs ansible com intro patterns html one should be able to express or but this will result in no hosts found steps to reproduce expected results host2 should have been selected it the one you get from expressing db as it the only item in the list other than the first one patterns pattern replace split >>>bug_report p2
using variable for task results in file could not be read issue type bug report ansible version ansible configured module search path none environment multiple osx ubuntu 12 04 ubuntu 14 04 summary when use variables to identify task file to run ansible no longer resolves the variable and returns `error file could not read steps to reproduce `git clone https github com joehack3r temp git` `pip install ansible 2` `ansible playbook myplaybook yml` `pip install ansible 1` `ansible playbook myplaybook yml` expected results `play start instance skipping no hosts matched` play recap actual results `error file could not read roles myrole tasks my2015tasks `>>>bug_report p1
extra var not present when host var evaluated issue type bug report ansible version bug introduced by https github com ansible ansible commit f1267c0b053e5975dc08c151530c802015902242 diff af869caf5f6f46706dbf35970e39c686r1166 environment summary can rely anymore on extra variables being present when host variables are evaluated steps to reproduce run the playbook in https gist github com jscheid fac33da8580ad1880606 more generally define host variable that applies `to json` to an extra variable use the `template` action expected results extra variables should always be set when host variables are being evaluated output with 716f3eb6d98af14dc896f4bd3b551c7c85febb6c actual results extra variables aren always set when host variables are being evaluated output with f1267c0b053e5975dc08c151530c802015902242 >>>bug_report p1
correct typo of actively attempt >>>docs_pull_request p2
correct typo of actively the word actively seems more appropriate than activity here >>>docs_pull_request
fix misspelled necessarily >>>docs_pull_request p2
module template wrong resolves user home dir with tilde issue type bug report ansible version environment ubuntu 14 04 summary after updating from to module template doesn resolve tilde as home of sudo user str run playbook with ansible ssh user vagrant in inventory file execute task sudo user user123 template src ssh config dest ssh config expected result file copy to home user123 ssh config actual result file is tried copy to home vagrant ssh config >>>bug_report p1
add elasticache parameter group parameter to elasticache module hi just an idea feature request that would be really useful if you want to manage almost everything related to elasticache through ansible it would be really useful to have the parameter parameter group for the cache parameters groups on elasticache when creating cache cluster right now there is no way to choose different parameter group than the default one instead you have to use the aws managment console to do this >>>cloud feature_idea
make sure windows modules are installed fixes https github com ansible ansible issues 9659 while ps1 files are included in the setup tarball they aren installed for both and >>>bugfix_pull_request p1 windows
bug module setup not found in configured module paths for windows hosts with ansible issue type bug report ansible version official installed with pip ansible configured module search path none environment running from ubuntu 14 04 managing windows 2008 r1 summary during gathering facts phase get this error for any windows hosts steps to reproduce run playbook targeting windows with gather facts enabled expected results the gathering facts phase to pass successfully actual results module setup not found in configured module paths >>>bug_report p1 windows
give nice message when trying to use undefined variable within jinja2 template instead of write msg typeerror argument of type strictundefined is not iterable failed true give nice message similar to the one defined in template from string function >>>bugfix_pull_request
fix for 9607 syntax check executes vars prompt summary when syntax checking playbook with syntax check the user is prompted for input when vars prompt is processed this prevents automated syntax checking steps to reproduce create playbook using vars prompt check syntax with ansible playbook syntax check expected results ansible playbook non interactively checks the syntax of the supplied playbooks no part of the playbook is executed it is only checked for syntax actual results ansible playbook prompts the user for input during the syntax checking processes whenever vars prompt occurs >>>feature_pull_request needs_rebase
ansible can use the lookup with included lookup in hosts key issue type bug report ansible version also in develop environment rhel summary when use the lookup with pipe or file with included another lookup for get hosts variable need that it be various in some tasks ve got empty results if use just one lookup without included it worked well also lookup with including lookup worked well in for example debug module steps to reproduce expected results actual results >>>bug_report p2
ansible git with recursive ignores accept hostkey when executing the `git` command with `recursive yes` the `accept hostkey yes` directive is ignored for submodules if the submodule remote is different server to the main git repo the ansible script hangs waiting for manual authentication of the remote >>>bug_report
add ansible vault view command to the docs added the missing ansible vault view command to the docs because it awesome >>>docs_pull_request
run sftp in in batch mode normally the return code of sftp is always independent of failure or success of the interactive commands as consequence put or get errors in the ssh connection plugin are not detected right now if sftp is used for file transport which is the default by switching to batch mode the return code of sftp is nonzero if the put or get fails >>>bugfix_pull_request
update test strategies rst switch from old format action module to newer format module >>>docs_pull_request
bug regression variables read by debug not used in other modules issue type bug ansible version environment from archlinux against openbsd summary ansible doesn seem to use `ansible python interpreter` variable even though it reads it according to `debug` module this is regression from `ansible 2` steps to reproduce use `hosts` file similar to the following host `192 168 5` doesn have usr bin python2` executable but has usr local bin python2 7` run these expected results successful execution of both commands actual results >>>bug_report p2
docker port mappings not working name running docker registry container docker image tcurdt docker registry name docker registry state running net host volumes volumes ports 127 5000 5000 should be the equivalent of running `docker run name registry 127 5000 5000 srv docker registry srv docker registry tcurdt docker registry` but it not it seems to ignore the port mapping plus the documentation is horrible no clue how multiple port mappings are supposed to work assume have to use the same hack use for volumes this is on docker version build 39fa2fa ansible 2>>>bug_report p2
blob devel plugins inventory ec2 py no support for authentication via iam roles having followed aws best practices an instance profile with limited privileged was created and the ansible instance running on aws was associated with it this way no credentials need to be hardcoded in the instance itself can confirm this works with awscli below is very trimmed down output from aws ec2 describe instances region eu west debug running on the instance 2014 11 27 07 09 43 934 mainthread botocore credentials debug looking for credentials via env 2014 11 27 07 09 43 934 mainthread botocore credentials debug looking for credentials via assume role 2014 11 27 07 09 43 934 mainthread botocore credentials debug looking for credentials via shared credentials file 2014 11 27 07 09 43 935 mainthread botocore credentials debug looking for credentials via config file 2014 11 27 07 09 43 935 mainthread botocore credentials debug looking for credentials via ec2 credentials file 2014 11 27 07 09 43 935 mainthread botocore credentials debug looking for credentials via boto config 2014 11 27 07 09 43 935 mainthread botocore credentials debug looking for credentials via iam role 2014 11 27 07 09 43 946 mainthread botocore vendored requests packages urllib3 connectionpool info starting new http connection 169 254 169 254 2014 11 27 07 09 43 957 mainthread botocore vendored requests packages urllib3 connectionpool debug get latest meta data iam security credentials http 200 56 2014 11 27 07 09 43 959 mainthread botocore vendored requests packages urllib3 connectionpool info starting new http connection 169 254 169 254 2014 11 27 07 09 43 960 mainthread botocore vendored requests packages urllib3 connectionpool debug get latest meta data iam security credentials xxxxxxxxx http 200 910 2014 11 27 07 09 43 961 mainthread botocore credentials info found credentials from iam role xxxxxxxxx unfortunately it is very different story with ec2 py renamed to just hosts here traceback most recent call last file hosts line 738 in ec2inventory file hosts line 166 in init self do api calls update cache file hosts line 319 in do api calls update cache self get instances by region region file hosts line 331 in get instances by region conn self ec2 connect region file hosts line 720 in ec2 connect conn ec2 connect to region region self connect args file usr lib python2 dist packages boto ec2 init py line 55 in connect to region for region in regions kw params file usr lib python2 dist packages boto ec2 init py line 38 in regions ec2connection kw params file usr lib python2 dist packages boto ec2 connection py line 88 in init security token file usr lib python2 dist packages boto connection py line 852 in init security token security token file usr lib python2 dist packages boto connection py line 486 in init host config self provider self required auth capability file usr lib python2 dist packages boto auth py line 407 in get auth handler check your credentials len names str names boto exception noauthhandlerfound no handler was ready to authenticate handlers were checked querysignaturev2authhandler check your credentials there seems to be some work going on to address other forms of authentication the above is already patched ec2 py from https github com ansible ansible pull 9505 but even then it won work perhaps missed something >>>bug_report cloud
enable plugins for jinja2 tests issue type feature pull request summary move boolean filters to `test plugins core py` and enable users to write their own test plugins register all test plugins additionally as filter plugins to retain backwards compatibility supersedes 8235 discussed but never resolved here https groups google com forum topic ansible devel oa6xsffchjg >>>feature_pull_request needs_revision p2
added facts for openindiana openindina report i86pc so changed the regex to detect this arch used the oracle solaris as template for openindiana>>>feature_pull_request needs_info
ansible not detecting pre existing ebs volume getting this after run playbook second time playbook snippet >>>bug_report cloud
permit instances with no public ip address currently the `gce` dynamic inventory script dies when an instance has no public ip address it shouldn given that an instance may be accessible through vpn to the instance private ip address this patch leaves an instance with no public ip address with `gce public ip` of null and uses the private ip for `ansible ssh host` >>>cloud feature_pull_request
fix issue with ssl wrap socket not using tlsv1 version by default fix small issue when doing url request to remote that forces tlsv1 and does not support sslv2 or v3 seems we are doing tlsv1 by default anyway in customhttpsconnection >>>feature_pull_request p2
don template play vars by themselves it too early summary templating the play variables before the rest of the variables are loaded can lead to wrong results in variables example inventory example playbook expected results actual results >>>bug_report p1
is it not possible to set comment in the same line error if variable defined with the comment >>>docs_pull_request p1
postgresql user no longer works in issue type bug report ansible version ansible configured module search path none environment running from ubuntu 14 04 in fresh virtualenv ansible installed with pip managed os is ubuntu 14 04 summary postgresql user tasks fail with stacktrace steps to reproduce task postgresql user name test password test sudo user postgres expected results creates the db user if missing actual results task db user failed failed true parsed false sudo success oisqwddolheudkppwhnhkbgjdwjwzucd traceback most recent call last file tmp ansible tmp 1417008833 32 259074618651633 postgresql user line 2251 in main file tmp ansible tmp 1417008833 32 259074618651633 postgresql user line 481 in main role attr flags parse role attrs module params role attr flags file tmp ansible tmp 1417008833 32 259074618651633 postgresql user line 405 in parse role attrs if not flag set is subset valid flags attributeerror frozenset object has no attribute is subset >>>bug_report p1
relative file lookup inside roles no longer works issue type bug report ansible version ansible environment debian wheezy summary have file stored as roles mariadb files mariadb gpg using the lookup plugin to read its contents no longer works when using relative path inside the role it used to work in but not anymore in steps to reproduce put file in roles mariadb files mariadb gpg then run playbook that utilizes the mariadb role the contents of roles mariadb tasks main yml the contents of the playbook expected results the contents of the mariadb gpg file actual results >>>bug_report p1
setting lc messages prevent unparseable messages fixes issue 9635 this locale variable defines how tools should display their messages this is for example gonna change the yum message from nothing to do to rien faire in my case french as the yum module parses that string in err if the message is not enforced in english this is gonna fail so this commits just enriches bit more the code that already written for that enforcement this commit fixes issue 9635 >>>bugfix_pull_request
lc messages should also be forced ansible may not behave the same depending on your ssh config sendenv values hi just spent some hours yesterday digging into an issue to sum up we people all run our playbooks from the same control machine we connect with ssh to the tested playbook was working fine for everyone but me we finally found out it has to do with etc ssh ssh config which seems to be default setting nowadays on servers mistake imo but that another story sendenv lc and then some yum messages get displayed in my native language instead of english which makes ansible unable to correctly parse out the nothing to do string as it actually becomes rien faire was the only one using linux as my box having this settings since the others were connecting from windows machines pure waste as you migh imagine anyway imo the value of ansible is that you expect it to kind of behave the same not depending on who running the playbook and in this case ansible fails in some cases because ssh sub layers screws up one might say that the solution is just to comment out the line above in the ssh config but though we indeed already did it don feel this is durable solid solution hence think we should enforce this in the ansible code setting lc messages as is already done with setting lc ctype and lang >>>bug_report
ansible setup module is not working under suse enterprise linux 11 sles11 issue type bug report ansible version ansible environment suse enterprice linux server 11 sp3 sles11sp3 64 bit summary have found an issue in ansible when use setup module under suse enterprose linux it brings be other results as ansible machine data is uname linux suse02i 101 35 default smp wed jul 11 43 04 utc 2014 c36987d x86 64 x86 64 x86 64 gnu linux cat etc suse release suse linux enterprise server 11 x86 64 version 11 patchlevel steps to reproduce ansible setup ansible hosts all grep dist expected results ansible command ansible setup ansible hosts all grep dist ansible distribution suse ansible distribution major version 11 ansible distribution release ansible distribution version 11 facter lsbdistcodename facter lsbdistdescription suse linux enterprise server 11 x86 64 facter lsbdistid suse linux facter lsbdistrelease 11 facter lsbmajdistrelease 11 actual results ansible command pdmadm22 suse02i ansible setup ansible hosts all grep dist ansible distribution suse ansible distribution major version 11 ansible distribution release x86 64 ansible distribution version 11 facter lsbdistcodename facter lsbdistdescription suse linux enterprise server 11 x86 64 facter lsbdistid suse linux facter lsbdistrelease 11 facter lsbmajdistrelease 11 in ansible sles sp3 is shown in ansible distribution release in ansible is does not work anymore had allready mailed this bug few days ago but in final it is stil present have created the following patch now it works under ansible as expected again ansible setup ansible hosts all grep dist ansible distribution sles ansible distribution major version 11 ansible distribution release ansible distribution version 11 facter lsbdistcodename facter lsbdistdescription suse linux enterprise server 11 x86 64 facter lsbdistid suse linux facter lsbdistrelease 11 facter lsbmajdistrelease 11 can you please check this need the correct sp value in ansible distribution realse and ansible distribution should be sles unter sles in all of my ansible scripts >>>bug_report p2
mysql user module doesn add grant privilege assigned to the user issue type bug report ansible version ansible version ansible configured module search path none environment centos summary mysql user module cannot provide grant option to the database user steps to reproduce our ansible playbooks worked with an invocation of the module as below this is based off the example in http docs ansible com mysql user module html expected results ansible step succeeds with the user being granted the specified privileges actual results with we get >>>bug_report p2
ec2 inventory enhancement adds ability to address dynamic servers by local dns or etc hosts if you run local dns server and or have your ec2 hosts stored in etc hosts using friendlier names than the default amazon fqdn it is convenient to be able to address them this also allows for nice tricks such as defining groups and variables in static inventory hosts file and merging them with the dynamic inventory such that all the variables become available example assuming that host web0 is defined in etc hosts default behavior new behavior when enabled via ec2 ini use local dns true as bonus it allows merging with groups defined in inventory hosts for example in the above example assuming that web0 exists in etc hosts one can address it via tag name or via web0 and the server type variable will properly be pulled this helps avoid accidents in certain configurations when one invokes playbook via tag and another via hostname and causes differences in configured variables >>>cloud feature_pull_request
unable to combine two variables in template dest think have uncovered bug in the template module whatever do can remove inserted quotes for dest path which are inserted by ansible the same combination does work for other modules have tried using the join filter but this produces the same results below is the relevant debug info vars xbmc docker dir xbmc docker home opt docker name create advanced settings file for our mysql xbmc server template src advancedsettings xml j2 dest docker home xbmc docker dir xbmcdata userdata advancedsettings xml owner root group root mode 0644 error task xbmc headless docker create advanced settings file for our mysql xbmc server failed thorn home stanandliz net failed true msg destination directory opt docker xbmc xbmcdata userdata does not exist fatal all hosts have already failed aborting>>>bug_report needs_info p2
fixes to template function fix listification by partially reverting change to how terms are passed noted in 9622 added missing parameters to recursive calls to function to keep calls consistent replaced var named vars reserved python for templatevars>>>bugfix_pull_request p1
prevent empty diffs being written between task messages when running playbook with the check and diff options empty diffs are still passed to the display method resulting in an empty line being output between each task message this pr simply checks non empty diff was returned before passing to display >>>bugfix_pull_request needs_rebase
an ansible inventory garnered from fleetctl modeled after the vagrant inventory >>>feature_pull_request
particular jinja construct doesn evaluate to list anymore in devel issue type bug report ansible version ansible devel 8e7447962e last updated 2014 11 25 11 12 10 gmt 200 lib ansible modules core detached head 10ebcccedb last updated 2014 11 25 11 12 10 gmt 200 lib ansible modules extras detached head 317654dba5 last updated 2014 11 25 11 12 10 gmt 200 v2 ansible modules core detached head cb69744bce last updated 2014 10 07 09 23 36 gmt 200 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 10 07 09 23 40 gmt 200 configured module search path usr share ansible worked fine in environment ubuntu 14 04 on management host summary using the result of difference between two lists in loop `java all packages difference java pkg steps to reproduce this debug output shows the values of each variable expected results list with all items except `oracle java7` actual results ansible yields an error on the result not being list when used in with items loop `fatal tomcathost with items expects list or set please note that adding the `list` filter like this doesn help here `java all packages difference java pkg list`>>>bug_report p1
variables from var files are not properly expanded issue type bug report ansible version ansible devel d36c38c35e last updated 2014 11 25 13 43 44 gmt 200 lib ansible modules core detached head 10ebcccedb last updated 2014 11 25 13 45 21 gmt 200 lib ansible modules extras detached head 317654dba5 last updated 2014 11 25 13 45 27 gmt 200 v2 ansible modules core detached head cb69744bce last updated 2014 11 25 13 45 32 gmt 200 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 11 25 13 45 38 gmt 200 configured module search path usr share ansible according to git bisect the bug was introduced with commit 9a0f8f015877e8f1ae3c728a035120a25d4e7fa9 used to fix 9498 environment fedora 20 summary variables from var files are not properly expanded steps to reproduce mkdir vars mkdir playbooks mkdir handlers cat files eof eof cat vars global yml eof basedir lookup env ansible public basedir handlers basedir handlers eof cat playbooks example yml eof hosts example vars files lookup env ansible public basedir vars global yml handlers include handlers restart services yml eof cat handlers restart services yml eof eof ansible public basedir pwd ansible playbook playbooks example yml expected results play example skipping no hosts matched play recap actual results error file could not read home till ansible bug playbooks handlers restart services yml >>>bug_report needs_info p1
fix group variable precedence in 6734 group variables defined in inventory should override entries in the group vars directories add regression test >>>bugfix_pull_request p2
playbook dir not available for include in devel branch 19606afe5f issue type bug report ansible version devel 19606afe5f environment mac os 10 10 using virtualenv with python summary ansible is not be able to resolve playbook dir when including task file from another role steps to reproduce sample at https github com mfriedenhagen ansible no playbookdir given you checked out `ansible` to ansible` and initialized submodules please run expected results output of `ansible playbook hosts local playbook yml` with actual results running `ansible playbook hosts local playbook yml` now ends with >>>bug_report p2
allow to select subset of tasks with only add only to alow to easily select subset of tasks to run this makes development of playbooks easier faster because one can select only the tasks that one modified to run instead of starting full ansible run each time >>>feature_pull_request
sudo user in task should imply sudo true in task edited description hi had some problems with sudo user switching config file not changed ansible server linux mint 17 remote host ubuntu server 14 04 lts test yml in docs saw this example http docs ansible com playbooks intro html you can also login as you and then sudo to different users than root but as you see it not quite right help please how can execute command under specific user not root end not remote user >>>bug_report needs_info
fix synchronize local fixes issue 9606>>>bugfix_pull_request p2
windows powershell encoding fix for python this commit fixes ansible ansible 8588 root cause kudos to tom for the interesting encoding debug session bug scenario the try catch mechanism doesn work if no special characters are present in command it assumes unicode whereas utf was given this leads to task module name to be of type unicode the module name is part of the command string the command string is then processed by powershell py powershell py uses shlex to parse the command but the shlex doc for python states that the shlex module currently does not support unicode input this leads to base64encoded string which contains lot of zeroes and is quite long like this in b64 aaaaaaaaaeeaaaaaaaaacaaaaaaaaabwaaaaaaaaaeqaaa powershell fails to handle this broken base64 string saying it cannot find file which is the drive letter rest of command is cut off symptoms running any of the win modules the following message is shown using vvvv debug level winrm result failed logonebm6 int failed true parsed false invalid output was processing file failed because the file does not have ps1 extension specify valid windows powershell script file name and then try again fatal all hosts have already failed aborting>>>bugfix_pull_request needs_info p2 windows
ansible keep remote files not preventing temp files from being deleted here are the results from running playbook with ansible keep remote files before execution gathering facts task after playbook is done can reproduce this at will ansible el7 noarch >>>bug_report needs_info
add support for win copy win file and win template modules this pr is for the supporting action plugins and integration tests needed to support the core windows modules available from https github com ansible ansible modules core pull 384 both this pr and the one referenced above would be needed to add win copy win file and win template modules >>>feature_pull_request p2 windows
suggestion additional options for ansible vault issue type feature idea ansible version ansible environment summary like to suggest adding two options to the ansible vault command ask vault pass just like with ansible playbook this would be useful if you have default vault password file in your ansible config but want to override it mode when you edit file ansible vault changes the file mode to 0600 even if you don make any changes in some cases you may need this to be different if you run ansible playbook as different user so it would be nice to be able to set the mode yourself steps to reproduce expected results actual results a>>>feature_idea
with is not evaluating jinja2 expressions withouth issue type bug report ansible version ansible devel 116109468c last updated 2014 11 24 21 06 08 gmt 300 lib ansible modules core detached head 19b328c4df last updated 2014 11 24 21 05 39 gmt 300 lib ansible modules extras detached head e64751b0eb last updated 2014 11 24 21 05 40 gmt 300 v2 ansible modules core detached head cb69744bce last updated 2014 11 24 21 06 56 gmt 300 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 11 24 21 07 01 gmt 300 configured module search path usr share ansible environment archlinux summary with subelements fails when giving it list of dicts passed through some jinja2 filter steps to reproduce inventory users name someuser password somepass authorized keys ssh public keys key1 pub ssh public keys key2 pub name anotheruser password anotherpass playbook task name add authorized keys for users authorized key user item name key lookup file item with subelements users rejectattr authorized keys undefined list authorized keys tags users expected results expect it to work as it works on actual results gives the error subelements lookup expects dictionary got users rejectattr authorized keys undefined list >>>bug_report p2
ansible cfg does not recognize home properly edit in ssh args with these values set in my home ansible cfg private key file home ssh keypair pem the output for the command `ansible playbook vvvv check hosts site yml` include exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home rkasten ansible cp ansible ssh port 22 identityfile home ssh keypair pem kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user keypair connecttimeout 10 host bin sh mkdir home ansible tmp ansible tmp 1416843520 79 15764353703490 chmod rx home ansible tmp ansible tmp 1416843520 79 15764353703490 echo home ansible tmp ansible tmp 1416843520 79 15764353703490 and in the ssh debug section there is this debug1 trying private key home ssh keypair pem no such identity home ssh keypair pem no such file or directory however the command `ansible playbook vvvv check private key home ssh keypair pem hosts site yml` works fine with this output exec ssh tt vvv controlmaster auto controlpersist 60s controlpath home rkasten ansible cp ansible ssh port 22 identityfile home rkasten ssh keypair pem kbdinteractiveauthentication no preferredauthentications gssapi with mic gssapi keyex hostbased publickey passwordauthentication no user keypair connecttimeout 10 host bin sh mkdir home ansible tmp ansible tmp 1416843941 97 204104573912616 chmod rx home ansible tmp ansible tmp 1416843941 97 204104573912616 echo home ansible tmp ansible tmp 1416843941 97 204104573912616 is this by design >>>bug_report
syntax check executes vars prompt issue type bug report ansible version ansible environment summary when syntax checking playbook with syntax check the user is prompted for input when vars prompt is processed this prevents automated syntax checking steps to reproduce create playbook using vars prompt check syntax with ansible playbook syntax check expected results ansible playbook non interactively checks the syntax of the supplied playbooks no part of the playbook is executed it is only checked for syntax actual results ansible playbook prompts the user for input during the syntax checking processes whenever vars prompt occurs >>>bug_report p2
synchronize module doesn prepend path to src when run locally issue type bug report ansible version environment vagrant ubuntu 14 04 summary synchronize module doesn prepend ansible role xxx files directory to src steps to reproduce have the following role name copy solr directory to tomcat synchronize src solr dest tomcat dir then run as normal from localhost ansible playbook ansible site vagrant yml ansible stage connection local expected results in the generated python file module complex args dest home vagrant webapps tomcat src home vagrant ansible roles solr files solr actual results in the generated python file module complex args dest home vagrant webapps tomcat src solr >>>bug_report p2
display more info when ssh errors occur this is in the same vein as 9603 but it is more ambitious in that it attempts to display more helpful info for number of different ssh errors sample outputs cc sontek aconrad sudarkoff>>>feature_pull_request
nameerror global name group is not defined trying to run ec2 group to create security groups in aws name create magneto security group magneto group local action module ec2 group name magneto group description magneto description region ec2 region rules proto tcp ssh from port 22 to port 22 group name jumpbox group group desc jumpbox description proto tcp http from port 80 to port 80 cidr ip proto tcp http from port 8080 to port 8080 cidr ip rules egress proto all group name tt magneto group group desc security group for magneto nodes proto all cidr ip this produces this error failed 127 failed true parsed false invalid output was traceback most recent call last file home ubuntu ansible tmp ansible tmp 1416814033 57159820801170 ec2 group line 1770 in main file home ubuntu ansible tmp ansible tmp 1416814033 57159820801170 ec2 group line 292 in main group id ip target group created get target from rule rule name groups file home ubuntu ansible tmp ansible tmp 1416814033 57159820801170 ec2 group line 139 in get target from rule group id group id nameerror global name group is not defined the security group tt magneto group does correctly get setup but the task fails given the above error >>>bug_report cloud p2
more useful error when host key verification fails this changes the error message when host key verification fails from to full output >>>feature_pull_request
handle powershell parameters passed via splatting allows powershell arguments such as the following to be passed to scripts cmdlets script myscript ps1 this this that that other other more info on splatting http technet microsoft com en us magazine gg675931 aspx via discussion on ansible project mailing list https groups google com forum topic ansible project jojvfohowqm >>>feature_pull_request windows
set delegate on connection plugin before calling connect the `host` argument currently passed to the connection plugin reflects the value of `ansible ssh host` or `delegate to` whereas inventory variables are looked up by hostname since `conn delegate` is currently set after the `connect method is called on the plugin it is not always possible to access host variables before connecting with this change connection plugin can use the following code to read host variables prior to making connection def connect self hostvars self runner inventory get variables self delegate or self host do stuff with hostvars and connect return self planning to use this approach to support additional host variables for authentication with winrm connection without having to handle these host variables as special case within runner >>>feature_pull_request
make ansibleerror plain ol exception python `exception` constructor already takes `message` as parameter which you can then get at by doing `str `e message` was deprecated the reason bothered to make this change was because was debugging with pdb and noticed that `ansibleerror`s don give useful information in pdb probably because they don have repr method that prints the `msg` attribute pdb users marca dev git repos ansible lib ansible runner init py 599 executor msg str ae pdb ae ansibleerror >>>feature_pull_request
fixes ansible modules core issues 302 https github com ansible ansible modules core issues 302>>>bugfix_pull_request
make version report the active config file this is useful for troubleshooting note the last line above note also that `lib ansible config py` https github com msabramo ansible blob make version report active config file lib ansible config py is pretty much just extracted from `lib ansible constants py` but while was at it made sure that the new file is flake8 compliant cc sontek sudarkoff>>>feature_pull_request
making hacking env setup init git submodules this is more convenient than manually doing it >>>feature_pull_request needs_info
add auto accept hostkey to ansible pull>>>feature_pull_request
small fix of code syntax in markdown in markdown it is enough to use single backquotes for inline code blocks so replaced double backquotes with single backquotes >>>docs_pull_request
jinja rand filter now supports repeatable randomness by passing in seed which allows for repeatable randomness in conjunction with variable that unique per host this allows for repeatable random values per host that most importantly don change for each run of the playbook ex ansible all debug msg 60 random seed inventory hostname personally would like to use this to repeatably splay set of cron jobs across cluster of hosts>>>feature_pull_request needs_revision
feature added puppetdb based inventory script have written an inventory script based on puppetdb using the python pypuppetdb library so ansible and puppet can be used together>>>feature_pull_request
change to the new syntax>>>docs_pull_request
use full timestamp so backups during the same minute dst changes are unique when testing playbooks on single host it easily possible to make multiple changes to file within single minute and it possible for there to be confusion during daylight savings rollover this patch includes the time zone without resorting to dateutil tz tested by applying the patch to my installed copy of as lack all the dependencies for full test example output grub conf 2014 11 20 21 22 46 393099 0800 grub conf 2014 11 21 06 36 32 014887 0100 >>>feature_pull_request
test git add tests for version case this test covers recently fixed bug https github com ansible ansible modules core issues 313>>>feature_pull_request
add missing behavioral inventory parameters in doc>>>docs_pull_request
fixing wrong make command in docsite readme fixed the documentation make command for the html output from `webdocs` to `htmldocs` in the docsite readme md>>>docs_pull_request
adding inventory parameter to documentation adding the inventory parameter `ansible sudo` to the list of behavioural inventory parameters in the intro inventory documentation >>>docs_pull_request
change location of ec2 ini example to moved location if you right click on the `ec2 ini` file in the docs it downloads file with 301permmove >>>docs_pull_request p2
apt provider unable to purge package once removed ansible version from pip also tested and confirmed with environment ubuntu 12 04 summary the apt provider does not purge packages that are removed but not yet purged state rc steps to reproduce install and remove without purging random package now try to purge the package expected results actual results >>>bug_report
feature request ability to skip includes currently if do something like the included playbook is parsed and every step in it is skipped if the conditional is not met this can generate lot of extraneous output to no useful end since nothing is going to be done can we get unusable to be able to simply ignore the include even if that would require different module like cond include >>>feature_idea
parsing traceback in issue type bug report ansible version environment mac os 10 10 yosemite summary yaml traceback when hosts in playbook is number steps to reproduce create simple playbook and set hosts to number expected results playbook should run or if that not possible for some reason output should be more friendly and informative actual results flamingo rdte joliver ansible playbook java yml play 111 traceback most recent call last file opt local bin ansible playbook line 309 in sys exit main sys argv file opt local bin ansible playbook line 249 in main pb run file opt local library frameworks python framework versions lib python2 site packages ansible playbook init py line 339 in run if not self run play play file opt local library frameworks python framework versions lib python2 site packages ansible playbook init py line 635 in run play play play hosts self inventory list hosts play hosts file opt local library frameworks python framework versions lib python2 site packages ansible inventory init py line 494 in list hosts result name for in self get hosts pattern file opt local library frameworks python framework versions lib python2 site packages ansible inventory init py line 185 in get hosts patterns pattern replace split attributeerror int object has no attribute replace >>>bug_report
detect bhyve hosts and guests>>>feature_pull_request
duplicate role execution with role denpendencies issue type bug report ansible version ansible dfsg bpo70 environment debian summary today try to split our grown ansible roles in more simple roles after do some work realize that after rewrite and set some dependencies in our roles some roles got executed multiple times so google bit and found an bug report https github com ansible ansible issues 5971 which descibe the same behavior the bug gets closed because of not reproducable and no further information so recreate the simple test in comment nr and bam no duplicate running after some testing figured out the only difference to our plays the duplicate run is triggered if you add some tags to the play as sugested in https groups google com msg ansible project 3tc6muz1dfi jhfnplvccxcj ve open this bug report steps to reproduce run without duplicates test yml name dependency test gather facts false hosts localhost connection local roles role base role feature roles base meta main yml roles base tasks main yml name in base debug msg here we are in base roles feature meta main yml dependencies role base roles feature tasks main yml name in feature debug msg here we are in feature play dependency test task base in base ok localhost msg here we are in base task feature in feature ok localhost msg here we are in feature play recap localhost ok changed unreachable failed run with duplicates test yml name dependency test gather facts false hosts localhost connection local roles role base tags base role feature tags feature roles base meta main yml roles base tasks main yml name in base debug msg here we are in base roles feature meta main yml dependencies role base roles feature tasks main yml name in feature debug msg here we are in feature play dependency test task base in base ok localhost msg here we are in base task base in base ok localhost msg here we are in base task feature in feature ok localhost msg here we are in feature play recap localhost ok changed unreachable failed expected results if the playbook is run and the roles are tagged the dependencys should run only once actual results if the playbook is run and the roles are tagged the dependencys run multiple times >>>bug_report
ansible connect windows sslerror errno ssl 1429 error 14094438 ssl routines ssl3 read bytes tlsv1 alert internal error env ansible control ubuntu 14 04 x64 ansible1 client windows server 2012 r2 x64 my steps control pip install http github com diyan pywinrm archive master zip egg pywinrm cat etc ansible hosts win2 192 168 cat etc ansible group vars win2 yml ansible ssh user administrator ansible ssh pass 3krxusezvdx5 ansible ssh port 3389 ansible connection winrm then run the scripts on windows server 2012 r2 upgrade to ps3 ps1 configureremotingforansible ps1 https github com ansible ansible blob devel examples scripts configureremotingforansible ps1 the question root instance jb53h7st ansible win2 win ping 192 168 failed traceback most recent call last file usr local python2 lib python2 site packages ansible py2 egg ansible runner init py line 588 in executor exec rc self executor internal host new stdin file usr local python2 lib python2 site packages ansible py2 egg ansible runner init py line 767 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file usr local python2 lib python2 site packages ansible py2 egg ansible runner init py line 930 in executor internal inner conn self connector connect actual host actual port actual user actual pass actual transport actual private key file file usr local python2 lib python2 site packages ansible py2 egg ansible runner connection py line 51 in connect self active conn connect file usr local python2 lib python2 site packages ansible py2 egg ansible runner connection plugins winrm py line 132 in connect self protocol self winrm connect file usr local python2 lib python2 site packages ansible py2 egg ansible runner connection plugins winrm py line 86 in winrm connect protocol send message file usr local python2 lib python2 site packages winrm protocol py line 190 in send message return self transport send message message file usr local python2 lib python2 site packages winrm transport py line 82 in send message response urlopen request timeout self timeout file usr local python2 lib python2 urllib2 py line 127 in urlopen return opener open url data timeout file usr local python2 lib python2 urllib2 py line 404 in open response self open req data file usr local python2 lib python2 urllib2 py line 422 in open open req file usr local python2 lib python2 urllib2 py line 382 in call chain result func args file usr local python2 lib python2 urllib2 py line 1222 in https open return self do open httplib httpsconnection req file usr local python2 lib python2 urllib2 py line 1187 in do open getresponse buffering true file usr local python2 lib python2 httplib py line 1067 in getresponse response begin file usr local python2 lib python2 httplib py line 409 in begin version status reason self read status file usr local python2 lib python2 httplib py line 365 in read status line self fp readline maxline file usr local python2 lib python2 socket py line 476 in readline data self sock recv self rbufsize file usr local python2 lib python2 ssl py line 246 in recv return self read buflen file usr local python2 lib python2 ssl py line 165 in read return self sslobj read len sslerror errno ssl 1429 error 14094438 ssl routines ssl3 read bytes tlsv1 alert internal error can you help me >>>bug_report windows
windows install of ansible using pip fails because of pwd module not dupe of 7049 have the same problem as issue 7049 except not using cygwin just installed the official python installer then ran `python get pip py` to install `pip` when running `pip install ansible` get the above error importerror no module named pwd >>>windows
add list hosts to man pages fixes 9574>>>docs_pull_request
cache plugin that stores facts persistently in local json dumps for those who want low key low impact cache>>>feature_pull_request p2
dependencies in requirements yml do not use path description if you have specified path for your required dependency it should be preserved for all requirements id assume example requirements yml drush from galaxy installing to relative path in this project src geerlingguy drush path roles desired operation should download the dependency geerlingguy php to the reltive path roles as well actual result tries and fails to download it to etc ansible roles which assume is the role path on this machine workaround any wayward souls looking for short term fix can find one by using local ansible cfg instead defaults roles path roles version ansible master branch as of issue date >>>bug_report
start at task option causes error when specify utf name task issue type bug report ansible version ansible 4ae2d58d728a9185252593d818cf029b208b9b6a environment macosx with python freebsd python summary ansible playbook with start at task option to utf named task cause error steps to reproduce and type ansible playbook localhost utf8 taskname yml start at task expected results start normally actual results thank you for developing ansible ansible is totally cool >>>bug_report p2
updated shebang from bin bash to usr bin env bash more flexible >>>feature_pull_request
assertions fail with template error in ansible when an assertion is made with an expression that doesn evaluate to boolean ansible correctly displays the error message error while evaluating conditional observe that in but not in previous versions certain expressions produce different error message template error while templating string here is sample playbook to reproduce the issue and the result >>>bug_report
wip added deploy helper module tests did not know if this was required but it seemed prudent to add tests for the deplot helper module the pull request for the module is on the ansible modules extra repository https github com ansible ansible modules extras pull 110 consider this wip the tests all run down here and they cover all the module features parameters but still like to have second opinion >>>feature_pull_request
manual entry for the deploy module guide this is proposed guide for using the deploy helper module in this pull request https github com ansible ansible modules extras pull 110 >>>docs_pull_request
fix file mode calculation since 9da0627 file mode calculation is incorrect for example when `umask` is `0077` file mode is `0611` instead of `0600` see 898a38b 7196 >>>feature_pull_request
start step docs moved text from original provided by sjahl to keep the playbooks intro simple>>>docs_pull_request p2
adding nested dictionary lookups this lookup accepts nested dicts of potentially any depth and recursively flattens them to single dict with `value` and one or more numbered keys `key 0` `key 1` `key n` my use case for this was dicts nested two levels deep for configuring an ini file where the first level was section name and the second level was the option name and the scalar value for it and the example task >>>feature_pull_request
fix documentation link to issue template on the ansible community page http docs ansible com community html in the like to report bug section the link to the issue template is broken it links to url https raw2 github com ansible ansible devel issue template md which results in github 404 page not found error page fix points link to url that works >>>docs_pull_request p2
minor clarifications of variable precedence hope this removes some of the confusion>>>docs_pull_request p2
add ipaddr filter plugin with `ipaddr filter plugin you can test and manipulate ip addresses and network ranges inside jinja2 templates `python netaddr` library is used as the backend and is required on ansible controller but not on remote hosts more information and usage examples can be found here https github com drybjed ansible ipaddr filter>>>feature_pull_request
ansible vault cannot be used for any multiline content sensitive to whitespace related to 9172 multiline literal variables have doubled newlines contrary to yaml spec input edit the workaround specified in 9172 does not work task expected correct output actual output this makes it impossible to use ansible vault to protect content such as ssl certificates or ssh keys to be used with ansible vault they must be in yaml files as variables and they also must be multiline literals however after decryption they will have doubled newlines and will fail this severely limits the utility of ansible vault right now ve written script that manually deletes all doubled newlines from the output files but this should be fixed >>>bug_report
allow fact objects to be instantiated triggering all fact collection this opens the ability to do specific facts at much lower cost now you can instantiate the fact object and call the methods only of the facts you need but you must be aware some facts require other facts to be collected first mostly os distro >>>feature_pull_request
lookup plugin template doesn search the same paths as file ansible version the problem file lookup plugin searches for file in the playbook directory and in the role files directory when using the template plugin the playbook directory isn searched and lookup returns empty string if file is not found lookup file config test j2 returns the file contents lookup template config test j2 return empty string lookup template home somebody project config test j2 absolute path works as expected the dir structure is >>>bug_report p2
wrong disk size 21tb instead of 3tb this is bug report attaching label currently unavailable for me hello ve got an issue using ansible from os 10 to debian see the root size of 21 tb after executing ansible groupname hosts setup` but this is actually the tb disk dev sda` is detected correctly please tell me if should provide something more >>>bug_report p2
removed yaml as documented local facts format as it is not supported and would require extra modules on target this solves 9519 >>>docs_pull_request
implemented info action for galaxy this should fix 9258>>>bugfix_pull_request p2
lineinfile fails in check mode if file doesn exist with ansible on centos have the following task to add line to file if the file doesn exist yet when run my playbook with check get the following error it works fine without check and creates the file from then on it works with check since the file exists >>>bug_report p2
fix ssh sudo hang use python backport of subprocess to prevent ssh processes from hanging indefinitely see 9544 >>>bugfix_pull_request
ssh sudo password can hang indefinitely issue type bug report ansible version ansible version ansible environment macos also occurs on ubuntu 14 04 summary ssh logins that require sudo passwords can hang indefinitely steps to reproduce think the bug could be be reproduced if you enable sudo passwords and change sudo to program that runs sleep 10 before it executes then run playbook with the ask sudo parameter with that machine in the inventory here is what think is happening ansible attempts to ssh into machine ansible successfully logs in and attempts to run sudo sudo takes while and requires password to be entered ansible does select on the read socket the select times out after 10 seconds ansible waits for the ssh process to terminate from ansible runner connection plugins ssh py however since ansible is logged in and sudo is running the process never terminates communicate gets stuck essentially think this is corner case where the ssh login succeeds but the time it takes for sudo to execute and ask for password exceeds the timeout since the ssh session was successful the ssh process will never return causing ansible to hang indefinitely verified this was happening by adding continue here this worked essentially short time later the select returned successfully and ansible functioned well to confirm this added some debug statements using time time here is what saw start of first select 10 000742 timeout occurs 10 000874 second select returns successfully how to fix this ideally we would have some way of knowing that the ssh session successfully logged in but was waiting for sudo don think there is foolproof way of knowing this in any case communicate should have timeout so that if ssh fails to terminate we either terminate the ssh process or run select again just to be sure there are some ideas here for how to implement timeout http stackoverflow com questions 1191374 subprocess with timeout for now ve worked around the problem by changing timeout 20 but think the code still needs to prevent communicate from getting stuck expected results ssh logins and sudo executes fine actual results ssh process never returns and causes ansible to get stuck think similar issue was reported in issue 8058 >>>bug_report
docker inventory script tls connection support this pr adds tls connection support for the docker inventory script have come across the problem of the docker inventory script not working any more with boot2docker the issue is that boot2docker creates server that wants to use full tls mutually authenticated connection server cert client cert the current docker inventory script does not support tls connection settings setup notable changes now you can use the script to inventorize one docker instance by having the configuration variables stored in shell environment variables boot2docker example by default boot2docker will use tls as of version boot2docker init eval boot2docker shellinit export docker assert hostname boot2docker docker py list now the connection settings stored in shell environment variables are imported using docker py docker utils kwargs from env function that properly sets up the kwargs including the docker tls tlsconfig needed by the connection constructor the configuration data structures and so the yaml confguration file were changed so that the server connection configuration sits in its own dict now the script supports multiple connection methods plain simple unauthenticated https mutually authenticated tls this means that the docker client connection init now can be called with may different signatures cherrypicking the options can lead to problems either leaving something out or calling with an incompatible constellation of options it cleaner and more maintainable to keep this settings in seperate dict that can be used as kwargs for the connection constructor now the variable names in the server configuration stanza correspond to the arguments of the constructor of the docker client class the exception being the tls object the tlsconfig class is instantiated with the kwargs in the tls config object for reference the signature of the docker tls tlsconfig init def init self client cert none ca cert none verify none ssl version none assert hostname none the signature of the docker client init def init self base url none version default docker api version timeout default timeout seconds tls false configuration example defaults server base url https 192 168 59 103 2376 tls config client cert home me boot2docker certs boot2docker vm docker dev cert pem home me boot2docker certs boot2docker vm docker dev key pem ca cert home me boot2docker certs boot2docker vm docker dev ca pem verify true assert hostname false ssl version tlsv1 version timeout 60 the old style settings are imported for the script needs to be backward compatible for imported settings tls is disabled as the old configuration had no support for tls settings if you have an old style configuration file and you want tls connections you will have to convert your settings if you don want tls you don need to do anything >>>feature_pull_request
allow multiple interpreters to be specified it may be inconvenient to set specific ansible interpreter explicitly for each host in inventory instead allow the specification of comma separated list of interpreters the first time an interpreter is required for given host try them in turn until an executable is found and cache the value for future use >>>feature_pull_request
ssh password auth host key checking enabled hangs osx issue type bug report ansible version ansible version ansible devel ffc2e5a627 last updated 2014 11 12 08 46 40 gmt 200 lib ansible modules core detached head 2970b339eb last updated 2014 11 06 15 57 19 gmt 200 lib ansible modules extras detached head ad181b7aa9 last updated 2014 11 06 15 57 33 gmt 200 v2 ansible modules core detached head cb69744bce last updated 2014 11 06 15 57 45 gmt 200 v2 ansible modules extras detached head 8a4f07eecd last updated 2014 11 06 15 57 58 gmt 200 configured module search path none environment osx 10 pip list duplicity 24 ecdsa 11 jinja2 libvirt python markupsafe 18 mercurial msgpack python paramiko 15 pika 14 pip py 25 py rrdtool pycrypto pytest pyyaml 10 setuptools untangle vboxapi wsgiref xmltodict summary ssh connection hangs when host key checking is enabled steps to reproduce cat hosts vms trusty ansible trusty hosts setup ssh password echo defaults echo host key checking false ansible cfg ansible trusty hosts setup ssh password trusty success ansible facts ansible all ipv4 addresses etc aside the correct host key is already cached at least for the command line ssh client ssh trusty hostname brian trusty password trusty but know it using paramiko because it gave an error about paramiko being required until installed it `sudo pip install paramiko` expected results either would prompt to accept the host key or would terminate with an error actual results hangs as shown above unless host key checking is turned off >>>bug_report
screen program broken in working pre have shell task that runs bin installer as follows name exec one click installer shell screen test bash tmp cloudera manager installer bin agree to all licenses noprompt noreadme nooptions tags execoneclick ansible reports rc but the program never executes screenlog is zero bytes so no help there am left with dead screen session on the target machine screen rd reports it as dead can use ssh to execute the same line successfully and the bin program does indeed run you can get the bin file am using from wget http archive cloudera com cm5 installer latest cloudera manager installer bin tmp cloudera manager installer bin>>>bug_report
shell command modules extraneous single quote being prepended to command issue type bug report ansible version also occurs with latest head running from fresh git clone sourced with hacking env setup` environment ubuntu 14 04 amd64 on ec2 summary am using the shell module to install rvm using globally installed rvm executable no matter whether use the shell or the command module an extraneous quote is being inserted at the beginning of my command and causing either module to fail steps to reproduce please see https gist github com tombamford 2ceff646e72f2885fa34 for example playbook and inventory file to reproduce the issue gist also includes verbose output from running `ansible playbook` expected results the command to be run evaluates to this command should be run on the remote node actual results the command appears to be evaluated as note the phantom single quote at the start of the command this causes the shell module to fail with the following error please see the gist at https gist github com tombamford 2ceff646e72f2885fa34 for full output >>>bug_report
updates to configureremotingforansible ps1 updated firewall rules to include changes from https github com ansible ansible pull 9372 and https github com ansible ansible pull 9474 if run on host already configured with an earlier version of the script it will update the existing firewall rule if run multiple times on the same host it will not create additional firewall rules updated error handling so the script will stop and return nonzero exit code on failure updated comments messages capitalization whitespace for consistency readability maybe https github com ansible ansible blob devel coding guidelines md needs powershell section tested against server 2008 2008 r2 2012 and 2012 r2 on ec2 by adding the following user data invoke expression new object net webclient downloadstring https raw githubusercontent com cchurch ansible 2f7348fddf3add69eb620d5e1ca6cdf1ec55a534 examples scripts configureremotingforansible ps1 >>>bugfix_pull_request feature_pull_request p2 windows
ignore failed errors when running in checked mode issue type feature idea ansible version environment centos summary while running my scripts in check mode often get errors that make the script fail that would otherwise work in actual mode for example touch file and then add configuration information to the file in check mode it fails to add the config info because the file doesn exist steps to reproduce expected results imagine this would be tough to add status message against and this logic below may not suit all cases if file exists and changed changed else if file exists and not changed ok else if file does not exist changed should always occur since file was just created unless it was created by template end if actual results >>>feature_idea
netmask to cidr function added to help convert between netmasks given in the facts to cidr value supply jinja function to help us out this was discussed in https github com ansible ansible issues 8584 but it doesn look like anyone tried to get it in the tree >>>feature_pull_request
add tags options to ansible pull ed add or tags options to pass to ansible playbook>>>feature_pull_request p2
include it doesn expand variables within its name location issue type bug report ansible version ansible environment macosx summary ive tried to use ansible distribution in order to execute tasks dynamically depending on the operating system but it doesn expand the variables steps to reproduce create defaults main yml create hosts create site yml create tasks main yml create tasks install package yml create tasks package macosx yml create tasks package centos yml create tasks package ubuntu yml results it doesn expand those variables is this bug >>>bug_report
vars prompt private logging feature issue type feature idea ansible version environment centos summary for some of my scripts am asking for some protected information from the user passwords etc that are applied to configuration files am using the replace module that has the with items portion each item is logged to the screen and it would be beneficial for the logged item to be xxx out if private was set to yes steps to reproduce expected results actual results >>>feature_idea
rax py inventory improvements this pr adds the following improvements to the `rax py` inventory script adds support for rackconnect v3 by allowing the user to configure which network to use for `ansible ssh host` as well as whether to use ipv4 or ipv6 adds support for reading configurations from config file as well as environment vars example config file is provided supports servers booted from volume the ability to specify the access network and access ip version also supports fallbacks specifying `rax access network public private` and `rax access ip version 4` will look for public ipv6 public ipv4 private ipv6 and finally private ipv4 if no matching networks are found `ansible ssh host` will not be set ultimately falling back to the `inventory hostname` additionally the in code documentation has been cleaned up this pr supersedes 9307 extra testing appreciated angstwad claco>>>feature_pull_request
support nested modules with ansible library env var this pr adds support to look for modules in nested directories when using `ansible library` due to ansible now using git submodules don init the submodules for dev purposes instead have my own forks cloned and use currently when using ansible set up this way ansible fails to find any modules >>>feature_pull_request p1
host not found exception with host aliases issue type bug report ansible version ansible version ansible devel 3ff8f01087 last updated 2014 11 10 16 58 15 gmt 800 lib ansible modules core devel 6317d3a988 last updated 2014 11 10 14 35 41 gmt 800 lib ansible modules extras devel 5a514ccdda last updated 2014 11 10 14 35 58 gmt 800 v2 ansible modules core devel 6317d3a988 last updated 2014 11 10 14 34 25 gmt 800 v2 ansible modules extras devel 5a514ccdda last updated 2014 11 10 14 35 10 gmt 800 configured module search path none environment summary https github com ansible ansible commit f1267c0b053e5975dc08c151530c802015902242 causes host not found exceptions when used with host aliases believe its due to https github com ansible ansible commit f1267c0b053e5975dc08c151530c802015902242 diff af869caf5f6f46706dbf35970e39c686l1162 steps to reproduce cat testhosts testalias ansible ssh host ip address testvar testvalue cat testplaybook yml hosts testalias gather facts false tasks copy content testvar dest tmp testfile ansible playbook testhosts testplaybook yml expected results file tmp testfile with content testvalue on host ip address actual results ansible playbook testhosts testplaybook yml play testalias task copy content testvar dest tmp testfile fatal testalias traceback most recent call last file path to ansible lib ansible runner init py line 582 in executor exec rc self executor internal host new stdin file path to ansible lib ansible runner init py line 755 in executor internal return self executor internal inner host self module name self module args inject port complex args complex args file path to ansible lib ansible runner init py line 988 in executor internal inner result handler run conn tmp module name module args inject complex args file path to ansible lib ansible runner action plugins copy py line 178 in run remote checksum self runner remote checksum conn tmp path dest file file path to ansible lib ansible runner init py line 1164 in remote checksum inject self get inject vars conn host file path to ansible lib ansible runner init py line 606 in get inject vars host variables self inventory get variables host vault password self vault pass file path to ansible lib ansible inventory init py line 442 in get variables raise exception host not found hostname exception host not found ip address fatal all hosts have already failed aborting play recap to retry use limit path to testplaybook retry testalias ok changed unreachable failed >>>bug_report needs_info p1
delete import json several syntax changes import json called twice in first it will call an exception if json module not installed >>>bugfix_pull_request p2
